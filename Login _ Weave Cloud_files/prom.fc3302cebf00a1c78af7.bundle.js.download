(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{1219:function(e,t,n){"use strict";n.d(t,"f",function(){return l}),n.d(t,"g",function(){return u}),n.d(t,"d",function(){return p}),n.d(t,"e",function(){return m}),n.d(t,"a",function(){return d}),n.d(t,"c",function(){return f}),n.d(t,"b",function(){return y});var r=n(6),o=n.n(r),a=n(15),i=n.n(a),c=n(23),s=n(1232),l=Object(c.createSelector)([function(e){return o()(e,["root","timeTravel","timestamp"])},function(e){return o()(e,["root","timeTravel","rangeMs"])}],function(e,t){return i()(e).subtract(t).utc().format()}),u=Object(c.createSelector)([l],function(e){return i()(e).unix()}),p=Object(c.createSelector)([function(e){return o()(e,["root","timeTravel","timestamp"])}],function(e){return i()(e).utc().format()}),m=Object(c.createSelector)([p],function(e){return i()(e).unix()}),d=m,f=Object(c.createSelector)([function(e){return o()(e,["root","timeTravel","rangeMs"])}],function(e){return e/1e3}),y=Object(c.createSelector)([f],function(e){return Object(s.a)(e)})},1221:function(e,t,n){"use strict";var r=n(185),o=n.n(r),a=n(0),i=n.n(a),c=n(22),s=n(9),l=n(13),u=n.n(l),p=n(15),m=n.n(p),d=n(64),f=n(2),y=n(111),b=n(11),h=n(76),_=n(7),v=n(16),g=n(1232),k=n(125);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(n,!0).forEach(function(t){C(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var q=m.a.duration(2,"weeks").asSeconds(),T=function(e){function t(e){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=E(t).call(this,e),n=!a||"object"!==w(a)&&"function"!=typeof a?P(r):a,C(P(n),"updateUrl",function(e){n.props.exploreContext?window.location=e:u.a.push(e)}),C(P(n),"updatedPath",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n.props.exploreContext)return Object(b.u)(S({},n.props.sharedQueryParams,{},e),n.props.instanceId);var t=u.a.getCurrentLocation(),r=t.hash,o=Object(k.h)(e,n.props.location);return"".concat(n.props.location.pathname).concat(o).concat(r)}),C(P(n),"updateUrlWith",function(e){var t=u.a.getCurrentLocation(),r=t.pathname,o=t.search,a=t.hash,i=decodeURI("".concat(r).concat(o).concat(a)),c=n.updatedPath(e);c!==i&&n.updateUrl(c)}),C(P(n),"updateVisibleRange",function(e){var t=e.startAt,r=e.endAt,o=n.props,a=o.instanceId,i=o.workloadId,c=void 0===i?v.FLUX_ALL_WORKLOADS:i,s=m()(r).unix(),l=m()(t).unix();n.setState({visibleRangeEndAtSec:s,visibleRangeStartAtSec:l}),s-l<q&&(n.setState({isLoadingDeployments:!0}),n.props.getFluxHistory(a,c,null,r,!0,t).then(function(){n.setState({isLoadingDeployments:!1})}))}),C(P(n),"handleLiveModeChange",function(e){n.props.updateTimeTravelLiveState(e),e&&n.updateUrlWith({timestamp:null})}),C(P(n),"handleTimestampChange",function(e){n.props.updateTimeTravelTimestamp(e),n.updateUrlWith({timestamp:e})}),C(P(n),"handleRangeChange",function(e){var t=Object(k.j)({rangeMs:e}).range;n.props.updateTimeTravelRange(e),n.updateUrlWith({range:t})}),C(P(n),"trackTimelineTimestampEdit",function(){Object(_.trackEvent)("timeline.timestamp.edit")}),C(P(n),"trackTimelineTimestampButtonClick",function(){Object(_.trackEvent)("timeline.timestamp.button.click")}),C(P(n),"trackTimelinePanButtonClick",function(){Object(_.trackEvent)("timeline.pan.button.click")}),C(P(n),"trackTimelinePan",function(){Object(_.trackEvent)("timeline.pan")}),C(P(n),"trackTimelineZoom",function(e){Object(_.trackEvent)("timeline.zoom",{zoomedPeriod:e})}),C(P(n),"trackDeploymentClick",function(){Object(_.trackEvent)("timeline.deployment.click")}),C(P(n),"deploymentsLinkBuilder",function(e){return Object(b.q)(n.props.sharedQueryParams,n.props.instanceId,e)}),n.state={isLoadingDeployments:!1,visibleRangeEndAtSec:null,visibleRangeStartAtSec:null},n.debouncedUpdateVisibleRange=o()(n.updateVisibleRange,500),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.props.showingLive&&this.startAutoRefreshTimer(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.props.showingLive!==e.showingLive&&(e.showingLive?this.startAutoRefreshTimer(e):this.stopAutoRefreshTimer()),this.props.rangeMs!==e.rangeMs&&e.showingLive&&(this.stopAutoRefreshTimer(),this.startAutoRefreshTimer(e))}},{key:"componentWillUnmount",value:function(){this.stopAutoRefreshTimer(),this.debouncedUpdateVisibleRange.cancel()}},{key:"startAutoRefreshTimer",value:function(e){var t=this,n=e.hasRangeSelector,r=e.rangeMs,o=n?Object(g.a)(r):1e4;this.props.updateTimeTravelTimestamp(Object(k.c)()),this.autoRefreshTimer=setInterval(function(){t.props.updateTimeTravelTimestamp(Object(k.c)())},o)}},{key:"stopAutoRefreshTimer",value:function(){clearInterval(this.autoRefreshTimer)}},{key:"render",value:function(){var e=this.state,t=e.isLoadingDeployments,n=e.visibleRangeStartAtSec,r=e.visibleRangeEndAtSec,o=this.props.deployments.filter(function(e){var t=m()(e.Stamp).unix();return n<=t&&t<=r});return i.a.createElement(s.TimeTravel,{hasLiveMode:!0,showingLive:this.props.showingLive,onChangeLiveMode:this.handleLiveModeChange,timestamp:this.props.timestamp,earliestTimestamp:this.props.firstSeenConnectedAt,onChangeTimestamp:this.handleTimestampChange,hasRangeSelector:this.props.hasRangeSelector,rangeMs:this.props.rangeMs,onChangeRange:this.handleRangeChange,onUpdateVisibleRange:this.debouncedUpdateVisibleRange,onTimestampInputEdit:this.trackTimelineTimestampEdit,onTimelineLabelClick:this.trackTimelineTimestampButtonClick,onTimelinePanButtonClick:this.trackTimelinePanButtonClick,onTimelineZoom:this.trackTimelineZoom,onTimelinePan:this.trackTimelinePan,onDeploymentClick:this.trackDeploymentClick,deploymentsLinkBuilder:this.deploymentsLinkBuilder,deployments:o,isLoading:t})}}])&&j(n.prototype,r),a&&j(n,a),t}();T.defaultProps={exploreContext:!1,hasRangeSelector:!1},t.a=Object(c.connect)(function(e,t){var n=t.instanceId,r=t.workloadId,o=Object(d.f)(n)(e);return S({deployments:Object(h.a)(e,n,r),firstSeenConnectedAt:o&&o.firstSeenConnectedAt,sharedQueryParams:Object(y.b)(e),timeState:e.root.timeTravel},e.root.timeTravel)},{getFluxHistory:f.A,updateTimeTravelLiveState:f.Yb,updateTimeTravelRange:f.Zb,updateTimeTravelTimestamp:f.ac})(T)},1232:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){return e/200}},1266:function(e,t,n){"use strict";n.d(t,"a",function(){return j});var r=n(188),o=n.n(r),a=n(14),i=n.n(a),c=n(39),s=n.n(c),l=n(228),u=n.n(l),p=n(0),m=n.n(p),d=n(5),f=n.n(d),y=n(1);function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var k=y.default.div.withConfig({displayName:"tab-selector__TabSelectorWrapper",componentId:"sc-1s9qozc-0"})([""]),w=y.default.div.withConfig({displayName:"tab-selector__TabButtons",componentId:"sc-1s9qozc-1"})([""]),O=y.default.button.withConfig({displayName:"tab-selector__TabButton",componentId:"sc-1s9qozc-2"})(["cursor:pointer;margin-bottom:-1px;margin-right:5px;padding:10px 20px;font-size:",";outline:0;",";",""],function(e){return e.theme.fontSizes.large},function(e){var t=e.selected,n=e.theme;return"\n    background-color: ".concat(t?n.colors.white:n.colors.gray50,";\n    border-top-left-radius: ").concat(n.borderRadius.soft,";\n    border-top-right-radius: ").concat(n.borderRadius.soft,";\n    border: 1px solid ").concat(n.colors.purple100,";\n  ")},function(e){return e.selected&&"border-bottom: 1px solid transparent;"}),S=y.default.span.withConfig({displayName:"tab-selector__TabName",componentId:"sc-1s9qozc-3"})(["color:",";opacity:",";"],function(e){return e.theme.colors.purple900},function(e){return e.selected?1:.65}),j=y.default.div.withConfig({displayName:"tab-selector__TabContent",componentId:"sc-1s9qozc-4"})(["padding:20px;background-color:",";",";"],function(e){return e.theme.colors.white},function(e){return"\n    border-top-right-radius: ".concat(e.theme.borderRadius.soft,";\n    border-bottom-right-radius: ").concat(e.theme.borderRadius.soft,";\n    border-bottom-left-radius: ").concat(e.theme.borderRadius.soft,";\n    border: 1px solid ").concat(e.theme.colors.purple100,";\n  ")}),E=function(e){function t(e){var n,r,o,a,i,c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=_(t).call(this,e),n=!o||"object"!==b(o)&&"function"!=typeof o?v(r):o,a=v(n),c=function(e){n.setState({selectedTabId:e.props.id}),n.props.onSelectedTabChange&&n.props.onSelectedTabChange(e.props.id)},(i="handleClick")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n.state={selectedTabId:e.selectedTabId},n.isTabSelected=function(e){return e.props.id===n.state.selectedTabId},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,m.a.Component),n=t,(r=[{key:"componentWillReceiveProps",value:function(e){e.selectedTabId!==this.props.selectedTabId&&this.setState({selectedTabId:e.selectedTabId})}},{key:"render",value:function(){var e=this,t=u()(o()(this.props.children)),n=s()(t,this.isTabSelected);return m.a.createElement(k,null,m.a.createElement(w,null,i()(t,function(t,n){return m.a.createElement(O,{key:n,selected:e.isTabSelected(t),onClick:function(){return e.handleClick(t)}},m.a.createElement(S,{selected:e.isTabSelected(t)},t&&t.props.name))})),m.a.createElement(j,null,n&&n.props.children))}}])&&h(n.prototype,r),a&&h(n,a),t}();E.propTypes={selectedTabId:f.a.string.isRequired},t.b=E},1268:function(e,t,n){"use strict";var r=n(126),o=n.n(r),a=n(0),i=n.n(a),c=n(22),s=n(9),l=n(7),u=n(86),p=n(8),m=n(11),d=n(111),f=n(1219);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=function(e){function t(e,n){var r,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=_(t).call(this,e,n),r=!a||"object"!==y(a)&&"function"!=typeof a?v(o):a,k(v(r),"trackDeploymentClick",function(){Object(l.trackEvent)("prom.graph.deployment.click")}),k(v(r),"deploymentsLinkBuilder",function(e){return Object(m.q)(r.props.sharedQueryParams,r.props.instanceId,e)}),r.state={endTimeSec:e.endTimeSec,error:null,isFirstLoading:!0,multiSeries:[],startTimeSec:e.startTimeSec,stepDurationSec:e.stepDurationSec},r.activeRequest=null,r.queuedRequestParams=null,r}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,i.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.maybeFetchGraphData(this.props)}},{key:"componentWillReceiveProps",value:function(e){var t=e.instanceId!==this.props.instanceId,n=e.query!==this.props.query,r=e.rangeSec!==this.props.rangeSec,o=e.endTimeSec!==this.props.endTimeSec;if(t||n||r||o){var a=Math.abs(e.endTimeSec-this.props.endTimeSec)>2*e.stepDurationSec;t||n||r||a?(this.setState({isFirstLoading:!0}),this.activeRequest&&this.activeRequest.cancel()):this.props.onRefreshStart&&this.props.onRefreshStart(),this.maybeFetchGraphData(e)}}},{key:"componentWillUnmount",value:function(){this.queuedRequestParams=null,this.activeRequest&&this.activeRequest.cancel()}},{key:"fetchGraphData",value:function(e){var t=this,n=e.query,r=e.startTimeSec,o=e.endTimeSec,a=e.stepDurationSec,i={end:o,query:n,start:r,step:a};this.activeRequest=Object(u.a)(Object(p.X)(this.props.instanceId,i).then(function(e){return Promise.resolve(function(e){var t=[],n=null;return"matrix"!==e.data.resultType?n="Result is not of matrix type!":e.data.result&&0===e.data.result.length?n="No datapoints found. Maybe the metric does not exist?":t=e.data.result,{error:n,multiSeries:t}}(e))},function(e){return Promise.resolve({error:e.error||e.errors[0].message})}));var c=this.activeRequest,s=window.performance.now();c.promise.then(function(e){var i=e.isCanceled,c=e.multiSeries,l=void 0===c?[]:c,u=e.error,p=window.performance.now();if(t.queuedRequestParams){var m=t.queuedRequestParams;t.queuedRequestParams=null,t.fetchGraphData(m)}else t.activeRequest=null;if(!i){var d=t.state.isFirstLoading,f=Math.round(p-s),y={isFirstLoading:d,query:n,responseTime:f};u&&t.props.onReceiveError&&t.props.onReceiveError(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(n,!0).forEach(function(t){k(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({error:u},y)),!u&&t.props.onReceiveSuccess&&t.props.onReceiveSuccess(y),t.props.onRefreshFinish&&t.props.onRefreshFinish(l),t.setState({endTimeSec:o,error:u,isFirstLoading:!1,multiSeries:l,startTimeSec:r,stepDurationSec:a})}})}},{key:"maybeFetchGraphData",value:function(e){var t=o()(e,["query","startTimeSec","endTimeSec","stepDurationSec"]);this.activeRequest?this.queuedRequestParams=t:this.fetchGraphData(t)}},{key:"render",value:function(){return i.a.createElement(s.PrometheusGraph,{error:this.state.error,loading:this.state.isFirstLoading,multiSeries:this.state.multiSeries,stepDurationSec:this.state.stepDurationSec,startTimeSec:this.state.startTimeSec,endTimeSec:this.state.endTimeSec,yAxisLabel:this.props.yAxisLabel,metricUnits:this.props.metricUnits,valuesMinSpread:this.props.valuesMinSpread,showStacked:this.props.showStacked,colorTheme:this.props.colorTheme,simpleTooltip:this.props.simpleTooltip,legendCollapsable:this.props.legendCollapsable,legendShown:this.props.legendShown,renderLegendItemSuffix:this.props.renderLegendItemSuffix,selectedLegendKeys:this.props.selectedLegendKeys,getSeriesKey:this.props.getSeriesKey,onChangeLegendSelection:this.props.onChangeLegendSelection,onDeploymentClick:this.trackDeploymentClick,deploymentsLinkBuilder:this.deploymentsLinkBuilder,deployments:this.props.deployments})}}])&&h(n.prototype,r),a&&h(n,a),t}();t.a=Object(c.connect)(function(e,t){var n=t.startTimeSec;return{endTimeSec:Object(f.e)(e),rangeSec:Object(f.c)(e),sharedQueryParams:Object(d.b)(e),startTimeSec:n||Object(f.g)(e),stepDurationSec:Object(f.b)(e)}})(w)},1273:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(1),i=n(22),c=n(2),s=n(76),l=n(16),u=n(1219),p=n(1326);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=a.default.div.withConfig({displayName:"dashboard__DashboardRow",componentId:"sc-9im5gp-0"})(["display:flex;align-items:stretch;justify-content:space-between;"]),_=a.default.div.withConfig({displayName:"dashboard__DashboardChartSlot",componentId:"sc-9im5gp-1"})(["width:",";border-radius:",";background-color:",";"],function(e){return"calc(100% / ".concat(e.numberOfColumnsPerRow,")")},function(e){return e.theme.borderRadius.soft},function(e){return e.focused?e.theme.colors.blue50:"transparent"}),v=function(e){function t(){var e,n,r,o,a,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=this,o=(e=f(t)).call.apply(e,[this].concat(l)),n=!o||"object"!==m(o)&&"function"!=typeof o?y(r):o,a=y(n),c=function(e){var t=e.id;return t&&t===n.props.focusedChartId},(i="isChartFocused")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.props.updateTimeStateFromUrl(this.props.location)}},{key:"componentWillReceiveProps",value:function(e){e.location.search!==this.props.location.search&&this.props.updateTimeStateFromUrl(e.location),e.endTime===this.props.endTime&&e.startTime===this.props.startTime||this.props.getFluxHistory(this.props.instanceId,l.FLUX_ALL_WORKLOADS,null,e.endTime,!0,e.startTime)}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,this.props.rows.map(function(t){return o.a.createElement(h,{key:t.key},t.charts.map(function(n){return o.a.createElement(_,{"data-id":n.id,key:n.title,focused:e.isChartFocused(n),numberOfColumnsPerRow:t.charts.length},o.a.createElement(p.a,{key:n.title,yAxisLabel:n.yAxisLabel,metricUnits:n.metricUnits,valuesMinSpread:n.valuesMinSpread,getLabel:n.getLabel,colorTheme:n.colorTheme,showStacked:n.showStacked,hideOnNoMetrics:n.hideOnNoMetrics,title:n.title,query:n.query,instanceId:e.props.instanceId,namespaceId:e.props.namespaceId,filterDeployments:n.filterDeployments,deployments:e.props.deployments,startTime:e.props.startTimeSec,endTime:e.props.endTimeSec,queryStepSeconds:e.props.queryStepSec,rangeSeconds:e.props.rangeSec,selectedLegendKeys:e.props.selectedLegendKeys,renderLegendItemSuffix:e.props.renderLegendItemSuffix}))}))}))}}])&&d(n.prototype,r),a&&d(n,a),t}();t.a=Object(i.connect)(function(e,t){var n=t.instanceId;return{deployments:Object(s.a)(e,n),endTime:Object(u.d)(e),endTimeSec:Object(u.e)(e),queryStepSec:Object(u.b)(e),rangeSec:Object(u.c)(e),startTime:Object(u.f)(e),startTimeSec:Object(u.g)(e)}},{getFluxHistory:c.A,updateTimeStateFromUrl:c.Xb})(v)},1279:function(e,t,n){"use strict";n.d(t,"b",function(){return B});var r=n(103),o=n.n(r),a=n(113),i=n.n(a),c=n(49),s=n.n(c),l=n(32),u=n.n(l),p=n(102),m=n.n(p),d=n(126),f=n.n(d),y=n(186),b=n.n(y),h=n(47),_=n.n(h),v=n(62),g=n.n(v),k=n(78),w=n.n(k),O=n(6),S=n.n(O),j=n(0),E=n.n(j),P=n(1),x=n(22),C=n(9),q=n(7),T=n(76),R=n(8),I=n(11),N=n(111),L=n(1375),D=n(125);function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Q(e){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function F(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e,t){var n=e||D.a.label,r=Object(D.d)(n),o=Math.max(Math.floor(r/250),1),a=t||new Date/1e3;return{end:a,range:n,start:a-r,step:o}}function K(e){return u()(e)?"":JSON.stringify(e,null,1)}var G=function(e){return/\s(by|without|ignoring|on|group_left|group_right)\s?/.test(e)},H=function(e){return/;\s+?\w/.test(e)},V=P.default.div.withConfig({displayName:"prom-graph__PromGraphContainer",componentId:"redg1o-0"})(["margin:0 50px 30px 32px;"]),Y=function(e){function t(e,n){var r,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=Q(t).call(this,e,n),r=!a||"object"!==M(a)&&"function"!=typeof a?F(o):a,z(F(r),"trackDeploymentClick",function(){Object(q.trackEvent)("prom.graph.deployment.click")}),z(F(r),"deploymentsLinkBuilder",function(e){return Object(I.q)(r.props.sharedQueryParams,r.props.instanceId,e)}),r.state={data:[],end:null,start:null,step:null},r.requestQueue=null,r}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(t,E.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.maybeFetchGraphData(this.props)}},{key:"componentWillReceiveProps",value:function(e){e.query===this.props.query&&e.range===this.props.range&&e.end===this.props.end||this.maybeFetchGraphData(e)}},{key:"setError",value:function(e){this.setState({data:[]}),this.props.onReceiveError&&this.props.onReceiveError(e)}},{key:"fetchGraphData",value:function(e){var t=this,n=new Date,r=B(e.range,e.end),a=r.start,i=r.end,c=r.step,s=r.range,l=e.query.split(L.a).map(function(e){return e.trim()}).filter(o.a);if(0!==l.length){this.props.onRequestQuery&&this.props.onRequestQuery();var u=[],p=[];this.requestingQuery=!0,l.reduce(function(e,n){var r={end:i,query:n,start:a,step:c};return e.then(function(){return Object(R.X)(t.props.instanceId,r)}).then(function(e){var t=function(e){var t,n;return"matrix"!==e.data.resultType?n="Result is not of matrix type! Please enter a correct expression.":e.data.result&&0===e.data.result.length?n="No datapoints found. Maybe the metric does not exist?":t=e.data.result,{data:t,error:n}}(e),r=t.data,o=t.error;o&&p.push(o),r&&(u=u.concat(r.map(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(n,!0).forEach(function(t){z(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({query:n},e)})))},function(e){return p.push(e.error||e.errors[0].message)})},Promise.resolve()).then(function(){t.requestingQuery=!1;var e=new Date-n,r=u.length>0;t.onReceiveQuery(),t.props.onReceiveQuery&&t.props.onReceiveQuery({dataReceived:r,end:i,range:s},e),0===u.length&&p.length>0?t.setError(p[0]):t.setState({data:u,end:i,start:a,step:c})})}}},{key:"maybeFetchGraphData",value:function(e){var t=f()(e,["end","query","range"]);this.requestingQuery?this.requestQueue=t:this.fetchGraphData(t)}},{key:"onReceiveQuery",value:function(){if(this.requestQueue){var e=this.requestQueue;this.requestQueue=null,this.fetchGraphData(e)}}},{key:"render",value:function(){if(!this.state.data||0===this.state.data.length)return null;var e,t=this.state.data.length>1;return E.a.createElement(V,null,E.a.createElement(C.PrometheusGraph,{simpleTooltip:!0,legendShown:t,legendCollapsable:t,startTimeSec:this.state.start,endTimeSec:this.state.end,stepDurationSec:this.state.step,multiSeries:this.state.data,onDeploymentClick:this.trackDeploymentClick,deploymentsLinkBuilder:this.deploymentsLinkBuilder,deployments:this.props.deployments,getSeriesNameParts:(e=this.props.query,function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=S()(t.metric,"__name__")||"",a=_()(t.metric,["__name__"]);if(!o){if(u()(a))return[t.query];if(1===w()(a))return G(t.query)&&H(e)?[b()(m()(a)),t.query]:[b()(m()(a))]}if(r&&w()(n)>1){var c=i()(s()(a),function(e){return g()(n,function(t){return t.metric[e]===a[e]})});a=_()(a,c)}return["".concat(o).concat(K(a))]})}))}}])&&U(n.prototype,r),a&&U(n,a),t}();t.a=Object(x.connect)(function(e,t){var n=t.instanceId;return{deployments:Object(T.a)(e,n),sharedQueryParams:Object(N.b)(e)}})(Y)},1291:function(e,t,n){"use strict";var r=n(5),o=n.n(r),a=function(){return null};a.propTypes={id:o.a.string.isRequired,name:o.a.string.isRequired},t.a=a},1299:function(e,t,n){"use strict";var r=n(1),o=n(45),a=r.default.div.withConfig({displayName:"banner__Banner",componentId:"sc-6brsw9-0"})(["padding:12px;margin:8px;background-color:",";border:1px solid ",";border-radius:",";i{margin-right:6px;color:",";}"],function(e){return Object(o.transparentize)(.75,e.theme.colors.yellow500)},function(e){return Object(o.transparentize)(.5,e.theme.colors.yellow500)},function(e){return e.theme.borderRadius.soft},function(e){return e.theme.colors.yellow500});t.a=a},1326:function(e,t,n){"use strict";n.d(t,"a",function(){return k});var r=n(32),o=n.n(r),a=n(0),i=n.n(a),c=n(1),s=n(9),l=n(1268),u=n(7);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=c.default.div.withConfig({displayName:"dashboard-chart__ChartWrapper",componentId:"sc-1w3hpfe-0"})(["box-sizing:border-box;padding:20px 40px;width:100%;",";"],function(e){return e.hide&&"\n    width: 0;\n    position: absolute;\n    visibility: hidden;\n  "}),_=c.default.div.withConfig({displayName:"dashboard-chart__ChartHeader",componentId:"sc-1w3hpfe-1"})(["display:flex;align-items:center;justify-content:center;height:40px;"]),v=c.default.h3.withConfig({displayName:"dashboard-chart__ChartTitle",componentId:"sc-1w3hpfe-2"})(["white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center;padding-left:40px;margin:0;"]),g=c.default.span.withConfig({displayName:"dashboard-chart__ChartTitleSpinner",componentId:"sc-1w3hpfe-3"})(["display:flex;justify-content:center;width:40px;"]),k=function(e){function t(e,n){var r,a,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,i=d(t).call(this,e,n),r=!i||"object"!==p(i)&&"function"!=typeof i?f(a):i,b(f(r),"handleLegendSelectionChange",function(e){r.setState({selectedLegendKeys:e})}),b(f(r),"handleRefreshStart",function(){r.setState({isRefreshing:!0})}),b(f(r),"handleRefreshFinish",function(e){r.setState({hasMetrics:!o()(e),isRefreshing:!1})}),b(f(r),"handleReceiveSuccess",function(e){var t=e.isFirstLoading,n=e.responseTime;Object(u.trackUserTiming)("prom.dashboard.querySuccessTime",n,"Dashboard query time",{chartTitle:r.props.title,initialQuery:t})}),b(f(r),"handleReceiveError",function(e){var t=e.error,n=e.isFirstLoading,o=e.responseTime;Object(u.trackUserTiming)("prom.dashboard.queryErrorTime",o,"Dashboard query time",{chartTitle:r.props.title,error:t,initialQuery:n})}),r.state={hasMetrics:!1,isRefreshing:!1,selectedLegendKeys:e.selectedLegendKeys},r}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,i.a.Component),n=t,(r=[{key:"componentWillReceiveProps",value:function(e){e.selectedLegendKeys!==this.props.selectedLegendKeys&&this.setState({selectedLegendKeys:e.selectedLegendKeys})}},{key:"render",value:function(){var e=this.state.selectedLegendKeys,t=void 0===e?[]:e,n=this.props,r=n.deployments,o=n.filterDeployments,a=n.namespaceId,c=o?o(r,t,{namespaceId:a}):r;return i.a.createElement(h,{hide:this.props.hideOnNoMetrics&&!this.state.hasMetrics},i.a.createElement(_,null,i.a.createElement(v,null,this.props.title),i.a.createElement(g,null,this.state.isRefreshing&&i.a.createElement(s.CircularProgress,{size:"small"}))),i.a.createElement(l.a,{instanceId:this.props.instanceId,query:this.props.query,yAxisLabel:this.props.yAxisLabel,metricUnits:this.props.metricUnits,valuesMinSpread:this.props.valuesMinSpread,getSeriesKey:this.props.getLabel,getSeriesName:this.props.getLabel,showStacked:this.props.showStacked,colorTheme:this.props.colorTheme,legendShown:this.props.legendShown,deployments:c,renderLegendItemSuffix:this.props.renderLegendItemSuffix,selectedLegendKeys:this.state.selectedLegendKeys,onChangeLegendSelection:this.handleLegendSelectionChange,onRefreshStart:this.handleRefreshStart,onRefreshFinish:this.handleRefreshFinish,onReceiveSuccess:this.handleReceiveSuccess,onReceiveError:this.handleReceiveError}))}}])&&m(n.prototype,r),a&&m(n,a),t}()},1327:function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var o={getRows:function(e){var t=e.platform;r(e,["platform"]);switch(t){case"docker":return[{charts:[{getLabel:function(e){return e.metric.node_name},metricUnits:"percent",query:'1 - (avg(rate(node_cpu{mode="idle"}[1m])  * on(instance) group_left(node_name) node_meta{node_name=~".+"}) by (node_name))',queryMetrics:["node_cpu","node_meta"],title:"CPU usage",valuesMinSpread:1}],key:"CPU"},{charts:[{getLabel:function(e){return e.metric.node_name},metricUnits:"percent",query:'1 - sum(((node_memory_MemFree + node_memory_Cached + node_memory_Buffers) / node_memory_MemTotal) * on(instance) group_left(node_name) node_meta{node_name=~".+"}) by (node_name)',queryMetrics:["node_memory_MemFree","node_memory_Cached","node_memory_Buffers","node_memory_MemTotal","node_meta"],title:"Memory usage",valuesMinSpread:1}],key:"Memory"},{charts:[{getLabel:function(e){var t=e.metric;return"".concat(t.node_name," - ").concat(t.device)},metricUnits:"percent",query:'1 - ((max(node_filesystem_avail{fstype=~"ext4|ext3|btrfs|xfs"} * on(instance) group_left(node_name) node_meta{node_name=~".+"}) by (device, node_name)) / max(node_filesystem_size{fstype=~"ext4|ext3|btrfs|xfs"} * on(instance) group_left(node_name) node_meta{node_name=~".+"}) by (device, node_name))',queryMetrics:["node_filesystem_avail","node_filesystem_size","node_meta"],title:"Disk usage",valuesMinSpread:1}],key:"Disk"}];case"":case"kubernetes":default:return[{charts:[{getLabel:function(e){return e.metric.node},metricUnits:"percent",query:'1 - (avg(rate(node_cpu{mode="idle"}[1m])) by (node))',queryMetrics:["node_cpu"],title:"CPU usage",valuesMinSpread:1}],key:"CPU"},{charts:[{getLabel:function(e){return e.metric.node},metricUnits:"percent",query:"1 - max((node_memory_MemFree + node_memory_Cached + node_memory_Buffers) / node_memory_MemTotal) by (node)",queryMetrics:["node_memory_MemFree","node_memory_Cached","node_memory_Buffers","node_memory_MemTotal"],title:"Memory usage",valuesMinSpread:1}],key:"Memory"},{charts:[{getLabel:function(e){return e.metric.node},hideOnNoMetrics:!0,metricUnits:"percent",query:"avg (container_accelerator_duty_cycle) by (instance) / 100",queryMetrics:["container_accelerator_duty_cycle"],title:"GPU usage",valuesMinSpread:1}],key:"GPU"},{charts:[{getLabel:function(e){return e.metric.node},hideOnNoMetrics:!0,metricUnits:"percent",query:"sum by (instance) (container_accelerator_memory_used_bytes) / sum by (instance) (container_accelerator_memory_total_bytes)",queryMetrics:["container_accelerator_memory_used_bytes","container_accelerator_memory_total_bytes"],title:"GPU memory usage",valuesMinSpread:1}],key:"GPU memory"},{charts:[{getLabel:function(e){var t=e.metric;return"".concat(t.node," - ").concat(t.device)},metricUnits:"percent",query:'1 - (max(node_filesystem_avail{fstype=~"ext4|ext3|btrfs|xfs"}) by (device, node) / max(node_filesystem_size{fstype=~"ext4|ext3|btrfs|xfs"}) by (device, node))',queryMetrics:["node_filesystem_avail","node_filesystem_size"],title:"Disk usage",valuesMinSpread:1}],key:"Disk"}]}},href:"node-resources",id:"node-resources",name:"Node resources"};t.a=o},1340:function(e,t,n){"use strict";var r=n(6),o=n.n(r),a=n(99),i=n.n(a),c=n(32),s=n.n(c);function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var u=function(e,t){return"sum by (_name) (\n    sum by (pod) (\n      # Rename pod_name -> pod so we can match the metrics below\n      label_replace(".concat(t,', "pod", "$0", "pod_name", ".*")\n    )\n    * on (pod) group_left(_name)\n    (\n      max by (pod, _name) (\n        # Find a good label for this series\n        label_replace(kube_pod_labels{namespace="').concat(e,'",label_name!=""}, "_name", "$0", "label_name", ".*") or\n        label_replace(kube_pod_labels{namespace="').concat(e,'",label_k8s_app!=""}, "_name", "$0", "label_k8s_app", ".*") or\n        label_replace(\n          label_replace(\n            kube_pod_labels{namespace="').concat(e,'",label_name="",label_k8s_app=""},\n            "_name", "$1", "pod", "^(.*?)(?:(?:-[0-9]+)?-[0-9a-z]{5})?$"\n          ),\n          "_name", "$1", "_name", "^(kube-.*)-(?:ip|gke)-.*$"\n        )\n      )\n    )\n  )')},p=function(e,t){return e.filter(function(e){return i()(t,function(t){return e.Data.match(t)})})},m=function(e,t){return s()(t)?e:p(e,t.map(function(e){return new RegExp(", ".concat(e,":"),"gi")}))},d=function(e,t,n){var r=n.namespaceId;return s()(t)?m(e,[r]):p(e,t.map(function(e){return new RegExp(", ".concat(r,":[a-z]+/").concat(e),"gi")}))},f=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){return o()(e,"metric._name")},id:"workload-cpu",query:u(t,'rate(container_cpu_usage_seconds_total{image!="",namespace="'.concat(t,'"}[2m])')),queryMetrics:["container_cpu_usage_seconds_total","kube_pod_labels"],showStacked:!0,title:"CPU usage by workload",yAxisLabel:"CPU seconds / second"}:{filterDeployments:m,getLabel:function(e){return o()(e,"metric.namespace")},query:'sum(rate(container_cpu_usage_seconds_total{image!="",namespace!=""}[2m])) by (namespace)',queryMetrics:["container_cpu_usage_seconds_total"],showStacked:!0,title:"CPU usage by namespace",yAxisLabel:"CPU seconds / second"}},y=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){return o()(e,"metric._name")},id:"workload-memory",metricUnits:"bytes",query:u(t,'container_memory_rss{image!="",namespace="'.concat(t,'"}')),queryMetrics:["container_memory_rss","kube_pod_labels"],showStacked:!0,title:"Memory usage by workload"}:{filterDeployments:m,getLabel:function(e){return o()(e,"metric.namespace")},metricUnits:"bytes",query:'sum(container_memory_rss{image!="",namespace!=""}) by (namespace)',queryMetrics:["container_memory_rss"],showStacked:!0,title:"Memory usage by namespace"}},b=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){return o()(e,"metric._name")},hideOnNoMetrics:!0,id:"workload-gpu",query:u(t,'container_accelerator_duty_cycle{image!="",namespace="'.concat(t,'"}')),queryMetrics:["container_accelerator_duty_cycle","kube_pod_labels"],showStacked:!0,title:"GPU usage by workload",yAxisLabel:"Percent (%)"}:{filterDeployments:m,getLabel:function(e){return o()(e,"metric.namespace")},hideOnNoMetrics:!0,query:'avg (container_accelerator_duty_cycle{image!="",namespace!=""}) by (namespace)',queryMetrics:["container_accelerator_duty_cycle"],showStacked:!0,title:"GPU usage by namespace",yAxisLabel:"Percent (%)"}},h=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){return o()(e,"metric._name")},hideOnNoMetrics:!0,id:"workload-gpu-memory",metricUnits:"bytes",query:u(t,'container_accelerator_memory_used_bytes{image!="",namespace="'.concat(t,'"}')),queryMetrics:["container_accelerator_memory_used_bytes","kube_pod_labels"],showStacked:!0,title:"GPU memory usage by workload"}:{filterDeployments:m,getLabel:function(e){return o()(e,"metric.namespace")},hideOnNoMetrics:!0,metricUnits:"bytes",query:'sum (container_accelerator_memory_used_bytes{image!="",namespace!=""}) by (namespace)',queryMetrics:["container_accelerator_memory_used_bytes"],showStacked:!0,title:"GPU memory usage by namespace"}},_=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){return o()(e,"metric._name")},metricUnits:"bytes",query:u(t,'rate(container_network_receive_bytes_total{image!="",interface="eth0",namespace="'.concat(t,'"}[2m])')),queryMetrics:["container_network_receive_bytes_total","kube_pod_labels"],showStacked:!0,title:"Received bytes by workload"}:{filterDeployments:m,getLabel:function(e){return o()(e,"metric.namespace")},metricUnits:"bytes",query:'sum(rate(container_network_receive_bytes_total{image!="",namespace!="",interface="eth0"}[2m])) by (namespace)',queryMetrics:["container_network_receive_bytes_total"],showStacked:!0,title:"Received bytes by namespace"}},v=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){return o()(e,"metric._name")},metricUnits:"bytes",query:u(t,'rate(container_network_transmit_bytes_total{image!="",interface="eth0",namespace="'.concat(t,'"}[2m])')),queryMetrics:["container_network_transmit_bytes_total","kube_pod_labels"],showStacked:!0,title:"Transmitted bytes by workload"}:{filterDeployments:m,getLabel:function(e){return o()(e,"metric.namespace")},metricUnits:"bytes",query:'sum(rate(container_network_transmit_bytes_total{image!="",namespace!="",interface="eth0"}[2m])) by (namespace)',queryMetrics:["container_network_transmit_bytes_total"],showStacked:!0,title:"Transmitted bytes by namespace"}},g=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){return o()(e,"metric._name")},metricUnits:"bytes",query:u(t,"rate(container_fs_writes_bytes_total{image!='',namespace=\"".concat(t,'"}[2m])')),queryMetrics:["container_fs_writes_bytes_total","kube_pod_labels"],showStacked:!0,title:"Disk write by workload"}:{filterDeployments:m,getLabel:function(e){return o()(e,"metric.namespace")},metricUnits:"bytes",query:'sum(rate(container_fs_writes_bytes_total{image!="",namespace!=""}[2m])) by (namespace)',queryMetrics:["container_fs_writes_bytes_total"],showStacked:!0,title:"Disk write by namespace"}},k=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){return o()(e,"metric._name")},metricUnits:"bytes",query:u(t,"rate(container_fs_reads_bytes_total{image!='',namespace=\"".concat(t,'"}[2m])')),queryMetrics:["container_fs_reads_bytes_total","kube_pod_labels"],showStacked:!0,title:"Disk read by workload"}:{filterDeployments:m,getLabel:function(e){return o()(e,"metric.namespace")},metricUnits:"bytes",query:'sum(rate(container_fs_reads_bytes_total{image!="",namespace!=""}[2m])) by (namespace)',queryMetrics:["container_fs_reads_bytes_total"],showStacked:!0,title:"Disk read by namespace"}},w=function(e,t){return t.substr(e.length+1)},O=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){var n=e.metric;return w(t,n.container_label_com_docker_swarm_service_name)},query:'sum(rate(container_cpu_usage_seconds_total{id=~"/docker/.*",container_label_com_docker_stack_namespace="'.concat(t,'"}[2m])) by (container_label_com_docker_swarm_service_name)'),queryMetrics:["container_cpu_usage_seconds_total"],showStacked:!0,title:"CPU usage by workload",yAxisLabel:"CPU seconds / second"}:{filterDeployments:m,getLabel:function(e){return e.metric.container_label_com_docker_stack_namespace},query:'sum(rate(container_cpu_usage_seconds_total{id=~"/docker/.*",container_label_com_docker_stack_namespace!=""}[2m])) by (container_label_com_docker_stack_namespace)',queryMetrics:["container_cpu_usage_seconds_total"],showStacked:!0,title:"CPU usage by namespace",yAxisLabel:"CPU seconds / second"}},S=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){var n=e.metric;return w(t,n.container_label_com_docker_swarm_service_name)},metricUnits:"bytes",query:'sum(container_memory_rss{id=~"/docker/.*",container_label_com_docker_stack_namespace="'.concat(t,'"}) by (container_label_com_docker_swarm_service_name)'),queryMetrics:["container_memory_rss"],showStacked:!0,title:"Memory usage by workload"}:{filterDeployments:m,getLabel:function(e){return e.metric.container_label_com_docker_stack_namespace},metricUnits:"bytes",query:'sum(container_memory_rss{id=~"/docker/.*",container_label_com_docker_stack_namespace!=""}) by (container_label_com_docker_stack_namespace)',queryMetrics:["container_memory_rss"],showStacked:!0,title:"Memory usage by namespace"}},j=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){var n=e.metric;return w(t,n.container_label_com_docker_swarm_service_name)},hideOnNoMetrics:!0,query:'avg (container_accelerator_duty_cycle{id=~"/docker/.*",container_label_com_docker_stack_namespace="'.concat(t,'"}) by (container_label_com_docker_swarm_service_name)'),queryMetrics:["container_accelerator_duty_cycle"],showStacked:!0,title:"GPU usage by workload",yAxisLabel:"Percent (%)"}:{filterDeployments:m,getLabel:function(e){return e.metric.container_label_com_docker_stack_namespace},hideOnNoMetrics:!0,query:'avg (container_accelerator_duty_cycle{id=~"/docker/.*",container_label_com_docker_stack_namespace!=""}) by (container_label_com_docker_stack_namespace)',queryMetrics:["container_accelerator_duty_cycle"],showStacked:!0,title:"GPU usage by namespace",yAxisLabel:"Percent (%)"}},E=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){var n=e.metric;return w(t,n.container_label_com_docker_swarm_service_name)},hideOnNoMetrics:!0,metricUnits:"bytes",query:'sum (container_accelerator_memory_used_bytes{id=~"/docker/.*",container_label_com_docker_stack_namespace="'.concat(t,'"}) by (container_label_com_docker_swarm_service_name)'),queryMetrics:["container_accelerator_memory_used_bytes"],showStacked:!0,title:"GPU memory usage by workload"}:{filterDeployments:m,getLabel:function(e){return e.metric.container_label_com_docker_stack_namespace},hideOnNoMetrics:!0,metricUnits:"bytes",query:'sum (container_accelerator_memory_used_bytes{id=~"/docker/.*",container_label_com_docker_stack_namespace!=""}) by (container_label_com_docker_stack_namespace)',queryMetrics:["container_accelerator_memory_used_bytes"],showStacked:!0,title:"GPU memory usage by namespace"}},P=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){var n=e.metric;return w(t,n.container_label_com_docker_swarm_service_name)},metricUnits:"bytes",query:'sum(rate(container_network_receive_bytes_total{id=~"/docker/.*",container_label_com_docker_stack_namespace="'.concat(t,'"}[2m])) by (container_label_com_docker_swarm_service_name)'),queryMetrics:["container_network_receive_bytes_total"],showStacked:!0,title:"Received bytes by workload"}:{filterDeployments:m,getLabel:function(e){return e.metric.container_label_com_docker_stack_namespace},metricUnits:"bytes",query:'sum(rate(container_network_receive_bytes_total{id=~"/docker/.*",container_label_com_docker_stack_namespace!=""}[2m])) by (container_label_com_docker_stack_namespace)',queryMetrics:["container_network_receive_bytes_total"],showStacked:!0,title:"Received bytes by namespace"}},x=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){var n=e.metric;return w(t,n.container_label_com_docker_swarm_service_name)},metricUnits:"bytes",query:'sum(rate(container_network_transmit_bytes_total{id=~"/docker/.*",container_label_com_docker_stack_namespace="'.concat(t,'"}[2m])) by (container_label_com_docker_swarm_service_name)'),queryMetrics:["container_network_transmit_bytes_total"],showStacked:!0,title:"Transmitted bytes by workload"}:{filterDeployments:m,getLabel:function(e){return e.metric.container_label_com_docker_stack_namespace},metricUnits:"bytes",query:'sum(rate(container_network_transmit_bytes_total{id=~"/docker/.*",container_label_com_docker_stack_namespace!=""}[2m])) by (container_label_com_docker_stack_namespace)',queryMetrics:["container_network_transmit_bytes_total"],showStacked:!0,title:"Transmitted bytes by namespace"}},C=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){var n=e.metric;return w(t,n.container_label_com_docker_swarm_service_name)},metricUnits:"bytes",query:'sum(rate(container_fs_writes_bytes_total{id=~"/docker/.*",container_label_com_docker_stack_namespace="'.concat(t,'"}[2m])) by (container_label_com_docker_swarm_service_name)'),queryMetrics:["container_fs_writes_bytes_total"],showStacked:!0,title:"Disk write by service"}:{filterDeployments:m,metricUnits:"bytes",query:'sum(rate(container_fs_writes_bytes_total{id=~"/docker/.*",container_label_com_docker_stack_namespace!=""}[2m])) by (container_label_com_docker_stack_namespace)',queryMetrics:["container_fs_writes_bytes_total"],showStacked:!0,title:"Disk write by namespace"}},q=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){var n=e.metric;return w(t,n.container_label_com_docker_swarm_service_name)},metricUnits:"bytes",query:'sum(rate(container_fs_reads_bytes_total{id=~"/docker/.*",container_label_com_docker_stack_namespace="'.concat(t,'"}[2m])) by (container_label_com_docker_swarm_service_name)'),queryMetrics:["container_fs_reads_bytes_total"],showStacked:!0,title:"Disk read by service"}:{filterDeployments:m,metricUnits:"bytes",query:'sum(rate(container_fs_reads_bytes_total{id=~"/docker/.*",container_label_com_docker_stack_namespace!=""}[2m])) by (container_label_com_docker_stack_namespace)',queryMetrics:["container_fs_reads_bytes_total"],showStacked:!0,title:"Disk read by namespace"}},T={getRows:function(e){var t,n=e.platform,r=l(e,["platform"]);switch(n){case"docker":return t=r.namespace,[{charts:[O({namespace:t})],key:"CPU"},{charts:[S({namespace:t})],key:"Memory"},{charts:[j({namespace:t})],key:"GPU",optional:!0},{charts:[E({namespace:t})],key:"GPU memory",optional:!0},{charts:[P({namespace:t})],key:"Received bytes"},{charts:[x({namespace:t})],key:"Transmitted bytes"},{charts:[C({namespace:t})],key:"Disk write",optional:!0},{charts:[q({namespace:t})],key:"Disk read",optional:!0}];case"":case"kubernetes":default:return function(e){var t=e.namespace;return[{charts:[f({namespace:t})],key:"CPU"},{charts:[y({namespace:t})],key:"Memory"},{charts:[b({namespace:t})],key:"GPU",optional:!0},{charts:[h({namespace:t})],key:"GPU Memory",optional:!0},{charts:[_({namespace:t})],key:"Received bytes"},{charts:[v({namespace:t})],key:"Transmitted bytes"},{charts:[g({namespace:t})],key:"Disk write",optional:!0},{charts:[k({namespace:t})],key:"Disk read",optional:!0}]}(r)}},href:"workload-resources",id:"workload-resources",name:"Workload resources"};t.a=T},1375:function(e,t,n){"use strict";var r=n(126),o=n.n(r),a=n(78),i=n.n(a),c=n(77),s=n.n(c),l=n(1289),u=n.n(l),p=n(186),m=n.n(p),d=n(0),f=n.n(d),y=n(22),b=n(13),h=n.n(b),_=n(9),v=n(1),g=n(57),k=n.n(g),w=n(2),O=n(55),S=n(7),j=n(17),E=n(1249),P=n(11),x=n(155),C=n(300),q=n(16),T=n(111),R=n(1221),I=n(60),N=n.n(I),L=n(303),D=n(1311),M=n(1279),A=n(127),U=n.n(A),Q=n(47),F=n.n(Q),W=n(307),z=n(30),B=n(222),K=n.n(B),G=n(8);function H(e){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function X(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z(e,t){return(Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(n,!0).forEach(function(t){ee(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function te(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var ne=Object(W.format)(",.3f");function re(e){return e.map(function(e){return J({},(r=e.metric,o=r.__name__||"",a=F()(r,"__name__"),{key:[o].concat(te(Object.keys(a).map(function(e){return[e,a[e]].join()}))).join(),labels:a,name:o}),{value:(t=e.value[1],n=parseFloat(t),Number.isNaN(n)?null:n)});var t,n,r,o,a})}function oe(e,t){return K()("prom-table-row",{"prom-table-row-max":e.value&&t&&e.value===t,"prom-table-row-null":!e.value})}var ae=v.default.span.withConfig({displayName:"prom-table__LabelKey",componentId:"sc-1u3adnv-0"})(["color:",";"],function(e){return e.theme.colors.purple400}),ie=function(e){function t(e,n){var r,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=Y(t).call(this,e,n),r=!a||"object"!==H(a)&&"function"!=typeof a?X(o):a,ee(X(r),"handleResponse",function(e,t,n){var o=new Date-n,a=e.data.result&&e.data.result.length>0;if(r.props.onReceiveQuery&&r.props.onReceiveQuery({dataReceived:a,end:t.end},o),"vector"!==e.data.resultType)r.setError("Result is not of vector type! Please enter a correct expression.");else if(e.data.result&&0===e.data.result.length)r.setError("No datapoints found. Maybe the metric does not exist?");else{var i=r.props.query.search(/sort\(|sort_desc\(/)>-1,c=re(e.data.result),s=i?c:U()(c,function(e){return e.value}).reverse(),l=Object(z.e)(s,function(e){return e.value}),u=Object(z.g)(s,function(e){return e.value}),p=Object(z.f)(s,function(e){return e.value}),m=Object(z.d)(s,function(e){return e.value}),d=Object(z.m)(s,function(e){return e.value}),f=s.length,y=Object.keys(s.reduce(function(e,t){return J({},e,{},t.labels)},{})).sort();r.setState({columns:y,count:f,data:s,deviation:m,max:l,mean:p,min:u,variance:d})}}),ee(X(r),"handleClickLabel",function(e,t,n){r.props.onClickLabel&&r.props.onClickLabel(e,t,n)}),ee(X(r),"getRef",function(e){r.wrapper=e}),r.state={data:[]},r}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Z(e,t)}(t,f.a.Component),n=t,(r=[{key:"setError",value:function(e){this.setState({data:[]}),this.props.onReceiveError&&this.props.onReceiveError(e)}},{key:"fetchData",value:function(e){var t=this,n=new Date,r={end:e.end||new Date/1e3,query:e.query};this.props.onRequestQuery&&this.props.onRequestQuery(),Object(G.W)(e.instanceId,r).then(function(e){return t.handleResponse(e,r,n)},function(e){var n=e.errors;return t.setError(n[0].message)})}},{key:"componentWillReceiveProps",value:function(e){e.query===this.props.query&&e.end===this.props.end&&e.executeQueryUUID===this.props.executeQueryUUID||this.fetchData(e)}},{key:"componentDidMount",value:function(){this.fetchData(this.props)}},{key:"renderSummary",value:function(){if(void 0===this.state.max)return"Metric";var e=this.state,t=e.count,n=e.deviation,r=e.max,o=e.mean,a=e.min,i=e.variance;return"Summary: count ".concat(t,", min ").concat(ne(a),", mean ").concat(ne(o),", max ").concat(ne(r),", stdev ").concat(ne(n),", variance ").concat(ne(i))}},{key:"render",value:function(){var e=this,t=this.state.columns;return f.a.createElement("table",{ref:this.getRef,className:"prom-table",style:{width:"calc(100vw - 395px)"}},f.a.createElement("thead",{className:"prom-table-header"},f.a.createElement("tr",null,t&&t.map(function(e){return f.a.createElement("td",{key:e,title:e,className:"prom-table-header-cell"},f.a.createElement(ae,null,e))}),f.a.createElement("td",{className:"prom-table-header-cell",title:this.renderSummary()},"Value"))),f.a.createElement("tbody",{className:"prom-table-body"},this.state.data.map(function(n){return f.a.createElement("tr",{className:oe(n,e.state.max),key:n.key},t.map(function(t){return function(e,t,n){if(!t.labels||!t.labels[e])return f.a.createElement("td",{key:e});var r=t.labels[e];return f.a.createElement("td",{title:"".concat(r," (Click to filter by this ").concat(e,")"),className:t.name?"prom-table-cell prom-table-cell-filterable":"prom-table-cell",onClick:t.name?function(){return n(t.name,e,r)}:null,key:e},r)}(t,n,e.handleClickLabel)}),f.a.createElement("td",{className:"prom-table-cell prom-table-cell-value"},n.value?ne(n.value):n.value))})))}}])&&V(n.prototype,r),o&&V(n,o),t}();var ce="graph",se="table",le="text";function ue(e){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function me(e){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function de(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fe(e,t){return(fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var be=k()("service:prom-notebook-entry"),he=v.default.div.withConfig({displayName:"prom-notebook-entry__QueryLine",componentId:"sc-1s6chiq-0"})(["display:flex;align-items:flex-start;"]),_e=v.default.div.withConfig({displayName:"prom-notebook-entry__QueryField",componentId:"sc-1s6chiq-1"})(["flex:1;overflow:hidden;"]),ve=v.default.div.withConfig({displayName:"prom-notebook-entry__SideIconContainer",componentId:"sc-1s6chiq-2"})(["margin-left:8px;width:20px;"]),ge=v.default.span.withConfig({displayName:"prom-notebook-entry__SideIconRemove",componentId:"sc-1s6chiq-3"})(["cursor:pointer;height:18px;padding:5px;"]),ke=v.default.div.withConfig({displayName:"prom-notebook-entry__Hints",componentId:"sc-1s6chiq-4"})(["display:flex;justify-content:flex-end;margin:10px 60px 20px 0px;font-size:",";"],function(e){return e.theme.fontSizes.tiny}),we=v.default.div.withConfig({displayName:"prom-notebook-entry__Hint",componentId:"sc-1s6chiq-5"})(["display:flex;align-items:center;position:relative;margin-left:12px;"]),Oe=v.default.span.withConfig({displayName:"prom-notebook-entry__HintLabel",componentId:"sc-1s6chiq-6"})(["color:",";"],function(e){return e.theme.colors.blue700}),Se=v.default.div.withConfig({displayName:"prom-notebook-entry__HintButton",componentId:"sc-1s6chiq-7"})(["margin-right:4px;padding:2px 4px;color:",";cursor:pointer;border:1px solid ",";border-radius:",";"],function(e){return e.theme.colors.blue700},function(e){return e.theme.colors.blue700},function(e){return e.theme.borderRadius.soft}),je=Object(v.default)(Se).withConfig({displayName:"prom-notebook-entry__HintButtonReorder",componentId:"sc-1s6chiq-8"})(["display:inline-block;margin-left:4px;"]),Ee=v.default.div.withConfig({displayName:"prom-notebook-entry__HintShortcut",componentId:"sc-1s6chiq-9"})(["color:",";"],function(e){return e.theme.colors.purple200}),Pe=v.default.span.withConfig({displayName:"prom-notebook-entry__LinkIcon",componentId:"sc-1s6chiq-10"})([""]),xe=function(e){return e.shiftKey&&(e.metaKey||e.ctrlKey)&&("J"===e.key||"K"===e.key)},Ce=function(e){return e.shiftKey&&(e.metaKey||e.ctrlKey)&&"D"===e.key};function qe(e){return e.type?e.type:e.rawContentState?le:e.queryRange?ce:se}function Te(e){return!!(e&&e.indexOf(";")>0)}var Re=function(e){function t(e,n){var r,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=me(t).call(this,e,n),r=!a||"object"!==ue(a)&&"function"!=typeof a?de(o):a,ye(de(r),"entryRef",void 0),ye(de(r),"handleChange",function(e){var t=r.state.query||r.props.query,n=!!e&&t!==e;if(r.setState({query:e}),r.state.edited!==n){var o=qe({queryRange:r.state.queryRange,rawContentState:r.state.rawContentState,type:r.state.entryType});r.setState({edited:n,entryType:o}),r.props.onEntryChange({id:r.props.id,query:e,rawContentState:e},!0)}r.setState({multiQuery:Te(e)})}),ye(de(r),"handleKeyDown",function(e){return"Enter"===e.key?(r.handleSubmit(e),{change:!1}):(xe(e)&&(e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),r.handleReorder("K"===e.key?"up":"down")),Ce(e)&&(e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),r.handleKeyPressRemove()),{})}),ye(de(r),"handleReorder",function(e){r.props.onReorder(e),setTimeout(function(){if(r.entryRef){var e=window.innerHeight,t=r.entryRef.getBoundingClientRect(),n=t.top;t.bottom>e?r.entryRef&&r.entryRef.scrollIntoView(!1):n<0&&r.entryRef&&r.entryRef.scrollIntoView(!0)}},0)}),ye(de(r),"handleBlur",function(){r.setState({evaluatedQuery:r.state.query})}),ye(de(r),"handleFocus",function(){r.props.onFocus(r.props.id)}),ye(de(r),"handleSubmit",function(e){if(e.preventDefault(),r.props.type!==le)if(r.state.multiQuery)r.handleSubmitGraph();else{if(e.altKey)return r.handleSubmitTable(),void r.setState({defaultReturn:se});if(e.ctrlKey)return r.handleSubmitGraph(),void r.setState({defaultReturn:ce});r.state.defaultReturn!==se?r.handleSubmitGraph():r.handleSubmitTable()}else r.executeQuery(null)}),ye(de(r),"handleSubmitGraph",function(){r.executeQuery(null,ce),Object(S.trackEvent)("prom.notebook.entry.run",{action:"click",queryType:"graph"})}),ye(de(r),"handleSubmitTable",function(){r.executeQuery(null,se),Object(S.trackEvent)("prom.notebook.entry.run",{action:"click",queryType:"table"})}),ye(de(r),"executeQuery",function(e,t){var n=Object(j.k)(),o=e||r.state.query,a=t||r.state.entryType;be("Executing query",o),r.setState({edited:!1,entryType:a,error:null,evaluatedQuery:o,executeQueryUUID:n,query:o}),r.props.onEntryChange({id:r.props.id,query:o,type:a},!0)}),ye(de(r),"handleClickMetricLabel",function(e,t,n){var o=r.state.query||r.props.query,a=function(e,t,n,r){if(!t||!n||!r)return e;for(var o,a,i=/[a-zA-Z_:]/,c=/[a-zA-Z0-9_:]/,s=-1;s<e.length&&-1!==(s=e.indexOf(t,s+1));){var l=e[s+t.length];i.test(e[s-1]||"")||c.test(l||"")||("{"===l?(o=e.substring(0,s+t.length+1),a=e.substring(s+t.length+1),e="".concat(o).concat(n,'="').concat(r,'",').concat(a)):(o=e.substring(0,s+t.length),a=e.substring(s+t.length),e="".concat(o,"{").concat(n,'="').concat(r,'"}').concat(a)))}return e}(o,e,t,n);r.setState({query:o}),r.executeQuery(a),Object(S.trackEvent)("prom.notebook.entry.table.label.click")}),ye(de(r),"handleEntryTextChange",function(e,t){var n,o=(n=e)&&n.length>5&&-1!==n.indexOf(" ")&&-1===n.indexOf("(")&&/[A-Z]/.test(n[0]);return o&&t&&r.props.onEntryChange({id:r.props.id,rawContentState:t},!0),o}),ye(de(r),"handleReceiveQuery",function(e,t){var n=r.state,o=n.query,a=n.queryRange,i=n.entryType,c=e.end;r.setState({dataReceived:!0,error:null,latency:t,loading:!1});var s={error:null,id:r.props.id,query:o,queryEnd:c,queryRange:a,type:i};r.props.onEntryChange(s)}),ye(de(r),"handleReceiveError",function(e){r.setState({error:e,loading:!1}),r.props.onEntryChange({error:e,id:r.props.id})}),ye(de(r),"handleRequestQuery",function(){r.setState({latency:null,loading:!0})}),ye(de(r),"handleClickLink",function(){r.setState({showLink:!r.state.showLink})}),ye(de(r),"handleClickRemove",function(){r.props.id&&r.props.onRemoveQuery&&r.props.onRemoveQuery(r.props.id),Object(S.trackEvent)("prom.notebook.entry.remove.click")}),ye(de(r),"handleKeyPressRemove",function(){r.props.id&&r.props.onRemoveQuery&&r.props.onRemoveQuery(r.props.id),Object(S.trackEvent)("prom.notebook.entry.remove.keypress")}),ye(de(r),"getLinkToQuery",function(){var e=r.props,t=e.instanceId,n=e.sharedQueryParams,o=Object(P.P)(n,t,[r.state.query]);return"".concat(window.location.protocol,"//").concat(window.location.host).concat(o)}),ye(de(r),"saveEntryRef",function(e){e&&(r.entryRef=e)}),r.state={defaultReturn:ce,edited:!1,entryType:qe(e),error:null,evaluatedQuery:r.props.query||"",loading:!1,multiQuery:Te(e.query),query:r.props.query||"",showLink:!1},r}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fe(e,t)}(t,f.a.Component),n=t,(r=[{key:"componentWillReceiveProps",value:function(e){e.type&&e.type!==this.state.entryType&&this.setState({entryType:e.type})}},{key:"shouldComponentUpdate",value:function(e,t){return!N()(this.props,e)||!N()(this.state,t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.history,r=t.isFirst,o=t.isLast,a=t.labelSets,i=t.metricNames,c=t.number,s=t.instanceId,l=t.readOnly,u=t.queryEnd,p=t.queryRange,m=t.trailingNow,d=this.state,y=d.dataReceived,b=d.defaultReturn,h=d.edited,v=d.error,g=d.evaluatedQuery,k=d.executeQueryUUID,w=d.multiQuery,O=d.latency,S=d.loading,j=d.showLink,E=d.entryType,P=E===le,x=!h&&v&&!P,C=r&&o,q=this.state.query||this.props.query,T=q&&E===ce,R=q&&E===se,I=b===ce||w,N=P?[]:n.map(function(e){return"string"==typeof e?e:e.query}),A=v&&q?f.a.createElement("span",{style:{marginRight:4},className:"fas fa-exclamation-triangle"}):"",U=O?"".concat(O,"ms"):"Unknown",Q=S?"Query running...":"Query took: ".concat(U),F=f.a.createElement(we,null,f.a.createElement(Oe,null,"Move",f.a.createElement(je,{onClick:function(){return e.handleReorder("up")},title:"Move this notebook entry up one position"},"up"),"/",f.a.createElement(je,{onClick:function(){return e.handleReorder("down")},title:"Move this notebook entry down one position"},"down")),f.a.createElement(Ee,null,"Ctrl+Shift+j/k"));return f.a.createElement("div",{className:"prom-notebook-entry",ref:this.saveEntryRef},f.a.createElement(he,null,f.a.createElement("a",{href:"#".concat(c),id:c,className:"prom-notebook-entry-number"},f.a.createElement("span",{className:"prom-notebook-entry-number-anchor"},"#"),c),f.a.createElement(_e,null,f.a.createElement(D.a,{readOnly:l,id:c,autoFocus:this.props.isFocused,onChange:this.handleChange,value:this.state.query,metricNames:i,language:E===le?"markdown":"promql",showLineNumbers:!1,onKeyDown:this.handleKeyDown,onBlur:this.handleBlur,onFocus:this.handleFocus,intellisenseEnabled:E!==le,isNotebook:!0,wrapLines:!0,placeholder:E===le?"Enter markdown":"Enter a PromQL query",history:N,labelSets:a,instanceId:s,key:E})),f.a.createElement(ve,null,S?f.a.createElement(_.CircularProgress,{size:"small"}):!C&&!l&&f.a.createElement(ge,{onClick:this.handleClickRemove,title:"Remove this entry (Ctrl+Shift+d)",className:"fas fa-times"}))),P&&!l&&f.a.createElement(ke,null,F),!P&&f.a.createElement(ke,null,!v&&!P&&q&&f.a.createElement("div",{className:"prom-notebook-entry-status"},y&&f.a.createElement("span",null,Q)),!l&&F,f.a.createElement(we,null,f.a.createElement(Se,{onClick:this.handleSubmitGraph},"Run as Graph"),f.a.createElement(Ee,null,I&&"Return /"," Ctrl+Return")),!w&&f.a.createElement(we,null,f.a.createElement(Se,{onClick:this.handleSubmitTable},"Run as Table"),f.a.createElement(Ee,null,!I&&"Return /"," Alt+Return")),f.a.createElement(we,null,f.a.createElement(Se,{title:"Show link to query",onClick:this.handleClickLink},f.a.createElement(Pe,{className:"fa fa-link"})),j&&f.a.createElement("div",{className:"prom-notebook-entry-link"},f.a.createElement(L.a,null,this.getLinkToQuery())))),x&&f.a.createElement("div",{className:"prom-notebook-entry-error"},A,v),!P&&R&&f.a.createElement("div",{style:{display:v?"none":"flex"}},f.a.createElement("div",{style:{flex:1,padding:"0 32px"}},f.a.createElement(ie,{query:g,instanceId:s,end:m?null:u,executeQueryUUID:k,onClickLabel:this.handleClickMetricLabel,onReceiveQuery:this.handleReceiveQuery,onReceiveError:this.handleReceiveError,onRequestQuery:this.handleRequestQuery}))),!P&&T&&f.a.createElement("div",{style:{display:v?"none":"flex"}},f.a.createElement("div",{style:{flex:1}},f.a.createElement(M.a,{query:g,instanceId:s,range:p,end:u,executeQueryUUID:k,onReceiveQuery:this.handleReceiveQuery,onReceiveError:this.handleReceiveError,onRequestQuery:this.handleRequestQuery}))))}}])&&pe(n.prototype,r),o&&pe(n,o),t}();var Ie=Object(y.connect)(function(e){return{sharedQueryParams:Object(T.b)(e)}})(Re),Ne=n(18),Le=n.n(Ne),De=[{description:"This notebook has a collection of queries that require the Prometheus Node Exporter to be installed in your infrastructure.",label:"Node resources",prefix:"node",queries:[{depends:["node_cpu"],label:"CPU usage in % by mode",query:'sum by (mode) (irate(node_cpu{mode!="idle"}[2m]))'},{depends:["node_disk_io_time_ms"],label:"Disk IO (% time spent) by device",query:"irate(node_disk_io_time_ms[2m]) / 1000 * 100"},{depends:["node_memory_MemFree","node_memory_Buffers","node_memory_Cached"],label:"Free memory in bytes",query:"node_memory_MemFree + node_memory_Buffers + node_memory_Cached"},{depends:["node_network_receive_bytes"],label:"Network received bytes/s by device",query:'irate(node_network_receive_bytes{device!="lo"}[2m])'},{depends:["node_filesystem_avail","node_filesystem_size"],label:"Filesystem fullness in % by filesystem",query:"100 - (node_filesystem_avail / node_filesystem_size * 100)"}]},{description:"This notebook has a collection of queries that require the Kubernetes Exporter to be installed in your infrastructure.",label:"Kubernetes",prefix:"container",queries:[{depends:["container_cpu_user_seconds_total","container_cpu_system_seconds_total"],label:"CPU usage in % by pod",query:'sum by(instance, pod_name) (rate(container_cpu_user_seconds_total{pod_name!=""}[1m])) + sum by(instance, pod_name) (rate(container_cpu_system_seconds_total{pod_name!=""}[1m]))'},{depends:["container_cpu_user_seconds_total","container_cpu_system_seconds_total"],label:"CPU usage in % of pods by namespace",query:'sum by(namespace) (rate(container_cpu_user_seconds_total{pod_name!=""}[1m])) + sum by(namespace) (rate(container_cpu_system_seconds_total{pod_name!=""}[1m]))'},{depends:["container_memory_rss"],label:"Memory usage by pod",query:'sum by(instance, pod_name) (container_memory_rss{pod_name!=""})'}]},{description:"This notebook has a collection of queries that require the Weave Net Exporter to be installed in your infrastructure.",label:"Weave Net",prefix:"weave",queries:[{depends:["weave_ips","weave_max_ips"],label:"IP address space exhaustion in %",query:'sum without(instance, state) (weave_ips{state="local-used"}) / max without(instance) (weave_max_ips) * 100'},{depends:["weave_dns_entries"],label:"Number of local DNS entries per each host",query:'weave_dns_entries{state="local"}'},{depends:["weave_connection_terminations_total"],label:"Connection termination rate per second",query:"sum without(instance) (rate(weave_connection_terminations_total[2m]))"},{depends:["weavenpc_blocked_connections_total"],label:"Number of blocked connections per transport-layer protocol",query:"sum by(protocol, job) (weavenpc_blocked_connections_total)"},{depends:["weavenpc_blocked_connections_total"],label:"Frequent protocol-dport combinations of blocked connections",query:"topk(10, sum by(job, protocol, dport) (weavenpc_blocked_connections_total))"}]}];function Me(e){return(Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ue(e){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fe(e,t){return(Fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var We=function(e){function t(){var e,n,r,o,a,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=this,o=(e=Ue(t)).call.apply(e,[this].concat(l)),n=!o||"object"!==Me(o)&&"function"!=typeof o?Qe(r):o,a=Qe(n),c=function(){n.props.onClickPrefix(n.props.prefix)},(i="handleClickPrefix")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fe(e,t)}(t,f.a.Component),n=t,(r=[{key:"render",value:function(){return f.a.createElement("span",{className:"prom-metric-browser-prefix",rel:this.props.prefix,onClick:this.handleClickPrefix},f.a.createElement("span",{className:"query"},this.props.prefix)," [",this.props.count,"]")}}])&&Ae(n.prototype,r),o&&Ae(n,o),t}();function ze(e){return(ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function He(e,t){return(He=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ve(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Ye="_";var Xe=function(e){function t(){var e,n,r,o,a,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=this,o=(e=Ke(t)).call.apply(e,[this].concat(l)),n=!o||"object"!==ze(o)&&"function"!=typeof o?Ge(r):o,a=Ge(n),c=function(e){n.props.onClickMetricPrefix(e)},(i="handleClickPrefix")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&He(e,t)}(t,f.a.Component),n=t,(r=[{key:"render",value:function(){var e=this,t=this.props,n=t.metrics,r=t.prefixes,o=t.onClickClearPrefix,a=function(e,t){var n=e;t&&(n=n.filter(function(e){return 0===e.indexOf(t)}).map(function(e){return e.substr(t.length+1)}));var r={};return n.forEach(function(e){var t=e.split(Ye)[0];t&&(r[t]||(r[t]=[]),r[t]=[].concat(Ve(r[t]),[e]))}),r}(n,r.join(Ye)),i={close:{borderLeft:"1px solid ".concat(Le.a.colors.purple200),cursor:"pointer",padding:2},container:{},prefix:{padding:"1px 2px"},prefixes:{color:Le.a.colors.purple400,fontSize:"1em",marginBottom:4,marginTop:4},prefixWrapper:{border:"1px solid ".concat(Le.a.colors.purple200),borderRadius:2}};return f.a.createElement("div",{style:i.container},f.a.createElement("div",{style:i.prefixes},0===r.length&&"Prefixes",r.length>0&&r.map(function(e,t){return f.a.createElement("span",null,f.a.createElement("span",{style:i.prefixWrapper},f.a.createElement("span",{style:i.prefix},e),f.a.createElement("span",{className:"fas fa-times",style:i.close,title:e,onClick:o})),t<r.length-1&&Ye)})),f.a.createElement("div",null,Object.keys(a).map(function(t,n,r){return f.a.createElement("span",{key:t},f.a.createElement(We,{prefix:t,count:a[t].length,onClickPrefix:e.handleClickPrefix}),n<r.length-1&&", ")})))}}])&&Be(n.prototype,r),o&&Be(n,o),t}(),Ze=n(125);function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function et(e,t){return!t||"object"!==$e(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tt(e){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nt(e,t){return(nt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),et(this,tt(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nt(e,t)}(t,f.a.Component),n=t,(r=[{key:"renderQuery",value:function(e,t){var n=e.depends,r=e.label,o=e.query,a=this.props,i=a.metricNames,c=a.onClickQuery,s={query:{cursor:"pointer",fontSize:"1em",paddingBottom:4,textDecoration:"underline"},unavailableQuery:{opacity:.33,overflow:"hidden",paddingBottom:4,textOverflow:"ellipsis",whiteSpace:"nowrap"}};if(!Object(Ze.b)(i,n)){var l="".concat(r," (not available; depends on ").concat(n.join(", "),")");return f.a.createElement("div",{style:s.unavailableQuery,title:l,key:r},r)}return f.a.createElement("div",{style:s.query,onClick:c,title:o,key:o,"data-prefix":t},r)}},{key:"render",value:function(){var e=this,t=this.props,n=t.label,r=t.prefix,o=t.queries,a={category:{marginRight:16},label:{color:Le.a.colors.purple400,fontSize:"1em",marginBottom:4,marginTop:4}};return f.a.createElement("div",{style:a.category},f.a.createElement("div",{style:a.label},n),o.map(function(t){return e.renderQuery(t,r)}))}}])&&Je(n.prototype,r),o&&Je(n,o),t}();function ot(e){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function at(){return(at=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function it(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function st(e){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ut(e,t){return(ut=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var mt="prom-help-collapsed",dt=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=st(t).call(this,e),n=!o||"object"!==ot(o)&&"function"!=typeof o?lt(r):o,pt(lt(n),"handleClickSystemQuery",function(e){e.preventDefault();var t=e.target.title,r=e.target.dataset.prefix;n.props.onSetSystemQuery&&n.props.onSetSystemQuery(t),Object(S.trackEvent)("prom.systemqueries.click",{category:r,query:t})}),pt(lt(n),"handleClickMetricPrefix",function(e){var t=n.state.metricPrefixes;t=[].concat(it(t),[e]),n.setState({metricPrefixes:t});var r=t.join(Ye);n.props.onSetMetricPrefix&&n.props.onSetMetricPrefix(r),Object(S.trackEvent)("prom.metricsbrowser.prefix.click",{fullPrefix:r,prefix:e})}),pt(lt(n),"handleClickClearPrefix",function(e){var t=e.target.title,r=n.state.metricPrefixes.indexOf(t),o=n.state.metricPrefixes.slice(0,r);n.setState({metricPrefixes:o})}),pt(lt(n),"handleClickTestQuery",function(e){e.preventDefault(),n.props.onSetSystemQuery&&n.props.onSetSystemQuery("sum(up) by (job)"),Object(S.trackEvent)("prom.help.testquery.click")}),pt(lt(n),"handleClickHide",function(){var e=!n.state.collapsed;Object(O.storageSetObject)(mt,e),n.setState({collapsed:e})}),n.state={collapsed:Object(O.storageGetObject)(mt,!1),metricPrefixes:[],systemQueries:De},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ut(e,t)}(t,f.a.Component),n=t,(r=[{key:"render",value:function(){var e=this,t=this.props.metricNames,n=void 0===t?[]:t,r=this.state.collapsed,o={categories:{display:"flex"},heading:{color:Le.a.colors.purple300,fontSize:"0.8em",marginBottom:4,marginTop:16},listItem:{lineHeight:1.5,listStyleType:"disc"}};return r?f.a.createElement("div",{className:"prom-help-collapsed"},f.a.createElement("div",{className:"prom-help-collapsed-toggle",onClick:this.handleClickHide},"Show Help")):f.a.createElement("div",{className:"prom-help"},f.a.createElement("h3",null,"This is a Prometheus notebook"),f.a.createElement("p",null,"Monitoring is powered by Prometheus. You can create graphs and tables of your time series by entering PromQL queries."),f.a.createElement("ul",null,f.a.createElement("li",{style:o.listItem},"Enter a query in the field above and then Return to display the results as a graph or Alt+Return to show the latest values in a table."),f.a.createElement("li",{style:o.listItem},"You can add multiple queries to one notebook and save it. This is helpful when documenting an incident."),f.a.createElement("li",{style:o.listItem},"Try running a test query"," ",f.a.createElement("a",{style:{textDecoration:"underline"},className:"query",onClick:this.handleClickTestQuery},"sum(up) by (job)")),f.a.createElement("li",{style:o.listItem},"Or use the metric explorer below to find a metric.")),f.a.createElement("div",{style:o.heading},"Detected metric names"),f.a.createElement(Xe,{onClickClearPrefix:this.handleClickClearPrefix,onClickMetricPrefix:this.handleClickMetricPrefix,metrics:n,prefixes:this.state.metricPrefixes}),f.a.createElement("div",{style:o.heading},"Prometheus system queries"),f.a.createElement("div",{style:o.categories},this.state.systemQueries.map(function(t){return f.a.createElement(rt,at({key:t.prefix,metricNames:n,onClickQuery:e.handleClickSystemQuery},t))})),f.a.createElement("div",{className:"prom-help-toggle-wrapper"},f.a.createElement("div",{className:"prom-help-toggle",onClick:this.handleClickHide},"Hide help")))}}])&&ct(n.prototype,r),o&&ct(n,o),t}();var ft=Object(y.connect)(function(e,t){var n=(e.root.prometheus[t.instanceId]||{}).metricNames;return{metricNames:void 0===n?[]:n}})(dt);function yt(e){return(yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bt(){return(bt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ht(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function _t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ht(n,!0).forEach(function(t){Ot(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ht(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gt(e){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wt(e,t){return(wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function St(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n.d(t,"a",function(){return Et});var jt=9,Et=";",Pt=k()("service:prom-notebook"),xt=v.default.div.withConfig({displayName:"prom-notebook__NotebookContainer",componentId:"sc-1md4pqc-0"})(["margin:15px 20px;"]),Ct=v.default.div.withConfig({displayName:"prom-notebook__Header",componentId:"sc-1md4pqc-1"})(["margin:16px 32px;"]),qt=v.default.div.withConfig({displayName:"prom-notebook__TitleContainer",componentId:"sc-1md4pqc-2"})(["height:40px;display:flex;align-items:flex-start;position:relative;"]),Tt=v.default.input.withConfig({displayName:"prom-notebook__TitleInput",componentId:"sc-1md4pqc-3"})(["border:none;background-color:inherit;border-bottom:1px dotted ",";font-size:",";color:",";outline:none;transition:all 1000ms;width:calc(100% - 128px);margin-right:16px;position:relative;top:7px;&:focus{color:",";border-bottom-style:solid;border-bottom-color:",";}"],function(e){return e.theme.colors.purple100},function(e){return e.theme.fontSizes.large},function(e){return e.theme.colors.purple400},function(e){return e.theme.colors.purple600},function(e){return e.theme.colors.purple400}),Rt=v.default.div.withConfig({displayName:"prom-notebook__Description",componentId:"sc-1md4pqc-4"})(["font-size:",";color:",";margin:16px 0;"],function(e){return e.theme.fontSizes.small},function(e){return e.theme.colors.purple600}),It=v.default.div.withConfig({displayName:"prom-notebook__StatusContainer",componentId:"sc-1md4pqc-5"})(["color:",";font-size:",";margin-top:8px;display:flex;"],function(e){return e.theme.colors.purple600},function(e){return e.theme.fontSizes.tiny}),Nt=v.default.span.withConfig({displayName:"prom-notebook__StatusLabel",componentId:"sc-1md4pqc-6"})(["color:",";"],function(e){return e.theme.colors.purple400}),Lt=v.default.span.withConfig({displayName:"prom-notebook__StatusSpacing",componentId:"sc-1md4pqc-7"})(["margin:0 1em;"]),Dt=v.default.span.withConfig({displayName:"prom-notebook__RemoveButton",componentId:"sc-1md4pqc-8"})(["cursor:pointer;text-decoration:underline;color:",";&:hover{color:",";}"],function(e){return e.theme.colors.purple400},function(e){return e.theme.colors.purple600}),Mt=v.default.div.withConfig({displayName:"prom-notebook__AddEntryOptions",componentId:"sc-1md4pqc-9"})(["margin-top:32px;margin-left:32px;margin-bottom:64px;"]),At=Object(v.default)(_.Button).withConfig({displayName:"prom-notebook__AddEntryButton",componentId:"sc-1md4pqc-10"})(["margin-right:16px;",";"],function(e){return e.primary&&"\n    font-weight: bold;\n  "}),Ut=v.default.i.withConfig({displayName:"prom-notebook__AddEntryIcon",componentId:"sc-1md4pqc-11"})(["margin-right:4px;"]),Qt=Object(v.default)(_.Button).withConfig({displayName:"prom-notebook__SaveButton",componentId:"sc-1md4pqc-12"})(["font-weight:bold;"]);function Ft(e,t){var n=t;if(e){var r=n.findIndex(function(t){return t.query===e.query||t===e.query});r>-1&&(n=[].concat(St(n.slice(0,r)),St(n.slice(r+1)))),n=[e].concat(St(n)).slice(0,jt),Object(O.storageSetObject)(q.PROM_HISTORY_KEY,n)}return n}var Wt=function(e){return function(t,n){var r=n+e;if(r<0||r>t.length)return t;var o=St(t),a=o[n];return o.splice(n,1),o.splice(r,0,a),o}},zt=Wt(-1),Bt=Wt(1),Kt=function(e){return e&&e.length>0?e[0].id:void 0},Gt=function(e){function t(e,n){var r,a,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,c=gt(t).call(this,e,n),r=!c||"object"!==yt(c)&&"function"!=typeof c?kt(a):c,Ot(kt(r),"notebookId",void 0),Ot(kt(r),"handleClearQueryHistory",function(){Object(O.storageSetObject)(q.PROM_HISTORY_KEY,[]),r.setState({history:[]}),Object(S.trackEvent)("prom.notebook.clearhistory.click")}),Ot(kt(r),"updateTimeRange",function(e){if(r.updateNotebook(e,!1),r.state.entries&&r.state.entries.length>0){var t=_t({},r.state,{},e);r.loadFluxHistory(t)}}),Ot(kt(r),"handleTitleChange",function(e){r.updateNotebook({title:e.target.value})}),Ot(kt(r),"handleTitleKeyDown",function(e){var t=Boolean(r.state.title);13===e.keyCode&&t&&(e.target.blur(),Object(S.trackEvent)("prom.notebook.save",{action:"keypress",withTitle:t}))}),Ot(kt(r),"handleTitleClickSave",function(){var e=Boolean(r.state.title);if(e)r.saveNotebook();else{var t=Object(E.a)(new Date);r.saveNotebook(_t({},r.state,{title:t}))}var n=r.state.system;Object(S.trackEvent)("prom.notebook.save",{action:"click",isSystem:n,withTitle:e})}),Ot(kt(r),"handleRemoveNotebook",function(){window.confirm("Do you really want to remove this notebook?")&&(r.props.deletePrometheusNotebook(r.props.instanceId,r.props.id),h.a.replace(Object(P.P)(r.props.sharedQueryParams,r.props.instanceId))),Object(S.trackEvent)("prom.notebook.remove.click")}),Ot(kt(r),"handleEntryChange",function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Pt("saving entry",e);var n=r.upsertEntry(e),a={entries:n,history:[]};!e.rawContentState&&e.query&&(a.history=Ft(o()(e,["query","mode"]),r.state.history)),r.updateNotebook(a,t)}),Ot(kt(r),"handleRemoveQuery",function(e){var t={entries:r.state.entries.filter(function(t){return t.id!==e})};r.updateNotebook(t)}),Ot(kt(r),"onReorder",function(e){return function(t){var n=r.state.entries,o="up"===t?zt(n,e):Bt(n,e);r.setState({changed:!0,entries:o})}}),Ot(kt(r),"handleFocus",function(e){e!==r.state.focusedEntryId&&r.setState({focusedEntryId:e})}),Ot(kt(r),"handleSetMetricPrefix",function(e){var t=r.state.entries;i()(t)>0&&s()(t).type!==le?r.updateLastEntry(e):r.appendNewEntry(ce,e)}),Ot(kt(r),"handleSetSystemQuery",function(e){r.appendNewEntry(ce,e)}),Ot(kt(r),"handleAddNewQuery",function(){r.appendNewEntry(ce,"")}),Ot(kt(r),"handleAddNewText",function(){r.appendNewEntry(le,"")}),Ot(kt(r),"updateLastEntry",function(e){r.setState({changed:!0,entries:[].concat(St(u()(r.state.entries)),[_t({},s()(r.state.entries),{id:Object(j.k)(),query:e})])})}),Ot(kt(r),"appendNewEntry",function(e,t){var n=Object(j.k)();r.setState({changed:!0,entries:[].concat(St(r.state.entries),[{id:n,query:t,type:e}]),focusedEntryId:n})});var l=e.entries||[{id:Object(j.k)(),type:ce}];return r.state={changed:!1,entries:l,focusedEntryId:Kt(l),history:Object(O.storageGetObject)(q.PROM_HISTORY_KEY,[]),system:e.system,title:e.title||""},r.notebookId=null,r}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wt(e,t)}(t,f.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=!!this.props.params.deeplink,t=this.props.entries?this.props.entries.length:0;Object(S.trackMixpanelOnlyEvent)("prom.notebook.view",{cellCount:t,deepLink:e}),this.props.updateTimeStateFromUrl(this.props.location),this.loadFluxHistory(_t({},this.props))}},{key:"componentWillReceiveProps",value:function(e){e.location.search!==this.props.location.search&&this.props.updateTimeStateFromUrl(e.location);var t="new"===e.params.notebookId;if(e.id&&this.props.id!==e.id||e.params.notebookId!==this.props.params.notebookId){t&&(Pt("clearing notebook"),this.notebookId=null);var n=e.entries?e.entries:[],r=t?[{id:Object(j.k)(),type:ce}]:St(n),o=t?"":e.title,a=e.system,c={changed:!1,entries:r,focusedEntryId:Kt(r),system:a,title:o};this.setState(c),this.loadFluxHistory(_t({},e))}else 0===i()(this.state.entries)&&this.setState({entries:e.entries?e.entries:[],focusedEntryId:Kt(e.entries)})}},{key:"loadFluxHistory",value:function(e){var t=e.queryRange,n=e.queryEnd,r=new Date/1e3,o=Object(M.b)(t,n||r),a=o.start,i=o.end;this.props.getFluxHistory(this.props.instanceId,q.FLUX_ALL_WORKLOADS,250,new Date(1e3*i).toISOString(),!0,new Date(1e3*a).toISOString())}},{key:"removeEntry",value:function(e){return this.state.entries.filter(function(t){return t.id!==e})}},{key:"upsertEntry",value:function(e){var t=St(this.state.entries),n=t.findIndex(function(t){return t.id===e.id});return-1!==n&&(t[n]=_t({},t[n],{},e)),t}},{key:"hasChanged",value:function(){return this.state.changed}},{key:"hasBeenSaved",value:function(){return!this.state.system&&(this.props.id||this.notebookId)}},{key:"updateNotebook",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setState(_t({},e,{changed:t||this.state.changed}))}},{key:"saveNotebook",value:function(e){this.hasBeenSaved()||this.setState({system:!1});var t=this.props.id,n=["title","entries","version"],r=o()(this.props,n),a=o()(e||this.state,n),i=_t({entries:a.entries,id:t,system:!1},r,{},a),c=this.props.instanceId||this.props.params.instanceId;Pt("Saving notebook",i.id,i),this.props.savePrometheusNotebook(c,i,this.state.system),this.setState({changed:!1})}},{key:"render",value:function(){var e=this,t=this.state,n=t.history,r=t.system,o=this.props,a=o.description,c=o.createdAt,s=o.createdByEmail,l=o.updatedAt,u=o.updatedByEmail,p=o.error,d=o.metricNames,y=o.labelSets,b=o.entries,h=this.props,v=h.queryEnd,g=h.queryRange,k=h.trailingNow,w=this.state.entries;(!w||1===i()(w)&&!m()(w).query&&b)&&(w=b);var O=this.hasBeenSaved(),S=r?"Duplicate":"Save",j=r?"Create a copy of this system notebook. It will appear under Notebooks in the menu on the left.":"Save this notebook. It will appear under Notebooks in the menu on the left.";return O&&(j="Save this notebook."),this.props.loading?f.a.createElement(x.a,{text:"Loading notebooks..."}):f.a.createElement(xt,null,f.a.createElement(R.a,{instanceId:this.props.instanceId,location:this.props.location,hasRangeSelector:!0}),p&&f.a.createElement(_.Alert,{type:"error"},p),f.a.createElement(Ct,null,f.a.createElement(C.a,{permissions:["notebook.update"]},function(t){return f.a.createElement(qt,null,f.a.createElement(Tt,{disabled:!t,value:e.state.title,placeholder:"New notebook",onChange:e.handleTitleChange,onKeyDown:e.handleTitleKeyDown}),(e.state.system||e.hasChanged())&&t&&f.a.createElement("span",{title:j},f.a.createElement(Qt,{primary:!0,text:S,onClick:e.handleTitleClickSave})))}),a&&f.a.createElement(Rt,null,a),O&&f.a.createElement(It,null,f.a.createElement("div",null,f.a.createElement(Nt,null,"Created "),f.a.createElement(_.TimestampTag,{inheritStyles:!0,relative:!0,timestamp:c}),f.a.createElement(Nt,null," by "),s||"anonymous"),f.a.createElement(Lt,null,""),f.a.createElement("div",null,f.a.createElement(Nt,null,"Last edited "),f.a.createElement(_.TimestampTag,{inheritStyles:!0,relative:!0,timestamp:l}),f.a.createElement(Nt,null," by "),u||"anonymous"),f.a.createElement(C.a,{permissions:["notebook.delete"]},f.a.createElement(Lt,null,""),f.a.createElement(Dt,{title:"Delete this notebook",onClick:this.handleRemoveNotebook},"Remove")))),f.a.createElement(C.a,{permissions:["notebook.update"]},function(t){return w&&w.map(function(r,o,a){return f.a.createElement(Ie,bt({readOnly:!t,key:"".concat(String(e.props.id),":").concat(String(r.id)),history:n,number:o+1,onClearHistory:e.handleClearQueryHistory,onEntryChange:e.handleEntryChange,onRemoveQuery:e.handleRemoveQuery,onReorder:e.onReorder(o),onFocus:e.handleFocus},e.props,r,{queryRange:g,queryEnd:v,trailingNow:k,isFirst:0===o,isLast:o===a.length-1,isFocused:r.id===e.state.focusedEntryId,metricNames:d,labelSets:y}))})}),f.a.createElement(C.a,{permissions:["notebook.update"]},f.a.createElement(Mt,null,f.a.createElement(At,{onClick:this.handleAddNewQuery,primary:!0},f.a.createElement(Ut,{className:"fa fa-plus"})," New Query"),f.a.createElement(At,{onClick:this.handleAddNewText},f.a.createElement(Ut,{className:"fa fa-plus"})," Add Text")),f.a.createElement(ft,{onSetSystemQuery:this.handleSetSystemQuery,onSetMetricPrefix:this.handleSetMetricPrefix,instanceId:this.props.instanceId})))}}])&&vt(n.prototype,r),a&&vt(n,a),t}();t.b=Object(y.connect)(function(e,t){var n=e.root.timeTravel,r=n.showingLive,o=n.timestamp,a=n.rangeMs,i=t.params,c=i.notebookId,s=i.deeplink,l=i.instanceId,u=e.root.prometheus[l]||{},p=u.notebooks,m=void 0===p?{}:p,d=u.metricNames,f=void 0===d?[]:d,y=u.labelSets,b={entries:[],instanceId:l,labelSets:void 0===y?{}:y,loading:m.loading,metricNames:f,queryEnd:Object(Ze.g)(o),queryRange:Object(Ze.e)(a),sharedQueryParams:Object(T.b)(e),trailingNow:r};if(c){var h=m.data,_=(void 0===h?[]:h).find(function(e){return e.id===c})||{},v=_.id,g=_.title,k=_.createdAt,w=_.createdByEmail,O=_.updatedAt,S=_.updatedByEmail,E=_.version;return _t({},b,{createdAt:k,createdByEmail:w,entries:_.entries,id:v,title:g,updatedAt:O,updatedByEmail:S,version:E})}if(s){var P=decodeURIComponent(s);try{var x=JSON.parse(P),C=x.cells,q=x.time,R=x.title,I=q&&q.queryRange||b.queryRange,N=q&&q.queryEnd||b.queryEnd;return _t({},b,{entries:(C||[]).map(function(e){return{id:Object(j.k)(),query:e.queries&&e.queries.join("".concat(Et,"\n"))}}),queryEnd:N,queryRange:I,title:R})}catch(e){Pt("Error decoding deep link queries")}}return b},{deletePrometheusNotebook:w.l,getFluxHistory:w.A,savePrometheusNotebook:w.Fb,updateTimeStateFromUrl:w.Xb})(Gt)},1398:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(22),i=n(19),c=n.n(i),s=n(1299),l=n(11),u=n(64),p=n(125),m=n(1221),d=n(1273),f=n(1327);t.a=Object(a.connect)(function(e,t){var n=t.params,r=Object(u.f)(n.instanceId)(e).platform,o=e.root.prometheus[n.instanceId]||{},a=o.metricNames,i=o.metricNames,c=void 0===i?[]:i;return{instanceId:n.instanceId,metricNamesLoaded:a,metricsExist:f.a.getRows({platform:r}).some(function(e){return e.charts.every(function(e){return Object(p.b)(c,e.queryMetrics)})}),platform:r}})(function(e){var t=e.platform,n=e.metricNamesLoaded,r=e.metricsExist,a=e.params,i=e.location,u=e.instanceId,p=e.hideTimeTravel;return o.a.createElement("div",{className:f.a.id},n&&!r&&o.a.createElement(s.a,null,"Sorry, we could not find any node metrics.","kubernetes"===t&&o.a.createElement("span",null," ","Please ensure you have installed the",o.a.createElement(c.a,{to:Object(l.U)(u)}," Weave Cloud agents.")),""===t&&o.a.createElement("span",null,"If you are using Kubernetes, please ensure you have installed the"," ",o.a.createElement(c.a,{to:Object(l.U)(u)},"Weave Cloud agents."),o.a.createElement("br",null),"For other platforms, please setup the",o.a.createElement("a",{href:"https://github.com/prometheus/node_exporter"}," ","prometheus node-exporter"),"."),"kubernetes"!==t&&""!==t&&o.a.createElement("span",null," ","Please setup the",o.a.createElement("a",{href:"https://github.com/prometheus/node_exporter"}," ","prometheus node-exporter"),".")),!p&&o.a.createElement(m.a,{instanceId:a.instanceId,location:i,hasRangeSelector:!0}),o.a.createElement(d.a,{rows:f.a.getRows({platform:t}),instanceId:a.instanceId,location:i}))})},2377:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(1314),i=n.n(a),c=n(31),s=n.n(c),l=n(20),u=n.n(l),p=n(1398),m=n(363),d=n.n(m),f=n(89),y=n.n(f),b=n(14),h=n.n(b),_=n(6),v=n.n(_),g=n(22),k=n(13),w=n.n(k),O=n(19),S=n.n(O),j=n(1),E=n(9),P=n(55),x=n(7),C=n(11),q=n(1299),T=n(155),R=n(64),I=n(111),N=n(125),L=n(1221),D=Object(j.default)(S.a).withConfig({displayName:"legend-item-link__StyledLink",componentId:"sc-1q0qvk2-0"})(["font-size:",";position:relative;"],function(e){return e.theme.fontSizes.small}),M=j.default.i.withConfig({displayName:"legend-item-link__Icon",componentId:"sc-1q0qvk2-1"})(["position:absolute;left:5px;top:1px;"]);function A(){Object(x.trackEvent)("prom.dashboard.service.resources.legend.link.click")}var U=function(e){var t=e.to,n=e.tooltip;return o.a.createElement(D,{to:t,title:n,onClick:A},o.a.createElement(M,{className:"fa fa-arrow-circle-right"}))},Q=n(1273),F=n(2),W=n(1340);function z(e){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function K(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function G(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(n,!0).forEach(function(t){$(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function X(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z(e,t){return(Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var J="prom.selectedNS",ee=j.default.div.withConfig({displayName:"dashboard__NamespaceSelector",componentId:"sc-1p5fqdq-0"})(["font-size:",";align-items:baseline;margin-left:30px;margin-bottom:20px;display:flex;"],function(e){return e.theme.fontSizes.normal}),te=j.default.span.withConfig({displayName:"dashboard__SelectorLabel",componentId:"sc-1p5fqdq-1"})(["margin-right:1em;"]),ne={label:"--- All namespaces ---",value:"all"},re=function(e){return e?[e]:[]},oe=function(e){return"all"===e?"":e},ae=function(e){function t(e){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=Y(t).call(this,e),n=!a||"object"!==z(a)&&"function"!=typeof a?X(r):a,$(X(n),"getActiveChartId",function(){return n.props.location.hash.slice(1)}),$(X(n),"viewingAllNamespaces",function(){return n.state.selectedNamespace===ne.value}),$(X(n),"renderLegendItemSuffix",function(e,t){var r=e.key,a=t.selected,i=t.hovered,c=n.props,s=c.instanceId,l=c.sharedQueryParams,u=n.state.selectedNamespace,p="".concat(u,":deployment/").concat(r);return a||i?n.viewingAllNamespaces()?o.a.createElement(U,{tooltip:"View resources for this namespace",to:Object(C.i)(H({},l,{namespace:r}),s)}):o.a.createElement(U,{tooltip:"View resources for this workload",to:Object(C.Z)(l,s,p,"cadvisor-resources")}):null}),$(X(n),"smoothScrollToActiveChart",function(){if(!n.state.scrolled){var e=n.getActiveChartId(),t=document.querySelector('div[data-id="'.concat(e,'"]'));e&&t&&(n.setState({scrolled:!0}),t.scrollIntoView({behavior:"smooth",block:"start",inline:"start"}))}}),$(X(n),"handleNamespaceSelect",function(e,t){var r=n.props.location.query,o=(r.workload,K(r,["workload"])),a=H({},n.props.location,{query:o});w.a.push({pathname:n.props.location.pathname,search:Object(N.h)({namespace:t},a)}),Object(x.trackEvent)("prom.dashboard.workload.resources.namespace.change",{namespace:t}),n.updateSelectedNamespace(t)}),$(X(n),"updateSelectedNamespace",function(e){n.setState({selectedLegendKeys:[],selectedNamespace:e}),Object(P.storageSet)(J,e)}),n.state={scrolled:!1,selectedLegendKeys:re(e.location.query.workload),selectedNamespace:e.namespace||ne.value},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Z(e,t)}(t,o.a.Component),n=t,(r=[{key:"fetchNamespaceLabels",value:function(e){d()(e.platform)||this.props.loadNamespacesList(e.instanceId,e.platform)}},{key:"getRows",value:function(e,t){this.rows=W.a.getRows({instance:e.instance,namespace:oe(t.selectedNamespace),platform:e.platform})}},{key:"componentWillMount",value:function(){this.fetchNamespaceLabels(this.props),this.getRows(this.props,this.state)}},{key:"componentWillUpdate",value:function(e,t){this.props.instanceId===e.instanceId&&this.props.platform===e.platform||this.fetchNamespaceLabels(e),this.props.platform===e.platform&&this.state.selectedNamespace===t.selectedNamespace||this.getRows(e,t)}},{key:"componentWillReceiveProps",value:function(e){var t=this.state.selectedNamespace,n=y()(e.namespaces,t);this.state.selectedNamespace!==e.namespace&&this.updateSelectedNamespace(e.namespace),e.isLoading||this.viewingAllNamespaces()||n||this.updateSelectedNamespace(ne.value)}},{key:"componentDidMount",value:function(){this.smoothScrollToActiveChart(),w.a.replace(Object(C.i)(H({},this.props.sharedQueryParams,{namespace:this.state.selectedNamespace}),this.props.instanceId,v()(this.props,"location.hash")))}},{key:"componentDidUpdate",value:function(){this.smoothScrollToActiveChart()}},{key:"componentWillUnmount",value:function(){this.namespaceLabelsRequest&&this.namespaceLabelsRequest.cancel()}},{key:"render",value:function(){var e,t=this.state,n=t.selectedNamespace,r=t.selectedLegendKeys,a=this.props,i=a.platform,c=a.metricNamesLoaded,s=a.metricsExist,l=a.namespaces,u=a.instanceId,p=a.location;if(c&&!s){var m,d=o.a.createElement("span",null,"Please"," ",o.a.createElement(S.a,{to:Object(C.U)(u)},"re-install the Weave Cloud agents")," ","to collect Workload Resources metrics.");if(""===i)m=d;else m="kubernetes"===i||"docker"===i?d:o.a.createElement("span",null,"We cannot currently provide the Workload Resources Dashboard for your cluster platform.");e=o.a.createElement(q.a,null,"Sorry, we could not find any workload metrics.",m)}var f=[ne].concat(B(h()(l,function(e){return{label:e,value:e}}))),y=this.getActiveChartId();return o.a.createElement("div",{className:W.a.id},e,!this.props.hideTimeTravel&&o.a.createElement(L.a,{instanceId:u,location:p,hasRangeSelector:!0}),this.props.isLoading?o.a.createElement(T.a,null):o.a.createElement("div",null,o.a.createElement(ee,null,o.a.createElement(te,null,"Namespace"),o.a.createElement(E.Dropdown,{onChange:this.handleNamespaceSelect,value:oe(n),items:f},o.a.createElement("strong",null,n))),o.a.createElement(Q.a,{rows:this.rows,instanceId:u,focusedChartId:y,selectedLegendKeys:r,namespaceId:oe(n),renderLegendItemSuffix:this.renderLegendItemSuffix,location:p})))}}])&&V(n.prototype,r),a&&V(n,a),t}();var ie=Object(g.connect)(function(e,t){var n=t.params.instanceId,r=e.root.instances[n],o=Object(R.f)(n)(e).platform,a=e.root.prometheus[n]||{},i=t.location.query.namespace||Object(P.storageGet)(J,ne.value),c=a.metricNames,s=a.metricNames,l=void 0===s?[]:s;return{instance:r,instanceId:n,isLoading:v()(e,["root","namespaces",n,"loading"],!0),metricNamesLoaded:c,metricsExist:W.a.getRows({instance:r,namespace:i,platform:o}).every(function(e){return e.charts.every(function(e){return Object(N.b)(l,e.queryMetrics)})||e.optional}),namespace:i,namespaces:v()(e,["root","namespaces",n,"data"],[]),platform:o,sharedQueryParams:Object(I.b)(e)}},{loadNamespacesList:F.V})(ae),ce={getRows:function(){return[{charts:[{getLabel:function(e){return e.metric.job},metricUnits:"percent",query:'sum without(instance, state) (weave_ips{state="local-used"}) / max without(instance) (weave_max_ips) * 100',queryMetrics:["weave_ips","weave_max_ips"],title:"IP address space exhaustion",valuesMinSpread:1}],key:"IP exhaustion"},{charts:[{getLabel:function(e){return e.metric.job},query:'weave_dns_entries{state="local"}',queryMetrics:["weave_dns_entries"],title:"Number of local DNS entries per host"}],key:"Local DNS"},{charts:[{getLabel:function(e){return e.metric.job},query:"sum without(instance) (rate(weave_connection_terminations_total[2m]))",queryMetrics:["weave_connection_terminations_total"],title:"Connection termination rate per second"}],key:"Termination rate"},{charts:[{getLabel:function(e){return e.metric.job},query:"sum by(protocol, job) (weavenpc_blocked_connections_total)",queryMetrics:["weave_connection_terminations_total"],title:"Number of blocked connections per transport-layer protocol"}],key:"Blocked per protocol"},{charts:[{getLabel:function(e){return e.metric.job},query:"topk(10, sum by(job, protocol, dport) (weavenpc_blocked_connections_total))",queryMetrics:["weave_connection_terminations_total"],title:"Frequent (protocol,dport) combinations of blocked connections"}],key:"Blocked per protocol,dport"}]},href:"weave-net",id:"weave-net",name:"Weave Net",onlyShowIfMetricsAvailable:!0},se=function(e){var t=e.params,n=e.location;return o.a.createElement("div",{className:ce.id},o.a.createElement(L.a,{instanceId:t.instanceId,location:n,hasRangeSelector:!0}),o.a.createElement(Q.a,{rows:ce.getRows(),instanceId:t.instanceId,location:n}))},le=n(32),ue=n.n(le),pe=n(1266),me=n(1291),de=n(1549),fe=n(1326);function ye(e){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function he(e){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ve(e,t){return(ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ge=j.default.div.withConfig({displayName:"dashboard-tab__TabWrapper",componentId:"sc-1w7z23b-0"})([""]),ke=j.default.div.withConfig({displayName:"dashboard-tab__DashboardSection",componentId:"sc-1w7z23b-1"})(["margin-left:-40px;"]),we=j.default.h3.withConfig({displayName:"dashboard-tab__DashboardSectionName",componentId:"sc-1w7z23b-2"})(["font-size:",";text-align:center;margin-top:20px;margin-bottom:0;opacity:0.5;"],function(e){return e.theme.fontSizes.extraLarge}),Oe=j.default.div.withConfig({displayName:"dashboard-tab__DashboardSectionContent",componentId:"sc-1w7z23b-3"})(["margin-bottom:30px;"]),Se=j.default.div.withConfig({displayName:"dashboard-tab__DashboardRow",componentId:"sc-1w7z23b-4"})(["display:flex;align-items:stretch;justify-content:space-between;"]),je=j.default.div.withConfig({displayName:"dashboard-tab__DashboardChartSlot",componentId:"sc-1w7z23b-5"})(["width:",";background-color:",";"],function(e){return"calc(100% / ".concat(e.numberOfColumnsPerRow,")")},function(e){return e.shaded?e.theme.colors.purple50:"transparent"}),Ee=function(e){function t(e){var n,r,o,a,i,c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=he(t).call(this,e),n=!o||"object"!==ye(o)&&"function"!=typeof o?_e(r):o,a=_e(n),c=function(e){n.setState({isLoading:!0}),n.props.loadAwsDashboards(e.instanceId,e.type).then(function(e){n.setState({isLoading:!1}),e&&e.dashboards&&n.setState({sections:e.dashboards[0].sections})})},(i="loadDashboardCharts")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n.state={isLoading:!0,sections:[]},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ve(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.loadDashboardCharts(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.loadDashboardCharts(e)}},{key:"render",value:function(){var e=this;return o.a.createElement(ge,null,this.state.isLoading?o.a.createElement(T.a,null):this.state.sections.map(function(t){return o.a.createElement(ke,{key:t.name},o.a.createElement(we,null,t.name),o.a.createElement(Oe,null,h()(t.rows,function(t,n){return o.a.createElement(Se,{key:n},t.panels.map(function(n){return o.a.createElement(je,{"data-id":n.id,key:n.title,numberOfColumnsPerRow:t.panels.length},o.a.createElement(fe.a,{title:n.title,query:n.query,metricUnits:n.unit.format,instanceId:e.props.instanceId,legendShown:!0}))}))})))}))}}])&&be(n.prototype,r),a&&be(n,a),t}();var Pe=Object(g.connect)(function(){return{}},{loadAwsDashboards:F.S})(Ee);function xe(e){return(xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qe(e){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Re(e,t){return(Re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ie=j.default.div.withConfig({displayName:"dashboard__AwsInstructionsWrapper",componentId:"sc-1m0inm2-0"})(["margin:50px 70px 50px 105px;"]),Ne=j.default.div.withConfig({displayName:"dashboard__AwsWrapper",componentId:"sc-1m0inm2-1"})(["margin:15px 20px;"]),Le=j.default.div.withConfig({displayName:"dashboard__AwsContainer",componentId:"sc-1m0inm2-2"})(["margin:10px 20px;"]),De=function(e){function t(e){var n,r,o,a,i,c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=qe(t).call(this,e),n=!o||"object"!==xe(o)&&"function"!=typeof o?Te(r):o,a=Te(n),c=function(e){n.setState({selectedTabId:e})},(i="handleTabChange")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n.state={isFirstLoading:!0,selectedTabId:null},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Re(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=this;this.props.updateTimeStateFromUrl(this.props.location),this.props.loadAwsResourcesList(this.props.params.instanceId).then(function(){e.setState({isFirstLoading:!1})}),this.polling=setInterval(function(){e.props.hasDashboards||e.props.loadAwsResourcesList(e.props.params.instanceId)},2e4)}},{key:"componentWillReceiveProps",value:function(e){e.location.search!==this.props.location.search&&this.props.updateTimeStateFromUrl(e.location)}},{key:"componentWillUnmount",value:function(){clearInterval(this.polling)}},{key:"render",value:function(){var e=this;return this.state.isFirstLoading?o.a.createElement(T.a,null):this.props.hasDashboards?o.a.createElement(Ne,null,o.a.createElement(L.a,{instanceId:this.props.params.instanceId,location:this.props.location,hasRangeSelector:!0}),o.a.createElement(Le,null,o.a.createElement(pe.b,{onSelectedTabChange:this.handleTabChange,selectedTabId:this.state.selectedTabId||this.props.dashboards[0].type},h()(this.props.dashboards,function(t){return o.a.createElement(me.a,{key:t.type,id:t.type,name:t.label},o.a.createElement(Pe,{instanceId:e.props.params.instanceId,active:t.type===e.state.selectedTabId,type:t.type,dashboard:t}))})))):o.a.createElement(Ie,null,o.a.createElement(de.a,null))}}])&&Ce(n.prototype,r),a&&Ce(n,a),t}();var Me=Object(g.connect)(function(e,t){var n=t.params.instanceId,r=v()(e,["root","awsDashboards",n,"data"]);return{dashboards:r,hasDashboards:!ue()(r)}},{loadAwsResourcesList:F.T,updateTimeStateFromUrl:F.Xb})(De),Ae=n(3),Ue=n(233),Qe=n.n(Ue);function Fe(e){return(Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function We(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ze(e){return(ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Be(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ke(e,t){return(Ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var He=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=ze(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Fe(o)&&"function"!=typeof o?Be(r):o,Ge(Be(n),"handleFrameLoad",function(){if(n.props.css){var e='<style type="text/css">'.concat(n.props.css,"</style>");try{var t=n.iFrame.contentDocument;t.querySelector("head").insertAdjacentHTML("beforeend",e),n.props.onLoad&&n.props.onLoad(t)}catch(e){}}n.iFrame.contentWindow.addEventListener("focus",n.handleFrameFocus,!0)}),Ge(Be(n),"handleFrameFocus",function(){n.props.dispatch(Object(F.r)())}),Ge(Be(n),"saveIFrameRef",function(e){n.iFrame=e}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ke(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("iframe",{frameBorder:"0",scrolling:"yes",ref:this.saveIFrameRef,onLoad:this.handleFrameLoad,src:this.props.src,style:{border:"none",display:"block",height:"100%",minHeight:"800px",width:"100%"}})}}])&&We(n.prototype,r),a&&We(n,a),t}(),Ve=Object(g.connect)()(He),Ye=n(158);function Xe(e){return(Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ze(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function $e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Je(e){return(Je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function et(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tt(e,t){return(tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nt=Object(j.default)(Ve).withConfig({displayName:"wrapper___StyledIFrame",componentId:"lw6bd5-0"})(["",""],function(e){return e._css}),rt=function(e){function t(){var e,n,r,o,a,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=this,o=(e=Je(t)).call.apply(e,[this].concat(l)),n=!o||"object"!==Xe(o)&&"function"!=typeof o?et(r):o,a=et(n),c=function(e){var t=e.querySelector("body");new MutationObserver(function(e){Qe.a.apply(void 0,Ze(e.map(function(e){return Ze(e.addedNodes)}))).map(function(e){return Array.prototype.map.call(e.getElementsByTagName("a"),function(e){var t=e.getAttribute("href");if(t)if(t.startsWith("/graph?")){var r=Object(Ae.e)(t.substr(7).replace(/\+/g," "))["g0.expr"];e.setAttribute("target","_parent"),e.setAttribute("href",Object(C.P)({},n.props.instanceId,[r]))}else"#/status"===t&&e.parentNode.removeChild(e)})})}).observe(t,{childList:!0,subtree:!0})},(i="mangleLinks")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tt(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props.url;return o.a.createElement(nt,{src:e,onLoad:this.mangleLinks,_css:"\n      body {\n        background: white;\n      }\n      header {\n        display: none;\n      }\n      #content {\n        padding: 0.5em;\n      }\n    "})}}])&&$e(n.prototype,r),a&&$e(n,a),t}(),ot=Object(Ye.a)(rt);function at(e){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function it(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["/api/app/","/api/prom/alertmanager/#alerts"]);return it=function(){return e},e}function ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function st(e,t){return!t||"object"!==at(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lt(e){return(lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ut(e,t){return(ut=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),st(this,lt(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ut(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props.params,t=Object(Ae.d)(it(),e.instanceId);return o.a.createElement(ot,{url:t,instanceId:e.instanceId,params:e})}}])&&ct(n.prototype,r),a&&ct(n,a),t}();function mt(e){return(mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dt(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["/api/app/","/api/prom/alertmanager/#silences"]);return dt=function(){return e},e}function ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yt(e,t){return!t||"object"!==mt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bt(e){return(bt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ht(e,t){return(ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),yt(this,bt(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ht(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props.params,t=Object(Ae.d)(dt(),e.instanceId);return o.a.createElement(ot,{url:t,instanceId:e.instanceId,params:e})}}])&&ft(n.prototype,r),a&&ft(n,a),t}(),vt=n(8),gt=n(159),kt=n(422),wt=n(189),Ot=n.n(wt),St=n(304),jt=n.n(St),Et=n(127),Pt=n.n(Et),xt=n(18),Ct=n.n(xt),qt=n(17),Tt=n(300),Rt=n(1327),It=[W.a,Rt.a,ce],Nt=n(1382),Lt=n.n(Nt),Dt=n(222),Mt=n.n(Dt);function At(e){return(At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qt(e){return(Qt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ft(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wt(e,t){return(Wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var zt=j.default.div.withConfig({displayName:"prom-bar-collapsable__CollapsableWrapper",componentId:"sc-1tivtsv-0"})([""]),Bt=j.default.div.withConfig({displayName:"prom-bar-collapsable__CollapsableContent",componentId:"sc-1tivtsv-1"})(["display:",";"],function(e){return e.expanded?"block":"none"}),Kt=j.default.span.withConfig({displayName:"prom-bar-collapsable__ToggleTitle",componentId:"sc-1tivtsv-2"})(["color:",";font-size:",";cursor:pointer;line-height:1.5;white-space:pre;&:hover{color:",";}"],function(e){return e.theme.colors.purple400},function(e){return e.theme.fontSizes.small},function(e){return e.theme.colors.purple700}),Gt=function(e){function t(e){var n,r,o,a,i,c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Qt(t).call(this,e),n=!o||"object"!==At(o)&&"function"!=typeof o?Ft(r):o,a=Ft(n),c=function(){Object(x.trackEvent)("prom.nav.".concat(n.props.id)),n.setState({expanded:!n.state.expanded})},(i="handleToggle")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n.state={expanded:e.expanded},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wt(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentWillReceiveProps",value:function(e){!this.props.expanded&&e.expanded&&this.setState({expanded:!0})}},{key:"render",value:function(){var e=this.state.expanded,t=this.props,n=t.title,r=t.count;return r?o.a.createElement(zt,null,o.a.createElement(Kt,{onClick:this.handleToggle},this.props.pluralize?o.a.createElement(Lt.a,{singular:n,count:r}):n,"  ",o.a.createElement("i",{className:Mt()({"fa fa-caret-down":e,"fa fa-caret-right":!e})})),o.a.createElement(Bt,{expanded:e},this.props.children)):null}}])&&Ut(n.prototype,r),a&&Ut(n,a),t}();function Ht(e){return(Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vt(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function Yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vt(n,!0).forEach(function(t){Xt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Xt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $t(e,t){return!t||"object"!==Ht(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jt(e){return(Jt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function en(e,t){return(en=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tn=j.default.div.withConfig({displayName:"prom-bar__LoadingContainer",componentId:"sc-3pf4zh-0"})(["padding:24px;display:flex;justify-content:center;"]),nn=function(e){var t=e.id,n=e.description,r=e.href,a=e.relativeHref,i=e.text,c=e.className,s=e.newWindow,l=e.prefix,u=e.selected,p=a?function(e){e.metaKey||(e.preventDefault(),w.a.push(a)),Object(x.trackEvent)("prom.nav.".concat(t))}:function(){Object(x.trackEvent)("prom.nav.".concat(t))},m={item:{color:u&&Ct.a.colors.purple700,cursor:"pointer",fontSize:"1em",lineHeight:1.5}};return o.a.createElement("div",{key:r||a||i,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"pre"}},l,o.a.createElement("a",{className:c,onClick:p,href:r||a,target:s&&"_blank",style:m.item,title:n},i,"",r&&o.a.createElement("span",{className:"fas fa-external-link-alt"})))};function rn(e){var t=e.notebooks.length;return t>0&&t<11||!!e.currentNotebookId}var on=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=$t(this,Jt(t).call(this,e))).state={notebooksVisible:rn(e)},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&en(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentWillReceiveProps",value:function(e){this.props.loading&&!e.loading&&this.setState({notebooksVisible:rn(e)})}},{key:"render",value:function(){var e=this,t=this.props,n=t.instanceId,r=t.notebooks,a=t.loading,i=t.currentNotebookId,c=t.currentDashboardId,s=t.children,l=t.metricNames,u=t.sharedQueryParams,p=function(e,t,n){return e.map(function(e){var r=e.id,o=e.href,a=e.name;return{description:"Shows the ".concat(a.toLowerCase()," dashboard"),hrefId:o,id:"".concat(r,"-dashboard"),relativeHref:Object(C.h)(n,t,o),text:a}})}(It.filter(function(e){return function(e,t){return!e.onlyShowIfMetricsAvailable||e.getRows().some(function(e){return e.charts.some(function(e){return Object(N.b)(t,e.queryMetrics)})})}(e,l)}),n,u),m=function(e){return[{description:"View Prometheus alerts",id:"alerts",relativeHref:Object(C.c)(e),text:"Firing alerts"},{description:"View Prometheus silenced alerts",id:"silenced",relativeHref:Object(C.W)(e),text:"Silenced alerts"}]}(n),d=[{description:"Learn about the flexible query language to leverage things like dimensionality",href:"https://prometheus.io/docs/querying/examples/",id:"promql",newWindow:!0,text:"PromQL query examples"}];return a?o.a.createElement(tn,null,o.a.createElement(E.CircularProgress,null)):o.a.createElement("div",{className:"prom-bar"},o.a.createElement("div",{className:"prom-bar-section"},o.a.createElement("div",{className:"prom-bar-heading"},"Dashboards"),o.a.createElement("div",{className:"prom-bar-items"},p.map(function(e){return nn(Yt({},e,{selected:c===e.hrefId}))}),nn({description:"Shows the AWS CloudWatch dashboards",id:"aws",relativeHref:Object(C.f)(u,n),selected:"aws"===c,text:"AWS CloudWatch"}))),o.a.createElement("div",{className:"prom-bar-section"},o.a.createElement("div",{className:"prom-bar-heading"},"Notebooks"),o.a.createElement("div",{className:"prom-bar-items"},o.a.createElement(Tt.a,{permissions:["notebook.create"]},nn({className:"prom-bar-items-important",description:"Shows an empty notebook to enter Prometheus queries.",id:"new-notebook",relativeHref:Object(C.P)(u,n),selected:"new"===i,text:"Create notebook"})),o.a.createElement(Gt,{pluralize:!0,title:"Notebook",id:"view-notebooks",count:r.length,expanded:this.state.notebooksVisible},r.map(function(e){return o.a.createElement("span",{key:e.id},nn({description:e.title,id:"saved-notebook",prefix:"    ",relativeHref:Object(C.Q)(u,n,e.id),selected:e.id===i,text:e.title}))})))),o.a.createElement("div",{className:"prom-bar-section"},o.a.createElement("div",{className:"prom-bar-heading"},"Alerting"),o.a.createElement("div",{className:"prom-bar-items"},m.map(function(t){return nn(Yt({},t,{selected:t.relativeHref===e.props.location.pathname}))}))),o.a.createElement("div",{className:"prom-bar-section"},o.a.createElement("div",{className:"prom-bar-heading"},"Prometheus help"),o.a.createElement("div",{className:"prom-bar-items"},d.map(nn))),s)}}])&&Zt(n.prototype,r),a&&Zt(n,a),t}();var an=Object(g.connect)(function(e,t){var n=t.instanceId,r=e.root.prometheus[n]||{},o=r.metricNames,a=void 0===o?[]:o,i=(r.notebooks||{}).data,c=void 0===i?[]:i;return{loading:r.notebooks&&r.notebooks.loading,metricNames:a,notebooks:Pt()(c,function(e){return jt()(Ot()(Object(qt.r)(e.title)))}),sharedQueryParams:Object(I.b)(e)}})(on);function cn(e){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sn(){return(sn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ln(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function un(e,t){return!t||"object"!==cn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pn(e){return(pn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mn(e,t){return(mn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dn=j.default.div.withConfig({displayName:"page__PromContent",componentId:"sc-1q45br3-0"})(["flex:1;width:100%;padding:15px 20px;"]),fn=null,yn=null,bn=3e4;function hn(e){var t=e.params.instanceId;e.checkPrometheus(t),e.loadPrometheusNotebooks(t),null!==e.workloadIds||e.workloadIdsLoading||e.loadWorkloadIds(t)}var _n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),un(this,pn(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mn(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){Object(x.trackMixpanelOnlyEvent)("prom.page.view"),hn(this.props),this.props.checkPrometheus(this.props.params.instanceId),this.props.loadPrometheusNotebooks(this.props.params.instanceId)}},{key:"componentWillReceiveProps",value:function(e){e.params.instanceId!==this.props.params.instanceId&&hn(e)}},{key:"componentWillUnmount",value:function(){clearTimeout(yn)}},{key:"render",value:function(){var e=this.props.location.pathname.indexOf("/intro")>0,t=this.props.location.pathname.indexOf("/setup")>0,n=this.props.location.pathname.indexOf("/dashboard/")>0?this.props.location.pathname.split("/").pop():null;return o.a.createElement(gt.a,sn({page:"prom"},this.props.params),!e&&!t&&o.a.createElement("div",{className:"prom-nav"},o.a.createElement(an,{instanceId:this.props.params.instanceId,currentNotebookId:this.props.params.notebookId,currentDashboardId:n,location:this.props.location})),o.a.createElement(dn,null,this.props.children))}}])&&ln(n.prototype,r),a&&ln(n,a),t}(),vn=Object(g.connect)(function(e,t){var n=Object(R.e)(t.params.instanceId)(e),r=n.loading;return{workloadIds:n.list,workloadIdsLoading:r}},{checkPrometheus:function e(t){return function(n){clearTimeout(yn),fn=t,Object(vt.U)(t).then(function(e){t===fn&&n(Object(F.ub)(t,e.data))}).catch(function(){t===fn&&n(Object(F.tb)(t,"Prometheus connection error"))}).then(function(){yn=setTimeout(function(){n(e(t))},bn)})}},loadPrometheusNotebooks:F.W,loadWorkloadIds:kt.a})(Object(Ye.a)(_n)),gn=n(631),kn=n.n(gn);function wn(e){return(wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function On(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sn(e,t){return!t||"object"!==wn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jn(e){return(jn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function En(e,t){return(En=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Pn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Sn(this,jn(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&En(e,t)}(t,o.a.Component),n=t,(r=[{key:"handleButtonClick",value:function(){var e=this.props,t=e.connected,n=e.instanceId,r=t?Object(C.N)({},n):Object(C.U)(n);t||Object(x.trackEvent)("prom.intro.configure.click"),w.a.push(r)}},{key:"render",value:function(){var e=this,t=this.props.connected?"Monitor":"Install";return o.a.createElement("div",{className:"workload-intro-page workload-intro-page-prom"},o.a.createElement(E.Grid,null,o.a.createElement(E.GridRow,{alignContent:"center"},o.a.createElement(E.GridColumn,{span:4},o.a.createElement("img",{src:kn.a,alt:"Monitoring screenshot"})),o.a.createElement(E.GridColumn,{span:4},o.a.createElement("div",{className:"workload-intro-page-text"},o.a.createElement("h2",null,"Monitor your cluster"),o.a.createElement("p",null,'No matter how dynamic your microservices environment, Weave Cloud"s hosted, horizontally scalable Prometheus service lets you quickly identify issues with your app.'),o.a.createElement("h3",null,"Visibility"),o.a.createElement("p",null,"In a constantly changing environment, you need alternative approaches to monitoring individual VMs or servers. Weave Cloud lets you monitor your whole environment no matter how many moving parts."),o.a.createElement("h3",null,"Reliability and scale"),o.a.createElement("p",null,"Weave Cloud Monitoring is based on Prometheus and its dimensional data model and powerful query language. This allows you to drill down quickly into problems, enabling you to focus on apps."),o.a.createElement(E.Button,{primary:!0,onClick:function(){return e.handleButtonClick()},text:t}))))))}}])&&On(n.prototype,r),a&&On(n,a),t}();var xn=Object(g.connect)(function(e,t){var n=t.params.instanceId;return{connected:Object(R.d)(n)(e).prom,instanceId:n}},{getSetupStatus:F.Q})(Pn),Cn=n(1375);t.default=[o.a.createElement(u.a,{component:vn},o.a.createElement(i.a,{to:"dashboard"}),o.a.createElement(u.a,{path:"intro",component:xn,gaName:"PromIntro",mpEvent:"prom.intro.view"}),o.a.createElement(s.a,{from:"dashboard",to:"dashboard/workload-resources"}),o.a.createElement(s.a,{from:"dashboard/service-resources",to:"dashboard/workload-resources"}),o.a.createElement(u.a,{path:"dashboard/node-resources",gaName:"PromDashboardNodeResources",mpEvent:"prom.dashboard.node.resources.view",component:p.a}),o.a.createElement(u.a,{path:"dashboard/workload-resources",gaName:"PromDashboardWorkloadResources",mpEvent:"prom.dashboard.service.resources.view",mpEventProps:function(e){return{namespace:e.location.query.namespace}},component:ie}),o.a.createElement(u.a,{path:"dashboard/weave-net",gaName:"PromDashboardWeaveNet",mpEvent:"prom.dashboard.weave.net.view",component:se}),o.a.createElement(u.a,{path:"dashboard/aws",gaName:"PromDashboardAws",mpEvent:"prom.dashboard.aws.view",component:Me}),o.a.createElement(u.a,{path:"notebook/:notebookId",gaName:"PromNotebook",noMpEvent:"see prom.notebook.view",component:Cn.b}),o.a.createElement(u.a,{path:"notebook/new(/:deeplink)",gaName:"PromNotebook",noMpEvent:"see prom.notebook.view",component:Cn.b}),o.a.createElement(u.a,{path:"alerts/silenced",component:_t,gaName:"Silenced",mpEvent:"prom.alertmanager.alerts.silenced.view"}),o.a.createElement(u.a,{path:"alerts",component:pt,gaName:"Alerts",mpEvent:"prom.alertmanager.alerts.view"}),o.a.createElement(s.a,{from:"wrapper",to:"notebook/new"}),o.a.createElement(s.a,{path:"config",to:"/:instanceId/org/alerts"}),o.a.createElement(s.a,{path:"alerts/config",to:"/:instanceId/org/alerts"}))]}}]);