(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{1310:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(5),i=n.n(o),c=n(1),l=n(45);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=c.default.div.withConfig({displayName:"callout__CalloutContainer",componentId:"hr9imq-0"})(["align-items:center;background-color:",";border-radius:",";border:2px solid ",";display:flex;margin:8px 0 8px 0;min-height:1em;padding:0.5em;transition:opacity 0.2s linear;a{color:",";text-decoration:underline;&:hover{text-decoration:none;}}"],function(e){return Object(l.transparentize)(.75,e.theme.colors.yellow500)},function(e){return e.theme.borderRadius.soft},function(e){return Object(l.transparentize)(.5,e.theme.colors.yellow500)},function(e){return e.theme.colors.black}),b=c.default.i.withConfig({displayName:"callout__Icon",componentId:"hr9imq-1"})(["font-size:",";margin-right:12px;margin-left:6px;"],function(e){return e.theme.fontSizes.large}),g=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),d(this,f(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,a.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.icon,n=e.children;return a.a.createElement(m,null,a.a.createElement(b,{className:t})," ",a.a.createElement("div",null,n))}}])&&u(n.prototype,r),o&&u(n,o),t}();g.propTypes={icon:i.a.string},g.defaultProps={icon:"fa fa-info-circle"},t.a=g},1316:function(e,t,n){"use strict";n.d(t,"b",function(){return m}),n.d(t,"a",function(){return b});var r=n(56),a=n.n(r),o=n(0),i=n.n(o),c=n(18),l=n.n(c),s=n(17);function u(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(n,!0).forEach(function(t){f(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p="^1";function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{"flux-version":p,"git-branch":t.branch,"git-label":"flux-".concat(e),"git-path":t.path,"git-url":t.url}}function b(e){var t=e.instanceId,n=e.token,r=e.config,o=void 0===r?{}:r,c=e.prevConfig,u=void 0===c?{}:c,p=e.focused,b=d({"k8s-version":"$(kubectl version | base64 | tr -d ".concat("'\\n'",")"),t:n},m(t,o)),g=a()(["branch","url","path"].filter(function(e){return Object(s.q)(o,u,[e])}).map(function(e){return["git-".concat(e),l.a.colors.blue400]})),h=d({},p&&f({},"git-".concat(p),l.a.colors.blue400),{},g),y=Object(s.v)(b,h),v=window.location,E=v.protocol,k=v.host,w="".concat(E,"//").concat(k,"/k8s/flux.yaml");return i.a.createElement("span",null,"kubectl apply -f"," ",'"',w,"?",i.a.createElement("wbr",null),y,'"')}},1467:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(1),i=n(15),c=n.n(i),l=n(22),s=n(13),u=n.n(s),d=n(9),f=n(2),p=n(64),m=n(1663),b=n(7),g=n(11),h=n(302),y=n(163),v=n(17);function E(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(n,!0).forEach(function(t){x(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=o.default.div.withConfig({displayName:"config-status__ConfigStatusWrapper",componentId:"sc-4wnhck-0"})(["text-align:center;"]),P=o.default.div.withConfig({displayName:"config-status__ConfigStatusItems",componentId:"sc-4wnhck-1"})(["display:inline-block;margin:20px 0;"]),N=o.default.div.withConfig({displayName:"config-status__ConfigStatusItem",componentId:"sc-4wnhck-2"})(["margin:8px 0;display:flex;text-align:left;opacity:",";",";i{font-size:",";width:20px;text-align:center;}"],function(e){return e.finished?.65:e.error?.9:1},function(e){return e.error&&"color: ".concat(e.theme.colors.orange500,"\n  ")},function(e){return e.theme.fontSizes.large}),I=o.default.span.withConfig({displayName:"config-status__StatusText",componentId:"sc-4wnhck-3"})(["margin-left:5px;max-width:400px;"]);function T(e,t){var n=e?a.a.createElement("i",{className:"far fa-check-circle"}):a.a.createElement(d.CircularProgress,{inline:!0,size:20});return a.a.createElement(N,{finished:e},n,a.a.createElement(I,null,t))}var z=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?S(e):t}(this,O(t).call(this,e,n)),x(S(r),"onHomepageButtonClick",function(){var e=r.props,t=e.instance.billingProvider,n=e.instanceId,a=Object(g.D)(n);"gcp"===t?(Object(v.s)(a),self.close()):u.a.push(a)}),r.state={connectedAtLeastOnce:!1},r}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(t,a.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.stopPollingEvents=this.props.pollEvents(this.props.instanceId)}},{key:"componentWillUnmount",value:function(){this.stopPollingEvents()}},{key:"componentWillReceiveProps",value:function(e){var t=e.connected,n=e.isOnboarding,r=e.onboardingStartedEvent,a=e.onFirstConnect;a&&!this.state.connectedAtLeastOnce&&t&&(this.setState({connectedAtLeastOnce:!0}),a(e));var o=function(e,t,r){!t&&r&&c()().subtract(5,"minutes").isBefore(r.timestamp)&&Object(b.trackEvent)(e,{isOnboarding:n})};o("instance.install.started",this.props.onboardingStartedEvent,r),o("instance.install.failed",this.props.onboardingFailedEvent,e.onboardingFailedEvent)}},{key:"renderInstallStartedStep",value:function(e){var t=e.hasInstallStarted,n=this.props,r=n.instance,o=n.onboardingStartedEvent;if("kubernetes"!==n.platform)return null;var i=r&&r.platformVersion?" on Kubernetes cluster ".concat(r.platformVersion):"";return T(t,t?function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:60;if(t){var o=c()(t);if(o.add(r,"minutes").isBefore())return a.a.createElement("span",null,e," ",a.a.createElement(d.TimestampTag,{inheritStyles:!0,relative:!0,timestamp:o}))}return n}("Last started installing agents".concat(i),o&&o.timestamp,"Started installing agents".concat(i)):"Please run the install command above!")}},{key:"renderAgentsConnectingStep",value:function(e){var t=e.anyAgentsConnected,n=e.allAgentsConnected,r=e.connectedAgentCount,o=e.hasInstallStarted,i=this.props.expectedAgents;return o?T(n,t?n?"All Weave Cloud agents are connected!":a.a.createElement("span",null,"".concat(r," of ").concat(i.length)," Weave Cloud agents connected!",a.a.createElement("br",null),"Waiting for remaining agents"):"Waiting for Weave Cloud agents to connect"):null}},{key:"render",value:function(){var e,t=this.props,n=t.expectedAgents,r=t.instanceStatus,o=t.onboardingStartedEvent,i=t.onboardingFailedEvent,l=n.filter(function(e){return r[e.id]}).length,s=0!==l,u=l>=n.length,f={allAgentsConnected:u,anyAgentsConnected:s,connectedAgentCount:l,hasInstallStarted:s||!!o};return a.a.createElement(_,null,a.a.createElement(P,null,this.renderInstallStartedStep(f),!u&&o&&i&&c()(i.timestamp).isAfter(o.timestamp)?(e=i,a.a.createElement(N,{error:!0},a.a.createElement("i",{className:"far fa-times-circle"}),a.a.createElement(I,null,e.text))):this.renderAgentsConnectingStep(f)),u&&a.a.createElement("div",null,a.a.createElement(d.Button,{primary:!0,text:"View your cluster",onClick:this.onHomepageButtonClick})))}}])&&C(n.prototype,r),o&&C(n,o),t}();t.a=Object(l.connect)(function(e,t){var n=t.environment,r=t.instanceId,a=t.platform,o=Object(p.f)(r)(e),i=Object(p.d)(r,!1)(e);return{connected:Object(h.d)(i),expectedAgents:Object(y.b)(k({},o,{environment:n,platform:a})),instance:o,instanceStatus:i,onboardingFailedEvent:Object(m.a)(r)(e),onboardingStartedEvent:Object(m.b)(r)(e)}},{pollEvents:f.jb})(z)},1658:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var r={dcos:"DC/OS",docker:"Docker",ecs:"Amazon ECS",kubernetes:"Kubernetes"},a={aws:"AWS",cloud:"Docker Cloud",ee:"Enterprise",eks:"EKS",generic:"Generic",gke:"GKE",linux:"Linux",mac:"Mac",mesosphere:"Mesosphere",minikube:"Minikube","self-hosted":"Self Hosted",swarm:"Swarm",windows:"Windows"}},1660:function(e,t,n){e.exports=n.p+"src/images/docker.f7a644beb2965fdd2d6f412898588ddb.svg"},1661:function(e,t,n){e.exports=n.p+"src/images/github-logo-small.438c17272c5f0e9f4a6da34d3e4bc5bd.png"},1662:function(e,t,n){e.exports=n.p+"src/images/quay-logo.57afbac9550027a594c148871988553b.svg"},1663:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return c});var r=n(15),a=n.n(r),o=function(e,t,n){var r=function(e,t){var n=function(e){return function(t){return t.root.events[e]||[]}}(e);return function(e){return n(e).filter(function(e){return e.type===t})}}(e,t);return function(e){var t=r(e)[0];return t&&a()().diff(t.timestamp,"hours")<n?t:null}},i=function(e){return o(e,"onboarding_started",24)},c=function(e){return o(e,"onboarding_failed",24)}},1664:function(e,t,n){"use strict";n.d(t,"a",function(){return j});var r=n(0),a=n.n(r),o=n(9),i=n(1),c=n(16),l=n(8),s=n(409),u=n(300),d=n(310),f=n(155);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=i.default.div.withConfig({displayName:"instance-details__Container",componentId:"sc-1ulm92e-0"})(["padding:8px;"]),E=i.default.div.withConfig({displayName:"instance-details__Details",componentId:"sc-1ulm92e-1"})(["display:inline-block;max-width:100%;"]),k=i.default.div.withConfig({displayName:"instance-details__NameEditor",componentId:"sc-1ulm92e-2"})(["margin-bottom:20px;.weave-textfield-wrapper{width:85%;}"]),w=i.default.div.withConfig({displayName:"instance-details__FormButtons",componentId:"sc-1ulm92e-3"})(["margin-top:15px;*{margin-right:10px;}"]),C=i.default.div.withConfig({displayName:"instance-details__EditableName",componentId:"sc-1ulm92e-4"})(["display:flex;align-items:center;font-size:",";&:hover{color:",";}"],function(e){return e.theme.fontSizes.large},function(e){return e.theme.colors.purple400}),O=i.default.span.withConfig({displayName:"instance-details__Name",componentId:"sc-1ulm92e-5"})(["cursor:text;display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]),S=i.default.i.withConfig({displayName:"instance-details__EditIcon",componentId:"sc-1ulm92e-6"})(["cursor:pointer;font-size:",";padding-left:15px;"],function(e){return e.theme.fontSizes.normal}),j=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?g(e):t}(this,b(t).call(this,e)),y(g(n),"clearErrors",function(){n.setState({alertVisible:!1})}),y(g(n),"doSubmit",function(){var e=n.props.id,t=n.state.editingName;t&&(n.setState({submitting:!0}),Object(l.fb)(e,{name:t}).then(function(){n.setState({alertType:"info",alertVisible:!0,editing:!1,notices:[{message:"Name changed to ".concat(t)}],submitting:!1}),n.props.onChange&&n.props.onChange(t)},function(e){n.setState({alertType:"error",alertVisible:!0,notices:e.errors,submitting:!1})}))}),y(g(n),"handleKeyDown",function(e){13===e.keyCode&&n.doSubmit()}),y(g(n),"handleClickCancel",function(){n.setState({editing:!1,editingName:n.props.name})}),y(g(n),"handleClickEdit",function(e){e.preventDefault(),n.setState({editing:!0,editingName:n.props.name})}),y(g(n),"handleClickSave",function(){n.doSubmit()}),y(g(n),"handleChangeNameInput",function(e){n.setState({editingName:e.target.value})}),n.state={alertType:void 0,alertVisible:!1,editing:!1,editingName:e.name,notices:null,submitting:!1},n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,a.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props.id,t=this.state.editing,n=this.state.editing?this.state.editingName:this.props.name;return e?a.a.createElement(v,null,a.a.createElement(s.a,null,a.a.createElement(o.Alert,{type:this.state.alertType,visible:this.state.alertVisible,onClose:this.clearErrors},(this.state.notices||[]).map(function(e){return e.message}).join(". "))),a.a.createElement("div",null,t?a.a.createElement(k,null,a.a.createElement(d.a,{focus:!0,onChange:this.handleChangeNameInput,value:this.state.editingName,hintText:"Provide a name",onKeyDown:this.handleKeyDown,maxLength:c.INSTANCE_NAME_MAX_LENGTH}),a.a.createElement(w,null,a.a.createElement(o.Button,{primary:!0,text:"Save",disabled:Boolean(this.state.submitting),onClick:this.handleClickSave}),a.a.createElement(o.Button,{text:"Cancel",disabled:Boolean(this.state.submitting),onClick:this.handleClickCancel}))):a.a.createElement(E,{title:n},a.a.createElement(C,{onClick:this.handleClickEdit},a.a.createElement(O,null,n),a.a.createElement(S,{className:"fas fa-pencil-alt"}))),a.a.createElement(u.a,{permissions:["instance.token.view"]},a.a.createElement("div",{className:"section"},a.a.createElement("div",null,"Service token: "),a.a.createElement("div",{className:"token"},this.props.probeToken))))):a.a.createElement(f.a,null)}}])&&m(n.prototype,r),i&&m(n,i),t}()},1667:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=function(){return a.a.createElement("div",{className:"platform-instructions"},a.a.createElement("p",null,"You can Explore your app in Weave Cloud if it’s installed as a DC/OS package in Mesosphere Universe."),a.a.createElement("p",null,"The easiest way to get started with DC/OS in the public-cloud is to"," ",a.a.createElement("a",{target:"_blank",href:"https://mesosphere.com/amazon/"},"deploy it on Amazon Web Services (AWS).")),a.a.createElement("p",null,a.a.createElement("a",{target:"_blank",href:"http://universe.dcos.io/#/package/weavescope-probe/version/latest"},"Check out the Weave Cloud Explore Mesosphere DC/OS package here")))},i=n(303),c=n(17),l=n(163);var s=function(e){var t=e.environment,n=e.instance,r=e.onCopy;return a.a.createElement("div",{className:"platform-instructions"},a.a.createElement("p",null,"Weave Cloud needs agents running alongside your application to enable its various services."),a.a.createElement("p",null,"To ",a.a.createElement("strong",null,"monitor"),", ",a.a.createElement("strong",null,"explore")," and troubleshoot your containers, run the following commands. We can even show you uncontained processes!"),function(e){var t=e.environment,n=e.instance,r=e.onCopy,o=Object(c.g)(n.probeToken),s=!0;return Object(l.a)(t)&&(o=Object(c.h)(n.probeToken),s=!1),a.a.createElement(i.a,{multiCommand:s,onCopy:r},o)}({environment:t,instance:n,onCopy:r}),function(e){var t=e.environment;return Object(l.a)(t)?a.a.createElement("div",null,a.a.createElement("p",null,"This will install the Weave Cloud agents including Prometheus exporters as swarm services, connecting them to this instance."),a.a.createElement("p",null,"If swarm mode is not active, you need to run the installer on each Docker engine node.")):a.a.createElement("div",null,a.a.createElement("p",null,"This will install the Weave Cloud Explore agent, connecting it to this instance."),a.a.createElement("p",null,"You can also"," ",a.a.createElement("a",{href:"https://www.weave.works/docs/cloud/latest/install/monitoring-without-kube/"},"configure Prometheus")," ","for ",a.a.createElement("strong",null,"monitoring")," or"," ",a.a.createElement("a",{href:"https://www.weave.works/docs/net/latest/install/installing-weave/"},"use Weave Net")," ","as your container ",a.a.createElement("strong",null,"networking")," solution."))}({environment:t}))},u=function(e){var t=e.instance,n=e.onCopy;return a.a.createElement("div",{className:"platform-instructions"},a.a.createElement("p",null,"You can launch a stack to AWS. See",a.a.createElement("a",{href:"https://www.weave.works/docs/cloud/latest/install/ecs-no-kubernetes/",target:"scopedocs"},"how to configure this"),"."),a.a.createElement("p",null,"Alternatively, Scope works with any hosts running Docker, and can even show you uncontained processes. See the"," ",a.a.createElement("a",{href:"https://www.weave.works/docs/scope/latest/installing/",target:"scopedocs"},"Scope docs")," ","to see how to install it on your platform, or just run:"),a.a.createElement(i.a,{onCopy:n},Object(c.g)(t.probeToken)))},d=function(){return a.a.createElement("div",null,"No instructions found")},f=n(127),p=n.n(f),m=n(57),b=n(9),g=n(1),h=n(7),y=n(302),v=n(8),E=n(1310),k=n(1467),w=g.default.i.withConfig({displayName:"shared__UnderlinedIcon",componentId:"sc-1e1oziz-0"})(["text-decoration:underline;"]);function C(e){var t=e.href,n=e.children;return a.a.createElement("span",null,n," ",a.a.createElement("a",{href:t,target:"_blank"},a.a.createElement(w,{className:"fas fa-external-link-alt","aria-hidden":"true"})))}function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var N=Object(m.debug)("service:gke"),I=g.default.div.withConfig({displayName:"gke__Center",componentId:"sc-1bzlpr3-0"})(["display:flex;align-items:center;justify-content:center;margin-top:20px;margin-bottom:20px;"]),T=g.default.div.withConfig({displayName:"gke__Container",componentId:"sc-1bzlpr3-1"})(["display:flex;align-items:center;"]),z=g.default.span.withConfig({displayName:"gke__Icon",componentId:"sc-1bzlpr3-2"})(["margin:10px;"]);function D(e){var t=e.icon;return a.a.createElement(z,{className:t})}function W(e){var t=e.children;return a.a.createElement("div",{className:"platform-instructions"},a.a.createElement("section",{className:"weave-cloud-agents"},t))}function A(e,t){return{clusterId:e.clusterId,kubernetesVersion:e.kubernetesVersion,label:e.clusterId,projectId:e.projectId,value:t,zone:e.zone}}var F=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==O(t)&&"function"!=typeof t?x(e):t}(this,j(t).call(this,e)),P(x(n),"handleError",function(e,t){Object(h.trackNetworkError)(e),N(JSON.stringify(e)),n.setState({clusters:[],error:t,failed:!0,idxSelected:-1,loaded:!0})}),P(x(n),"loadGkeClusters",function(){var e=n.state.instance;if(N.enabled){n.handleGkeClustersLoaded([{clusterId:"gke-1",kubernetesVersion:"1.8.5-gke.0",projectId:"gke-integration",zone:"us-central1-a"},{clusterId:"gke-integration",kubernetesVersion:"1.8.5-gke.0",projectId:"gke-integration",zone:"us-central1-a"}])}else Object(v.E)(e.id,e.user).then(function(e){e?n.handleGkeClustersLoaded(e):n.handleError(e,"Your GKE clusters could not be loaded at this time.")},function(e){return n.handleError(e,"Your GKE clusters could not be loaded at this time.")})}),P(x(n),"handleSelect",function(e,t){n.setState({idxSelected:t}),n.forceUpdate()}),P(x(n),"handleClick",function(){n.setState({kubectlFailed:!1,kubectlRunning:!0,kubectlSucceeded:!1});var e=n.state,t=e.clusters,r=e.extraParams,a=e.idxSelected,o=e.instance;if(Object(y.c)(o,["gcp-new-laucher"]))Object(v.k)(o.id,o.user,t[a].projectId,t[a].clusterId,t[a].zone,o.probeToken,N.enabled).then(function(e){N.enabled&&N(JSON.stringify(e)),n.setState({kubectlFailed:!1,kubectlRunning:!1,kubectlSucceeded:!0})}).catch(function(e){n.handleError(e,"The Weave Cloud agents could not automatically be installed on your cluster at this time."),n.setState({kubectlFailed:!0,kubectlRunning:!1,kubectlSucceeded:!1})});else{var i=Object(c.j)("k8s",null,o.probeToken,Object.assign({},r,{"k8s-version":t[a].kubernetesVersion}));N.enabled&&N(i),Object(v.jb)(o.id,o.user,t[a].projectId,t[a].clusterId,t[a].zone,N.enabled?["get","po"]:i).then(function(e){N.enabled&&N(JSON.stringify(e)),n.setState({kubectlFailed:!1,kubectlRunning:!1,kubectlSucceeded:!0})}).catch(function(e){n.handleError(e,"The Weave Cloud agents could not automatically be installed on your cluster at this time."),n.setState({kubectlFailed:!0,kubectlRunning:!1,kubectlSucceeded:!1})})}}),n.state={clusters:[],error:null,extraParams:e.extraParams,failed:!1,gcp:"gcp"===e.instance.billingProvider,idxSelected:-1,instance:e.instance,kubectlFailed:!1,kubectlRunning:!1,kubectlSucceeded:!1,loaded:!1,onCopy:e.onCopy},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(t,a.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.state.gcp&&this.loadGkeClusters()}},{key:"handleGkeClustersLoaded",value:function(e){var t=p()(e,["clusterId"]).map(A);this.setState({clusters:t,failed:!1,idxSelected:0,loaded:!0})}},{key:"render",value:function(){var e=this.state,t=e.gcp,n=e.instance,r=e.onCopy,o=e.loaded,i=e.failed,l=e.kubectlRunning,s=e.kubectlSucceeded,u=e.kubectlFailed,d=e.clusters,f=e.idxSelected,p=e.error;if(t&&!o)return a.a.createElement(W,null,a.a.createElement(I,null,a.a.createElement(b.CircularProgress,{size:"small"})," ",a.a.createElement("span",{className:"text",style:{marginLeft:10}},"Loading your clusters from GKE...")));if(i||u||!t){var m=Object(c.i)("k8s",null,n.probeToken,"--gke");return a.a.createElement(W,null,t&&a.a.createElement(E.a,{icon:"fa fa-exclamation-circle"},p),a.a.createElement(c.a,{isGke:!0,onCopy:r,token:n.probeToken},m),a.a.createElement(k.a,{platform:"kubernetes",environment:"gke",instanceId:n.id,onFirstConnect:this.props.onFirstConnect,isOnboarding:this.props.isOnboarding}))}if(0===d.length)return a.a.createElement(W,null,a.a.createElement(E.a,{icon:"fa fa-question-circle"},"Don't have a GKE cluster set up?"," ",a.a.createElement(C,{href:"https://cloud.google.com/kubernetes-engine/docs/quickstart"},"Create one now on Google Cloud Platform"),".",a.a.createElement("br",null),"Refresh this page after your cluster is running.",a.a.createElement("br",null),a.a.createElement("small",null,"We recommend ",a.a.createElement("strong",null,"n1-standard-1")," machine types or better. The Weave Cloud agents will ",a.a.createElement("em",null,"not")," work on f1-micro.")));var g=a.a.createElement(W,null,a.a.createElement(T,null,"Select your Kubernetes cluster:",a.a.createElement(b.Dropdown,{className:"gke-dropdown",onChange:this.handleSelect,items:d,value:f}),a.a.createElement(b.Button,{primary:!0,disabled:l||s,onClick:this.handleClick},"Install Weave Cloud")));return l?a.a.createElement("div",null,g,a.a.createElement(I,null,a.a.createElement(b.CircularProgress,{size:"small"}),a.a.createElement("span",{className:"text",style:{marginLeft:10}},"Installing Weave Cloud agents"))):s?a.a.createElement("div",null,g,a.a.createElement(I,null,a.a.createElement(D,{icon:"fa fa-check-circle"}),"Weave Cloud agents successfully installed"),a.a.createElement(k.a,{platform:"kubernetes",environment:"gke",instanceId:n.id,onFirstConnect:this.props.onFirstConnect,isOnboarding:this.props.isOnboarding})):g}}])&&S(n.prototype,r),o&&S(n,o),t}(),G=function(){return a.a.createElement(E.a,{icon:"fa fa-question-circle"},"Don","'","t have an EKS cluster? Create one quickly with"," ",a.a.createElement(C,{href:"https://github.com/weaveworks/eksctl"},a.a.createElement("code",null,"eksctl")))},R=function(e){var t=e.environment,n=e.instance,r=e.extraParams,o=e.onCopy,i=e.onFirstConnect,l=e.isOnboarding,s="gke"===t;if("gcp"===n.billingProvider)return a.a.createElement(F,{instance:n,extraParams:r,onCopy:o,onFirstConnect:i,isOnboarding:l});var u=Object(c.i)("k8s",null,n.probeToken,s?"--gke":"");return a.a.createElement("div",{className:"platform-instructions"},"eks"===t&&a.a.createElement(G,null),a.a.createElement("section",{className:"weave-cloud-agents"},a.a.createElement(c.a,{isGke:s,onCopy:o,token:n.probeToken},u),a.a.createElement(c.b,null)))};t.a={dcos:o,docker:s,ecs:u,empty:d,kubernetes:R}}}]);