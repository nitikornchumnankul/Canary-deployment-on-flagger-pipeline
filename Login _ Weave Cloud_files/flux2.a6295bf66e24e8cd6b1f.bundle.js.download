(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{1213:function(e,t,n){"use strict";n.d(t,"c",function(){return E}),n.d(t,"b",function(){return S}),n.d(t,"a",function(){return x});var r=n(47),o=n.n(r),a=n(149),i=n.n(a),c=n(0),l=n.n(c),s=n(18),u=n.n(s),p=n(9),f=n(1);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function v(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(n,!0).forEach(function(t){k(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=16,O={"wc-stop":{svg:l.a.createElement("polygon",{points:"397.414486 202.259745 428.693916 233.377342 428.813072 278.039879 397.702153 310.084647 353.585514 310.740255 322.306084 279.622658 322.186928 234.960121 353.297847 202.915353"}),viewBox:"321 201 109 111"},"wc-stop-o":{svg:l.a.createElement("g",null,l.a.createElement("path",{d:"M397.414486,202.259745 L428.693916,233.377342 L428.813072,278.039879 L397.702153,310.084647 L353.585514,310.740255 L322.306084,279.622658 L322.186928,234.960121 L353.297847,202.915353 L397.414486,202.259745 Z M393.924588,210.897545 L420.222746,237.059642 L420.322926,274.609638 L394.166444,301.551253 L357.075412,302.102455 L330.777254,275.940358 L330.677074,238.390362 L356.833556,211.448747 L393.924588,210.897545 Z",fillRule:"evenodd"}),l.a.createElement("polygon",{fillRule:"evenodd",points:"390.267655 219.948772 411.346124 240.918187 411.42642 271.015216 390.461507 292.609429 360.732345 293.051228 339.653876 272.081813 339.57358 241.984784 360.538493 220.390571"})),viewBox:"321 201 109 111"}};function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e){if(i()(e,"wc-"))return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=O[e];if(n){var r=w({fill:u.a.colors.purple300,height:_,width:_},t);return l.a.createElement("svg",{style:r,viewBox:n.viewBox},n.svg)}}(e,t);var r=w({color:u.a.colors.purple300,fontSize:_},t);return l.a.createElement("i",g({style:r,className:e},n))}}var S=Object(f.default)(p.Text).withConfig({displayName:"flux-button__Label",componentId:"wwwnph-0"})(["line-height:28px;font-size:",";padding:0 12px;min-width:90px;"],function(e){return e.theme.fontSizes.small}),x=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=h(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==d(o)&&"function"!=typeof o?y(r):o,k(y(n),"handleClick",function(e){var t=n.props.onClick;t&&t(n.props.value,e)}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(t,l.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.fa,n=e.title,r=e.svg,a=e.label,i=e.flat,c=e.primary,s=e.selected,f=e.style,d=o()(this.props,["fa","title","svg","flat","onClick","style"]),m=w({display:"inline-block",fontSize:u.a.fontSizes.small},i&&{backgroundColor:"transparent"},{},i&&!s&&{boxShadow:"none"},{},f),h=w({verticalAlign:"text-top"},c&&{color:"white"});return l.a.createElement(p.Button,g({title:n,style:m,onClick:this.handleClick},d),E(t||r,h)," ",l.a.createElement("span",null,a))}}])&&m(n.prototype,r),a&&m(n,a),t}()},1219:function(e,t,n){"use strict";n.d(t,"f",function(){return s}),n.d(t,"g",function(){return u}),n.d(t,"d",function(){return p}),n.d(t,"e",function(){return f}),n.d(t,"a",function(){return d}),n.d(t,"c",function(){return m}),n.d(t,"b",function(){return h});var r=n(6),o=n.n(r),a=n(15),i=n.n(a),c=n(23),l=n(1232),s=Object(c.createSelector)([function(e){return o()(e,["root","timeTravel","timestamp"])},function(e){return o()(e,["root","timeTravel","rangeMs"])}],function(e,t){return i()(e).subtract(t).utc().format()}),u=Object(c.createSelector)([s],function(e){return i()(e).unix()}),p=Object(c.createSelector)([function(e){return o()(e,["root","timeTravel","timestamp"])}],function(e){return i()(e).utc().format()}),f=Object(c.createSelector)([p],function(e){return i()(e).unix()}),d=f,m=Object(c.createSelector)([function(e){return o()(e,["root","timeTravel","rangeMs"])}],function(e){return e/1e3}),h=Object(c.createSelector)([m],function(e){return Object(l.a)(e)})},1221:function(e,t,n){"use strict";var r=n(185),o=n.n(r),a=n(0),i=n.n(a),c=n(22),l=n(9),s=n(13),u=n.n(s),p=n(15),f=n.n(p),d=n(64),m=n(2),h=n(111),y=n(11),b=n(76),g=n(7),v=n(16),w=n(1232),k=n(125);function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(n,!0).forEach(function(t){I(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var P=f.a.duration(2,"weeks").asSeconds(),T=function(e){function t(e){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=x(t).call(this,e),n=!a||"object"!==_(a)&&"function"!=typeof a?j(r):a,I(j(n),"updateUrl",function(e){n.props.exploreContext?window.location=e:u.a.push(e)}),I(j(n),"updatedPath",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n.props.exploreContext)return Object(y.u)(E({},n.props.sharedQueryParams,{},e),n.props.instanceId);var t=u.a.getCurrentLocation(),r=t.hash,o=Object(k.h)(e,n.props.location);return"".concat(n.props.location.pathname).concat(o).concat(r)}),I(j(n),"updateUrlWith",function(e){var t=u.a.getCurrentLocation(),r=t.pathname,o=t.search,a=t.hash,i=decodeURI("".concat(r).concat(o).concat(a)),c=n.updatedPath(e);c!==i&&n.updateUrl(c)}),I(j(n),"updateVisibleRange",function(e){var t=e.startAt,r=e.endAt,o=n.props,a=o.instanceId,i=o.workloadId,c=void 0===i?v.FLUX_ALL_WORKLOADS:i,l=f()(r).unix(),s=f()(t).unix();n.setState({visibleRangeEndAtSec:l,visibleRangeStartAtSec:s}),l-s<P&&(n.setState({isLoadingDeployments:!0}),n.props.getFluxHistory(a,c,null,r,!0,t).then(function(){n.setState({isLoadingDeployments:!1})}))}),I(j(n),"handleLiveModeChange",function(e){n.props.updateTimeTravelLiveState(e),e&&n.updateUrlWith({timestamp:null})}),I(j(n),"handleTimestampChange",function(e){n.props.updateTimeTravelTimestamp(e),n.updateUrlWith({timestamp:e})}),I(j(n),"handleRangeChange",function(e){var t=Object(k.j)({rangeMs:e}).range;n.props.updateTimeTravelRange(e),n.updateUrlWith({range:t})}),I(j(n),"trackTimelineTimestampEdit",function(){Object(g.trackEvent)("timeline.timestamp.edit")}),I(j(n),"trackTimelineTimestampButtonClick",function(){Object(g.trackEvent)("timeline.timestamp.button.click")}),I(j(n),"trackTimelinePanButtonClick",function(){Object(g.trackEvent)("timeline.pan.button.click")}),I(j(n),"trackTimelinePan",function(){Object(g.trackEvent)("timeline.pan")}),I(j(n),"trackTimelineZoom",function(e){Object(g.trackEvent)("timeline.zoom",{zoomedPeriod:e})}),I(j(n),"trackDeploymentClick",function(){Object(g.trackEvent)("timeline.deployment.click")}),I(j(n),"deploymentsLinkBuilder",function(e){return Object(y.q)(n.props.sharedQueryParams,n.props.instanceId,e)}),n.state={isLoadingDeployments:!1,visibleRangeEndAtSec:null,visibleRangeStartAtSec:null},n.debouncedUpdateVisibleRange=o()(n.updateVisibleRange,500),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.props.showingLive&&this.startAutoRefreshTimer(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.props.showingLive!==e.showingLive&&(e.showingLive?this.startAutoRefreshTimer(e):this.stopAutoRefreshTimer()),this.props.rangeMs!==e.rangeMs&&e.showingLive&&(this.stopAutoRefreshTimer(),this.startAutoRefreshTimer(e))}},{key:"componentWillUnmount",value:function(){this.stopAutoRefreshTimer(),this.debouncedUpdateVisibleRange.cancel()}},{key:"startAutoRefreshTimer",value:function(e){var t=this,n=e.hasRangeSelector,r=e.rangeMs,o=n?Object(w.a)(r):1e4;this.props.updateTimeTravelTimestamp(Object(k.c)()),this.autoRefreshTimer=setInterval(function(){t.props.updateTimeTravelTimestamp(Object(k.c)())},o)}},{key:"stopAutoRefreshTimer",value:function(){clearInterval(this.autoRefreshTimer)}},{key:"render",value:function(){var e=this.state,t=e.isLoadingDeployments,n=e.visibleRangeStartAtSec,r=e.visibleRangeEndAtSec,o=this.props.deployments.filter(function(e){var t=f()(e.Stamp).unix();return n<=t&&t<=r});return i.a.createElement(l.TimeTravel,{hasLiveMode:!0,showingLive:this.props.showingLive,onChangeLiveMode:this.handleLiveModeChange,timestamp:this.props.timestamp,earliestTimestamp:this.props.firstSeenConnectedAt,onChangeTimestamp:this.handleTimestampChange,hasRangeSelector:this.props.hasRangeSelector,rangeMs:this.props.rangeMs,onChangeRange:this.handleRangeChange,onUpdateVisibleRange:this.debouncedUpdateVisibleRange,onTimestampInputEdit:this.trackTimelineTimestampEdit,onTimelineLabelClick:this.trackTimelineTimestampButtonClick,onTimelinePanButtonClick:this.trackTimelinePanButtonClick,onTimelineZoom:this.trackTimelineZoom,onTimelinePan:this.trackTimelinePan,onDeploymentClick:this.trackDeploymentClick,deploymentsLinkBuilder:this.deploymentsLinkBuilder,deployments:o,isLoading:t})}}])&&S(n.prototype,r),a&&S(n,a),t}();T.defaultProps={exploreContext:!1,hasRangeSelector:!1},t.a=Object(c.connect)(function(e,t){var n=t.instanceId,r=t.workloadId,o=Object(d.f)(n)(e);return E({deployments:Object(b.a)(e,n,r),firstSeenConnectedAt:o&&o.firstSeenConnectedAt,sharedQueryParams:Object(h.b)(e),timeState:e.root.timeTravel},e.root.timeTravel)},{getFluxHistory:m.A,updateTimeTravelLiveState:m.Yb,updateTimeTravelRange:m.Zb,updateTimeTravelTimestamp:m.ac})(T)},1232:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){return e/200}},1238:function(e,t,n){"use strict";var r=n(77),o=n.n(r),a=n(1289),i=n.n(a),c=n(0),l=n.n(c),s=n(1),u=n(5),p=n.n(u);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var b,g,v,w=s.default.span.withConfig({displayName:"last-bit-is-important__Container",componentId:"sc-1f0px90-0"})(["display:flex;white-space:nowrap;"]),k=s.default.span.withConfig({displayName:"last-bit-is-important__Initial",componentId:"sc-1f0px90-1"})(["opacity:",";display:flex;color:inherit;min-width:0;"],function(e){return e.faded?.65:1}),_=s.default.span.withConfig({displayName:"last-bit-is-important__Shortened",componentId:"sc-1f0px90-2"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;min-width:0;"]),O=s.default.span.withConfig({displayName:"last-bit-is-important__Last",componentId:"sc-1f0px90-3"})([""]),E=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),m(this,h(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,l.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.value,n=e.separator,r=e.highlighted,a=t.split(n),c=i()(a).join(n),s=o()(a);return l.a.createElement(w,null,l.a.createElement(k,{faded:r},l.a.createElement(_,null,c),c&&l.a.createElement("span",null,n)),l.a.createElement(O,null,s))}}])&&d(n.prototype,r),a&&d(n,a),t}();v={highlighted:!1,separator:"/"},(g="defaultProps")in(b=E)?Object.defineProperty(b,g,{value:v,enumerable:!0,configurable:!0,writable:!0}):b[g]=v,E.propTypes={highlighted:p.a.bool,separator:p.a.string,value:p.a.string.isRequired},t.a=E},1243:function(e,t,n){"use strict";var r=n(1),o=n(45),a=n(18),i=n.n(a),c=Object(r.keyframes)(["50%{opacity:1;}75%{opacity:0.4;}100%{opacity:1;}"]),l={background:i.a.colors.purple25,caretColor:i.a.colors.blue700,cellBorder:Object(o.transparentize)(.6,i.a.colors.gray200),currentTag:Object(o.transparentize)(.7,i.a.colors.yellow500),grayText:i.a.colors.gray600,highlight:i.a.colors.blue700,latestTag:Object(o.transparentize)(.7,i.a.colors.green500),loadingAnimation:Object(r.css)(["","2.5s infinite"],c),rowSelected:Object(o.transparentize)(.5,i.a.colors.purple100),unknownTag:i.a.colors.purple100};t.a=l},1249:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return c});var r=n(15),o=n.n(r),a=function(e){return o()(e).subtract(1,"month")},i=function(e){return e&&o()(e).format("D MMM YYYY")};function c(e){return o.a.utc(e).format()}},1266:function(e,t,n){"use strict";n.d(t,"a",function(){return S});var r=n(188),o=n.n(r),a=n(14),i=n.n(a),c=n(39),l=n.n(c),s=n(228),u=n.n(s),p=n(0),f=n.n(p),d=n(5),m=n.n(d),h=n(1);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var k=h.default.div.withConfig({displayName:"tab-selector__TabSelectorWrapper",componentId:"sc-1s9qozc-0"})([""]),_=h.default.div.withConfig({displayName:"tab-selector__TabButtons",componentId:"sc-1s9qozc-1"})([""]),O=h.default.button.withConfig({displayName:"tab-selector__TabButton",componentId:"sc-1s9qozc-2"})(["cursor:pointer;margin-bottom:-1px;margin-right:5px;padding:10px 20px;font-size:",";outline:0;",";",""],function(e){return e.theme.fontSizes.large},function(e){var t=e.selected,n=e.theme;return"\n    background-color: ".concat(t?n.colors.white:n.colors.gray50,";\n    border-top-left-radius: ").concat(n.borderRadius.soft,";\n    border-top-right-radius: ").concat(n.borderRadius.soft,";\n    border: 1px solid ").concat(n.colors.purple100,";\n  ")},function(e){return e.selected&&"border-bottom: 1px solid transparent;"}),E=h.default.span.withConfig({displayName:"tab-selector__TabName",componentId:"sc-1s9qozc-3"})(["color:",";opacity:",";"],function(e){return e.theme.colors.purple900},function(e){return e.selected?1:.65}),S=h.default.div.withConfig({displayName:"tab-selector__TabContent",componentId:"sc-1s9qozc-4"})(["padding:20px;background-color:",";",";"],function(e){return e.theme.colors.white},function(e){return"\n    border-top-right-radius: ".concat(e.theme.borderRadius.soft,";\n    border-bottom-right-radius: ").concat(e.theme.borderRadius.soft,";\n    border-bottom-left-radius: ").concat(e.theme.borderRadius.soft,";\n    border: 1px solid ").concat(e.theme.colors.purple100,";\n  ")}),x=function(e){function t(e){var n,r,o,a,i,c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=g(t).call(this,e),n=!o||"object"!==y(o)&&"function"!=typeof o?v(r):o,a=v(n),c=function(e){n.setState({selectedTabId:e.props.id}),n.props.onSelectedTabChange&&n.props.onSelectedTabChange(e.props.id)},(i="handleClick")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n.state={selectedTabId:e.selectedTabId},n.isTabSelected=function(e){return e.props.id===n.state.selectedTabId},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,f.a.Component),n=t,(r=[{key:"componentWillReceiveProps",value:function(e){e.selectedTabId!==this.props.selectedTabId&&this.setState({selectedTabId:e.selectedTabId})}},{key:"render",value:function(){var e=this,t=u()(o()(this.props.children)),n=l()(t,this.isTabSelected);return f.a.createElement(k,null,f.a.createElement(_,null,i()(t,function(t,n){return f.a.createElement(O,{key:n,selected:e.isTabSelected(t),onClick:function(){return e.handleClick(t)}},f.a.createElement(E,{selected:e.isTabSelected(t)},t&&t.props.name))})),f.a.createElement(S,null,n&&n.props.children))}}])&&b(n.prototype,r),a&&b(n,a),t}();x.propTypes={selectedTabId:m.a.string.isRequired},t.b=x},1267:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(1);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=Object(a.keyframes)(["0%,50%,100%{opacity:1;}25%{opacity:0.5;}"]),f=a.default.div.withConfig({displayName:"glowing-loader__LoadingWrapper",componentId:"sc-69yzhu-0"})(["display:block;",";"],function(e){return e.isLoading&&Object(a.css)(["animation:"," 2.5s infinite;"],p)}),d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),l(this,s(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){return o.a.createElement(f,{isLoading:this.props.isLoading},this.props.children)}}])&&c(n.prototype,r),a&&c(n,a),t}();t.a=d},1268:function(e,t,n){"use strict";var r=n(126),o=n.n(r),a=n(0),i=n.n(a),c=n(22),l=n(9),s=n(7),u=n(86),p=n(8),f=n(11),d=n(111),m=n(1219);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=function(e){function t(e,n){var r,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=g(t).call(this,e,n),r=!a||"object"!==h(a)&&"function"!=typeof a?v(o):a,k(v(r),"trackDeploymentClick",function(){Object(s.trackEvent)("prom.graph.deployment.click")}),k(v(r),"deploymentsLinkBuilder",function(e){return Object(f.q)(r.props.sharedQueryParams,r.props.instanceId,e)}),r.state={endTimeSec:e.endTimeSec,error:null,isFirstLoading:!0,multiSeries:[],startTimeSec:e.startTimeSec,stepDurationSec:e.stepDurationSec},r.activeRequest=null,r.queuedRequestParams=null,r}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,i.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.maybeFetchGraphData(this.props)}},{key:"componentWillReceiveProps",value:function(e){var t=e.instanceId!==this.props.instanceId,n=e.query!==this.props.query,r=e.rangeSec!==this.props.rangeSec,o=e.endTimeSec!==this.props.endTimeSec;if(t||n||r||o){var a=Math.abs(e.endTimeSec-this.props.endTimeSec)>2*e.stepDurationSec;t||n||r||a?(this.setState({isFirstLoading:!0}),this.activeRequest&&this.activeRequest.cancel()):this.props.onRefreshStart&&this.props.onRefreshStart(),this.maybeFetchGraphData(e)}}},{key:"componentWillUnmount",value:function(){this.queuedRequestParams=null,this.activeRequest&&this.activeRequest.cancel()}},{key:"fetchGraphData",value:function(e){var t=this,n=e.query,r=e.startTimeSec,o=e.endTimeSec,a=e.stepDurationSec,i={end:o,query:n,start:r,step:a};this.activeRequest=Object(u.a)(Object(p.X)(this.props.instanceId,i).then(function(e){return Promise.resolve(function(e){var t=[],n=null;return"matrix"!==e.data.resultType?n="Result is not of matrix type!":e.data.result&&0===e.data.result.length?n="No datapoints found. Maybe the metric does not exist?":t=e.data.result,{error:n,multiSeries:t}}(e))},function(e){return Promise.resolve({error:e.error||e.errors[0].message})}));var c=this.activeRequest,l=window.performance.now();c.promise.then(function(e){var i=e.isCanceled,c=e.multiSeries,s=void 0===c?[]:c,u=e.error,p=window.performance.now();if(t.queuedRequestParams){var f=t.queuedRequestParams;t.queuedRequestParams=null,t.fetchGraphData(f)}else t.activeRequest=null;if(!i){var d=t.state.isFirstLoading,m=Math.round(p-l),h={isFirstLoading:d,query:n,responseTime:m};u&&t.props.onReceiveError&&t.props.onReceiveError(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(n,!0).forEach(function(t){k(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({error:u},h)),!u&&t.props.onReceiveSuccess&&t.props.onReceiveSuccess(h),t.props.onRefreshFinish&&t.props.onRefreshFinish(s),t.setState({endTimeSec:o,error:u,isFirstLoading:!1,multiSeries:s,startTimeSec:r,stepDurationSec:a})}})}},{key:"maybeFetchGraphData",value:function(e){var t=o()(e,["query","startTimeSec","endTimeSec","stepDurationSec"]);this.activeRequest?this.queuedRequestParams=t:this.fetchGraphData(t)}},{key:"render",value:function(){return i.a.createElement(l.PrometheusGraph,{error:this.state.error,loading:this.state.isFirstLoading,multiSeries:this.state.multiSeries,stepDurationSec:this.state.stepDurationSec,startTimeSec:this.state.startTimeSec,endTimeSec:this.state.endTimeSec,yAxisLabel:this.props.yAxisLabel,metricUnits:this.props.metricUnits,valuesMinSpread:this.props.valuesMinSpread,showStacked:this.props.showStacked,colorTheme:this.props.colorTheme,simpleTooltip:this.props.simpleTooltip,legendCollapsable:this.props.legendCollapsable,legendShown:this.props.legendShown,renderLegendItemSuffix:this.props.renderLegendItemSuffix,selectedLegendKeys:this.props.selectedLegendKeys,getSeriesKey:this.props.getSeriesKey,onChangeLegendSelection:this.props.onChangeLegendSelection,onDeploymentClick:this.trackDeploymentClick,deploymentsLinkBuilder:this.deploymentsLinkBuilder,deployments:this.props.deployments})}}])&&b(n.prototype,r),a&&b(n,a),t}();t.a=Object(c.connect)(function(e,t){var n=t.startTimeSec;return{endTimeSec:Object(m.e)(e),rangeSec:Object(m.c)(e),sharedQueryParams:Object(d.b)(e),startTimeSec:n||Object(m.g)(e),stepDurationSec:Object(m.b)(e)}})(_)},1273:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(1),i=n(22),c=n(2),l=n(76),s=n(16),u=n(1219),p=n(1326);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var b=a.default.div.withConfig({displayName:"dashboard__DashboardRow",componentId:"sc-9im5gp-0"})(["display:flex;align-items:stretch;justify-content:space-between;"]),g=a.default.div.withConfig({displayName:"dashboard__DashboardChartSlot",componentId:"sc-9im5gp-1"})(["width:",";border-radius:",";background-color:",";"],function(e){return"calc(100% / ".concat(e.numberOfColumnsPerRow,")")},function(e){return e.theme.borderRadius.soft},function(e){return e.focused?e.theme.colors.blue50:"transparent"}),v=function(e){function t(){var e,n,r,o,a,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return r=this,o=(e=m(t)).call.apply(e,[this].concat(s)),n=!o||"object"!==f(o)&&"function"!=typeof o?h(r):o,a=h(n),c=function(e){var t=e.id;return t&&t===n.props.focusedChartId},(i="isChartFocused")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.props.updateTimeStateFromUrl(this.props.location)}},{key:"componentWillReceiveProps",value:function(e){e.location.search!==this.props.location.search&&this.props.updateTimeStateFromUrl(e.location),e.endTime===this.props.endTime&&e.startTime===this.props.startTime||this.props.getFluxHistory(this.props.instanceId,s.FLUX_ALL_WORKLOADS,null,e.endTime,!0,e.startTime)}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,this.props.rows.map(function(t){return o.a.createElement(b,{key:t.key},t.charts.map(function(n){return o.a.createElement(g,{"data-id":n.id,key:n.title,focused:e.isChartFocused(n),numberOfColumnsPerRow:t.charts.length},o.a.createElement(p.a,{key:n.title,yAxisLabel:n.yAxisLabel,metricUnits:n.metricUnits,valuesMinSpread:n.valuesMinSpread,getLabel:n.getLabel,colorTheme:n.colorTheme,showStacked:n.showStacked,hideOnNoMetrics:n.hideOnNoMetrics,title:n.title,query:n.query,instanceId:e.props.instanceId,namespaceId:e.props.namespaceId,filterDeployments:n.filterDeployments,deployments:e.props.deployments,startTime:e.props.startTimeSec,endTime:e.props.endTimeSec,queryStepSeconds:e.props.queryStepSec,rangeSeconds:e.props.rangeSec,selectedLegendKeys:e.props.selectedLegendKeys,renderLegendItemSuffix:e.props.renderLegendItemSuffix}))}))}))}}])&&d(n.prototype,r),a&&d(n,a),t}();t.a=Object(i.connect)(function(e,t){var n=t.instanceId;return{deployments:Object(l.a)(e,n),endTime:Object(u.d)(e),endTimeSec:Object(u.e)(e),queryStepSec:Object(u.b)(e),rangeSec:Object(u.c)(e),startTime:Object(u.f)(e),startTimeSec:Object(u.g)(e)}},{getFluxHistory:c.A,updateTimeStateFromUrl:c.Xb})(v)},1279:function(e,t,n){"use strict";n.d(t,"b",function(){return K});var r=n(103),o=n.n(r),a=n(113),i=n.n(a),c=n(49),l=n.n(c),s=n(32),u=n.n(s),p=n(102),f=n.n(p),d=n(126),m=n.n(d),h=n(186),y=n.n(h),b=n(47),g=n.n(b),v=n(62),w=n.n(v),k=n(78),_=n.n(k),O=n(6),E=n.n(O),S=n(0),x=n.n(S),j=n(1),C=n(22),I=n(9),P=n(7),T=n(76),R=n(8),N=n(11),L=n(111),D=n(1375),q=n(125);function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function K(e,t){var n=e||q.a.label,r=Object(q.d)(n),o=Math.max(Math.floor(r/250),1),a=t||new Date/1e3;return{end:a,range:n,start:a-r,step:o}}function Q(e){return u()(e)?"":JSON.stringify(e,null,1)}var H=function(e){return/\s(by|without|ignoring|on|group_left|group_right)\s?/.test(e)},G=function(e){return/;\s+?\w/.test(e)},V=j.default.div.withConfig({displayName:"prom-graph__PromGraphContainer",componentId:"redg1o-0"})(["margin:0 50px 30px 32px;"]),Y=function(e){function t(e,n){var r,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=U(t).call(this,e,n),r=!a||"object"!==M(a)&&"function"!=typeof a?z(o):a,B(z(r),"trackDeploymentClick",function(){Object(P.trackEvent)("prom.graph.deployment.click")}),B(z(r),"deploymentsLinkBuilder",function(e){return Object(N.q)(r.props.sharedQueryParams,r.props.instanceId,e)}),r.state={data:[],end:null,start:null,step:null},r.requestQueue=null,r}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(t,x.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.maybeFetchGraphData(this.props)}},{key:"componentWillReceiveProps",value:function(e){e.query===this.props.query&&e.range===this.props.range&&e.end===this.props.end||this.maybeFetchGraphData(e)}},{key:"setError",value:function(e){this.setState({data:[]}),this.props.onReceiveError&&this.props.onReceiveError(e)}},{key:"fetchGraphData",value:function(e){var t=this,n=new Date,r=K(e.range,e.end),a=r.start,i=r.end,c=r.step,l=r.range,s=e.query.split(D.a).map(function(e){return e.trim()}).filter(o.a);if(0!==s.length){this.props.onRequestQuery&&this.props.onRequestQuery();var u=[],p=[];this.requestingQuery=!0,s.reduce(function(e,n){var r={end:i,query:n,start:a,step:c};return e.then(function(){return Object(R.X)(t.props.instanceId,r)}).then(function(e){var t=function(e){var t,n;return"matrix"!==e.data.resultType?n="Result is not of matrix type! Please enter a correct expression.":e.data.result&&0===e.data.result.length?n="No datapoints found. Maybe the metric does not exist?":t=e.data.result,{data:t,error:n}}(e),r=t.data,o=t.error;o&&p.push(o),r&&(u=u.concat(r.map(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(n,!0).forEach(function(t){B(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({query:n},e)})))},function(e){return p.push(e.error||e.errors[0].message)})},Promise.resolve()).then(function(){t.requestingQuery=!1;var e=new Date-n,r=u.length>0;t.onReceiveQuery(),t.props.onReceiveQuery&&t.props.onReceiveQuery({dataReceived:r,end:i,range:l},e),0===u.length&&p.length>0?t.setError(p[0]):t.setState({data:u,end:i,start:a,step:c})})}}},{key:"maybeFetchGraphData",value:function(e){var t=m()(e,["end","query","range"]);this.requestingQuery?this.requestQueue=t:this.fetchGraphData(t)}},{key:"onReceiveQuery",value:function(){if(this.requestQueue){var e=this.requestQueue;this.requestQueue=null,this.fetchGraphData(e)}}},{key:"render",value:function(){if(!this.state.data||0===this.state.data.length)return null;var e,t=this.state.data.length>1;return x.a.createElement(V,null,x.a.createElement(I.PrometheusGraph,{simpleTooltip:!0,legendShown:t,legendCollapsable:t,startTimeSec:this.state.start,endTimeSec:this.state.end,stepDurationSec:this.state.step,multiSeries:this.state.data,onDeploymentClick:this.trackDeploymentClick,deploymentsLinkBuilder:this.deploymentsLinkBuilder,deployments:this.props.deployments,getSeriesNameParts:(e=this.props.query,function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=E()(t.metric,"__name__")||"",a=g()(t.metric,["__name__"]);if(!o){if(u()(a))return[t.query];if(1===_()(a))return H(t.query)&&G(e)?[y()(f()(a)),t.query]:[y()(f()(a))]}if(r&&_()(n)>1){var c=i()(l()(a),function(e){return w()(n,function(t){return t.metric[e]===a[e]})});a=g()(a,c)}return["".concat(o).concat(Q(a))]})}))}}])&&F(n.prototype,r),a&&F(n,a),t}();t.a=Object(C.connect)(function(e,t){var n=t.instanceId;return{deployments:Object(T.a)(e,n),sharedQueryParams:Object(L.b)(e)}})(Y)},1290:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(1),i=Object(a.keyframes)(["0%,40%,100%{transform:scaleY(0.333);}20%{transform:scaleY(1);}"]),c=a.default.div.withConfig({displayName:"bar-progress__Container",componentId:"sc-17vpj1i-0"})(["display:inline-block;width:21px;height:18px;text-align:center;vertical-align:middle;"]),l=a.default.div.withConfig({displayName:"bar-progress__Bar",componentId:"sc-17vpj1i-1"})(["background-color:",";height:100%;width:4px;display:inline-block;animation:"," 1.2s infinite ease-in-out;animation-delay:","s;margin-right:3px;&:last-child{margin-right:0;}"],function(e){return e.theme.colors.blue600},i,function(e){var t=e.animationDelay;return void 0===t?0:t});function s(e){return o.a.createElement(c,e,o.a.createElement(l,null),o.a.createElement(l,{animationDelay:.1}),o.a.createElement(l,{animationDelay:.2}))}s.defaultProps={className:void 0},t.a=s},1291:function(e,t,n){"use strict";var r=n(5),o=n.n(r),a=function(){return null};a.propTypes={id:o.a.string.isRequired,name:o.a.string.isRequired},t.a=a},1292:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(0),o=n.n(r);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,l(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.cancelFns=this.props.fns.map(function(e){return e()})}},{key:"componentWillUnmount",value:function(){this.cancelFns.forEach(function(e){return e()})}},{key:"render",value:function(){return null}}])&&i(n.prototype,r),a&&i(n,a),t}()},1293:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var r=n(90),o=n.n(r),a=n(0),i=n.n(a);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=n(1).default.div.withConfig({displayName:"tooltip-wrapper__Tooltip",componentId:"sc-1khisxm-0"})(["background:",";border-radius:",";color:",";opacity:",";z-index:",";border:0;padding:8px;position:absolute;top:-33px;margin-left:-3px;transition:opacity 0.5s;white-space:nowrap;width:max-content;pointer-events:none;&:before{border-left:8px solid transparent;border-right:8px solid transparent;border-top:8px solid ",";content:'';display:block;height:0;left:4px;position:absolute;top:32px;width:0;}"],function(e){return e.theme.colors.purple800},function(e){return e.theme.borderRadius.soft},function(e){return e.theme.colors.white},function(e){return e.active?.75:0},function(e){return e.theme.layers.tooltip},function(e){return e.theme.colors.purple800}),m=function(e){function t(e,n){var r,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=s(t).call(this,e,n),r=!a||"object"!==c(a)&&"function"!=typeof a?u(o):a,f(u(r),"handleMouseEnter",function(){r.props.showOnHover&&r.setState({hovered:!0})}),f(u(r),"handleMouseLeave",function(){r.setState({hovered:!1})}),r.state={hovered:!1},r}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this,t=this.props,n=t.text,r=t.children,a=t.className,c=t.active,l=t.withComponent||"div";return i.a.createElement(l,{style:{display:"inline-block"},onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,className:a},o()(r)?r(this.state.hovered,n):i.a.createElement(i.a.Fragment,null,i.a.createElement(d,{ref:function(t){e.tooltip=t},text:n,className:"tooltip",active:this.state.hovered||c}),r))}}])&&l(n.prototype,r),a&&l(n,a),t}()},1299:function(e,t,n){"use strict";var r=n(1),o=n(45),a=r.default.div.withConfig({displayName:"banner__Banner",componentId:"sc-6brsw9-0"})(["padding:12px;margin:8px;background-color:",";border:1px solid ",";border-radius:",";i{margin-right:6px;color:",";}"],function(e){return Object(o.transparentize)(.75,e.theme.colors.yellow500)},function(e){return Object(o.transparentize)(.5,e.theme.colors.yellow500)},function(e){return e.theme.borderRadius.soft},function(e){return e.theme.colors.yellow500});t.a=a},1311:function(e,t,n){"use strict";var r=n(90),o=n.n(r),a=n(60),i=n.n(a),c=n(185),l=n.n(c),s=n(0),u=n.n(s),p=n(88),f=n(1469),d=n(1521),m=n.n(d),h=n(1415),y=n(22),b=n(1),g=n(2),v=n(227),w=n(45);function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var _=Object(b.css)(["color:",";font-family:",";direction:ltr;text-align:left;font-size:",";-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;&::selection{background:",";}"],function(e){return e.theme.colors.purple800},function(e){return"markdown"===e.styled.language?e.theme.fontFamilies.regular:e.theme.fontFamilies.monospace},function(e){return e.styled.isNotebook?e.theme.fontSizes.normal:e.theme.fontSizes.small},function(e){return Object(w.transparentize)(.5,e.theme.colors.blue700)}),O=b.default.code.withConfig({displayName:"renderers__Code",componentId:"sc-1uz02sy-0"})(["",""],_),E=b.default.pre.withConfig({displayName:"renderers__Pre",componentId:"sc-1uz02sy-1"})([""," margin:0;border:",";border-radius:",";background-color:",";padding:",";"," counter-reset:line;"],_,function(e){return e.styled.isNotebook?"1px dotted ".concat(e.theme.colors.purple100):"1px solid ".concat(e.theme.colors.gray200)},function(e){return e.theme.borderRadius.soft},function(e){return e.theme.colors.white},function(e){return e.styled.isNotebook?"5px":"0"},function(e){return e.styled.wrapLines?"\n    white-space: pre-wrap;\n    word-break: break-word;\n  ":"overflow: scroll;"}),S=b.default.div.withConfig({displayName:"renderers__Line",componentId:"sc-1uz02sy-2"})(["position:relative;display:flex;",";"],function(e){return e.styled.showLineNumbers&&"\n    &:before {\n      counter-increment: line;\n      content: counter(line);\n      display: inline-block;\n      text-align: right;\n      min-width: 25px;\n      padding-right: 5px;\n      margin-right: 5px;\n      background-color: ".concat(e.theme.colors.purple50,";\n      border-right: 1px solid ").concat(e.theme.colors.gray200,";\n      user-select: none; /* Do not allow selection line numbers in Safari */\n    }\n  ")}),x=b.default.div.withConfig({displayName:"renderers__LineWrapper",componentId:"sc-1uz02sy-3"})(["flex:1;"]),j=function(e){return function(t){switch(t.node.type){case"code_block":return function(e,t){return u.a.createElement("div",{id:"code-editor-".concat(t.id),style:{position:"relative"}},u.a.createElement(E,{styled:{isNotebook:t.isNotebook,language:t.language,wrapLines:t.wrapLines}},u.a.createElement(O,k({},e.attributes,{autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",styled:{isNotebook:t.isNotebook}}),e.children)))}(t,e);case"code_line":return function(e,t){return u.a.createElement(S,k({},e.attributes,{styled:t}),u.a.createElement(x,null,e.children))}(t,e);default:return null}}},C=function(e){var t=e.id,n=e.language,r=e.isNotebook,o=void 0!==r&&r,a=e.showLineNumbers,i=void 0===a||a,c=e.wrapLines;return{renderNode:j({id:t,isNotebook:o,language:n,showLineNumbers:i,wrapLines:void 0!==c&&c}),schema:{document:{nodes:[{min:1,types:["code_block"]}]}}}},I=n(1338),P=n.n(I),T=(n(1535),n(1536),n(1210)),R=n(623),N=n.n(R);function L(e,t){var n=e.toLowerCase(),r=t.toLowerCase(),o=[],a=0,i=r.indexOf(n);if(-1!==i){for(var c=i;c<i+n.length;c+=1)o.push(c);a=i}else{for(var l=0,s=0,u=0;s!==n.length&&u<=r.length-(n.length-s);)n[s]===r[u]&&(o.push(u),s+=1,l+1!==u&&(a+=(l+1)*(u-l)),l=u),u+=1;if(s!==e.length)return[!1,0,[]]}var p=t.charAt(o[0]-1);return-1===["","_"].indexOf(p)&&(a+=40),[!0,-a,o]}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var q="METRIC_NAME_TYPE",M="TYPE_FUNCTION_TYPE",A="LABEL_KEY_TYPE",F="LABEL_VALUE_TYPE",U="RANGE_TYPE",z="HISTORY_TYPE",W=["abs","absent","ceil","changes","clamp_max","clamp_min","day_of_month","day_of_week","days_in_month","delta","deriv","exp","floor","histogram_quantile","holt_winters","hour","idelta","increase","irate","label_join","label_replace","ln","log2","log10","minute","month","predict_linear","rate","resets","round","scalar","sort","sort_desc","sqrt","time","vector","year","sum","min","max","avg","stddev","stdvar","count","count_values","bottomk","topk","quantile","group_right","group_left","avg_over_time","min_over_time","max_over_time","sum_over_time","count_over_time","quantile_over_time","stddev_over_time","stdvar_over_time"],B=function(e,t){var n=t.get("score")-e.get("score");return 0===n&&(n=e.get("text").localeCompare(t.get("text"))),n},K=N()(function(e,t){var n=Object(p.List)();return W.forEach(function(t){var r=D(L(e,t),3),o=r[0],a=r[1],i=r[2];o&&(n=n.push(Object(p.Map)({matched:o,matchedIndices:Object(p.List)(i),score:a,text:t,type:M})))}),t.forEach(function(t){var r=D(L(e,t),3),o=r[0],a=r[1],i=r[2];o&&(n=n.push(Object(p.Map)({matched:o,matchedIndices:Object(p.List)(i),score:a,text:t,type:q})))}),n.sort(B)}),Q=N()(function(){var e=Object(p.List)();return["1m","5m","1h","1d"].forEach(function(t){e=e.push(Object(p.Map)({matchedIndices:Object(p.List)(),text:t,type:U}))}),e}),H=function(e,t,n){var r=Object(p.List)();return n.forEach(function(n){var o=D(L(t,n),3),a=o[0],i=o[1],c=o[2];a&&(r=r.push(Object(p.Map)({matched:a,matchedIndices:Object(p.List)(c),score:i,text:n,type:e})))}),r.sort(B)},G=function(e){var t=e.texts.get(0).getLeaves().get(0).text,n=e.selection.anchorOffset;return[t.substring(0,n),t.substring(n)]},V="[a-zA-Z_:][a-zA-Z0-9_:]*",Y="[a-zA-Z_][a-zA-Z0-9_]*",Z=/.*\s(by|without|ignoring|on|group_left|group_right)\s?\(.*/,X=function(e){var t=e.editor,n=e.metricNames,r=e.labelSets,o=e.history,a=e.getPrometheusLabelSet,i=e.instanceId,c=t.document.getTexts();if(window.getSelection().anchorNode&&1===c.size&&0===c.get(0).characters.size)return{matchedText:"",matches:Object(p.List)(o.map(function(e){return Object(p.Map)({matchedIndices:Object(p.List)(),text:e,type:z})}))};var l=D(G(t),2),s=l[0];return function(e){for(var t=e.preText,n=e.postText,r=e.metricNames,o=e.labelSets,a=e.instanceId,i=e.getPrometheusLabelSet,c=!1,l=0;l<t.length;l+=1)"{"===t[l]&&(c=!0),"}"===t[l]&&(c=!1);if(Z.test(t))return{};if(!c){var s=/\[([^\]]*)$/.exec(t);if(s)return{matchedText:s[1],matches:Q()};var u=new RegExp("".concat(V,"$")).exec(t),f=/^\w+/.exec(n);if(u&&!f){var d=K(u[0],r).slice(0,100),m=d.size>0&&d.get(0).get("text")===u[0]?Object(p.List)():d;return{matchedText:u[0],matches:m}}return{}}var h=new RegExp("(".concat(V,"){[^{}]*$")).exec(t);if(!h||h.length<2)return{};var y=h[1];if(!(y in o))return i(a,y),{matches:Object(p.List)([Object(p.Map)({matchedIndices:Object(p.List)(),text:"Loading ...",type:"loading"})])};var b=new RegExp("({\\s*(".concat(Y,"|)|{.*,\\s*(").concat(Y,"|)\\s*)$")).exec(t),g=/^[\w=]+/.exec(n);if(b&&!g)return{matchedText:void 0!==b[3]?b[3]:b[2]||"",matches:H(A,void 0!==b[3]?b[3]:b[2],Object.keys(o[y]))};var v=new RegExp("\\s*=\\s*".concat("[\"`']?","(").concat("[^\\,\"`'}]*",")$")),w=new RegExp("^".concat("[\"`']?","(").concat("[^\\,\"`'}]*",")").concat("[\"`']?")),k=v.exec(t),_=w.exec(n);if(k){var O=new RegExp("(".concat(Y,")\\s*(?:=|!=|=~|!~)\\s*").concat("[\"`']?").concat("[^\\,\"`'}]*","$")).exec(t),E=O?O[1]:"";return E in o[y]?{matchedText:{deleteSize:k[0].length+_[0].length,endOffset:k.index+k[0].length+_[0].length},matches:H(F,k[1],o[y][E])}:{}}return{}}({getPrometheusLabelSet:a,instanceId:i,labelSets:r,metricNames:n,postText:l[1],preText:s})},$=function(e,t,n,r,o,a){var i=e.get("text");switch(e.get("type")){case M:return t.deleteBackward(n.length).insertText("".concat(i,"()")).move(-1);case q:return i in o||a(r,i),t.deleteBackward(n.length).insertText("".concat(i));case A:return t.deleteBackward(n.length).insertText(i);case F:var c='="'.concat(i,'"');return t.moveOffsetsTo(n.endOffset).deleteBackward(n.deleteSize).insertText(c);case U:return t.deleteBackward(n.length).insertText(i);case z:return t.insertText(i)}return null},J=function(e){var t=e.operations.get(e.operations.size-1);if("insert_text"===t.type){var n=D(G(e.value),1)[0];switch(t.text){case"(":return e.insertText(")").move(-1);case"{":return e.insertText("}").move(-1);case"[":return e.insertText("]").move(-1);case'"':if(n.split('"').length%2==0&&(e.value.anchorText.characters.size<=e.value.startOffset||e.value.anchorText.characters.get(e.value.startOffset).text.match(/\W/)))return e.insertText('"').move(-1)}}if("remove_text"===t.type)switch(t.text){case"(":if(e.value.anchorText.characters.size>e.value.startOffset&&")"===e.value.anchorText.characters.get(e.value.startOffset).text)return e.deleteForward(1);break;case"{":if(e.value.anchorText.characters.size>e.value.startOffset&&"}"===e.value.anchorText.characters.get(e.value.startOffset).text)return e.deleteForward(1);break;case"[":if(e.value.anchorText.characters.size>e.value.startOffset&&"]"===e.value.anchorText.characters.get(e.value.startOffset).text)return e.deleteForward(1);break;case'"':if(e.value.anchorText.characters.size>e.value.startOffset&&'"'===e.value.anchorText.characters.get(e.value.startOffset).text)return e.deleteForward(1)}return e};function ee(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(n,!0).forEach(function(t){ne(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var re=te({},P.a.languages,{promql:{comment:/(#.*)/,function:new RegExp("\\b(".concat(W.join("|"),")\\b")),number:/-?\d+(\.\d*)?([eE][+-]?\d*)?/,operator:/[-+*\/%^]|(==|!=|>|<|(>=)|(<=)|\b(and|or|unless|on)\b)/,"promql-aggregation":{inside:{"promql-label-key":{lookbehind:!0,pattern:/(\()[^)]*/}},pattern:/(by|without)\s*\([^)]*\)?/},"promql-labelset":{inside:{"promql-label-key":{pattern:/[a-z_]\w*(?=(\s*(=|!=|=~|!~))?)/},"promql-label-value":{greedy:!0,pattern:/"(\\.|[^\\,"}])*"?|`(\\.|[^\\,`}])*`?|'(\\.|[^\\,'}])*'?/}},pattern:/\{[^}]*\}?/},"promql-metric-name":{pattern:/\w+/},"promql-offset":{inside:{"promql-offset-duration":{pattern:/\b\d+[smhdwy]?\b/i}},pattern:/(offset)\s*\w*/},"promql-range":{inside:{"promql-range-duration":{pattern:/\b\d+[smhdwy]?\b/i}},pattern:/\[[^\]]*]?/},punctuation:/[(){},]/},yaml:te({},P.a.languages.yaml,{url:{greedy:!0,pattern:/(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,}))\.?)(?::\d{2,5})?(?:[\/?#]\S*)?/gi}})});re.promqlAlertConfig=te({},re.promql,{"promql-metric-name":void 0});var oe=re,ae=function(e){var t=e.text,n=e.textStart,r=e.textEnd,o=e.start,a=e.end,i=e.tokenType;return o>=r||a<=n?null:(o=Math.max(o,n),a=Math.min(a,r),o-=n,a-=n,new T.Range({anchorKey:t.key,anchorOffset:o,focusKey:t.key,focusOffset:a,isBackward:null,isFocused:!1,marks:new p.Set([new T.Mark({data:new p.Map({tokenType:i}),type:"prism-token"})])}))},ie=function(e,t){var n=oe[t];if(!n)return[];var r=e.getTexts(),o=r.map(function(e){return e.text}).join("\n"),a=P.a.tokenize(o,n),i=new p.List,c=0,l=0;return r.forEach(function(e){l=c+e.text.length;var t=0;a.forEach(function(n){return function n(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if("string"==typeof r){if(o){var a=ae({end:t+r.length,start:t,text:e,textEnd:l,textStart:c,tokenType:o});a&&(i=i.push(a))}t+=r.length}else if(o="".concat(o?"".concat(o," "):"").concat(r.type).concat(r.alias?" ".concat(r.alias):""),"string"==typeof r.content){var s=ae({end:t+r.content.length,start:t,text:e,textEnd:l,textStart:c,tokenType:o});s&&(i=i.push(s)),t+=r.content.length}else for(var u=0;u<r.content.length;u+=1)n(r.content[u],o)}(n)}),c=l+1}),i},ce=function(e){return function(t){return"code_line"!==t.type?null:ie(t,e)}},le=n(18),se=n.n(le),ue={markdown:function(e){switch(e){case"title":return Object(b.css)(["color:",";font-size:",";"],se.a.colors.purple400,se.a.fontSizes.large);case"bold":case"punctuation":return Object(b.css)(["font-weight:bold;"]);case"italic":return Object(b.css)(["font-style:italic;"]);default:return Object(b.css)([""])}},promql:function(e){switch(e){case"comment":case"prolog":case"doctype":case"cdata":return Object(b.css)(["color:",";font-style:italic;"],se.a.colors.promQL.comment);case"namespace":return Object(b.css)(["opacity:0.7;"]);case"string":case"attr-value":case"promql-label-value":return Object(b.css)(["color:",";"],se.a.colors.promQL.string);case"punctuation":return Object(b.css)(["font-weight:bold;color:",";"],se.a.colors.promQL.punctuation);case"operator":return Object(b.css)(["font-style:italic;"]);case"entity":case"url":case"symbol":case"number":case"boolean":case"variable":case"constant":case"property":case"regex":case"inserted":case"promql-range-duration":case"promql-offset-duration":return Object(b.css)(["color:",";"],se.a.colors.promQL.entity);case"promql-metric-name":return Object(b.css)(["color:",";"],se.a.colors.promQL.metricName);case"atrule":case"keyword":case"attr-name":case"promql-label-key":return Object(b.css)(["color:",";"],se.a.colors.promQL.attrName);case"function":return Object(b.css)(["color:",";"],se.a.colors.promQL.function);case"deleted":return Object(b.css)(["color:",";"],se.a.colors.promQL.deleted);case"tag":case"selector":return Object(b.css)(["color:",";"],se.a.colors.promQL.tag);case"important":case"bold":return Object(b.css)(["font-weight:bold;"]);case"italic":return Object(b.css)(["font-style:italic;"]);default:return Object(b.css)([""])}}};ue.promqlAlertConfig=ue.promql,ue.yaml=ue.promql;var pe=b.default.span.withConfig({displayName:"theme__Token",componentId:"sc-1vp3pmu-0"})(["",""],function(e){return t=e.styled.language,n=e.styled.type,r=n.split(" "),o=[],r.forEach(function(e){o=o.concat(ue[t](e))}),o;var t,n,r,o});function fe(){return(fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var de=function(e){var t,n=e.language;return{decorateNode:ce(n),renderMark:(t={language:n},function(e){var n=e.mark.data.get("tokenType");return u.a.createElement(pe,fe({styled:{language:t.language,type:n},className:!1},e.attributes),e.children)})}},me=function(e,t){var n={document:{nodes:[{data:{language:t},nodes:e.split("\n").map(function(e){return{nodes:[{leaves:[{text:e}],object:"text"}],object:"block",type:"code_line"}}),object:"block",type:"code_block"}]}};return T.Value.fromJSON(n)},he=function(e,t){return t.left>=e.left&&t.top>=e.top&&t.right<=e.right&&t.bottom<=e.bottom},ye=n(112),be=n.n(ye),ge=n(1665);function ve(e){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function we(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oe(e,t){return(Oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Se=window.document.getElementById("app"),xe=b.default.div.withConfig({displayName:"dropdown__Container",componentId:"sc-1xcp1x6-0"})(["padding:8px 7px 6px;position:absolute;z-index:",";opacity:",";top:","px;left:","px;border:1px solid ",";background:",";height:","px;max-height:400px;min-width:400px;"],function(e){return e.theme.layers.dropdown},function(e){return e.styled.visible?1:0},function(e){return e.styled.top},function(e){return e.styled.left},function(e){return e.theme.colors.gray200},function(e){return e.theme.colors.purple25},function(e){return 20*e.styled.number}),je=b.default.div.withConfig({displayName:"dropdown__Item",componentId:"sc-1xcp1x6-1"})(["background:",";display:flex;text-overflow:ellipsis;align-items:center;cursor:pointer;white-space:nowrap;"],function(e){return e.styled.highlighted?"lightgray":null}),Ce=b.default.div.withConfig({displayName:"dropdown__Icon",componentId:"sc-1xcp1x6-2"})(["padding:4px;font-size:",";color:",";"],function(e){return e.theme.fontSizes.tiny},function(e){return e.styled.color}),Ie=b.default.span.withConfig({displayName:"dropdown__TextHighlight",componentId:"sc-1xcp1x6-3"})(["font-weight:bold;color:",";"],function(e){return e.theme.colors.blue700}),Pe=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=ke(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==ve(o)&&"function"!=typeof o?_e(r):o,Ee(_e(n),"handleClick",function(e){return function(t){t.stopPropagation(),t.preventDefault(),n.props.onClick(e)}}),Ee(_e(n),"rowRenderer",function(e){for(var t=e.key,r=e.index,o=e.style,a=n.props,i=a.matches,c=a.highlightedIndex,l=i.get(r),s=0,p=[],f="",d=!1,m=0;m<l.get("text").length;m+=1)m===l.get("matchedIndices").get(s)?(!1===d&&f.length&&(p.push(f),f=""),d=!0,s+=1):(!0===d&&f.length&&(p.push(u.a.createElement(Ie,{key:"".concat(f,"-").concat(m)},f)),f=""),d=!1),f+=l.get("text")[m];!0===d&&f.length&&p.push(u.a.createElement(Ie,{key:"".concat(f,"-end")},f)),!1===d&&f.length&&p.push(f);var h="",y=null;switch(l.get("type")){case M:h="fa fa-cube",y=se.a.colors.purple500;break;case q:h="fa fa-bars";break;case A:h="fa fa-key",y=se.a.colors.blue700;break;case F:h="fa fa-caret-right",y=se.a.colors.blue700;break;case U:h="far fa-clock",y=se.a.colors.blue700;break;case z:h="fa fa-history",y=se.a.colors.promQL.salmon}return u.a.createElement("div",{key:t,style:o},u.a.createElement(je,{styled:{highlighted:r===c},onMouseDown:n.handleClick(r)},u.a.createElement(Ce,{className:h,styled:{color:y}})," ",p))}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oe(e,t)}(t,u.a.Component),n=t,(r=[{key:"shouldComponentUpdate",value:function(e){return!(e.highlightedIndex===this.props.highlightedIndex&&(!e.matches||e.matches.equals(this.props.matches))&&e.visible===this.props.visible&&i()(e.position,this.props.position))}},{key:"render",value:function(){var e=this,t=this.props,n=t.highlightedIndex,r=t.matches,o=t.visible,a=t.dropdownRef,i=t.position;return o?be.a.createPortal(u.a.createElement(xe,{id:"autocomplete",ref:a,styled:{left:i.left,number:r.size,top:i.top,visible:i.left&&i.top}},u.a.createElement("div",{style:{height:"100%",width:"100%"}},u.a.createElement(ge.a,null,function(t){var o=t.height,a=t.width;return u.a.createElement(ge.b,{width:a,height:o,rowCount:r?r.size:0,rowHeight:20,rowRenderer:e.rowRenderer,highlightedIndex:n,overscanRowCount:10,scrollToIndex:n,matches:r,style:{outline:"none"}})}))),Se):null}}])&&we(n.prototype,r),o&&we(n,o),t}(),Te=function(e,t,n,r,o,a,i,c,l){if(o&&n&&n.size>0)switch(e.key){case"Tab":case"Enter":if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)break;e.preventDefault();var s=n.get(r);return{change:$(s,t,a,i,c,l),forceHideDropdown:!0};case"Escape":return e.preventDefault(),{forceHideDropdown:!0};case"ArrowDown":return e.preventDefault(),{highlightedIndex:Math.min(r+1,n.size-1)};case"ArrowUp":return e.preventDefault(),{highlightedIndex:Math.max(r-1,0)}}return{}},Re=function(e,t,n,r,o,a,i){var c=t.get(r),l=e.change().focus();return{change:$(c,l,n,o,a,i),forceHideDropdown:!0}};function Ne(e){return(Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function De(e){return(De=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Me(e,t){return(Me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Fe=function(e){return"markdown"===e},Ue=function(e){return e.document.nodes.get(0).nodes.map(function(e){return e.text}).toJS().join("\n")},ze=b.default.div.withConfig({displayName:"code-editor__MdPreview",componentId:"sc-5n2vb4-0"})(["padding-top:5px;min-height:30px;cursor:text;"," >:first-child{margin-top:0;}"],v.a),We=function(e){function t(e){var n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=De(t).call(this,e),n=!a||"object"!==Ne(a)&&"function"!=typeof a?qe(r):a,Ae(qe(n),"dropdown",void 0),Ae(qe(n),"editor",void 0),Ae(qe(n),"editorWrap",void 0),Ae(qe(n),"plugins",void 0),Ae(qe(n),"serializedValue",void 0),Ae(qe(n),"fetchMatches",function(e){if(n.props.instanceId&&n.props.labelSets){var t=X({editor:e,getPrometheusLabelSet:n.props.getPrometheusLabelSet,history:n.props.history,instanceId:n.props.instanceId,labelSets:n.props.labelSets,metricNames:n.props.metricNames}),r=t.matches,o=t.matchedText;n.setState({matchedText:o,matches:r})}}),Ae(qe(n),"debouncedFetchMatches",l()(function(e){n.fetchMatches(e)},100)),Ae(qe(n),"onChange",function(e){var t=e;n.props.intellisenseEnabled&&(t=J(e),n.updateDropdown()),n.setState({editor:t.value}),n.serializedValue=h.a.serialize(t.value),o()(n.props.onChange)&&n.props.onChange(n.serializedValue),"remove_text"===e.operations.get(e.operations.size-1).type?n.debouncedFetchMatches(t.value):n.fetchMatches(t.value)}),Ae(qe(n),"onKeyDown",function(e,t){if(Fe(n.props.language))return n.props.onKeyDown(e),null;if(n.props.intellisenseEnabled){"Enter"!==e.key&&"Control"!==e.key&&"Shift"!==e.key&&"Alt"!==e.key&&"Meta"!==e.key&&n.setState({highlightedIndex:0});var r=Te(e,t,n.state.matches,n.state.highlightedIndex,n.state.dropdownVisible,n.state.matchedText,n.props.instanceId,n.props.labelSets,n.props.getPrometheusLabelSet),o=r.change,a=r.highlightedIndex,i=r.forceHideDropdown;if(void 0!==a&&n.setState({highlightedIndex:a}),n.setState({dropdownVisible:void 0===i}),o)return o}var c=n.props.onKeyDown&&n.props.onKeyDown(e);return c&&void 0!==c.change?c.change:null}),Ae(qe(n),"updateDropdown",function(){if(!Fe(n.props.language)){var e=qe(n),t=e.dropdown,r=e.editorWrap;if(t&&r&&n.state.dropdownVisible){var o=r.getBoundingClientRect(),a=window.getSelection();if(0!==a.rangeCount){var i=a.getRangeAt(0).getClientRects()[0];if(i&&he(o,i)){var c=0;null!==document.body&&(c=document.body.scrollWidth);var l=Math.min(c-t.offsetWidth-10,i.left+window.pageXOffset);n.setState({left:l,top:i.top+window.pageYOffset+i.height})}}}}}),Ae(qe(n),"focusCursorAtEndOfText",function(){setTimeout(function(){n.editor&&n.editor.change(function(e){e.selectAll(),e.collapseToEnd(),e.focus()})},0)}),Ae(qe(n),"handleConditionalFocus",function(){if(Fe(n.props.language)&&n.state.mdPreviewMode)return n.setState({mdPreviewMode:!1}),void n.focusCursorAtEndOfText();n.setState({dropdownVisible:!0})}),Ae(qe(n),"onBlur",function(){n.setState({dropdownVisible:!1,mdPreviewMode:Fe(n.props.language)}),o()(n.props.onBlur)&&n.props.onBlur()}),Ae(qe(n),"onDropdownClick",function(e){var t=n.state.editor,r=Re(t,n.state.matches,n.state.matchedText,e,n.props.instanceId,n.props.labelSets,n.props.getPrometheusLabelSet).change;n.setState({dropdownVisible:!1,editor:r.value}),n.serializedValue=h.a.serialize(r.value),n.props.onChange(n.serializedValue)}),Ae(qe(n),"createDropdownRef",function(e){n.dropdown=e});var i=e.id,c=e.isNotebook,s=e.language,u=e.showLineNumbers,p=e.wrapLines,f=e.value;return n.serializedValue=f,n.plugins=[C({id:i,isNotebook:c,language:s,showLineNumbers:u,wrapLines:p}),de({language:s}),m()({exitBlockType:null})],n.state={dropdownVisible:!1,editor:me(f,s),highlightedIndex:0,mdPreviewMode:!0},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Me(e,t)}(t,u.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.updateDropdown(),this.props.autoFocus&&this.focusCursorAtEndOfText()}},{key:"componentWillReceiveProps",value:function(e){e.value!==this.serializedValue&&(this.setState({editor:me(e.value,e.language)}),this.serializedValue=e.value),i()(e.labelSets,this.props.labelSets)||this.fetchMatches(this.state.editor)}},{key:"shouldComponentUpdate",value:function(e,t){return!Object(p.is)(this.state.editor,t.editor)||!i()(e,this.props)||!i()(t,this.state)}},{key:"componentDidUpdate",value:function(){this.updateDropdown()}},{key:"render",value:function(){var e,t=this,n=this.state,r=n.editor,o=n.highlightedIndex,a=this.props,i=a.readOnly,c=a.intellisenseEnabled,l=a.placeholder,s=a.language;return!i&&c&&(e=this.state.matches&&!!this.state.matches.size&&this.state.dropdownVisible),Fe(s)&&this.state.mdPreviewMode&&r.document.text.length>0?u.a.createElement(ze,{onClick:this.handleConditionalFocus},u.a.createElement(v.a,{text:Ue(r)})):u.a.createElement("div",null,!i&&c&&u.a.createElement(Pe,{position:{left:this.state.left,top:this.state.top},highlightedIndex:o,matches:this.state.matches,visible:e,dropdownRef:this.createDropdownRef,onClick:this.onDropdownClick}),u.a.createElement("div",{onClick:this.handleConditionalFocus,ref:function(e){t.editorWrap=e}},u.a.createElement(f.Editor,{ref:function(e){null!==e&&(t.editor=e)},onChange:this.onChange,onKeyDown:this.onKeyDown,onBlur:this.onBlur,plugins:this.plugins,readOnly:i,value:r,placeholder:l})))}}])&&Le(n.prototype,r),a&&Le(n,a),t}(),Be=Object(y.connect)(null,{getPrometheusLabelSet:g.O})(We);t.a=Be},1312:function(e,t,n){"use strict";var r=n(6),o=n.n(r),a=n(0),i=n.n(a),c=n(9),l=n(19),s=n.n(l),u=n(1),p=n(16),f=n(227),d=n(17),m=n(11),h=n(128),y=n(1213),b=n(1313);function g(e){return o()(e,["Event","serviceIDs"])||o()(e,["Event","metadata","spec","ServiceSpecs"])||o()(e,["Event","metadata","spec","spec","ServiceSpecs"])||Object.keys(o()(e,["Event","metadata","spec","spec"],{}))||[]}var v=u.default.div.withConfig({displayName:"flux-workload-history-item__EntryContent",componentId:"piylnm-0"})(["font-size:",";padding:12px 12px 12px 46px;position:relative;&:hover{opacity:0.9;}img{max-width:100%;}"],function(e){return e.theme.fontSizes.small}),w={automated:"fa fa-rocket fa-fw",autorelease:"fas fa-exchange-alt fa-fw",commit:"far fa-copy fa-fw",deautomated:"wc-stop-o",locked:"fa fa-lock fa-fw",release:"fas fa-exchange-alt fa-fw",sync:"fas fa-sync fa-fw",tag:"fa fa-filter fa-fw",unlocked:"fa fa-unlock fa-fw",untag:"fas fa-trash-alt-o fa-fw"},k={automated:"Automate",autorelease:"Automated deploy",commit:"Commit",deautomated:"Deautomate",locked:"Lock",release:"Manual deploy",sync:"Sync to cluster",tag:function(e){return i.a.createElement("span",null,"Add tag filter ",i.a.createElement("i",null,e)," to")},unlocked:"Unlock",untag:function(e){return i.a.createElement("span",null,"Remove tag filter ",i.a.createElement("i",null,e)," from")}};function _(e,t,n,r,a){var c=g(e)[0],l=Object(h.j)(e,c),u=l.type,y=l.param,v=o()(e,["Event","metadata","error"]),w=v?i.a.createElement("span",null,"Error: ",i.a.createElement("b",null,v),". Failed to ",u):function(e,t){var n=k[e];return"function"==typeof n?n(t):n}(u,y)||"",_=Object(h.f)(e),O=Object(h.g)(e),E=o()(e,["Event","metadata","spec","ImageSpec"]),S=v?{color:"red"}:null,x=function(e,t,n,r){var a=o()(t,["Event","metadata","revision"]),c=a?[{revision:a}]:o()(t,["Event","metadata","revisions"],[]).map(function(e){return{revision:e}});return(o()(t,["Event","metadata","commits"])||c).map(function(e){var t=e.revision,o=e.message;return i.a.createElement(b.a,{key:t,id:t,message:o,config:n,onClick:r})})}(0,e,n,a),j=function(e,t,n){return g(t).map(function(t){return t===p.FLUX_ALL_WORKLOADS?"all resources":i.a.createElement(s.a,{key:t,to:Object(m.p)(e,t),onClick:n},t)})}(t,e,r);return i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement("span",{style:S},w,":"),E&&" ".concat(E," to")," ",Object(d.n)(j,", ")," ",x.length>0&&i.a.createElement("span",null,"(",Object(d.n)(x,", "),")")),(O||_)&&i.a.createElement("div",null,_&&i.a.createElement(f.a,{text:_})," ",O&&i.a.createElement("span",null,"by ",Object(h.h)(O))))}t.a=function(e){var t=e.config,n=e.event,r=e.instanceId,o=e.workloadId,a=e.onWorkloadClick,l=e.onCommitClick,s=e.isoDate;return i.a.createElement(c.ListItem,{style:{padding:0}},i.a.createElement(v,{workloadId:o,event:n},Object(y.c)("".concat(function(e){var t=g(e)[0];return w[Object(h.j)(e,t).type]||""}(n)),{left:8,position:"absolute",top:12}),_(n,r,t,a,l),i.a.createElement(c.TimestampTag,{relative:!s,timestamp:n.Stamp})))}},1313:function(e,t,n){"use strict";var r=n(6),o=n.n(r),a=n(0),i=n.n(a);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(){var e,n,r,o,a,i,l;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var p=arguments.length,f=new Array(p),d=0;d<p;d++)f[d]=arguments[d];return r=this,o=(e=s(t)).call.apply(e,[this].concat(f)),n=!o||"object"!==c(o)&&"function"!=typeof o?u(r):o,a=u(n),l=function(){n.props.onClick&&n.props.onClick()},(i="handleClick")in a?Object.defineProperty(a,i,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[i]=l,n}var n,r,f;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,a["PureComponent"]),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.id,n=e.config,r=e.message,a=t.substr(0,12),c=o()(n,["git","commitUrl"]),l=c?i.a.createElement("a",{href:"".concat(c).concat(t),target:"github"},a):a;return i.a.createElement("span",{title:r},l)}}])&&l(n.prototype,r),f&&l(n,f),t}();t.a=f},1316:function(e,t,n){"use strict";n.d(t,"b",function(){return m}),n.d(t,"a",function(){return h});var r=n(56),o=n.n(r),a=n(0),i=n.n(a),c=n(18),l=n.n(c),s=n(17);function u(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(n,!0).forEach(function(t){f(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d="^1";function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{"flux-version":d,"git-branch":t.branch,"git-label":"flux-".concat(e),"git-path":t.path,"git-url":t.url}}function h(e){var t=e.instanceId,n=e.token,r=e.config,a=void 0===r?{}:r,c=e.prevConfig,u=void 0===c?{}:c,d=e.focused,h=p({"k8s-version":"$(kubectl version | base64 | tr -d ".concat("'\\n'",")"),t:n},m(t,a)),y=o()(["branch","url","path"].filter(function(e){return Object(s.q)(a,u,[e])}).map(function(e){return["git-".concat(e),l.a.colors.blue400]})),b=p({},d&&f({},"git-".concat(d),l.a.colors.blue400),{},y),g=Object(s.v)(h,b),v=window.location,w=v.protocol,k=v.host,_="".concat(w,"//").concat(k,"/k8s/flux.yaml");return i.a.createElement("span",null,"kubectl apply -f"," ",'"',_,"?",i.a.createElement("wbr",null),g,'"')}},1326:function(e,t,n){"use strict";n.d(t,"a",function(){return k});var r=n(32),o=n.n(r),a=n(0),i=n.n(a),c=n(1),l=n(9),s=n(1268),u=n(7);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=c.default.div.withConfig({displayName:"dashboard-chart__ChartWrapper",componentId:"sc-1w3hpfe-0"})(["box-sizing:border-box;padding:20px 40px;width:100%;",";"],function(e){return e.hide&&"\n    width: 0;\n    position: absolute;\n    visibility: hidden;\n  "}),g=c.default.div.withConfig({displayName:"dashboard-chart__ChartHeader",componentId:"sc-1w3hpfe-1"})(["display:flex;align-items:center;justify-content:center;height:40px;"]),v=c.default.h3.withConfig({displayName:"dashboard-chart__ChartTitle",componentId:"sc-1w3hpfe-2"})(["white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center;padding-left:40px;margin:0;"]),w=c.default.span.withConfig({displayName:"dashboard-chart__ChartTitleSpinner",componentId:"sc-1w3hpfe-3"})(["display:flex;justify-content:center;width:40px;"]),k=function(e){function t(e,n){var r,a,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,i=d(t).call(this,e,n),r=!i||"object"!==p(i)&&"function"!=typeof i?m(a):i,y(m(r),"handleLegendSelectionChange",function(e){r.setState({selectedLegendKeys:e})}),y(m(r),"handleRefreshStart",function(){r.setState({isRefreshing:!0})}),y(m(r),"handleRefreshFinish",function(e){r.setState({hasMetrics:!o()(e),isRefreshing:!1})}),y(m(r),"handleReceiveSuccess",function(e){var t=e.isFirstLoading,n=e.responseTime;Object(u.trackUserTiming)("prom.dashboard.querySuccessTime",n,"Dashboard query time",{chartTitle:r.props.title,initialQuery:t})}),y(m(r),"handleReceiveError",function(e){var t=e.error,n=e.isFirstLoading,o=e.responseTime;Object(u.trackUserTiming)("prom.dashboard.queryErrorTime",o,"Dashboard query time",{chartTitle:r.props.title,error:t,initialQuery:n})}),r.state={hasMetrics:!1,isRefreshing:!1,selectedLegendKeys:e.selectedLegendKeys},r}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,i.a.Component),n=t,(r=[{key:"componentWillReceiveProps",value:function(e){e.selectedLegendKeys!==this.props.selectedLegendKeys&&this.setState({selectedLegendKeys:e.selectedLegendKeys})}},{key:"render",value:function(){var e=this.state.selectedLegendKeys,t=void 0===e?[]:e,n=this.props,r=n.deployments,o=n.filterDeployments,a=n.namespaceId,c=o?o(r,t,{namespaceId:a}):r;return i.a.createElement(b,{hide:this.props.hideOnNoMetrics&&!this.state.hasMetrics},i.a.createElement(g,null,i.a.createElement(v,null,this.props.title),i.a.createElement(w,null,this.state.isRefreshing&&i.a.createElement(l.CircularProgress,{size:"small"}))),i.a.createElement(s.a,{instanceId:this.props.instanceId,query:this.props.query,yAxisLabel:this.props.yAxisLabel,metricUnits:this.props.metricUnits,valuesMinSpread:this.props.valuesMinSpread,getSeriesKey:this.props.getLabel,getSeriesName:this.props.getLabel,showStacked:this.props.showStacked,colorTheme:this.props.colorTheme,legendShown:this.props.legendShown,deployments:c,renderLegendItemSuffix:this.props.renderLegendItemSuffix,selectedLegendKeys:this.state.selectedLegendKeys,onChangeLegendSelection:this.handleLegendSelectionChange,onRefreshStart:this.handleRefreshStart,onRefreshFinish:this.handleRefreshFinish,onReceiveSuccess:this.handleReceiveSuccess,onReceiveError:this.handleReceiveError}))}}])&&f(n.prototype,r),a&&f(n,a),t}()},1327:function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var o={getRows:function(e){var t=e.platform;r(e,["platform"]);switch(t){case"docker":return[{charts:[{getLabel:function(e){return e.metric.node_name},metricUnits:"percent",query:'1 - (avg(rate(node_cpu{mode="idle"}[1m])  * on(instance) group_left(node_name) node_meta{node_name=~".+"}) by (node_name))',queryMetrics:["node_cpu","node_meta"],title:"CPU usage",valuesMinSpread:1}],key:"CPU"},{charts:[{getLabel:function(e){return e.metric.node_name},metricUnits:"percent",query:'1 - sum(((node_memory_MemFree + node_memory_Cached + node_memory_Buffers) / node_memory_MemTotal) * on(instance) group_left(node_name) node_meta{node_name=~".+"}) by (node_name)',queryMetrics:["node_memory_MemFree","node_memory_Cached","node_memory_Buffers","node_memory_MemTotal","node_meta"],title:"Memory usage",valuesMinSpread:1}],key:"Memory"},{charts:[{getLabel:function(e){var t=e.metric;return"".concat(t.node_name," - ").concat(t.device)},metricUnits:"percent",query:'1 - ((max(node_filesystem_avail{fstype=~"ext4|ext3|btrfs|xfs"} * on(instance) group_left(node_name) node_meta{node_name=~".+"}) by (device, node_name)) / max(node_filesystem_size{fstype=~"ext4|ext3|btrfs|xfs"} * on(instance) group_left(node_name) node_meta{node_name=~".+"}) by (device, node_name))',queryMetrics:["node_filesystem_avail","node_filesystem_size","node_meta"],title:"Disk usage",valuesMinSpread:1}],key:"Disk"}];case"":case"kubernetes":default:return[{charts:[{getLabel:function(e){return e.metric.node},metricUnits:"percent",query:'1 - (avg(rate(node_cpu{mode="idle"}[1m])) by (node))',queryMetrics:["node_cpu"],title:"CPU usage",valuesMinSpread:1}],key:"CPU"},{charts:[{getLabel:function(e){return e.metric.node},metricUnits:"percent",query:"1 - max((node_memory_MemFree + node_memory_Cached + node_memory_Buffers) / node_memory_MemTotal) by (node)",queryMetrics:["node_memory_MemFree","node_memory_Cached","node_memory_Buffers","node_memory_MemTotal"],title:"Memory usage",valuesMinSpread:1}],key:"Memory"},{charts:[{getLabel:function(e){return e.metric.node},hideOnNoMetrics:!0,metricUnits:"percent",query:"avg (container_accelerator_duty_cycle) by (instance) / 100",queryMetrics:["container_accelerator_duty_cycle"],title:"GPU usage",valuesMinSpread:1}],key:"GPU"},{charts:[{getLabel:function(e){return e.metric.node},hideOnNoMetrics:!0,metricUnits:"percent",query:"sum by (instance) (container_accelerator_memory_used_bytes) / sum by (instance) (container_accelerator_memory_total_bytes)",queryMetrics:["container_accelerator_memory_used_bytes","container_accelerator_memory_total_bytes"],title:"GPU memory usage",valuesMinSpread:1}],key:"GPU memory"},{charts:[{getLabel:function(e){var t=e.metric;return"".concat(t.node," - ").concat(t.device)},metricUnits:"percent",query:'1 - (max(node_filesystem_avail{fstype=~"ext4|ext3|btrfs|xfs"}) by (device, node) / max(node_filesystem_size{fstype=~"ext4|ext3|btrfs|xfs"}) by (device, node))',queryMetrics:["node_filesystem_avail","node_filesystem_size"],title:"Disk usage",valuesMinSpread:1}],key:"Disk"}]}},href:"node-resources",id:"node-resources",name:"Node resources"};t.a=o},1340:function(e,t,n){"use strict";var r=n(6),o=n.n(r),a=n(99),i=n.n(a),c=n(32),l=n.n(c);function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var u=function(e,t){return"sum by (_name) (\n    sum by (pod) (\n      # Rename pod_name -> pod so we can match the metrics below\n      label_replace(".concat(t,', "pod", "$0", "pod_name", ".*")\n    )\n    * on (pod) group_left(_name)\n    (\n      max by (pod, _name) (\n        # Find a good label for this series\n        label_replace(kube_pod_labels{namespace="').concat(e,'",label_name!=""}, "_name", "$0", "label_name", ".*") or\n        label_replace(kube_pod_labels{namespace="').concat(e,'",label_k8s_app!=""}, "_name", "$0", "label_k8s_app", ".*") or\n        label_replace(\n          label_replace(\n            kube_pod_labels{namespace="').concat(e,'",label_name="",label_k8s_app=""},\n            "_name", "$1", "pod", "^(.*?)(?:(?:-[0-9]+)?-[0-9a-z]{5})?$"\n          ),\n          "_name", "$1", "_name", "^(kube-.*)-(?:ip|gke)-.*$"\n        )\n      )\n    )\n  )')},p=function(e,t){return e.filter(function(e){return i()(t,function(t){return e.Data.match(t)})})},f=function(e,t){return l()(t)?e:p(e,t.map(function(e){return new RegExp(", ".concat(e,":"),"gi")}))},d=function(e,t,n){var r=n.namespaceId;return l()(t)?f(e,[r]):p(e,t.map(function(e){return new RegExp(", ".concat(r,":[a-z]+/").concat(e),"gi")}))},m=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){return o()(e,"metric._name")},id:"workload-cpu",query:u(t,'rate(container_cpu_usage_seconds_total{image!="",namespace="'.concat(t,'"}[2m])')),queryMetrics:["container_cpu_usage_seconds_total","kube_pod_labels"],showStacked:!0,title:"CPU usage by workload",yAxisLabel:"CPU seconds / second"}:{filterDeployments:f,getLabel:function(e){return o()(e,"metric.namespace")},query:'sum(rate(container_cpu_usage_seconds_total{image!="",namespace!=""}[2m])) by (namespace)',queryMetrics:["container_cpu_usage_seconds_total"],showStacked:!0,title:"CPU usage by namespace",yAxisLabel:"CPU seconds / second"}},h=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){return o()(e,"metric._name")},id:"workload-memory",metricUnits:"bytes",query:u(t,'container_memory_rss{image!="",namespace="'.concat(t,'"}')),queryMetrics:["container_memory_rss","kube_pod_labels"],showStacked:!0,title:"Memory usage by workload"}:{filterDeployments:f,getLabel:function(e){return o()(e,"metric.namespace")},metricUnits:"bytes",query:'sum(container_memory_rss{image!="",namespace!=""}) by (namespace)',queryMetrics:["container_memory_rss"],showStacked:!0,title:"Memory usage by namespace"}},y=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){return o()(e,"metric._name")},hideOnNoMetrics:!0,id:"workload-gpu",query:u(t,'container_accelerator_duty_cycle{image!="",namespace="'.concat(t,'"}')),queryMetrics:["container_accelerator_duty_cycle","kube_pod_labels"],showStacked:!0,title:"GPU usage by workload",yAxisLabel:"Percent (%)"}:{filterDeployments:f,getLabel:function(e){return o()(e,"metric.namespace")},hideOnNoMetrics:!0,query:'avg (container_accelerator_duty_cycle{image!="",namespace!=""}) by (namespace)',queryMetrics:["container_accelerator_duty_cycle"],showStacked:!0,title:"GPU usage by namespace",yAxisLabel:"Percent (%)"}},b=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){return o()(e,"metric._name")},hideOnNoMetrics:!0,id:"workload-gpu-memory",metricUnits:"bytes",query:u(t,'container_accelerator_memory_used_bytes{image!="",namespace="'.concat(t,'"}')),queryMetrics:["container_accelerator_memory_used_bytes","kube_pod_labels"],showStacked:!0,title:"GPU memory usage by workload"}:{filterDeployments:f,getLabel:function(e){return o()(e,"metric.namespace")},hideOnNoMetrics:!0,metricUnits:"bytes",query:'sum (container_accelerator_memory_used_bytes{image!="",namespace!=""}) by (namespace)',queryMetrics:["container_accelerator_memory_used_bytes"],showStacked:!0,title:"GPU memory usage by namespace"}},g=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){return o()(e,"metric._name")},metricUnits:"bytes",query:u(t,'rate(container_network_receive_bytes_total{image!="",interface="eth0",namespace="'.concat(t,'"}[2m])')),queryMetrics:["container_network_receive_bytes_total","kube_pod_labels"],showStacked:!0,title:"Received bytes by workload"}:{filterDeployments:f,getLabel:function(e){return o()(e,"metric.namespace")},metricUnits:"bytes",query:'sum(rate(container_network_receive_bytes_total{image!="",namespace!="",interface="eth0"}[2m])) by (namespace)',queryMetrics:["container_network_receive_bytes_total"],showStacked:!0,title:"Received bytes by namespace"}},v=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){return o()(e,"metric._name")},metricUnits:"bytes",query:u(t,'rate(container_network_transmit_bytes_total{image!="",interface="eth0",namespace="'.concat(t,'"}[2m])')),queryMetrics:["container_network_transmit_bytes_total","kube_pod_labels"],showStacked:!0,title:"Transmitted bytes by workload"}:{filterDeployments:f,getLabel:function(e){return o()(e,"metric.namespace")},metricUnits:"bytes",query:'sum(rate(container_network_transmit_bytes_total{image!="",namespace!="",interface="eth0"}[2m])) by (namespace)',queryMetrics:["container_network_transmit_bytes_total"],showStacked:!0,title:"Transmitted bytes by namespace"}},w=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){return o()(e,"metric._name")},metricUnits:"bytes",query:u(t,"rate(container_fs_writes_bytes_total{image!='',namespace=\"".concat(t,'"}[2m])')),queryMetrics:["container_fs_writes_bytes_total","kube_pod_labels"],showStacked:!0,title:"Disk write by workload"}:{filterDeployments:f,getLabel:function(e){return o()(e,"metric.namespace")},metricUnits:"bytes",query:'sum(rate(container_fs_writes_bytes_total{image!="",namespace!=""}[2m])) by (namespace)',queryMetrics:["container_fs_writes_bytes_total"],showStacked:!0,title:"Disk write by namespace"}},k=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){return o()(e,"metric._name")},metricUnits:"bytes",query:u(t,"rate(container_fs_reads_bytes_total{image!='',namespace=\"".concat(t,'"}[2m])')),queryMetrics:["container_fs_reads_bytes_total","kube_pod_labels"],showStacked:!0,title:"Disk read by workload"}:{filterDeployments:f,getLabel:function(e){return o()(e,"metric.namespace")},metricUnits:"bytes",query:'sum(rate(container_fs_reads_bytes_total{image!="",namespace!=""}[2m])) by (namespace)',queryMetrics:["container_fs_reads_bytes_total"],showStacked:!0,title:"Disk read by namespace"}},_=function(e,t){return t.substr(e.length+1)},O=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){var n=e.metric;return _(t,n.container_label_com_docker_swarm_service_name)},query:'sum(rate(container_cpu_usage_seconds_total{id=~"/docker/.*",container_label_com_docker_stack_namespace="'.concat(t,'"}[2m])) by (container_label_com_docker_swarm_service_name)'),queryMetrics:["container_cpu_usage_seconds_total"],showStacked:!0,title:"CPU usage by workload",yAxisLabel:"CPU seconds / second"}:{filterDeployments:f,getLabel:function(e){return e.metric.container_label_com_docker_stack_namespace},query:'sum(rate(container_cpu_usage_seconds_total{id=~"/docker/.*",container_label_com_docker_stack_namespace!=""}[2m])) by (container_label_com_docker_stack_namespace)',queryMetrics:["container_cpu_usage_seconds_total"],showStacked:!0,title:"CPU usage by namespace",yAxisLabel:"CPU seconds / second"}},E=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){var n=e.metric;return _(t,n.container_label_com_docker_swarm_service_name)},metricUnits:"bytes",query:'sum(container_memory_rss{id=~"/docker/.*",container_label_com_docker_stack_namespace="'.concat(t,'"}) by (container_label_com_docker_swarm_service_name)'),queryMetrics:["container_memory_rss"],showStacked:!0,title:"Memory usage by workload"}:{filterDeployments:f,getLabel:function(e){return e.metric.container_label_com_docker_stack_namespace},metricUnits:"bytes",query:'sum(container_memory_rss{id=~"/docker/.*",container_label_com_docker_stack_namespace!=""}) by (container_label_com_docker_stack_namespace)',queryMetrics:["container_memory_rss"],showStacked:!0,title:"Memory usage by namespace"}},S=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){var n=e.metric;return _(t,n.container_label_com_docker_swarm_service_name)},hideOnNoMetrics:!0,query:'avg (container_accelerator_duty_cycle{id=~"/docker/.*",container_label_com_docker_stack_namespace="'.concat(t,'"}) by (container_label_com_docker_swarm_service_name)'),queryMetrics:["container_accelerator_duty_cycle"],showStacked:!0,title:"GPU usage by workload",yAxisLabel:"Percent (%)"}:{filterDeployments:f,getLabel:function(e){return e.metric.container_label_com_docker_stack_namespace},hideOnNoMetrics:!0,query:'avg (container_accelerator_duty_cycle{id=~"/docker/.*",container_label_com_docker_stack_namespace!=""}) by (container_label_com_docker_stack_namespace)',queryMetrics:["container_accelerator_duty_cycle"],showStacked:!0,title:"GPU usage by namespace",yAxisLabel:"Percent (%)"}},x=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){var n=e.metric;return _(t,n.container_label_com_docker_swarm_service_name)},hideOnNoMetrics:!0,metricUnits:"bytes",query:'sum (container_accelerator_memory_used_bytes{id=~"/docker/.*",container_label_com_docker_stack_namespace="'.concat(t,'"}) by (container_label_com_docker_swarm_service_name)'),queryMetrics:["container_accelerator_memory_used_bytes"],showStacked:!0,title:"GPU memory usage by workload"}:{filterDeployments:f,getLabel:function(e){return e.metric.container_label_com_docker_stack_namespace},hideOnNoMetrics:!0,metricUnits:"bytes",query:'sum (container_accelerator_memory_used_bytes{id=~"/docker/.*",container_label_com_docker_stack_namespace!=""}) by (container_label_com_docker_stack_namespace)',queryMetrics:["container_accelerator_memory_used_bytes"],showStacked:!0,title:"GPU memory usage by namespace"}},j=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){var n=e.metric;return _(t,n.container_label_com_docker_swarm_service_name)},metricUnits:"bytes",query:'sum(rate(container_network_receive_bytes_total{id=~"/docker/.*",container_label_com_docker_stack_namespace="'.concat(t,'"}[2m])) by (container_label_com_docker_swarm_service_name)'),queryMetrics:["container_network_receive_bytes_total"],showStacked:!0,title:"Received bytes by workload"}:{filterDeployments:f,getLabel:function(e){return e.metric.container_label_com_docker_stack_namespace},metricUnits:"bytes",query:'sum(rate(container_network_receive_bytes_total{id=~"/docker/.*",container_label_com_docker_stack_namespace!=""}[2m])) by (container_label_com_docker_stack_namespace)',queryMetrics:["container_network_receive_bytes_total"],showStacked:!0,title:"Received bytes by namespace"}},C=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){var n=e.metric;return _(t,n.container_label_com_docker_swarm_service_name)},metricUnits:"bytes",query:'sum(rate(container_network_transmit_bytes_total{id=~"/docker/.*",container_label_com_docker_stack_namespace="'.concat(t,'"}[2m])) by (container_label_com_docker_swarm_service_name)'),queryMetrics:["container_network_transmit_bytes_total"],showStacked:!0,title:"Transmitted bytes by workload"}:{filterDeployments:f,getLabel:function(e){return e.metric.container_label_com_docker_stack_namespace},metricUnits:"bytes",query:'sum(rate(container_network_transmit_bytes_total{id=~"/docker/.*",container_label_com_docker_stack_namespace!=""}[2m])) by (container_label_com_docker_stack_namespace)',queryMetrics:["container_network_transmit_bytes_total"],showStacked:!0,title:"Transmitted bytes by namespace"}},I=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){var n=e.metric;return _(t,n.container_label_com_docker_swarm_service_name)},metricUnits:"bytes",query:'sum(rate(container_fs_writes_bytes_total{id=~"/docker/.*",container_label_com_docker_stack_namespace="'.concat(t,'"}[2m])) by (container_label_com_docker_swarm_service_name)'),queryMetrics:["container_fs_writes_bytes_total"],showStacked:!0,title:"Disk write by service"}:{filterDeployments:f,metricUnits:"bytes",query:'sum(rate(container_fs_writes_bytes_total{id=~"/docker/.*",container_label_com_docker_stack_namespace!=""}[2m])) by (container_label_com_docker_stack_namespace)',queryMetrics:["container_fs_writes_bytes_total"],showStacked:!0,title:"Disk write by namespace"}},P=function(e){var t=e.namespace;return t?{filterDeployments:d,getLabel:function(e){var n=e.metric;return _(t,n.container_label_com_docker_swarm_service_name)},metricUnits:"bytes",query:'sum(rate(container_fs_reads_bytes_total{id=~"/docker/.*",container_label_com_docker_stack_namespace="'.concat(t,'"}[2m])) by (container_label_com_docker_swarm_service_name)'),queryMetrics:["container_fs_reads_bytes_total"],showStacked:!0,title:"Disk read by service"}:{filterDeployments:f,metricUnits:"bytes",query:'sum(rate(container_fs_reads_bytes_total{id=~"/docker/.*",container_label_com_docker_stack_namespace!=""}[2m])) by (container_label_com_docker_stack_namespace)',queryMetrics:["container_fs_reads_bytes_total"],showStacked:!0,title:"Disk read by namespace"}},T={getRows:function(e){var t,n=e.platform,r=s(e,["platform"]);switch(n){case"docker":return t=r.namespace,[{charts:[O({namespace:t})],key:"CPU"},{charts:[E({namespace:t})],key:"Memory"},{charts:[S({namespace:t})],key:"GPU",optional:!0},{charts:[x({namespace:t})],key:"GPU memory",optional:!0},{charts:[j({namespace:t})],key:"Received bytes"},{charts:[C({namespace:t})],key:"Transmitted bytes"},{charts:[I({namespace:t})],key:"Disk write",optional:!0},{charts:[P({namespace:t})],key:"Disk read",optional:!0}];case"":case"kubernetes":default:return function(e){var t=e.namespace;return[{charts:[m({namespace:t})],key:"CPU"},{charts:[h({namespace:t})],key:"Memory"},{charts:[y({namespace:t})],key:"GPU",optional:!0},{charts:[b({namespace:t})],key:"GPU Memory",optional:!0},{charts:[g({namespace:t})],key:"Received bytes"},{charts:[v({namespace:t})],key:"Transmitted bytes"},{charts:[w({namespace:t})],key:"Disk write",optional:!0},{charts:[k({namespace:t})],key:"Disk read",optional:!0}]}(r)}},href:"workload-resources",id:"workload-resources",name:"Workload resources"};t.a=T},1375:function(e,t,n){"use strict";var r=n(126),o=n.n(r),a=n(78),i=n.n(a),c=n(77),l=n.n(c),s=n(1289),u=n.n(s),p=n(186),f=n.n(p),d=n(0),m=n.n(d),h=n(22),y=n(13),b=n.n(y),g=n(9),v=n(1),w=n(57),k=n.n(w),_=n(2),O=n(55),E=n(7),S=n(17),x=n(1249),j=n(11),C=n(155),I=n(300),P=n(16),T=n(111),R=n(1221),N=n(60),L=n.n(N),D=n(303),q=n(1311),M=n(1279),A=n(127),F=n.n(A),U=n(47),z=n.n(U),W=n(307),B=n(30),K=n(222),Q=n.n(K),H=n(8);function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(n,!0).forEach(function(t){ee(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function te(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var ne=Object(W.format)(",.3f");function re(e){return e.map(function(e){return J({},(r=e.metric,o=r.__name__||"",a=z()(r,"__name__"),{key:[o].concat(te(Object.keys(a).map(function(e){return[e,a[e]].join()}))).join(),labels:a,name:o}),{value:(t=e.value[1],n=parseFloat(t),Number.isNaN(n)?null:n)});var t,n,r,o,a})}function oe(e,t){return Q()("prom-table-row",{"prom-table-row-max":e.value&&t&&e.value===t,"prom-table-row-null":!e.value})}var ae=v.default.span.withConfig({displayName:"prom-table__LabelKey",componentId:"sc-1u3adnv-0"})(["color:",";"],function(e){return e.theme.colors.purple400}),ie=function(e){function t(e,n){var r,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=Y(t).call(this,e,n),r=!a||"object"!==G(a)&&"function"!=typeof a?Z(o):a,ee(Z(r),"handleResponse",function(e,t,n){var o=new Date-n,a=e.data.result&&e.data.result.length>0;if(r.props.onReceiveQuery&&r.props.onReceiveQuery({dataReceived:a,end:t.end},o),"vector"!==e.data.resultType)r.setError("Result is not of vector type! Please enter a correct expression.");else if(e.data.result&&0===e.data.result.length)r.setError("No datapoints found. Maybe the metric does not exist?");else{var i=r.props.query.search(/sort\(|sort_desc\(/)>-1,c=re(e.data.result),l=i?c:F()(c,function(e){return e.value}).reverse(),s=Object(B.e)(l,function(e){return e.value}),u=Object(B.g)(l,function(e){return e.value}),p=Object(B.f)(l,function(e){return e.value}),f=Object(B.d)(l,function(e){return e.value}),d=Object(B.m)(l,function(e){return e.value}),m=l.length,h=Object.keys(l.reduce(function(e,t){return J({},e,{},t.labels)},{})).sort();r.setState({columns:h,count:m,data:l,deviation:f,max:s,mean:p,min:u,variance:d})}}),ee(Z(r),"handleClickLabel",function(e,t,n){r.props.onClickLabel&&r.props.onClickLabel(e,t,n)}),ee(Z(r),"getRef",function(e){r.wrapper=e}),r.state={data:[]},r}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}(t,m.a.Component),n=t,(r=[{key:"setError",value:function(e){this.setState({data:[]}),this.props.onReceiveError&&this.props.onReceiveError(e)}},{key:"fetchData",value:function(e){var t=this,n=new Date,r={end:e.end||new Date/1e3,query:e.query};this.props.onRequestQuery&&this.props.onRequestQuery(),Object(H.W)(e.instanceId,r).then(function(e){return t.handleResponse(e,r,n)},function(e){var n=e.errors;return t.setError(n[0].message)})}},{key:"componentWillReceiveProps",value:function(e){e.query===this.props.query&&e.end===this.props.end&&e.executeQueryUUID===this.props.executeQueryUUID||this.fetchData(e)}},{key:"componentDidMount",value:function(){this.fetchData(this.props)}},{key:"renderSummary",value:function(){if(void 0===this.state.max)return"Metric";var e=this.state,t=e.count,n=e.deviation,r=e.max,o=e.mean,a=e.min,i=e.variance;return"Summary: count ".concat(t,", min ").concat(ne(a),", mean ").concat(ne(o),", max ").concat(ne(r),", stdev ").concat(ne(n),", variance ").concat(ne(i))}},{key:"render",value:function(){var e=this,t=this.state.columns;return m.a.createElement("table",{ref:this.getRef,className:"prom-table",style:{width:"calc(100vw - 395px)"}},m.a.createElement("thead",{className:"prom-table-header"},m.a.createElement("tr",null,t&&t.map(function(e){return m.a.createElement("td",{key:e,title:e,className:"prom-table-header-cell"},m.a.createElement(ae,null,e))}),m.a.createElement("td",{className:"prom-table-header-cell",title:this.renderSummary()},"Value"))),m.a.createElement("tbody",{className:"prom-table-body"},this.state.data.map(function(n){return m.a.createElement("tr",{className:oe(n,e.state.max),key:n.key},t.map(function(t){return function(e,t,n){if(!t.labels||!t.labels[e])return m.a.createElement("td",{key:e});var r=t.labels[e];return m.a.createElement("td",{title:"".concat(r," (Click to filter by this ").concat(e,")"),className:t.name?"prom-table-cell prom-table-cell-filterable":"prom-table-cell",onClick:t.name?function(){return n(t.name,e,r)}:null,key:e},r)}(t,n,e.handleClickLabel)}),m.a.createElement("td",{className:"prom-table-cell prom-table-cell-value"},n.value?ne(n.value):n.value))})))}}])&&V(n.prototype,r),o&&V(n,o),t}();var ce="graph",le="table",se="text";function ue(e){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fe(e){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function de(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function me(e,t){return(me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function he(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ye=k()("service:prom-notebook-entry"),be=v.default.div.withConfig({displayName:"prom-notebook-entry__QueryLine",componentId:"sc-1s6chiq-0"})(["display:flex;align-items:flex-start;"]),ge=v.default.div.withConfig({displayName:"prom-notebook-entry__QueryField",componentId:"sc-1s6chiq-1"})(["flex:1;overflow:hidden;"]),ve=v.default.div.withConfig({displayName:"prom-notebook-entry__SideIconContainer",componentId:"sc-1s6chiq-2"})(["margin-left:8px;width:20px;"]),we=v.default.span.withConfig({displayName:"prom-notebook-entry__SideIconRemove",componentId:"sc-1s6chiq-3"})(["cursor:pointer;height:18px;padding:5px;"]),ke=v.default.div.withConfig({displayName:"prom-notebook-entry__Hints",componentId:"sc-1s6chiq-4"})(["display:flex;justify-content:flex-end;margin:10px 60px 20px 0px;font-size:",";"],function(e){return e.theme.fontSizes.tiny}),_e=v.default.div.withConfig({displayName:"prom-notebook-entry__Hint",componentId:"sc-1s6chiq-5"})(["display:flex;align-items:center;position:relative;margin-left:12px;"]),Oe=v.default.span.withConfig({displayName:"prom-notebook-entry__HintLabel",componentId:"sc-1s6chiq-6"})(["color:",";"],function(e){return e.theme.colors.blue700}),Ee=v.default.div.withConfig({displayName:"prom-notebook-entry__HintButton",componentId:"sc-1s6chiq-7"})(["margin-right:4px;padding:2px 4px;color:",";cursor:pointer;border:1px solid ",";border-radius:",";"],function(e){return e.theme.colors.blue700},function(e){return e.theme.colors.blue700},function(e){return e.theme.borderRadius.soft}),Se=Object(v.default)(Ee).withConfig({displayName:"prom-notebook-entry__HintButtonReorder",componentId:"sc-1s6chiq-8"})(["display:inline-block;margin-left:4px;"]),xe=v.default.div.withConfig({displayName:"prom-notebook-entry__HintShortcut",componentId:"sc-1s6chiq-9"})(["color:",";"],function(e){return e.theme.colors.purple200}),je=v.default.span.withConfig({displayName:"prom-notebook-entry__LinkIcon",componentId:"sc-1s6chiq-10"})([""]),Ce=function(e){return e.shiftKey&&(e.metaKey||e.ctrlKey)&&("J"===e.key||"K"===e.key)},Ie=function(e){return e.shiftKey&&(e.metaKey||e.ctrlKey)&&"D"===e.key};function Pe(e){return e.type?e.type:e.rawContentState?se:e.queryRange?ce:le}function Te(e){return!!(e&&e.indexOf(";")>0)}var Re=function(e){function t(e,n){var r,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=fe(t).call(this,e,n),r=!a||"object"!==ue(a)&&"function"!=typeof a?de(o):a,he(de(r),"entryRef",void 0),he(de(r),"handleChange",function(e){var t=r.state.query||r.props.query,n=!!e&&t!==e;if(r.setState({query:e}),r.state.edited!==n){var o=Pe({queryRange:r.state.queryRange,rawContentState:r.state.rawContentState,type:r.state.entryType});r.setState({edited:n,entryType:o}),r.props.onEntryChange({id:r.props.id,query:e,rawContentState:e},!0)}r.setState({multiQuery:Te(e)})}),he(de(r),"handleKeyDown",function(e){return"Enter"===e.key?(r.handleSubmit(e),{change:!1}):(Ce(e)&&(e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),r.handleReorder("K"===e.key?"up":"down")),Ie(e)&&(e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),r.handleKeyPressRemove()),{})}),he(de(r),"handleReorder",function(e){r.props.onReorder(e),setTimeout(function(){if(r.entryRef){var e=window.innerHeight,t=r.entryRef.getBoundingClientRect(),n=t.top;t.bottom>e?r.entryRef&&r.entryRef.scrollIntoView(!1):n<0&&r.entryRef&&r.entryRef.scrollIntoView(!0)}},0)}),he(de(r),"handleBlur",function(){r.setState({evaluatedQuery:r.state.query})}),he(de(r),"handleFocus",function(){r.props.onFocus(r.props.id)}),he(de(r),"handleSubmit",function(e){if(e.preventDefault(),r.props.type!==se)if(r.state.multiQuery)r.handleSubmitGraph();else{if(e.altKey)return r.handleSubmitTable(),void r.setState({defaultReturn:le});if(e.ctrlKey)return r.handleSubmitGraph(),void r.setState({defaultReturn:ce});r.state.defaultReturn!==le?r.handleSubmitGraph():r.handleSubmitTable()}else r.executeQuery(null)}),he(de(r),"handleSubmitGraph",function(){r.executeQuery(null,ce),Object(E.trackEvent)("prom.notebook.entry.run",{action:"click",queryType:"graph"})}),he(de(r),"handleSubmitTable",function(){r.executeQuery(null,le),Object(E.trackEvent)("prom.notebook.entry.run",{action:"click",queryType:"table"})}),he(de(r),"executeQuery",function(e,t){var n=Object(S.k)(),o=e||r.state.query,a=t||r.state.entryType;ye("Executing query",o),r.setState({edited:!1,entryType:a,error:null,evaluatedQuery:o,executeQueryUUID:n,query:o}),r.props.onEntryChange({id:r.props.id,query:o,type:a},!0)}),he(de(r),"handleClickMetricLabel",function(e,t,n){var o=r.state.query||r.props.query,a=function(e,t,n,r){if(!t||!n||!r)return e;for(var o,a,i=/[a-zA-Z_:]/,c=/[a-zA-Z0-9_:]/,l=-1;l<e.length&&-1!==(l=e.indexOf(t,l+1));){var s=e[l+t.length];i.test(e[l-1]||"")||c.test(s||"")||("{"===s?(o=e.substring(0,l+t.length+1),a=e.substring(l+t.length+1),e="".concat(o).concat(n,'="').concat(r,'",').concat(a)):(o=e.substring(0,l+t.length),a=e.substring(l+t.length),e="".concat(o,"{").concat(n,'="').concat(r,'"}').concat(a)))}return e}(o,e,t,n);r.setState({query:o}),r.executeQuery(a),Object(E.trackEvent)("prom.notebook.entry.table.label.click")}),he(de(r),"handleEntryTextChange",function(e,t){var n,o=(n=e)&&n.length>5&&-1!==n.indexOf(" ")&&-1===n.indexOf("(")&&/[A-Z]/.test(n[0]);return o&&t&&r.props.onEntryChange({id:r.props.id,rawContentState:t},!0),o}),he(de(r),"handleReceiveQuery",function(e,t){var n=r.state,o=n.query,a=n.queryRange,i=n.entryType,c=e.end;r.setState({dataReceived:!0,error:null,latency:t,loading:!1});var l={error:null,id:r.props.id,query:o,queryEnd:c,queryRange:a,type:i};r.props.onEntryChange(l)}),he(de(r),"handleReceiveError",function(e){r.setState({error:e,loading:!1}),r.props.onEntryChange({error:e,id:r.props.id})}),he(de(r),"handleRequestQuery",function(){r.setState({latency:null,loading:!0})}),he(de(r),"handleClickLink",function(){r.setState({showLink:!r.state.showLink})}),he(de(r),"handleClickRemove",function(){r.props.id&&r.props.onRemoveQuery&&r.props.onRemoveQuery(r.props.id),Object(E.trackEvent)("prom.notebook.entry.remove.click")}),he(de(r),"handleKeyPressRemove",function(){r.props.id&&r.props.onRemoveQuery&&r.props.onRemoveQuery(r.props.id),Object(E.trackEvent)("prom.notebook.entry.remove.keypress")}),he(de(r),"getLinkToQuery",function(){var e=r.props,t=e.instanceId,n=e.sharedQueryParams,o=Object(j.P)(n,t,[r.state.query]);return"".concat(window.location.protocol,"//").concat(window.location.host).concat(o)}),he(de(r),"saveEntryRef",function(e){e&&(r.entryRef=e)}),r.state={defaultReturn:ce,edited:!1,entryType:Pe(e),error:null,evaluatedQuery:r.props.query||"",loading:!1,multiQuery:Te(e.query),query:r.props.query||"",showLink:!1},r}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&me(e,t)}(t,m.a.Component),n=t,(r=[{key:"componentWillReceiveProps",value:function(e){e.type&&e.type!==this.state.entryType&&this.setState({entryType:e.type})}},{key:"shouldComponentUpdate",value:function(e,t){return!L()(this.props,e)||!L()(this.state,t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.history,r=t.isFirst,o=t.isLast,a=t.labelSets,i=t.metricNames,c=t.number,l=t.instanceId,s=t.readOnly,u=t.queryEnd,p=t.queryRange,f=t.trailingNow,d=this.state,h=d.dataReceived,y=d.defaultReturn,b=d.edited,v=d.error,w=d.evaluatedQuery,k=d.executeQueryUUID,_=d.multiQuery,O=d.latency,E=d.loading,S=d.showLink,x=d.entryType,j=x===se,C=!b&&v&&!j,I=r&&o,P=this.state.query||this.props.query,T=P&&x===ce,R=P&&x===le,N=y===ce||_,L=j?[]:n.map(function(e){return"string"==typeof e?e:e.query}),A=v&&P?m.a.createElement("span",{style:{marginRight:4},className:"fas fa-exclamation-triangle"}):"",F=O?"".concat(O,"ms"):"Unknown",U=E?"Query running...":"Query took: ".concat(F),z=m.a.createElement(_e,null,m.a.createElement(Oe,null,"Move",m.a.createElement(Se,{onClick:function(){return e.handleReorder("up")},title:"Move this notebook entry up one position"},"up"),"/",m.a.createElement(Se,{onClick:function(){return e.handleReorder("down")},title:"Move this notebook entry down one position"},"down")),m.a.createElement(xe,null,"Ctrl+Shift+j/k"));return m.a.createElement("div",{className:"prom-notebook-entry",ref:this.saveEntryRef},m.a.createElement(be,null,m.a.createElement("a",{href:"#".concat(c),id:c,className:"prom-notebook-entry-number"},m.a.createElement("span",{className:"prom-notebook-entry-number-anchor"},"#"),c),m.a.createElement(ge,null,m.a.createElement(q.a,{readOnly:s,id:c,autoFocus:this.props.isFocused,onChange:this.handleChange,value:this.state.query,metricNames:i,language:x===se?"markdown":"promql",showLineNumbers:!1,onKeyDown:this.handleKeyDown,onBlur:this.handleBlur,onFocus:this.handleFocus,intellisenseEnabled:x!==se,isNotebook:!0,wrapLines:!0,placeholder:x===se?"Enter markdown":"Enter a PromQL query",history:L,labelSets:a,instanceId:l,key:x})),m.a.createElement(ve,null,E?m.a.createElement(g.CircularProgress,{size:"small"}):!I&&!s&&m.a.createElement(we,{onClick:this.handleClickRemove,title:"Remove this entry (Ctrl+Shift+d)",className:"fas fa-times"}))),j&&!s&&m.a.createElement(ke,null,z),!j&&m.a.createElement(ke,null,!v&&!j&&P&&m.a.createElement("div",{className:"prom-notebook-entry-status"},h&&m.a.createElement("span",null,U)),!s&&z,m.a.createElement(_e,null,m.a.createElement(Ee,{onClick:this.handleSubmitGraph},"Run as Graph"),m.a.createElement(xe,null,N&&"Return /"," Ctrl+Return")),!_&&m.a.createElement(_e,null,m.a.createElement(Ee,{onClick:this.handleSubmitTable},"Run as Table"),m.a.createElement(xe,null,!N&&"Return /"," Alt+Return")),m.a.createElement(_e,null,m.a.createElement(Ee,{title:"Show link to query",onClick:this.handleClickLink},m.a.createElement(je,{className:"fa fa-link"})),S&&m.a.createElement("div",{className:"prom-notebook-entry-link"},m.a.createElement(D.a,null,this.getLinkToQuery())))),C&&m.a.createElement("div",{className:"prom-notebook-entry-error"},A,v),!j&&R&&m.a.createElement("div",{style:{display:v?"none":"flex"}},m.a.createElement("div",{style:{flex:1,padding:"0 32px"}},m.a.createElement(ie,{query:w,instanceId:l,end:f?null:u,executeQueryUUID:k,onClickLabel:this.handleClickMetricLabel,onReceiveQuery:this.handleReceiveQuery,onReceiveError:this.handleReceiveError,onRequestQuery:this.handleRequestQuery}))),!j&&T&&m.a.createElement("div",{style:{display:v?"none":"flex"}},m.a.createElement("div",{style:{flex:1}},m.a.createElement(M.a,{query:w,instanceId:l,range:p,end:u,executeQueryUUID:k,onReceiveQuery:this.handleReceiveQuery,onReceiveError:this.handleReceiveError,onRequestQuery:this.handleRequestQuery}))))}}])&&pe(n.prototype,r),o&&pe(n,o),t}();var Ne=Object(h.connect)(function(e){return{sharedQueryParams:Object(T.b)(e)}})(Re),Le=n(18),De=n.n(Le),qe=[{description:"This notebook has a collection of queries that require the Prometheus Node Exporter to be installed in your infrastructure.",label:"Node resources",prefix:"node",queries:[{depends:["node_cpu"],label:"CPU usage in % by mode",query:'sum by (mode) (irate(node_cpu{mode!="idle"}[2m]))'},{depends:["node_disk_io_time_ms"],label:"Disk IO (% time spent) by device",query:"irate(node_disk_io_time_ms[2m]) / 1000 * 100"},{depends:["node_memory_MemFree","node_memory_Buffers","node_memory_Cached"],label:"Free memory in bytes",query:"node_memory_MemFree + node_memory_Buffers + node_memory_Cached"},{depends:["node_network_receive_bytes"],label:"Network received bytes/s by device",query:'irate(node_network_receive_bytes{device!="lo"}[2m])'},{depends:["node_filesystem_avail","node_filesystem_size"],label:"Filesystem fullness in % by filesystem",query:"100 - (node_filesystem_avail / node_filesystem_size * 100)"}]},{description:"This notebook has a collection of queries that require the Kubernetes Exporter to be installed in your infrastructure.",label:"Kubernetes",prefix:"container",queries:[{depends:["container_cpu_user_seconds_total","container_cpu_system_seconds_total"],label:"CPU usage in % by pod",query:'sum by(instance, pod_name) (rate(container_cpu_user_seconds_total{pod_name!=""}[1m])) + sum by(instance, pod_name) (rate(container_cpu_system_seconds_total{pod_name!=""}[1m]))'},{depends:["container_cpu_user_seconds_total","container_cpu_system_seconds_total"],label:"CPU usage in % of pods by namespace",query:'sum by(namespace) (rate(container_cpu_user_seconds_total{pod_name!=""}[1m])) + sum by(namespace) (rate(container_cpu_system_seconds_total{pod_name!=""}[1m]))'},{depends:["container_memory_rss"],label:"Memory usage by pod",query:'sum by(instance, pod_name) (container_memory_rss{pod_name!=""})'}]},{description:"This notebook has a collection of queries that require the Weave Net Exporter to be installed in your infrastructure.",label:"Weave Net",prefix:"weave",queries:[{depends:["weave_ips","weave_max_ips"],label:"IP address space exhaustion in %",query:'sum without(instance, state) (weave_ips{state="local-used"}) / max without(instance) (weave_max_ips) * 100'},{depends:["weave_dns_entries"],label:"Number of local DNS entries per each host",query:'weave_dns_entries{state="local"}'},{depends:["weave_connection_terminations_total"],label:"Connection termination rate per second",query:"sum without(instance) (rate(weave_connection_terminations_total[2m]))"},{depends:["weavenpc_blocked_connections_total"],label:"Number of blocked connections per transport-layer protocol",query:"sum by(protocol, job) (weavenpc_blocked_connections_total)"},{depends:["weavenpc_blocked_connections_total"],label:"Frequent protocol-dport combinations of blocked connections",query:"topk(10, sum by(job, protocol, dport) (weavenpc_blocked_connections_total))"}]}];function Me(e){return(Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fe(e){return(Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ze(e,t){return(ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var We=function(e){function t(){var e,n,r,o,a,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return r=this,o=(e=Fe(t)).call.apply(e,[this].concat(s)),n=!o||"object"!==Me(o)&&"function"!=typeof o?Ue(r):o,a=Ue(n),c=function(){n.props.onClickPrefix(n.props.prefix)},(i="handleClickPrefix")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ze(e,t)}(t,m.a.Component),n=t,(r=[{key:"render",value:function(){return m.a.createElement("span",{className:"prom-metric-browser-prefix",rel:this.props.prefix,onClick:this.handleClickPrefix},m.a.createElement("span",{className:"query"},this.props.prefix)," [",this.props.count,"]")}}])&&Ae(n.prototype,r),o&&Ae(n,o),t}();function Be(e){return(Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qe(e){return(Qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function He(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ge(e,t){return(Ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ve(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Ye="_";var Ze=function(e){function t(){var e,n,r,o,a,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return r=this,o=(e=Qe(t)).call.apply(e,[this].concat(s)),n=!o||"object"!==Be(o)&&"function"!=typeof o?He(r):o,a=He(n),c=function(e){n.props.onClickMetricPrefix(e)},(i="handleClickPrefix")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ge(e,t)}(t,m.a.Component),n=t,(r=[{key:"render",value:function(){var e=this,t=this.props,n=t.metrics,r=t.prefixes,o=t.onClickClearPrefix,a=function(e,t){var n=e;t&&(n=n.filter(function(e){return 0===e.indexOf(t)}).map(function(e){return e.substr(t.length+1)}));var r={};return n.forEach(function(e){var t=e.split(Ye)[0];t&&(r[t]||(r[t]=[]),r[t]=[].concat(Ve(r[t]),[e]))}),r}(n,r.join(Ye)),i={close:{borderLeft:"1px solid ".concat(De.a.colors.purple200),cursor:"pointer",padding:2},container:{},prefix:{padding:"1px 2px"},prefixes:{color:De.a.colors.purple400,fontSize:"1em",marginBottom:4,marginTop:4},prefixWrapper:{border:"1px solid ".concat(De.a.colors.purple200),borderRadius:2}};return m.a.createElement("div",{style:i.container},m.a.createElement("div",{style:i.prefixes},0===r.length&&"Prefixes",r.length>0&&r.map(function(e,t){return m.a.createElement("span",null,m.a.createElement("span",{style:i.prefixWrapper},m.a.createElement("span",{style:i.prefix},e),m.a.createElement("span",{className:"fas fa-times",style:i.close,title:e,onClick:o})),t<r.length-1&&Ye)})),m.a.createElement("div",null,Object.keys(a).map(function(t,n,r){return m.a.createElement("span",{key:t},m.a.createElement(We,{prefix:t,count:a[t].length,onClickPrefix:e.handleClickPrefix}),n<r.length-1&&", ")})))}}])&&Ke(n.prototype,r),o&&Ke(n,o),t}(),Xe=n(125);function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function et(e,t){return!t||"object"!==$e(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tt(e){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nt(e,t){return(nt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),et(this,tt(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nt(e,t)}(t,m.a.Component),n=t,(r=[{key:"renderQuery",value:function(e,t){var n=e.depends,r=e.label,o=e.query,a=this.props,i=a.metricNames,c=a.onClickQuery,l={query:{cursor:"pointer",fontSize:"1em",paddingBottom:4,textDecoration:"underline"},unavailableQuery:{opacity:.33,overflow:"hidden",paddingBottom:4,textOverflow:"ellipsis",whiteSpace:"nowrap"}};if(!Object(Xe.b)(i,n)){var s="".concat(r," (not available; depends on ").concat(n.join(", "),")");return m.a.createElement("div",{style:l.unavailableQuery,title:s,key:r},r)}return m.a.createElement("div",{style:l.query,onClick:c,title:o,key:o,"data-prefix":t},r)}},{key:"render",value:function(){var e=this,t=this.props,n=t.label,r=t.prefix,o=t.queries,a={category:{marginRight:16},label:{color:De.a.colors.purple400,fontSize:"1em",marginBottom:4,marginTop:4}};return m.a.createElement("div",{style:a.category},m.a.createElement("div",{style:a.label},n),o.map(function(t){return e.renderQuery(t,r)}))}}])&&Je(n.prototype,r),o&&Je(n,o),t}();function ot(e){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function at(){return(at=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function it(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lt(e){return(lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function st(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ut(e,t){return(ut=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ft="prom-help-collapsed",dt=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=lt(t).call(this,e),n=!o||"object"!==ot(o)&&"function"!=typeof o?st(r):o,pt(st(n),"handleClickSystemQuery",function(e){e.preventDefault();var t=e.target.title,r=e.target.dataset.prefix;n.props.onSetSystemQuery&&n.props.onSetSystemQuery(t),Object(E.trackEvent)("prom.systemqueries.click",{category:r,query:t})}),pt(st(n),"handleClickMetricPrefix",function(e){var t=n.state.metricPrefixes;t=[].concat(it(t),[e]),n.setState({metricPrefixes:t});var r=t.join(Ye);n.props.onSetMetricPrefix&&n.props.onSetMetricPrefix(r),Object(E.trackEvent)("prom.metricsbrowser.prefix.click",{fullPrefix:r,prefix:e})}),pt(st(n),"handleClickClearPrefix",function(e){var t=e.target.title,r=n.state.metricPrefixes.indexOf(t),o=n.state.metricPrefixes.slice(0,r);n.setState({metricPrefixes:o})}),pt(st(n),"handleClickTestQuery",function(e){e.preventDefault(),n.props.onSetSystemQuery&&n.props.onSetSystemQuery("sum(up) by (job)"),Object(E.trackEvent)("prom.help.testquery.click")}),pt(st(n),"handleClickHide",function(){var e=!n.state.collapsed;Object(O.storageSetObject)(ft,e),n.setState({collapsed:e})}),n.state={collapsed:Object(O.storageGetObject)(ft,!1),metricPrefixes:[],systemQueries:qe},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ut(e,t)}(t,m.a.Component),n=t,(r=[{key:"render",value:function(){var e=this,t=this.props.metricNames,n=void 0===t?[]:t,r=this.state.collapsed,o={categories:{display:"flex"},heading:{color:De.a.colors.purple300,fontSize:"0.8em",marginBottom:4,marginTop:16},listItem:{lineHeight:1.5,listStyleType:"disc"}};return r?m.a.createElement("div",{className:"prom-help-collapsed"},m.a.createElement("div",{className:"prom-help-collapsed-toggle",onClick:this.handleClickHide},"Show Help")):m.a.createElement("div",{className:"prom-help"},m.a.createElement("h3",null,"This is a Prometheus notebook"),m.a.createElement("p",null,"Monitoring is powered by Prometheus. You can create graphs and tables of your time series by entering PromQL queries."),m.a.createElement("ul",null,m.a.createElement("li",{style:o.listItem},"Enter a query in the field above and then Return to display the results as a graph or Alt+Return to show the latest values in a table."),m.a.createElement("li",{style:o.listItem},"You can add multiple queries to one notebook and save it. This is helpful when documenting an incident."),m.a.createElement("li",{style:o.listItem},"Try running a test query"," ",m.a.createElement("a",{style:{textDecoration:"underline"},className:"query",onClick:this.handleClickTestQuery},"sum(up) by (job)")),m.a.createElement("li",{style:o.listItem},"Or use the metric explorer below to find a metric.")),m.a.createElement("div",{style:o.heading},"Detected metric names"),m.a.createElement(Ze,{onClickClearPrefix:this.handleClickClearPrefix,onClickMetricPrefix:this.handleClickMetricPrefix,metrics:n,prefixes:this.state.metricPrefixes}),m.a.createElement("div",{style:o.heading},"Prometheus system queries"),m.a.createElement("div",{style:o.categories},this.state.systemQueries.map(function(t){return m.a.createElement(rt,at({key:t.prefix,metricNames:n,onClickQuery:e.handleClickSystemQuery},t))})),m.a.createElement("div",{className:"prom-help-toggle-wrapper"},m.a.createElement("div",{className:"prom-help-toggle",onClick:this.handleClickHide},"Hide help")))}}])&&ct(n.prototype,r),o&&ct(n,o),t}();var mt=Object(h.connect)(function(e,t){var n=(e.root.prometheus[t.instanceId]||{}).metricNames;return{metricNames:void 0===n?[]:n}})(dt);function ht(e){return(ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yt(){return(yt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function bt(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bt(n,!0).forEach(function(t){Ot(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wt(e){return(wt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _t(e,t){return(_t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Et(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n.d(t,"a",function(){return xt});var St=9,xt=";",jt=k()("service:prom-notebook"),Ct=v.default.div.withConfig({displayName:"prom-notebook__NotebookContainer",componentId:"sc-1md4pqc-0"})(["margin:15px 20px;"]),It=v.default.div.withConfig({displayName:"prom-notebook__Header",componentId:"sc-1md4pqc-1"})(["margin:16px 32px;"]),Pt=v.default.div.withConfig({displayName:"prom-notebook__TitleContainer",componentId:"sc-1md4pqc-2"})(["height:40px;display:flex;align-items:flex-start;position:relative;"]),Tt=v.default.input.withConfig({displayName:"prom-notebook__TitleInput",componentId:"sc-1md4pqc-3"})(["border:none;background-color:inherit;border-bottom:1px dotted ",";font-size:",";color:",";outline:none;transition:all 1000ms;width:calc(100% - 128px);margin-right:16px;position:relative;top:7px;&:focus{color:",";border-bottom-style:solid;border-bottom-color:",";}"],function(e){return e.theme.colors.purple100},function(e){return e.theme.fontSizes.large},function(e){return e.theme.colors.purple400},function(e){return e.theme.colors.purple600},function(e){return e.theme.colors.purple400}),Rt=v.default.div.withConfig({displayName:"prom-notebook__Description",componentId:"sc-1md4pqc-4"})(["font-size:",";color:",";margin:16px 0;"],function(e){return e.theme.fontSizes.small},function(e){return e.theme.colors.purple600}),Nt=v.default.div.withConfig({displayName:"prom-notebook__StatusContainer",componentId:"sc-1md4pqc-5"})(["color:",";font-size:",";margin-top:8px;display:flex;"],function(e){return e.theme.colors.purple600},function(e){return e.theme.fontSizes.tiny}),Lt=v.default.span.withConfig({displayName:"prom-notebook__StatusLabel",componentId:"sc-1md4pqc-6"})(["color:",";"],function(e){return e.theme.colors.purple400}),Dt=v.default.span.withConfig({displayName:"prom-notebook__StatusSpacing",componentId:"sc-1md4pqc-7"})(["margin:0 1em;"]),qt=v.default.span.withConfig({displayName:"prom-notebook__RemoveButton",componentId:"sc-1md4pqc-8"})(["cursor:pointer;text-decoration:underline;color:",";&:hover{color:",";}"],function(e){return e.theme.colors.purple400},function(e){return e.theme.colors.purple600}),Mt=v.default.div.withConfig({displayName:"prom-notebook__AddEntryOptions",componentId:"sc-1md4pqc-9"})(["margin-top:32px;margin-left:32px;margin-bottom:64px;"]),At=Object(v.default)(g.Button).withConfig({displayName:"prom-notebook__AddEntryButton",componentId:"sc-1md4pqc-10"})(["margin-right:16px;",";"],function(e){return e.primary&&"\n    font-weight: bold;\n  "}),Ft=v.default.i.withConfig({displayName:"prom-notebook__AddEntryIcon",componentId:"sc-1md4pqc-11"})(["margin-right:4px;"]),Ut=Object(v.default)(g.Button).withConfig({displayName:"prom-notebook__SaveButton",componentId:"sc-1md4pqc-12"})(["font-weight:bold;"]);function zt(e,t){var n=t;if(e){var r=n.findIndex(function(t){return t.query===e.query||t===e.query});r>-1&&(n=[].concat(Et(n.slice(0,r)),Et(n.slice(r+1)))),n=[e].concat(Et(n)).slice(0,St),Object(O.storageSetObject)(P.PROM_HISTORY_KEY,n)}return n}var Wt=function(e){return function(t,n){var r=n+e;if(r<0||r>t.length)return t;var o=Et(t),a=o[n];return o.splice(n,1),o.splice(r,0,a),o}},Bt=Wt(-1),Kt=Wt(1),Qt=function(e){return e&&e.length>0?e[0].id:void 0},Ht=function(e){function t(e,n){var r,a,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,c=wt(t).call(this,e,n),r=!c||"object"!==ht(c)&&"function"!=typeof c?kt(a):c,Ot(kt(r),"notebookId",void 0),Ot(kt(r),"handleClearQueryHistory",function(){Object(O.storageSetObject)(P.PROM_HISTORY_KEY,[]),r.setState({history:[]}),Object(E.trackEvent)("prom.notebook.clearhistory.click")}),Ot(kt(r),"updateTimeRange",function(e){if(r.updateNotebook(e,!1),r.state.entries&&r.state.entries.length>0){var t=gt({},r.state,{},e);r.loadFluxHistory(t)}}),Ot(kt(r),"handleTitleChange",function(e){r.updateNotebook({title:e.target.value})}),Ot(kt(r),"handleTitleKeyDown",function(e){var t=Boolean(r.state.title);13===e.keyCode&&t&&(e.target.blur(),Object(E.trackEvent)("prom.notebook.save",{action:"keypress",withTitle:t}))}),Ot(kt(r),"handleTitleClickSave",function(){var e=Boolean(r.state.title);if(e)r.saveNotebook();else{var t=Object(x.a)(new Date);r.saveNotebook(gt({},r.state,{title:t}))}var n=r.state.system;Object(E.trackEvent)("prom.notebook.save",{action:"click",isSystem:n,withTitle:e})}),Ot(kt(r),"handleRemoveNotebook",function(){window.confirm("Do you really want to remove this notebook?")&&(r.props.deletePrometheusNotebook(r.props.instanceId,r.props.id),b.a.replace(Object(j.P)(r.props.sharedQueryParams,r.props.instanceId))),Object(E.trackEvent)("prom.notebook.remove.click")}),Ot(kt(r),"handleEntryChange",function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];jt("saving entry",e);var n=r.upsertEntry(e),a={entries:n,history:[]};!e.rawContentState&&e.query&&(a.history=zt(o()(e,["query","mode"]),r.state.history)),r.updateNotebook(a,t)}),Ot(kt(r),"handleRemoveQuery",function(e){var t={entries:r.state.entries.filter(function(t){return t.id!==e})};r.updateNotebook(t)}),Ot(kt(r),"onReorder",function(e){return function(t){var n=r.state.entries,o="up"===t?Bt(n,e):Kt(n,e);r.setState({changed:!0,entries:o})}}),Ot(kt(r),"handleFocus",function(e){e!==r.state.focusedEntryId&&r.setState({focusedEntryId:e})}),Ot(kt(r),"handleSetMetricPrefix",function(e){var t=r.state.entries;i()(t)>0&&l()(t).type!==se?r.updateLastEntry(e):r.appendNewEntry(ce,e)}),Ot(kt(r),"handleSetSystemQuery",function(e){r.appendNewEntry(ce,e)}),Ot(kt(r),"handleAddNewQuery",function(){r.appendNewEntry(ce,"")}),Ot(kt(r),"handleAddNewText",function(){r.appendNewEntry(se,"")}),Ot(kt(r),"updateLastEntry",function(e){r.setState({changed:!0,entries:[].concat(Et(u()(r.state.entries)),[gt({},l()(r.state.entries),{id:Object(S.k)(),query:e})])})}),Ot(kt(r),"appendNewEntry",function(e,t){var n=Object(S.k)();r.setState({changed:!0,entries:[].concat(Et(r.state.entries),[{id:n,query:t,type:e}]),focusedEntryId:n})});var s=e.entries||[{id:Object(S.k)(),type:ce}];return r.state={changed:!1,entries:s,focusedEntryId:Qt(s),history:Object(O.storageGetObject)(P.PROM_HISTORY_KEY,[]),system:e.system,title:e.title||""},r.notebookId=null,r}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_t(e,t)}(t,m.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=!!this.props.params.deeplink,t=this.props.entries?this.props.entries.length:0;Object(E.trackMixpanelOnlyEvent)("prom.notebook.view",{cellCount:t,deepLink:e}),this.props.updateTimeStateFromUrl(this.props.location),this.loadFluxHistory(gt({},this.props))}},{key:"componentWillReceiveProps",value:function(e){e.location.search!==this.props.location.search&&this.props.updateTimeStateFromUrl(e.location);var t="new"===e.params.notebookId;if(e.id&&this.props.id!==e.id||e.params.notebookId!==this.props.params.notebookId){t&&(jt("clearing notebook"),this.notebookId=null);var n=e.entries?e.entries:[],r=t?[{id:Object(S.k)(),type:ce}]:Et(n),o=t?"":e.title,a=e.system,c={changed:!1,entries:r,focusedEntryId:Qt(r),system:a,title:o};this.setState(c),this.loadFluxHistory(gt({},e))}else 0===i()(this.state.entries)&&this.setState({entries:e.entries?e.entries:[],focusedEntryId:Qt(e.entries)})}},{key:"loadFluxHistory",value:function(e){var t=e.queryRange,n=e.queryEnd,r=new Date/1e3,o=Object(M.b)(t,n||r),a=o.start,i=o.end;this.props.getFluxHistory(this.props.instanceId,P.FLUX_ALL_WORKLOADS,250,new Date(1e3*i).toISOString(),!0,new Date(1e3*a).toISOString())}},{key:"removeEntry",value:function(e){return this.state.entries.filter(function(t){return t.id!==e})}},{key:"upsertEntry",value:function(e){var t=Et(this.state.entries),n=t.findIndex(function(t){return t.id===e.id});return-1!==n&&(t[n]=gt({},t[n],{},e)),t}},{key:"hasChanged",value:function(){return this.state.changed}},{key:"hasBeenSaved",value:function(){return!this.state.system&&(this.props.id||this.notebookId)}},{key:"updateNotebook",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setState(gt({},e,{changed:t||this.state.changed}))}},{key:"saveNotebook",value:function(e){this.hasBeenSaved()||this.setState({system:!1});var t=this.props.id,n=["title","entries","version"],r=o()(this.props,n),a=o()(e||this.state,n),i=gt({entries:a.entries,id:t,system:!1},r,{},a),c=this.props.instanceId||this.props.params.instanceId;jt("Saving notebook",i.id,i),this.props.savePrometheusNotebook(c,i,this.state.system),this.setState({changed:!1})}},{key:"render",value:function(){var e=this,t=this.state,n=t.history,r=t.system,o=this.props,a=o.description,c=o.createdAt,l=o.createdByEmail,s=o.updatedAt,u=o.updatedByEmail,p=o.error,d=o.metricNames,h=o.labelSets,y=o.entries,b=this.props,v=b.queryEnd,w=b.queryRange,k=b.trailingNow,_=this.state.entries;(!_||1===i()(_)&&!f()(_).query&&y)&&(_=y);var O=this.hasBeenSaved(),E=r?"Duplicate":"Save",S=r?"Create a copy of this system notebook. It will appear under Notebooks in the menu on the left.":"Save this notebook. It will appear under Notebooks in the menu on the left.";return O&&(S="Save this notebook."),this.props.loading?m.a.createElement(C.a,{text:"Loading notebooks..."}):m.a.createElement(Ct,null,m.a.createElement(R.a,{instanceId:this.props.instanceId,location:this.props.location,hasRangeSelector:!0}),p&&m.a.createElement(g.Alert,{type:"error"},p),m.a.createElement(It,null,m.a.createElement(I.a,{permissions:["notebook.update"]},function(t){return m.a.createElement(Pt,null,m.a.createElement(Tt,{disabled:!t,value:e.state.title,placeholder:"New notebook",onChange:e.handleTitleChange,onKeyDown:e.handleTitleKeyDown}),(e.state.system||e.hasChanged())&&t&&m.a.createElement("span",{title:S},m.a.createElement(Ut,{primary:!0,text:E,onClick:e.handleTitleClickSave})))}),a&&m.a.createElement(Rt,null,a),O&&m.a.createElement(Nt,null,m.a.createElement("div",null,m.a.createElement(Lt,null,"Created "),m.a.createElement(g.TimestampTag,{inheritStyles:!0,relative:!0,timestamp:c}),m.a.createElement(Lt,null," by "),l||"anonymous"),m.a.createElement(Dt,null,""),m.a.createElement("div",null,m.a.createElement(Lt,null,"Last edited "),m.a.createElement(g.TimestampTag,{inheritStyles:!0,relative:!0,timestamp:s}),m.a.createElement(Lt,null," by "),u||"anonymous"),m.a.createElement(I.a,{permissions:["notebook.delete"]},m.a.createElement(Dt,null,""),m.a.createElement(qt,{title:"Delete this notebook",onClick:this.handleRemoveNotebook},"Remove")))),m.a.createElement(I.a,{permissions:["notebook.update"]},function(t){return _&&_.map(function(r,o,a){return m.a.createElement(Ne,yt({readOnly:!t,key:"".concat(String(e.props.id),":").concat(String(r.id)),history:n,number:o+1,onClearHistory:e.handleClearQueryHistory,onEntryChange:e.handleEntryChange,onRemoveQuery:e.handleRemoveQuery,onReorder:e.onReorder(o),onFocus:e.handleFocus},e.props,r,{queryRange:w,queryEnd:v,trailingNow:k,isFirst:0===o,isLast:o===a.length-1,isFocused:r.id===e.state.focusedEntryId,metricNames:d,labelSets:h}))})}),m.a.createElement(I.a,{permissions:["notebook.update"]},m.a.createElement(Mt,null,m.a.createElement(At,{onClick:this.handleAddNewQuery,primary:!0},m.a.createElement(Ft,{className:"fa fa-plus"})," New Query"),m.a.createElement(At,{onClick:this.handleAddNewText},m.a.createElement(Ft,{className:"fa fa-plus"})," Add Text")),m.a.createElement(mt,{onSetSystemQuery:this.handleSetSystemQuery,onSetMetricPrefix:this.handleSetMetricPrefix,instanceId:this.props.instanceId})))}}])&&vt(n.prototype,r),a&&vt(n,a),t}();t.b=Object(h.connect)(function(e,t){var n=e.root.timeTravel,r=n.showingLive,o=n.timestamp,a=n.rangeMs,i=t.params,c=i.notebookId,l=i.deeplink,s=i.instanceId,u=e.root.prometheus[s]||{},p=u.notebooks,f=void 0===p?{}:p,d=u.metricNames,m=void 0===d?[]:d,h=u.labelSets,y={entries:[],instanceId:s,labelSets:void 0===h?{}:h,loading:f.loading,metricNames:m,queryEnd:Object(Xe.g)(o),queryRange:Object(Xe.e)(a),sharedQueryParams:Object(T.b)(e),trailingNow:r};if(c){var b=f.data,g=(void 0===b?[]:b).find(function(e){return e.id===c})||{},v=g.id,w=g.title,k=g.createdAt,_=g.createdByEmail,O=g.updatedAt,E=g.updatedByEmail,x=g.version;return gt({},y,{createdAt:k,createdByEmail:_,entries:g.entries,id:v,title:w,updatedAt:O,updatedByEmail:E,version:x})}if(l){var j=decodeURIComponent(l);try{var C=JSON.parse(j),I=C.cells,P=C.time,R=C.title,N=P&&P.queryRange||y.queryRange,L=P&&P.queryEnd||y.queryEnd;return gt({},y,{entries:(I||[]).map(function(e){return{id:Object(S.k)(),query:e.queries&&e.queries.join("".concat(xt,"\n"))}}),queryEnd:L,queryRange:N,title:R})}catch(e){jt("Error decoding deep link queries")}}return y},{deletePrometheusNotebook:_.l,getFluxHistory:_.A,savePrometheusNotebook:_.Fb,updateTimeStateFromUrl:_.Xb})(Ht)},1376:function(e,t,n){"use strict";var r=n(46),o=n.n(r),a=n(189),i=n.n(a),c=n(14),l=n.n(c),s=n(188),u=n.n(s),p=n(0),f=n.n(p),d=n(22),m=n(9),h=n(190),y=n(2),b=n(411);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,c=new Array(a),s=0;s<a;s++)c[s]=arguments[s];return r=this,o=(e=w(t)).call.apply(e,[this].concat(c)),n=!o||"object"!==g(o)&&"function"!=typeof o?k(r):o,O(k(n),"handleSearch",function(e,t){n.props.onChange(e,t),n.props.updateSearch(e,u()(l()(t,i.a)))}),O(k(n),"handleFilterSelect",function(e){n.props.updateSearch("",Object(b.b)(n.props.searchQueryString,e).split(" ")),n.props.onFilterSelect(e)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(t,f.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.searchQuery,n=e.pinnedSearches,r=e.onFocus,o=e.onBlur,a=e.filters,i=e.ref;return f.a.createElement(m.Search,{onFocus:r,onBlur:o,ref:i,filters:a,query:t,pinnedTerms:n,onChange:this.handleSearch,onFilterSelect:this.handleFilterSelect})}}])&&v(n.prototype,r),o&&v(n,o),t}();O(E,"defaultProps",{onChange:o.a,onFilterSelect:o.a}),t.a=Object(d.connect)(function(e){var t=Object(h.c)(e),n=t.searchQuery;return{pinnedSearches:t.pinnedSearches,searchQuery:n,searchQueryString:Object(h.b)(e)}},{updateSearch:y.Wb})(E)},1377:function(e,t,n){"use strict";var r=n(6),o=n.n(r),a=n(0),i=n.n(a),c=n(15),l=n.n(c),s=n(1),u=n(22),p=n(13),f=n.n(p),d=n(7),m=n(16),h=n(11),y=n(111),b=n(2),g=n(1219),v=n(155),w=n(1266);function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var x=s.default.span.withConfig({displayName:"workload-dashboards__LinkIcon",componentId:"sc-15vcgsm-0"})(["margin:6px;font-size:",";"],function(e){return e.theme.fontSizes.tiny}),j=s.default.span.withConfig({displayName:"workload-dashboards__LinkSpan",componentId:"sc-15vcgsm-1"})(["display:inline-block;margin-top:16px;"]),C=function(e){var t=e.text,n=e.href;return i.a.createElement(j,null,i.a.createElement("a",{onClick:function(){return Object(d.trackEvent)("workload.help.dashboard")},href:n,target:"_blank"},t,i.a.createElement(x,{className:"fas fa-external-link-alt","aria-hidden":"true"})))},I=s.default.div.withConfig({displayName:"workload-dashboards__Container",componentId:"sc-15vcgsm-2"})(["margin-bottom:40px;"]),P=function(e){function t(){var e,n,r,o,a,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return r=this,n=!(o=(e=O(t)).call.apply(e,[this].concat(s)))||"object"!==k(o)&&"function"!=typeof o?E(r):o,a=E(n),c={loadingDashboards:!0},(i="state")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,i.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.props.updateTimeStateFromUrl(this.props.location),this.updateDeploymentAnnotations(this.props),this.updateWorkloadDashboardsLayout(this.props),this.fetchWorkloadMetrics(this.props),this.redirectIfDashboardNotFound(this.props),Object(d.trackEvent)("prom.nav.workload-dashboard",{workloadId:this.props.workloadId})}},{key:"componentWillReceiveProps",value:function(e){e.location.search!==this.props.location.search&&this.props.updateTimeStateFromUrl(e.location),e.endTime===this.props.endTime&&e.startTime===this.props.startTime&&e.workloadId===this.props.workloadId||(this.updateDeploymentAnnotations(e),this.updateWorkloadDashboardsLayout(e),this.fetchWorkloadMetrics(e)),this.redirectIfDashboardNotFound(e)}},{key:"updateWorkloadDashboardsLayout",value:function(e){var t=this;if(e.workloadId!==m.FLUX_ALL_WORKLOADS){var n=this.props.loadWorkloadDashboards(e.instanceId,e.workloadId,{end:l()(e.endTime).unix(),start:l()(e.startTime).unix()});if(this.props.canary){var r=this.props.loadWorkloadDashboards(e.instanceId,"".concat(e.workloadId,"-primary"),{end:l()(e.endTime).unix(),start:l()(e.startTime).unix()});return void Promise.all([n,r]).then(function(){return t.setState({loadingDashboards:!1})})}n.then(function(){return t.setState({loadingDashboards:!1})})}}},{key:"fetchWorkloadMetrics",value:function(e){e.workloadId!==m.FLUX_ALL_WORKLOADS&&(this.props.loadWorkloadMetrics(e.instanceId,e.workloadId,{end:l()(e.endTime).unix()}),this.props.canary&&this.props.loadWorkloadMetrics(e.instanceId,"".concat(e.workloadId,"-primary"),{end:l()(e.endTime).unix()}))}},{key:"updateDeploymentAnnotations",value:function(e){this.props.getFluxHistory(e.instanceId,e.workloadId,null,e.endTime,!1,e.startTime)}},{key:"redirectIfDashboardNotFound",value:function(e){var t=e.instanceId,n=e.workloadId,r=e.sharedQueryParams,o=e.dashboardId,a=e.dashboardIds;this.state.loadingDashboards||a&&!a.includes(o)&&f.a.replace(Object(h.Z)(r,t,n,"summary"))}},{key:"render",value:function(){return this.state.loadingDashboards?i.a.createElement(v.a,{text:"Loading dashboards..."}):i.a.createElement(I,null,i.a.createElement(w.b,{selectedTabId:this.props.dashboardId,onSelectedTabChange:this.props.onSelectedTabChange},this.props.children),this.props.dashboardIds&&this.props.dashboardIds.length<=2&&i.a.createElement(C,{text:"Learn about automatic dashboards",href:"https://www.weave.works/docs/cloud/latest/tasks/monitor/workload-dashboards/"}))}}])&&_(n.prototype,r),o&&_(n,o),t}();t.a=Object(u.connect)(function(e,t){var n=t.instanceId;return{canary:o()(e,["root","urlQuery","canary"],!1),endTime:Object(g.d)(e),instance:o()(e,["root","instances",n]),sharedQueryParams:Object(y.b)(e),startTime:Object(g.f)(e)}},{getFluxHistory:b.A,loadWorkloadDashboards:b.Z,loadWorkloadMetrics:b.bb,updateTimeStateFromUrl:b.Xb})(P)},1378:function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"b",function(){return d});var r=n(304),o=n.n(r),a=n(0),i=n.n(a),c=n(1),l=n(1290),s="This is a system workload. It is considered\nread-only by Weave Cloud and its deploy status is not tracked",u=c.default.div.withConfig({displayName:"deploy-status__Container",componentId:"sc-1ljt4xb-0"})(["display:flex;"]),p=c.default.i.withConfig({displayName:"deploy-status__Icon",componentId:"sc-1ljt4xb-1"})(["color:",";"],function(e){var t=e.status,n=e.theme;return t?n.colors.green500:n.colors.purple400}),f=c.default.span.withConfig({displayName:"deploy-status__Label",componentId:"sc-1ljt4xb-2"})(["margin-left:6px;"]);function d(e){var t=e.workload,n=o()(t.Status),r=n?"fa fa-circle":"fa fa-minus";return i.a.createElement(u,{title:n||s},t.updating?i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,null)," ",i.a.createElement(f,null,"Deploying...")):i.a.createElement(i.a.Fragment,null,i.a.createElement(p,{status:n,className:"fa-fw ".concat(r)})," ",i.a.createElement(f,null,n||"Not tracked")))}},1379:function(e,t,n){"use strict";var r=n(32),o=n.n(r),a=n(0),i=n(5),c=n.n(i),l=n(22),s=n(302);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),f(this,d(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,a["Component"]),n=t,(r=[{key:"render",value:function(){var e,t=this.props,n=t.instances,r=t.instanceId,i=t.flags,c=t.substitute,l=t.children,u=t.inverted,p=t.teamId;if(e=r?n[r]:n[this.context.router.params.instanceId],o()(n)||!e&&!p)return null;var f=p?Object(s.e)(p,i,n):Object(s.c)(e,i);return(u?!f:f)?a.Children.only(l):c||null}}])&&p(n.prototype,r),i&&p(n,i),t}();h.contextTypes={router:c.a.object.isRequired},t.a=Object(l.connect)(function(e){return{instances:e.root.instances}})(h)},1380:function(e,t,n){e.exports=n.p+"src/images/flux-history-screenshot.d580951fc707c20fc1eebfb5854aadb6.png"},1396:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(18),i=n.n(a),c=n(1),l=n(22);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=c.default.span.withConfig({displayName:"show-more__Icon",componentId:"njext3-0"})(["position:relative;top:1;padding-left:",";"],function(e){return e.expanded?"":i.a.spacing.xxs}),h=c.default.span.withConfig({displayName:"show-more__Text",componentId:"njext3-1"})(["position:relative;padding:",";&:hover{background-color:",";color:",";border-radius:",";}"],i.a.spacing.xxs,i.a.colors.purple300,i.a.colors.purple900,i.a.borderRadius.soft),y=c.default.div.withConfig({displayName:"show-more__Container",componentId:"njext3-2"})(["background-color:",";border-top:1px dotted ",";color:",";cursor:pointer;font-size:",";margin:"," "," 0 ",";padding:"," 0 "," 0;text-align:right;position:",";"],i.a.colors.purple25,i.a.colors.purple100,i.a.colors.purple300,i.a.fontSizes.small,i.a.spacing.xs,i.a.spacing.xxs,i.a.spacing.xxs,i.a.spacing.small,i.a.spacing.xs,function(e){return e.expanded?"sticky":""}),b=function(e){function t(){var e,n,r,o,a,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var l=arguments.length,u=new Array(l),d=0;d<l;d++)u[d]=arguments[d];return r=this,o=(e=p(t)).call.apply(e,[this].concat(u)),n=!o||"object"!==s(o)&&"function"!=typeof o?f(r):o,a=f(n),c=function(e){e.preventDefault(),n.props.handleClick&&n.props.handleClick(),n.props.onClick&&n.props.onClick()},(i="handleClick")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.collection,n=e.notShown,r=e.expanded,a=t&&(r||n>0),i=!e.hideNumber&&!r&&n>0?"+".concat(n):"",c=!r&&n>0?"fa fa-caret-down":"fa fa-caret-up";return a?o.a.createElement(y,{expanded:r,onClick:this.handleClick},o.a.createElement(h,null,i,o.a.createElement(m,{className:c,expanded:r}))):o.a.createElement("span",null)}}])&&u(n.prototype,r),a&&u(n,a),t}();t.a=Object(l.connect)()(b)},1397:function(e,t,n){"use strict";var r=n(47),o=n.n(r),a=n(0),i=n.n(a);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,p(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,i.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.el.indeterminate=this.props.indeterminate}},{key:"componentDidUpdate",value:function(e){e.indeterminate!==this.props.indeterminate&&(this.el.indeterminate=this.props.indeterminate)}},{key:"render",value:function(){var e=this;return i.a.createElement("input",l({},o()(this.props,"indeterminate"),{type:"checkbox",readOnly:!0,ref:function(t){e.el=t}}))}}])&&s(n.prototype,r),a&&s(n,a),t}();d.defaultProps={indeterminate:!1},t.a=d},1398:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(22),i=n(19),c=n.n(i),l=n(1299),s=n(11),u=n(64),p=n(125),f=n(1221),d=n(1273),m=n(1327);t.a=Object(a.connect)(function(e,t){var n=t.params,r=Object(u.f)(n.instanceId)(e).platform,o=e.root.prometheus[n.instanceId]||{},a=o.metricNames,i=o.metricNames,c=void 0===i?[]:i;return{instanceId:n.instanceId,metricNamesLoaded:a,metricsExist:m.a.getRows({platform:r}).some(function(e){return e.charts.every(function(e){return Object(p.b)(c,e.queryMetrics)})}),platform:r}})(function(e){var t=e.platform,n=e.metricNamesLoaded,r=e.metricsExist,a=e.params,i=e.location,u=e.instanceId,p=e.hideTimeTravel;return o.a.createElement("div",{className:m.a.id},n&&!r&&o.a.createElement(l.a,null,"Sorry, we could not find any node metrics.","kubernetes"===t&&o.a.createElement("span",null," ","Please ensure you have installed the",o.a.createElement(c.a,{to:Object(s.U)(u)}," Weave Cloud agents.")),""===t&&o.a.createElement("span",null,"If you are using Kubernetes, please ensure you have installed the"," ",o.a.createElement(c.a,{to:Object(s.U)(u)},"Weave Cloud agents."),o.a.createElement("br",null),"For other platforms, please setup the",o.a.createElement("a",{href:"https://github.com/prometheus/node_exporter"}," ","prometheus node-exporter"),"."),"kubernetes"!==t&&""!==t&&o.a.createElement("span",null," ","Please setup the",o.a.createElement("a",{href:"https://github.com/prometheus/node_exporter"}," ","prometheus node-exporter"),".")),!p&&o.a.createElement(f.a,{instanceId:a.instanceId,location:i,hasRangeSelector:!0}),o.a.createElement(d.a,{rows:m.a.getRows({platform:t}),instanceId:a.instanceId,location:i}))})},1468:function(e,t,n){"use strict";var r=n(126),o=n.n(r),a=n(150),i=n.n(a),c=n(6),l=n.n(c),s=n(0),u=n.n(s),p=n(22),f=n(13),d=n.n(f),m=n(1),h=n(9),y=n(11),b=n(2),g=n(55),v=n(17),w=n(223),k=n(111),_=n(158),O=n(128),E=n(45),S=n(19),x=n.n(S),j=n(303),C=n(18),I=n.n(C);function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var D={container:{borderTop:"1px dotted ".concat(I.a.colors.purple100),color:I.a.colors.purple300,cursor:"pointer",fontSize:"90%",margin:"4px 4px 0 4px",padding:"6px 6px 0 0",textTransform:"uppercase"},icon:{color:I.a.colors.purple300,fontSize:"120%",position:"relative",top:1}},q=function(e){function t(){var e,n,r,o,a,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return r=this,o=(e=R(t)).call.apply(e,[this].concat(s)),n=!o||"object"!==P(o)&&"function"!=typeof o?N(r):o,a=N(n),c=function(e){e.preventDefault(),n.props.handleClick&&n.props.handleClick(),n.props.onClick&&n.props.onClick()},(i="handleClick")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(t,u.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.collection,n=e.notShown,r=e.expanded,o=e.hideNumber,a=e.message,i=t&&(r||n>0),c=(void 0===a?"":a)||"+".concat(n),l=!o&&!r&&n>0?c:"",s=!r&&n>0?"fa fa-caret-down":"fa fa-caret-up";return i?u.a.createElement("div",{style:D.container,onClick:this.handleClick},l," ",u.a.createElement("span",{style:D.icon,className:s})):u.a.createElement("span",null)}}])&&T(n.prototype,r),o&&T(n,o),t}(),M=Object(p.connect)()(q),A=n(1243),F=n(418),U=n.n(F),z=n(1213),W=n(1315),B=n.n(W),K=n(309),Q=n.n(K),H=n(47),G=n.n(H);function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(){return(Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function X(e){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var te=m.default.label.withConfig({displayName:"flux-forms__Label",componentId:"sc-20qwr2-0"})(["display:block;"]),ne=(m.default.label.withConfig({displayName:"flux-forms__LabelInline",componentId:"sc-20qwr2-1"})(["display:inline-block;"]),m.default.div.withConfig({displayName:"flux-forms__Field",componentId:"sc-20qwr2-2"})(["display:inline-block;"])),re=(m.default.div.withConfig({displayName:"flux-forms__FormLine",componentId:"sc-20qwr2-3"})(["margin:8px 0;"]),m.default.span.withConfig({displayName:"flux-forms__Note",componentId:"sc-20qwr2-4"})(["opacity:0.5;font-style:italic;"])),oe=m.default.input.withConfig({displayName:"flux-forms__FormInput",componentId:"sc-20qwr2-5"})(["margin:2px 0 2px 0;padding:6px;font-size:",";border:1px solid ",";"],function(e){return e.theme.fontSizes.small},function(e){return e.theme.colors.gray50}),ae=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=X(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==V(o)&&"function"!=typeof o?$(r):o,ee($(n),"handleInputChange",function(e){var t=e.target.value,r=n.props,o=r.path;(0,r.onChange)(function(e){return Q()(B()(e),o,t)})}),ee($(n),"handleBlur",function(e){n.props.onBlur&&n.props.onBlur(e,n.props.path)}),ee($(n),"handleFocus",function(e){n.props.onFocus&&n.props.onFocus(e,n.props.path)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}(t,u.a.Component),n=t,(r=[{key:"render",value:function(){var e=G()(this.props,["value","onChange","className","state","path","onFocus","onBlur"]),t=this.props,n=t.path,r=t.state,o=t.className,a=l()(r,n)||"",i="".concat(o);return u.a.createElement(oe,Y({className:i,onChange:this.handleInputChange,onFocus:this.handleFocus,onBlur:this.handleBlur,value:a},e))}}])&&Z(n.prototype,r),o&&Z(n,o),t}();function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ce(){return(ce=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function se(e){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pe(e,t){return(pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fe(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(n,!0).forEach(function(t){me(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var he=m.default.form.withConfig({displayName:"flux-setup-git-form__GitConfigWrapper",componentId:"sc-12ye55g-0"})(["display:flex;flex-direction:column;align-items:center;"]),ye=Object(m.default)(oe).withConfig({displayName:"flux-setup-git-form__GitConfigInput",componentId:"sc-12ye55g-1"})(["width:100%;height:30px;margin-bottom:24px;"]),be=m.default.div.withConfig({displayName:"flux-setup-git-form__InlineContainer",componentId:"sc-12ye55g-2"})(["display:inline-block;"]),ge=Object(m.default)(ae).withConfig({displayName:"flux-setup-git-form__GitFluxFormField",componentId:"sc-12ye55g-3"})(["width:300px;"]),ve=function(e){if(!e)return{branch:"",path:"",url:""};var t=U()(e);e&&0===t.protocols.length&&(t=U()("https://".concat(e)));var n=t.user.includes(":")&&t.protocol.startsWith("http")?t.protocol:"ssh";return{branch:t.ref,path:t.filepath,url:U.a.stringify(de({},t,{git_suffix:!1}),n)}},we=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=se(t).call(this,e),n=!o||"object"!==ie(o)&&"function"!=typeof o?ue(r):o,me(ue(n),"onGitURLChange",function(e){n.setState({gitURL:e.currentTarget.value})}),me(ue(n),"handleContinue",function(e){e.preventDefault();var t=n.state.gitURL,r=ve(t),o=r.url,a=r.path,i=r.branch;n.props.onChange(function(e){return de({},e,{git:de({},e.git,{branch:i,path:a,url:o})})})}),n.state={gitURL:""},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pe(e,t)}(t,u.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props;return e.state.git.url||e.state.git.path?u.a.createElement(be,null,u.a.createElement(ne,null,u.a.createElement(te,{htmlFor:"git.URL"},"SSH URL"),u.a.createElement(ge,ce({id:"git.URL",path:["git","url"]},e))),u.a.createElement("span",null," / "),u.a.createElement(ne,null,u.a.createElement(te,{htmlFor:"git.path"},"Path to YAML files ",u.a.createElement(re,null,"optional")),u.a.createElement(ae,ce({id:"git.path",path:["git","path"]},e))),u.a.createElement("span",null," : "),u.a.createElement(ne,null,u.a.createElement(te,{htmlFor:"git.branch"},"Branch ",u.a.createElement(re,null,"optional")),u.a.createElement(ae,ce({id:"git.branch",path:["git","branch"],placeholder:"master"},e)))):u.a.createElement(he,{onSubmit:this.handleContinue},u.a.createElement(ye,{id:"git.URL",autoFocus:e.focus,onChange:this.onGitURLChange,placeholder:"Paste any GitHub, GitLab, BitBucket or Git SSH URL here",value:this.state.gitURL}),u.a.createElement(z.a,{primary:!0,label:"Continue"}))}}])&&le(n.prototype,r),o&&le(n,o),t}(),ke=m.default.div.withConfig({displayName:"flux-setup-key__Container",componentId:"vkfzmk-0"})(["display:flex;flex-direction:row;margin-left:12px;"]),_e=m.default.div.withConfig({displayName:"flux-setup-key__Views",componentId:"vkfzmk-1"})(["flex:1;min-width:0;"]),Oe=m.default.div.withConfig({displayName:"flux-setup-key__KeyView",componentId:"vkfzmk-2"})(["margin-bottom:12px;display:flex;"]),Ee=m.default.div.withConfig({displayName:"flux-setup-key__Label",componentId:"vkfzmk-3"})(["color:",";width:140px;margin-right:12px;text-transform:uppercase;font-family:",";font-size:",";line-height:19px;vertical-align:top;opacity:1;"],function(e){return e.theme.colors.purple600},function(e){return e.theme.fontFamilies.regular},function(e){return e.theme.fontSizes.small}),Se=Object(m.default)(Ee).withConfig({displayName:"flux-setup-key__MainLabel",componentId:"vkfzmk-4"})(["opacity:0.7;width:100px;text-align:left;"]),xe=m.default.div.withConfig({displayName:"flux-setup-key__Value",componentId:"vkfzmk-5"})(["font-family:",";font-size:",";line-height:19px;white-space:normal;word-wrap:break-word;flex:1;min-width:0;"],function(e){return e.theme.fontFamilies.monospace},function(e){return e.theme.fontSizes.small});function je(e){var t=e.config,n=l()(t,["key"],""),r=l()(t,["fingerprints","md5","hash"],""),o=l()(t,["fingerprints","sha256","hash"],"");return u.a.createElement("div",null,u.a.createElement(ke,null,u.a.createElement(Se,null,"Public deploy key"),u.a.createElement(_e,null,u.a.createElement(Oe,null,u.a.createElement(Ee,null,"MD5 fingerprint"),u.a.createElement(xe,null,r||"No key present")),u.a.createElement(Oe,null,u.a.createElement(Ee,null,"SHA-256 fingerprint"),u.a.createElement(xe,null,o||"No key present")),u.a.createElement(Oe,null,u.a.createElement(Ee,null,"Full key"),u.a.createElement(xe,null,n||"No key present")))))}var Ce=n(5),Ie=n.n(Ce),Pe=n(8),Te=n(3),Re=n(7);function Ne(e){return(Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function De(e){return(De=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Me(e,t){return(Me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ae(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function Fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ze="/push-github-deploy-keys";function We(){return window.location.pathname.endsWith(ze)}function Be(e){var t=Ue(e.find(function(e){return"github"===e.id}).link.href.split("?"),2),n=t[0],r=t[1],o=Object(Te.e)(r),a=Object(Te.m)({next:"".concat(window.location.pathname).concat(ze)}),i=Object(Te.m)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(n,!0).forEach(function(t){Fe(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},o,{redirect_uri:"".concat(o.redirect_uri,"?").concat(a)}),["scope"]);return"".concat(n,"?").concat(i)}var Ke=Object(m.default)(z.a).withConfig({displayName:"flux-setup-push-github-key__InlineFluxButton",componentId:"sc-12apm3k-0"})(["min-width:0;height:26px;padding:0 8px;margin:4px 0;"]),Qe=Object(m.default)(h.Alert).withConfig({displayName:"flux-setup-push-github-key__ErrorMessage",componentId:"sc-12apm3k-1"})(["h3{color:",";}p{margin-left:12px;}"],function(e){return e.theme.colors.white}),He=Object(m.default)(z.a).withConfig({displayName:"flux-setup-push-github-key__ManualInstructionsButton",componentId:"sc-12apm3k-2"})(["color:",";"],function(e){return e.theme.colors.purple400}),Ge=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=De(t).call(this,e),n=!o||"object"!==Ne(o)&&"function"!=typeof o?qe(r):o,Fe(qe(n),"handleClickPushKeys",function(){n.pushGithubKeys(n.props)}),Fe(qe(n),"handleClickOpenGithubDeployKeys",function(){Object(Re.trackEvent)("flux.config.deploykeys.view");var e=n.props,t=e.owner,r=e.repo;Object(v.s)("https://github.com/".concat(t,"/").concat(r,"/settings/keys"))}),Fe(qe(n),"handlePushKeysSuccess",function(){n.handleFinishPushingKeys(),n.props.onSuccess&&n.props.onSuccess(n.props.instanceId)}),Fe(qe(n),"handlePushKeysError",function(e){var t=e.status,r=e.errors;401===t?(Object(Re.trackEvent)("flux.config.deploykeys.auth"),Pe.M().then(function(e){var t=Be(e.logins);n.props.onBeforeOauthRedirect&&n.props.onBeforeOauthRedirect(),window.location=t})):(n.handleFinishPushingKeys(r),n.props.onError&&n.props.onError(r))}),n.state={showingPushingKeysOverlay:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Me(e,t)}(t,u.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){We()&&this.props.config&&this.pushGithubKeys(this.props,!0)}},{key:"componentWillReceiveProps",value:function(e){!this.props.config&&e.config&&We()&&this.pushGithubKeys(e,!0)}},{key:"pushGithubKeys",value:function(e){var t=e.owner,n=e.repo,r=e.instanceId,o=e.instanceName,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(Re.trackEvent)("flux.config.deploykeys.push",{redirectedToGitHub:a}),this.setState({showingPushingKeysOverlay:!0}),Pe.eb(r,t,n,o).then(this.handlePushKeysSuccess,this.handlePushKeysError)}},{key:"handleFinishPushingKeys",value:function(e){if(Object(Re.trackEvent)("flux.config.deploykeys.finishpush",{success:!e}),this.setState({showingPushingKeysOverlay:!1}),We()){var t=window.location.pathname.replace(ze,"");d.a.replace(t)}}},{key:"renderDialog",value:function(){var e=this.props,t=e.owner,n=e.repo;return u.a.createElement(h.Dialog,{active:this.state.showingPushingKeysOverlay},u.a.createElement("div",null,u.a.createElement("h2",{style:{marginTop:0}},u.a.createElement(h.CircularProgress,{inline:!0})," ",u.a.createElement("span",{style:{verticalAlign:"middle"}},"Pushing GitHub deploy keys...")),u.a.createElement("p",null,"To repository: ",t,"/",n)))}},{key:"render",value:function(){var e=this.props,t=e.owner,n=e.repo,r=e.pushedKeysError,o=e.pushedKeysSuccess,a=e.onClickShowManualInstructions,i=e.showManualInstructions;return u.a.createElement("div",null,u.a.createElement("div",{className:"form-line"},u.a.createElement("div",{className:"form-el"},u.a.createElement(z.a,{primary:!0,label:"Push key to GitHub",onClick:this.handleClickPushKeys})," ",u.a.createElement(z.a,{label:"View ".concat(t,"/").concat(n," GitHub keys"),onClick:this.handleClickOpenGithubDeployKeys}),u.a.createElement(He,{flat:!0,label:"".concat(i?"Hide":"Show"," manual instructions"),onClick:a}),o&&u.a.createElement(h.Alert,{type:"success"},"Successfully pushed keys"),r&&u.a.createElement(u.a.Fragment,null,u.a.createElement(Qe,{type:"warning"},u.a.createElement("h3",null,"Error pushing keys"),r.map(function(e){return u.a.createElement("p",{key:e.message},e.message)})),u.a.createElement("p",null,"If you continue to receive this error try manually adding the key."," ")),i&&u.a.createElement("p",null,u.a.createElement(Ke,{label:"Open ".concat(t,"/").concat(n," GitHub keys"),onClick:this.handleClickOpenGithubDeployKeys})," ","and click ",u.a.createElement("b",null,"Add deploy key"),". Provide the FULL KEY below and make sure to ",u.a.createElement("b",null,"Allow write access"),"."))),this.renderDialog())}}])&&Le(n.prototype,r),o&&Le(n,o),t}();Ge.contextTypes={router:Ie.a.object.isRequired};var Ve=Ge;function Ye(e){return(Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xe(e,t){return!t||"object"!==Ye(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $e(e){return($e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Je(e,t){return(Je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var et=m.default.div.withConfig({displayName:"flux-setup-git-permissions__DeployKey",componentId:"sc-1790qg9-0"})(["margin:8px;"]),tt=m.default.span.withConfig({displayName:"flux-setup-git-permissions__RepoUrl",componentId:"sc-1790qg9-1"})(["opacity:0.7;"]),nt=function(e){var t=e.url,n=e.deployKey;return u.a.createElement("div",null,u.a.createElement("p",null,"Please enable read / write access on the git repository at"," ",u.a.createElement(tt,null,t)," for the following key:"),u.a.createElement(et,null,u.a.createElement(xe,null,n||"No key present")),u.a.createElement("p",null,"This step requires copying the above key and saving it somewhere in the configuration of your git repository. You many need to check the documentation for your git repository provider or contact your git repository administrator. When enabled please click the button below to proceed."))},rt=function(e){var t=e.owner,n=e.repo,r=e.deployKey;return u.a.createElement("div",null,u.a.createElement("p",null,"Add the following key to a"," ",u.a.createElement("a",{href:"https://bitbucket.org/".concat(t,"/").concat(n,"/admin/access"),target:"bitbucket.org"},"Bitbucket user that has access to ",t,"/",n,"."," "),"On Bitbucket navigate to:"," ",u.a.createElement("em",null,"User ",">"," Settings ",">"," SSH Keys ",">"," Add key.")),u.a.createElement(et,null,u.a.createElement(Oe,null,u.a.createElement(Ee,null,"Label"),u.a.createElement(xe,null,"Flux deploy key")),u.a.createElement(Oe,null,u.a.createElement(Ee,null,"Key"),u.a.createElement(xe,null,r||"No key present"))))},ot=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Xe(this,$e(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Je(e,t)}(t,u.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.instanceId,n=e.instanceName,r=e.config,o=e.onBeforeOauthRedirect,a=e.onSuccess,i=e.onError,c=e.closeOnSuccess,s=e.onClickUserSaysTheyPushedKeys,p=e.pushedKeysError,f=e.pushedKeysSuccess,d=e.onClickShowManualInstructions,m=e.showManualInstructions,h=l()(r,["url"],""),y=l()(r,["key"],""),b=Object(O.o)(h),g=b.owner,v=b.repo;return h?Object(O.l)(r)?u.a.createElement(Ve,{closeOnSuccess:c,owner:g,repo:v,instanceId:t,instanceName:n,config:r,pushedKeysSuccess:f,pushedKeysError:p,onClickShowManualInstructions:d,onBeforeOauthRedirect:o,onSuccess:a,onError:i,showManualInstructions:m,onClickUserSaysTheyPushedKeys:s}):Object(O.k)(r)?u.a.createElement(rt,{owner:g,repo:v,deployKey:y}):u.a.createElement(nt,{deployKey:y,url:h}):u.a.createElement("p",null,"First configure the config repository above.")}}])&&Ze(n.prototype,r),o&&Ze(n,o),t}(),at=n(1316);var it=m.default.div.withConfig({displayName:"flux-setup-steps__AgentStatus",componentId:"sc-1dim8a0-0"})(["display:",";border-radius:",";padding:13px;margin:",";background-color:",";color:",";a{color:",";}"],function(e){return e.inline?"inline-block":"block"},function(e){return e.theme.borderRadius.soft},function(e){return e.inline?"0 0 18px 0":"8px 0"},function(e){var t=e.state,n=e.theme;return{disconnected:n.colors.blue600,error:n.colors.yellow500,starting:n.colors.blue600,success:n.colors.green500}[t]},function(e){return e.theme.colors.white},function(e){return Object(E.transparentize)(.2,e.theme.colors.white)}),ct=m.default.span.withConfig({displayName:"flux-setup-steps__AgentStatusHeader",componentId:"sc-1dim8a0-1"})(["font-weight:bold;display:block;font-size:",";margin-bottom:8px;",""],function(e){return e.theme.fontSizes.normal},function(e){return e.pulse&&Object(m.css)(["animation:",";"],A.a.loadingAnimation)}),lt=m.default.div.withConfig({displayName:"flux-setup-steps__SettingsPage",componentId:"sc-1dim8a0-2"})(["font-size:",";"],function(e){return e.theme.fontSizes.small});function st(e){var t=e.done,n=e.current,r=e.warning,o=e.theme;return t?o.colors.green500:n?o.colors.blue400:r?o.colors.yellow500:o.colors.purple400}var ut=Object(m.keyframes)(["0%{box-shadow:0 0 0 0 ",";}70%{box-shadow:0 0 0 20px ",";}100%{box-shadow:0 0 0 20px transparent;}"],function(e){return e.theme.colors.blue400},function(e){return e.theme.colors.blue400}),pt=m.default.div.withConfig({displayName:"flux-setup-steps__Section",componentId:"sc-1dim8a0-3"})(["margin:48px 0;transition:opacity 0.5s;opacity:",";"],function(e){var t=e.done,n=e.current,r=e.warning;return t||n||r?1:.5}),ft=m.default.div.withConfig({displayName:"flux-setup-steps__Icon",componentId:"sc-1dim8a0-4"})(["border-radius:",";display:inline-block;width:1.8em;font-size:",";line-height:1.8em;box-shadow:0 0 0 ",";transition:color 0.5s;background-color:",";color:",";text-align:center;margin-right:4px;",";"],function(e){return e.theme.borderRadius.circle},function(e){return e.theme.fontSizes.normal},st,st,function(e){return e.theme.colors.white},function(e){var t=e.current,n=e.warning;return(t||n)&&Object(m.css)(["animation:"," 2s infinite;"],ut)}),dt=m.default.h3.withConfig({displayName:"flux-setup-steps__SectionHeader",componentId:"sc-1dim8a0-5"})(["margin-left:-38px;margin-bottom:-4px;color:",";"],function(e){return e.theme.colors.purple900}),mt=m.default.div.withConfig({displayName:"flux-setup-steps__SectionDescription",componentId:"sc-1dim8a0-6"})(["margin:0 0 24px 0;"]),ht=m.default.p.withConfig({displayName:"flux-setup-steps__CodeInstructions",componentId:"sc-1dim8a0-7"})(["margin:24px 0 4px 0;"]),yt=m.default.div.withConfig({displayName:"flux-setup-steps__SubSection",componentId:"sc-1dim8a0-8"})(["margin-bottom:14px;"]),bt=function(e){var t=e.errors;return u.a.createElement(it,{state:"error"},u.a.createElement(ct,null,u.a.createElement("i",{className:"fa fa-exclamation-triangle fa-fw"})," Configuration status"),t)},gt=function(e){var t=e.instanceId;return u.a.createElement(it,{state:"error"},u.a.createElement(ct,{pulse:!0},u.a.createElement("i",{className:"fa fa-exclamation-triangle fa-fw"})," Waiting for agent to connect..."),"Weave Deploy Agent is not connected. This might be temporary and we","'","ll continue checking, but if this persists try reconnecting the Agent by following the instruction on the"," ",u.a.createElement(x.a,{to:Object(y.E)(t)},"Install page"),"."," ")},vt=function(){return u.a.createElement(it,{state:"disconnected"},u.a.createElement(ct,{pulse:!0},u.a.createElement("i",{className:"fa fa-exclamation-triangle fa-fw"})," Waiting for agent to reconnect..."),"It does a little restart during re-configuration. This can take up to 30 seconds.")},wt=function(){return u.a.createElement(it,{state:"starting"},u.a.createElement(ct,{pulse:!0},u.a.createElement("i",{className:"fa fa-check-circle fa-fw"})," Agent reconnected"),"Starting up, just a second...")},kt=function(e){var t=e.onClickViewResources;return u.a.createElement(it,{state:"success"},u.a.createElement(ct,null,u.a.createElement("i",{className:"fa fa-check-circle fa-fw"})," Agent configured"),u.a.createElement("div",null,"You are ready to deploy."),u.a.createElement(z.a,{onClick:t,style:{marginTop:8},label:"View resources"}))};function _t(e){var t=e.config,n=e.fluxdState,r=e.focusedField,o=e.hasGithubRepo,a=e.hasRepo,i=e.instanceId,c=e.instanceName,s=e.localConfig,p=e.localErrors,f=e.probeToken,d=e.progress,m=e.seenAConnectedFlux,h=e.showFullKey,y=e.showManualInstructions,b=e.startingUp,g=e.pushedKeys,v=e.pushedKeysError,w=e.pushedKeysSuccess,k=e.handleClickToggleKey,_=e.handleClickViewResources,O=e.handleClickShowManualInstructions,E=e.handlePushedKeys,S=e.handlePushedKeysError,x=e.handleBeforeOauthRedirect,C=e.handleRepoChange,I=e.handleRepoFieldBlur,P=e.handleRepoFieldFocus,T=e.handleUserSaysTheyPushedKeys,R=l()(t,["errors",0,"message"]),N=Boolean(g===s.git.url||o&&!y);return u.a.createElement(lt,null,!m&&u.a.createElement(gt,{instanceId:i}),m&&"not-connected"===n&&u.a.createElement(vt,null),b&&u.a.createElement(wt,null),a&&R&&!p&&!b&&u.a.createElement(bt,{errors:R}),p&&!b&&u.a.createElement(bt,{errors:p}),"configured"===n&&u.a.createElement(kt,{onClickViewResources:_}),d.repo&&u.a.createElement(pt,d.repo,u.a.createElement(dt,null,u.a.createElement(ft,d.repo,"1")," Config repository"," ",u.a.createElement(re,null,"where your Kubernetes YAMLs are")),u.a.createElement(mt,null,"When a new image is deployed, ",u.a.createElement("em",null,"Weave Cloud Deploy")," will update the YAML files in your repository"),u.a.createElement(we,{focus:!a,instanceId:i,state:s,onChange:C,onBlur:I,onFocus:P})),(d.writePermission||d.apply)&&u.a.createElement(pt,d.writePermission,u.a.createElement(dt,null,u.a.createElement(ft,d.writePermission,"2")," Config repository read/write permission"),u.a.createElement(mt,null,u.a.createElement("em",null,"Weave Cloud Deploy")," requires write access to the config repository. Deploy keys are used to grant this permission."),u.a.createElement(yt,null,u.a.createElement(ot,{instanceId:i,config:s.git,pushedKeysError:v,pushedKeysSuccess:w,showManualInstructions:y,onSuccess:E,onClickShowManualInstructions:O,onError:S,onBeforeOauthRedirect:x,instanceName:c})),u.a.createElement(yt,null,h&&u.a.createElement(je,{instanceId:i,config:s.git}),!y&&u.a.createElement(M,{collection:[1],notShown:1,message:"Show deploy key details",expanded:h,onClick:k})),!N&&u.a.createElement(z.a,{primary:!0,label:"Read/write access for this deploy key has been enabled",onClick:T})),d.apply&&u.a.createElement(pt,d.apply,u.a.createElement(dt,null,u.a.createElement(ft,d.apply,"3")," Update cluster"),u.a.createElement(mt,null,u.a.createElement(ht,null,"To ",u.a.createElement("b",null,"save")," the above changes to the config repository, apply it to your cluster:")),u.a.createElement(j.a,null,u.a.createElement(at.a,{instanceId:i,key:"flux-apply-kubectl-command",token:f,focused:r,config:s.git,prevConfig:t.git}))))}function Ot(e){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Et(){return(Et=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function St(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xt(e){return(xt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ct(e,t){return(Ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function It(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Pt=3e4,Tt=["new","cloned"],Rt=function(e){return["connected","configured"].includes(e)},Nt=m.default.div.withConfig({displayName:"flux-setup-steps-container__ExampleRepo",componentId:"sc-1dte1aw-0"})(["font-family:",";"],function(e){return e.theme.fontFamilies.monospace}),Lt=function(e){var t=e.repoUrl,n=Object(O.o)(t),r=n.host,o=n.owner,a=n.repo,i="github.com"===r&&o&&a?"git@github.com:".concat(o,"/").concat(a):"git@github.com:user/repo-name";return u.a.createElement("div",null,"Weave Cloud Deploy does not support authentication on GitHub over"," ",u.a.createElement("em",null,"http(s)"),". Please change the URL to one that supports SSH. E.g."," ",u.a.createElement(Nt,null,i))},Dt=m.default.div.withConfig({displayName:"flux-setup-steps-container__LoadingContainer",componentId:"sc-1dte1aw-1"})(["margin:100px auto;width:500px;text-align:center;"]);function qt(e,t){return!Object(v.q)(e,t,"git.url","git.path","git.branch")}function Mt(e){return"".concat(e,".fluxsetup.git")}function At(e,t){Object(g.storageSetObject)(Mt(e),o()(t,"url","path","branch"),window.sessionStorage)}var Ft=function(e){function t(e){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=xt(t).call(this,e),n=!o||"object"!==Ot(o)&&"function"!=typeof o?jt(r):o,It(jt(n),"setStartingUp",function(){n.setState({startingUp:!0}),n.startingUpTimeout=setTimeout(function(){n.setState({startingUp:!1})},Pt)}),It(jt(n),"clearStartingUp",function(){n.setState({startingUp:!1}),clearTimeout(n.startingUpTimeout)}),It(jt(n),"handleClickToggleKey",function(){n.setState({showFullKey:!n.state.showFullKey})}),It(jt(n),"handleRepoChange",function(e){n.setState(function(t){return{localConfig:e(t.localConfig)}})}),It(jt(n),"handleRepoFieldBlur",function(){n.setState({focusedField:null})}),It(jt(n),"handleRepoFieldFocus",function(e,t){n.setState({focusedField:l()(t,[1])})}),It(jt(n),"handleBeforeOauthRedirect",function(){At(n.props.instanceId,n.state.localConfig.git)}),It(jt(n),"handlePushedKeys",function(){n.setState({pushedKeys:l()(n.state.localConfig,["git","url"],""),pushedKeysSuccess:!0,showFullKey:!1,showManualInstructions:!1})}),It(jt(n),"handlePushedKeysError",function(e){n.setState({pushedKeysError:e,showFullKey:!0,showManualInstructions:!0})}),It(jt(n),"handleUserSaysTheyPushedKeys",function(){n.setState({pushedKeys:l()(n.state.localConfig,["git","url"],""),pushedKeysError:null,pushedKeysSuccess:null,showFullKey:!1,showManualInstructions:!1})}),It(jt(n),"handleClickShowManualInstructions",function(){var e=!n.state.showManualInstructions;n.setState({showFullKey:e,showManualInstructions:e})}),It(jt(n),"handleClickViewResources",function(){var e=n.props,t=e.sharedQueryParams,r=e.instanceId;d.a.push(Object(y.m)(t,r))});var a,c,s=(a=e.instanceId,c=Object(g.storageGetObject)(Mt(a),"",window.sessionStorage),At(a,{}),c?{git:c}:{});return n.state={focusedField:null,localConfig:i()({},e.config,s),pushedKeys:e.pushedKeys,pushedKeysError:null,pushedKeysSuccess:null,seenAConnectedFlux:Rt(e.fluxdState),sessionConfig:s,showFullKey:!1,showManualInstructions:!1,startingUp:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ct(e,t)}(t,u.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=this.props.instanceId;this.stopPollingFluxStatus=this.props.pollFluxStatus(e,2500),this.props.getInstanceData(e)}},{key:"componentWillUnmount",value:function(){this.stopPollingFluxStatus(),clearTimeout(this.startingUpTimeout)}},{key:"componentWillReceiveProps",value:function(e){var t=e.fluxdState,n=e.config,r=e.pushedKeys;Rt(t)&&this.setState({seenAConnectedFlux:!0});var o="not-connected"===t,a="configured"===t;"not-connected"===this.props.fluxdState&&"connected"===t&&Tt.includes(n.status)?this.setStartingUp():(o||a)&&this.clearStartingUp(),qt(this.props.config,n)||this.setState({localConfig:i()({},n,this.state.sessionConfig),pushedKeys:r})}},{key:"render",value:function(){var e=this.props,t=e.probeToken,n=e.instanceId,r=e.instanceName,o=e.config,a=e.fluxdState,i=this.state,c=i.localConfig,s=i.focusedField,p=i.pushedKeys,f=i.seenAConnectedFlux,d=i.showFullKey,m=i.showManualInstructions,y=i.startingUp,b=i.pushedKeysError,g=i.pushedKeysSuccess,v=l()(o,["git","url"]),w=o.status&&Boolean("cloned"===o.status),k=l()(c,["git","url"]),_=Boolean((k||"").match(/^https?:\/\/github\.com/i)),E=_&&u.a.createElement(Lt,{repoUrl:k}),S=function(e,t,n,r,o,a,i,c){if("not-connected"===r||!0===o||!c)return{};if(i)return{repo:{warning:!0}};if("connected"===r&&qt(e,t)){if(a)return{repo:{done:!0},writePermission:{warning:!0}};if(t.git.url)return{repo:{warning:!0},writePermission:{warning:!0}}}if("configured"===r){if(qt(e,t))return{apply:{done:!0},repo:{done:!0},writePermission:{done:!0}};if(e.git.url===t.git.url&&(e.git.path!==t.git.path||e.git.branch!==t.git.branch))return{apply:{current:!0},repo:{done:!0}}}var s=l()(e,["git","url"]);return s?n!==s?{repo:{done:!0},writePermission:{current:!0}}:{apply:{current:!0},repo:{done:!0},writePermission:{done:!0}}:{repo:{current:!0}}}(c,o,p,a,y,w,_,f);if(!o.loaded)return u.a.createElement(Dt,null,u.a.createElement(h.CircularProgress,{inline:!0}),u.a.createElement("p",null,"Loading status..."));var x={config:o,fluxdState:a,focusedField:s,hasRepo:v,instanceId:n,instanceName:r,localConfig:c,localErrors:E,probeToken:t,progress:S,pushedKeys:p,pushedKeysError:b,pushedKeysSuccess:g,seenAConnectedFlux:f,showFullKey:d,showManualInstructions:m,startingUp:y};return u.a.createElement(_t,Et({},x,{hasGithubRepo:Object(O.l)(c.git),handleClickToggleKey:this.handleClickToggleKey,handleClickViewResources:this.handleClickViewResources,handleClickShowManualInstructions:this.handleClickShowManualInstructions,handlePushedKeys:this.handlePushedKeys,handlePushedKeysError:this.handlePushedKeysError,handleBeforeOauthRedirect:this.handleBeforeOauthRedirect,handleRepoChange:this.handleRepoChange,handleRepoFieldBlur:this.handleRepoFieldBlur,handleRepoFieldFocus:this.handleRepoFieldFocus,handleUserSaysTheyPushedKeys:this.handleUserSaysTheyPushedKeys}))}}])&&St(n.prototype,r),o&&St(n,o),t}();t.a=Object(p.connect)(function(e,t){var n=t.params,r=e.root,o=n.instanceId,a=r.instances[o]||{},i=a.probeToken,c=a.name,s=Object(w.g)(e)[o]||{},u=Object(w.i)(e);return{config:s,fluxdState:u,instanceId:o,instanceName:c,probeToken:i,pushedKeys:"configured"===u&&l()(s,["git","url"]),sharedQueryParams:Object(k.b)(e)}},{getInstanceData:b.H,pollFluxStatus:b.mb})(Object(_.a)(Ft))},1470:function(e,t,n){"use strict";var r=n(6),o=n.n(r),a=n(0),i=n.n(a),c=n(1),l=function(e){return[{name:"Weight",rows:[{panels:[{legendShown:!1,query:'sum(flagger_canary_weight{workload="'.concat(e,'-primary"}) by (workload, namespace)'),title:"",type:"line",unit:{explanation:"",format:"numeric"},valuesMinSpread:100}]}]},{name:"Incoming request volume",rows:[{panels:[{legendShown:!1,query:'round(sum(rate(istio_requests_total{reporter="destination",destination_workload=~"'.concat(e,'-primary"}[30s])) by (destination_workload), 0.001)'),title:"",type:"line",unit:{explanation:"",format:"numeric"},valuesMinSpread:100}]}]}]},s=function(e){return[{name:"Weight",rows:[{panels:[{legendShown:!1,query:'sum(flagger_canary_weight{workload="'.concat(e,'-primary"}) by (workload, namespace)'),title:"",type:"line",unit:{explanation:"",format:"numeric"},valuesMinSpread:100}]}]},{name:"Incoming request volume",rows:[{panels:[{legendShown:!1,query:'round(sum(rate(envoy_cluster_upstream_rq{kubernetes_pod_name=~"'.concat(e,'-primary-[0-9a-zA-Z]+(-[0-9a-zA-Z]+)"}[30s])) by (kubernetes_namespace), 0.001)'),title:"",type:"line",unit:{explanation:"",format:"numeric"},valuesMinSpread:100}]}]}]},u=n(76),p=n(22),f=n(9),d=n(1293),m=n(1268),h=n(7);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=c.default.div.withConfig({displayName:"workload-chart__ChartWrapper",componentId:"sc-1mu10nx-0"})(["box-sizing:border-box;width:100%;"]),O=c.default.div.withConfig({displayName:"workload-chart__ChartHeader",componentId:"sc-1mu10nx-1"})(["display:flex;align-items:flex-end;justify-content:center;position:relative;height:30px;margin-bottom:10px;"]),E=c.default.h3.withConfig({displayName:"workload-chart__ChartTitle",componentId:"sc-1mu10nx-2"})(["white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center;padding:0 5px;margin:0;"]),S=c.default.span.withConfig({displayName:"workload-chart__ChartTitleSpinner",componentId:"sc-1mu10nx-3"})(["display:flex;justify-content:center;width:25px;"]),x=c.default.span.withConfig({displayName:"workload-chart__ChartHelpIcon",componentId:"sc-1mu10nx-4"})(["color:",";font-size:",";cursor:pointer;padding:3px;opacity:0.75;"],function(e){return e.theme.colors.purple400},function(e){return e.theme.fontSizes.small}),j=function(e){function t(e,n){var r,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=g(t).call(this,e,n),r=!a||"object"!==y(a)&&"function"!=typeof a?v(o):a,k(v(r),"handleRefreshStart",function(){r.setState({isRefreshing:!0})}),k(v(r),"handleRefreshFinish",function(){r.setState({isRefreshing:!1})}),k(v(r),"handleReceiveSuccess",function(e){var t=e.isFirstLoading,n=e.responseTime;Object(h.trackUserTiming)("prom.workloads.dashboard.querySuccessTime",n,"Dashboard query time",{chartTitle:r.props.title,initialQuery:t,instanceId:r.props.instanceId,workloadId:r.props.workloadId})}),k(v(r),"handleReceiveError",function(e){var t=e.error,n=e.isFirstLoading,o=e.responseTime;Object(h.trackUserTiming)("prom.workloads.dashboard.queryErrorTime",o,"Dashboard query time",{chartTitle:r.props.title,error:t,initialQuery:n,instanceId:r.props.instanceId,workloadId:r.props.workloadId})}),r.state={isRefreshing:!1},r}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement(_,null,i.a.createElement(O,null,i.a.createElement(S,null,this.state.isRefreshing&&i.a.createElement(f.CircularProgress,{size:"small"})),i.a.createElement(E,null,this.props.title),this.props.help&&i.a.createElement(d.a,{showOnHover:!0,text:this.props.help},i.a.createElement(x,{className:"fa fa-info-circle"}))),i.a.createElement(m.a,{simpleTooltip:!0,instanceId:this.props.instanceId,query:this.props.query,startTimeSec:this.props.startTime,endTimeSec:this.props.endTime,stepDurationSec:this.props.queryStepSeconds,yAxisLabel:this.props.yAxisLabel,metricUnits:this.props.metricUnits,valuesMinSpread:this.props.valuesMinSpread,legendShown:this.props.legendShown,getSeriesName:this.props.getLabel,showStacked:this.props.showStacked,colorTheme:this.props.colorTheme,deployments:this.props.deployments,onRefreshStart:this.handleRefreshStart,onRefreshFinish:this.handleRefreshFinish,onReceiveSuccess:this.handleReceiveSuccess,onReceiveError:this.handleReceiveError}))}}])&&b(n.prototype,r),o&&b(n,o),t}();var C=Object(p.connect)(function(e,t){var n=t.instanceId,r=t.workloadId;return{deployments:Object(u.a)(e,n,r)}})(j);function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e,t){return!t||"object"!==I(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function L(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n.d(t,"a",function(){return K});var D=c.default.div.withConfig({displayName:"workload-dashboard__DashboardWrapper",componentId:"sc-1lonexe-0"})([""]),q=c.default.div.withConfig({displayName:"workload-dashboard__SectionWrap",componentId:"sc-1lonexe-1"})(["",";"],function(e){return e.twoColumn&&"\n    display: flex;\n\n    & > div {\n      flex: 1 1 50%;\n    }\n  "}),M=c.default.div.withConfig({displayName:"workload-dashboard__Section",componentId:"sc-1lonexe-2"})(["margin:15px 0 50px;&:last-child{margin-bottom:0;}"]),A=c.default.h2.withConfig({displayName:"workload-dashboard__SectionTitle",componentId:"sc-1lonexe-3"})(["margin:0 0 6px;padding-left:25px;text-align:center;"]),F=c.default.div.withConfig({displayName:"workload-dashboard__SectionContainer",componentId:"sc-1lonexe-4"})(["border-radius:",";background-color:",";padding:0 20px;"],function(e){return e.theme.borderRadius.soft},function(e){return e.theme.colors.white}),U=c.default.div.withConfig({displayName:"workload-dashboard__Row",componentId:"sc-1lonexe-5"})(["",";"],function(e){return!e.singleColumn&&"\n      display: flex;\n    "}),z=c.default.span.withConfig({displayName:"workload-dashboard__Panel",componentId:"sc-1lonexe-6"})(["width:100%;margin:5px 0 20px;&:not(:last-child){margin-right:50px;}"]),W=function(e,t){return e.replace("".concat(t,"-primary"),t)};function B(e,t){return[t.name,e.title].filter(Boolean).join(" - ")}var K=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),T(this,R(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.canary,n=e.canaryAppMesh,r=e.dashboard,a=e.instanceId,c=e.workloadId,p=Object(u.b)(c).workloadName,f=function(e,t,n,r){return n&&r&&"cadvisor-resources"===t.id?[].concat(L(s(e)),L(t.sections)):n&&"cadvisor-resources"===t.id?[].concat(L(l(e)),L(t.sections)):t.sections}(p,r,t,n),d=t&&Math.round(Date.now()/1e3)-600;return i.a.createElement(D,null,f.map(function(e,n){return i.a.createElement(q,{key:e.name,twoColumn:t},t&&i.a.createElement(M,{key:"".concat(e.name,"-primary")},0===n&&i.a.createElement(A,null,"Primary"),i.a.createElement(F,null,e.rows.map(function(n,r){var l=o()(n,"panels[0].title",r);return i.a.createElement(U,{key:l,singleColumn:t},n.panels.map(function(t){return i.a.createElement(z,{key:"".concat(t.title,"-primary")},i.a.createElement(C,{title:B(t,e),help:t.help,query:t.query,legendShown:t.legendShown,instanceId:a,workloadId:"".concat(c,"-primary"),startTime:d,metricUnits:t.unit.format,showStacked:"stacked-area"===t.type}))}))}))),i.a.createElement(M,{key:e.name},0===n&&t&&i.a.createElement(A,null,"Canary"),i.a.createElement(F,null,e.rows.map(function(n,r){var l=o()(n,"panels[0].title",r);return i.a.createElement(U,{key:l,singleColumn:t},n.panels.map(function(t){return i.a.createElement(z,{key:t.title},i.a.createElement(C,{title:B(t,e),help:t.help,legendShown:t.legendShown,query:W(t.query,p),valuesMinSpread:t.valuesMinSpread,instanceId:a,startTime:d,workloadId:c,metricUnits:t.unit.format,showStacked:"stacked-area"===t.type}))}))}))))}))}}])&&P(n.prototype,r),a&&P(n,a),t}()},2374:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(1314),i=n.n(a),c=n(31),l=n.n(c),s=n(20),u=n.n(s),p=n(22),f=n(1),d=n(159),m=n(1468);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var w=f.default.div.withConfig({displayName:"finish-setup-page__FlexContainer",componentId:"hdlcu5-0"})(["width:1008px;margin:24px auto;"]),k=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),b(this,g(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.instanceId,n=e.params;return o.a.createElement(d.a,{instanceId:t},o.a.createElement(w,null,o.a.createElement("h1",null,"Finish Deploy Setup..."),o.a.createElement(m.a,{params:n,stepWise:!0})))}}])&&y(n.prototype,r),a&&y(n,a),t}();var _=Object(p.connect)(function(e,t){var n=t.params;return{instanceId:n.instanceId,params:n}})(k),O=n(32),E=n.n(O),S=n(185),x=n.n(S),j=n(6),C=n.n(j),I=n(15),P=n.n(I),T=n(16),R=n(2),N=n(1221),L=n(1267),D=n(76),q=n(223),M=n(1219),A=n(78),F=n.n(A),U=n(77),z=n.n(U),W=n(18),B=n.n(W),K=n(13),Q=n.n(K),H=n(19),G=n.n(H),V=n(5),Y=n.n(V),Z=n(7),X=n(158),$=n(11),J=n(1213);function ee(e){return(ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function te(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function re(e){return(re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ae(e,t){return(ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ce=f.default.div.withConfig({displayName:"page__Toolbar",componentId:"sc-1k2xuvz-0"})(["padding:12px 0 12px 0;display:flex;"]),le=f.default.div.withConfig({displayName:"page__FlexContainer",componentId:"sc-1k2xuvz-1"})(["width:100%;margin-bottom:24px;flex:1;display:flex;flex-direction:row;align-items:stretch;"]),se=f.default.div.withConfig({displayName:"page__MainContent",componentId:"sc-1k2xuvz-2"})(["flex:1;min-width:1008px;margin:0;"]),ue=f.default.div.withConfig({displayName:"page__Spacer",componentId:"sc-1k2xuvz-3"})(["max-width:4%;flex:1;"]),pe=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=re(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==ee(o)&&"function"!=typeof o?oe(r):o,ie(oe(n),"handleClickWorkloads",function(){Object(Z.trackEvent)("flux.nav.click",{link:"services"});var e=Object($.o)(n.props.instanceId);Q.a.push(e)}),ie(oe(n),"handleClickReleases",function(){Object(Z.trackEvent)("flux.nav.click",{link:"releases"})}),ie(oe(n),"handleClickHistory",function(){Object(Z.trackEvent)("flux.nav.click",{link:"history"})}),ie(oe(n),"deployHistoryPath",function(){var e=n.props,t=e.instanceId,r=e.sharedQueryParams;return Object($.l)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(n,!0).forEach(function(t){ie(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},r,{range:"24h"}),t)}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ae(e,t)}(t,o.a.Component),n=t,(r=[{key:"renderToolbar",value:function(e,t){var n=this,r=function(e){return n.isActive(e)?B.a.colors.purple700:B.a.colors.purple300};return o.a.createElement(ce,null,o.a.createElement(G.a,{to:Object($.o)(this.props.instanceId),onClick:this.handleClickReleases},o.a.createElement(J.a,{flat:!0,style:{color:r("workloads"),fontSize:B.a.fontSizes.normal},label:"Resources"})),o.a.createElement(G.a,{to:this.deployHistoryPath(),onClick:this.handleClickHistory},o.a.createElement(J.a,{flat:!0,label:"History",style:{color:r("history"),fontSize:B.a.fontSizes.normal}})),t)}},{key:"isActive",value:function(e){var t=this.context.router.routes;return z()(t).name===e}},{key:"render",value:function(){var e=this.props,t=e.hideFooter,n=e.hasReleases,r=e.instanceId,a=e.toolbarItems;return o.a.createElement(d.a,{hideFooter:t,page:"flux",instanceId:r},o.a.createElement(le,null,o.a.createElement(ue,null),o.a.createElement(se,null,this.renderToolbar(n,a),this.props.children),o.a.createElement(ue,null)))}}])&&ne(n.prototype,r),a&&ne(n,a),t}();pe.contextTypes={router:Y.a.object.isRequired};var fe=Object(p.connect)(function(e,t){var n=t.instanceId,r=Object(q.k)(e);return{hasReleases:F()(r)>0,instanceId:n}})(Object(X.a)(pe)),de=n(1312);function me(e){return(me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function he(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ye(e){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function be(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ge(e,t){return(ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var we=f.default.div.withConfig({displayName:"history-page__Container",componentId:"i5fgqu-0"})(["margin:8px 32px;"]),ke=f.default.h3.withConfig({displayName:"history-page__Title",componentId:"i5fgqu-1"})(["margin-top:20px;"]),_e=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=ye(t).call(this,e),n=!o||"object"!==me(o)&&"function"!=typeof o?be(r):o,ve(be(n),"refreshHistory",function(){n.setState({filteredHistory:n.props.history.filter(function(e){var t=e.Stamp,r=P()(t).utc().format();return n.props.startTime<=r&&r<=n.props.endTime}),isLoading:!1,isRefreshing:!1})}),ve(be(n),"loadHistory",function(e){n.setState({isRefreshing:!0}),n.props.getFluxHistory(e.instanceId,T.FLUX_ALL_WORKLOADS,null,e.endTime,!1,e.startTime).then(function(){n.debouncedRefreshHistory()})}),n.state={filteredHistory:[],isLoading:!0,isRefreshing:!1},n.debouncedLoadHistory=x()(n.loadHistory,200),n.debouncedRefreshHistory=x()(n.refreshHistory,50),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ge(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.props.updateTimeStateFromUrl(this.props.location),this.debouncedLoadHistory(this.props),this.stopPollingFluxStatus=this.props.pollFluxStatus(this.props.instanceId)}},{key:"componentWillReceiveProps",value:function(e){e.location.search!==this.props.location.search&&this.props.updateTimeStateFromUrl(e.location),e.endTime===this.props.endTime&&e.startTime===this.props.startTime||this.debouncedLoadHistory(e)}},{key:"componentWillUnmount",value:function(){this.stopPollingFluxStatus()}},{key:"render",value:function(){var e=this,t=this.props,n=t.instanceId,r=t.params,a=this.state,i=a.isLoading,c=a.isRefreshing,l=a.filteredHistory,s=i&&"Loading...",u=E()(l)&&"No deployments found.";return o.a.createElement(fe,{instanceId:n,params:r},o.a.createElement(N.a,{instanceId:this.props.params.instanceId,location:this.props.location,hasRangeSelector:!0}),o.a.createElement(we,null,o.a.createElement(ke,null,"History"),o.a.createElement(L.a,{isLoading:c},s||u||l.map(function(t){return o.a.createElement(de.a,{key:C()(t,["Event","id"]),instanceId:n,workloadId:T.FLUX_ALL_WORKLOADS,config:e.props.config,event:t})}))))}}])&&he(n.prototype,r),a&&he(n,a),t}();var Oe=Object(p.connect)(function(e,t){var n=t.params.instanceId,r=Object(q.g)(e)[n],o=Object(D.a)(e,n),a=Object(M.f)(e);return{config:r,endTime:Object(M.d)(e),history:o,instanceId:n,startTime:a}},{getFluxHistory:R.A,pollFluxStatus:R.mb,updateTimeStateFromUrl:R.Xb})(_e),Ee=n(155),Se=n(1292),xe=n(1243),je=n(9),Ce=n(399),Ie=n.n(Ce),Pe=n(64);function Te(e){return(Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ne(e){return(Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Le(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function De(e,t){return(De=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Me="_weave_dismiss_git_webhook_reminder",Ae=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=Ne(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Te(o)&&"function"!=typeof o?Le(r):o,qe(Le(n),"state",{clickedClose:!1}),qe(Le(n),"dimissGitWebhookReminder",function(){Ie.a.set(Me,!0),n.setState({clickedClose:!0})}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&De(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.props.getInstanceWebhooks(this.props.instanceId)}},{key:"render",value:function(){var e=this.props,t=e.instanceId,n=e.showGitWebhookReminder,r=this.state.clickedClose;return!n||r?null:o.a.createElement(je.Alert,{onClose:this.dimissGitWebhookReminder,type:"info"},"You can ",o.a.createElement("a",{href:Object($.Y)(t)},"configure git webhooks")," ","to speed up syncing.")}}])&&Re(n.prototype,r),a&&Re(n,a),t}();var Fe=Object(p.connect)(function(e,t){var n=t.config,r=t.fluxdState,o=Object(Pe.b)(e);return{showGitWebhookReminder:"configured"===r&&!Ie.a.get(Me)&&C()(n,["git","url"],"").includes("github.com")&&C()(o,["webhooks"])&&0===o.webhooks.filter(function(e){return e.integrationType===T.WEBHOOK_TYPE_GITHUB_PUSH}).length}},{getInstanceWebhooks:R.J})(Ae),Ue=n(409),ze=n(111),We=n(1378),Be=n(128),Ke=n(1379),Qe=n(300),He=f.default.div.withConfig({displayName:"toolbar__ToolbarContainer",componentId:"iwl9ln-0"})(["padding:6px;background-color:",";border-radius:",";height:36px;button{min-width:136px;margin-right:8px;}",";"],function(e){return e.theme.colors.gray50},function(e){return e.theme.borderRadius.soft},function(e){return e.showLockMessage&&"\n    border-bottom-left-radius: ".concat(e.theme.borderRadius.none,";\n    border-bottom-right-radius: ").concat(e.theme.borderRadius.none,";\n  ")}),Ge=function(e){var t=e.workload;return o.a.createElement(o.a.Fragment,null,t.Locked&&o.a.createElement(J.a,{flat:!0,disabled:!0,label:"Locked",fa:"fa fa-lock"}),t.Automated&&o.a.createElement(J.a,{flat:!0,disabled:!0,label:"Automated",fa:"fa fa-rocket"}))},Ve=function(e){var t=e.busy,n=e.disabled,r=e.workload,a=e.showLockingMessageEditor,i=e.onClickAutomate,c=e.onClickLock,l=e.onClickRelease,s=e.onClickCanary;return o.a.createElement(He,{showLockMessage:a},o.a.createElement(Qe.a,{permissions:["flux.policy.update"],substitute:o.a.createElement(Ge,{workload:r})},o.a.createElement(J.a,{flat:!0,style:{backgroundColor:a?B.a.colors.gray200:"transparent"},className:"tour-step-anchor deploy-lock-toggle ".concat(r.Locked?"locked":"unlocked","-state"),disabled:n,value:{workload:r},onClick:c,title:Object(Be.i)(r,t)||"Lock a resource to indicate it should not be released. It will not be automatically updated.",label:r.Locked?"Unlock":"Lock",fa:r.Locked?"fa fa-unlock":"fa fa-lock"}),o.a.createElement(J.a,{className:"tour-step-anchor deploy-automate-toggle ".concat(r.Automated?"auto":"manual","-mode"),disabled:n,value:{workload:r},onClick:i,label:r.Automated?"Deautomate":"Automate",title:Object(Be.i)(r,t)||"Automated resources will be updated when a new image is available.",fa:!r.Automated&&"fa fa-rocket",svg:r.Automated&&"wc-stop-o"})),o.a.createElement(Qe.a,{permissions:["flux.image.deploy"]},!r.upToDate&&!r.Automated&&o.a.createElement(J.a,{value:{tag:{ID:T.FLUX_LATEST_IMAGES},workload:r},className:"tour-step-anchor deploy-update-button",label:"Update",title:Object(Be.i)(r,t)||"Update all containers to the latest matching tag.",onClick:l,fa:"fa fa-arrow-up",disabled:r.Locked||n}),o.a.createElement(Ke.a,{flags:["canary"]},o.a.createElement(J.a,{label:"Canary Release",fa:"fa fa-server",onClick:s}))))},Ye=n(39),Ze=n.n(Ye),Xe=n(45),$e=function(e){return Object(Xe.transparentize)(.7,e.colors.green500)},Je=function(e){return Object(Xe.transparentize)(.7,e.colors.yellow500)},et=function(e){return e.colors.purple200};var tt=Object(f.keyframes)(["0%{background-position:-300px 0;}100%{background-position:300px 0;}"]),nt=Object(f.css)(["background-image:linear-gradient( to right,transparent 0%,"," 40%,"," 60%,transparent 100% );background-repeat:no-repeat;background-size:130px 20px;position:relative;animation:1.2s linear 0s infinite normal forwards ",";"],function(e){return Object(Xe.transparentize)(.6,e.theme.colors.white)},function(e){return Object(Xe.transparentize)(.6,e.theme.colors.white)},tt),rt=f.default.div.withConfig({displayName:"image-tag__Tag",componentId:"oiv71r-0"})(["font-family:",";font-size:",";padding:2px 6px;margin:-2px 0;border-radius:",";background-color:",";transition:background-color 0.5s;"," "," "," min-height:16px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:fit-content;margin-right:8px;.weave-matched-text{background-color:",";}",""],function(e){return e.theme.fontFamilies.monospace},function(e){return e.theme.fontSizes.small},function(e){return e.theme.borderRadius.soft},function(e){var t,n=e.current,r=e.latest,o=e.theme,a=e.disabled;return t=e.initialLoading?et(o):r&&n?$e(o):n?Je(o):et(o),a?Object(Xe.desaturate)(3,t):t},function(e){return e.inline&&"display: inline;"},function(e){return e.shimmer&&"min-width: 50px;"},function(e){return e.strikethrough&&"text-decoration: line-through;"},function(e){return Object(Xe.transparentize)(.6,e.theme.colors.blue400)},function(e){return e.shimmer&&nt}),ot=function(e){return o.a.createElement(rt,e)};function at(e){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function it(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ct(e){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function st(e,t){return(st=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pt(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var ft="Please select a value",dt=f.default.div.withConfig({displayName:"canary-form__ContainerWrapper",componentId:"sc-1af78n2-0"})([""]),mt=f.default.div.withConfig({displayName:"canary-form__TagWrapper",componentId:"sc-1af78n2-1"})(["margin-top:",";"],function(e){return e.small?"0px":"15px"}),ht=f.default.div.withConfig({displayName:"canary-form__Title",componentId:"sc-1af78n2-2"})(["font-weight:bold;margin-bottom:15px;"]),yt=f.default.div.withConfig({displayName:"canary-form__Label",componentId:"sc-1af78n2-3"})(["font-size:",";margin-bottom:",";"],function(e){var t=e.small,n=e.theme;return t?n.fontSizes.small:n.fontSizes.normal},function(e){return e.small?"5px":"10px"}),bt=f.default.div.withConfig({displayName:"canary-form__NoWrap",componentId:"sc-1af78n2-4"})(["display:flex;flex-wrap:nowrap;"]),gt=Object(f.default)(je.Button).withConfig({displayName:"canary-form__WideButton",componentId:"sc-1af78n2-5"})(["width:100%;"]),vt=Object(f.default)(gt).withConfig({displayName:"canary-form__DummyButton",componentId:"sc-1af78n2-6"})(["cursor:default;&:hover{background-color:",";}"],function(e){return e.theme.colors.white}),wt=f.default.i.withConfig({displayName:"canary-form__Caret",componentId:"sc-1af78n2-7"})(["margin-left:auto;"]),kt=f.default.div.withConfig({displayName:"canary-form__Settings",componentId:"sc-1af78n2-8"})(["margin-top:20px;margin-bottom:20px;"]),_t=f.default.div.withConfig({displayName:"canary-form__SettingRow",componentId:"sc-1af78n2-9"})(["display:flex;margin-bottom:5px;"]),Ot=f.default.div.withConfig({displayName:"canary-form__Setting",componentId:"sc-1af78n2-10"})(["display:flex;align-items:center;justify-content:space-between;flex:1 1 50%;&:first-child{margin-right:10px;}"]),Et=f.default.span.withConfig({displayName:"canary-form__SettingLabel",componentId:"sc-1af78n2-11"})(["color:",";font-size:",";"],function(e){return e.theme.colors.gray600},function(e){return e.theme.fontSizes.small}),St=Object(f.default)(je.Input).withConfig({displayName:"canary-form__SettingInput",componentId:"sc-1af78n2-12"})(["width:60px;padding:0;margin-left:5px;"]),xt=function(e,t){var n=e.map(function(e){return{label:e.ID.split(":")[1],value:e.ID}}).filter(function(e){return e.value!==t});return[{label:ft,value:""}].concat(pt(n))},jt=function(e,t,n,r){return function(a){var i=a.onClick,c=a.selectedLabel,l=C()(Ze()(t,function(t){return t.ID===e}),"CreatedAt"),s=n===e,u=r===e;return o.a.createElement(gt,{onClick:i},o.a.createElement(bt,null,c===ft?o.a.createElement(o.a.Fragment,null,c):o.a.createElement(o.a.Fragment,null,o.a.createElement(ot,{current:s,latest:u},c),o.a.createElement(je.TimestampTag,{relative:!0,timestamp:l})),o.a.createElement(wt,{className:"fa fa-caret-down"})))}},Ct=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=ct(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==at(o)&&"function"!=typeof o?lt(r):o,ut(lt(n),"handleTagSelect",function(e){return function(t,r){n.props.onSelectCanaryTag(e,{ID:r})}}),n}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&st(e,t)}(t,r["PureComponent"]),n=t,(a=[{key:"render",value:function(){var e=this,t=this.props,n=t.allContainersAvailableTags,r=t.containers,a=t.canaryTags,i=r.length>1;return o.a.createElement("div",null,o.a.createElement(dt,null,r.map(function(t){var r=C()(t,"Current.ID",""),c=C()(t,"newer.ID",r),l=!C()(t,"newer.ID"),s=C()(a,[r,"ID"]),u=C()(n,[t.Name],[]);return o.a.createElement(o.a.Fragment,{key:r},i&&o.a.createElement(ht,null,t.Name),o.a.createElement(mt,{small:i},o.a.createElement(yt,{small:i},"Current"),o.a.createElement(vt,null,o.a.createElement(bt,null,o.a.createElement(ot,{current:!0,latest:l},r.split(":")[1]),o.a.createElement(je.TimestampTag,{relative:!0,timestamp:t.currentCreatedAt})))),o.a.createElement(mt,null,o.a.createElement(yt,{small:i},"Canary"),o.a.createElement(je.Dropdown,{value:s,items:xt(u,r),withComponent:jt(s||c,u,t.Current.ID,c),width:"100%",onChange:e.handleTagSelect(r)})),o.a.createElement(kt,null,o.a.createElement(yt,null,"Canary Settings"),o.a.createElement(_t,null,o.a.createElement(Ot,null,o.a.createElement(Et,null,"Max Weight"),o.a.createElement(St,{placeholder:"50%"})),o.a.createElement(Ot,null,o.a.createElement(Et,null,"Threshold"),o.a.createElement(St,{placeholder:"10"}))),o.a.createElement(_t,null,o.a.createElement(Ot,null,o.a.createElement(Et,null,"Min Weight"),o.a.createElement(St,{placeholder:"5%"})),o.a.createElement(Ot,null,o.a.createElement(Et,null,"Step Weight"),o.a.createElement(St,{placeholder:"5%"})))))})))}}])&&it(n.prototype,a),i&&it(n,i),t}();ut(Ct,"displayName","CanaryForm");var It=Ct,Pt=n(86);function Tt(e){return(Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nt(e){return(Nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Lt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dt(e,t){return(Dt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qt=function(e){function t(){var e,n,r,o,a,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return r=this,o=(e=Nt(t)).call.apply(e,[this].concat(s)),n=!o||"object"!==Tt(o)&&"function"!=typeof o?Lt(r):o,a=Lt(n),c=function(e){e.preventDefault(),n.props.loading||n.props.handleClick()},(i="handleClick")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dt(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.n,n=e.loading,r="+".concat(t);return o.a.createElement("div",{className:"load-more",onClick:this.handleClick},n&&o.a.createElement("span",null,"Loading... ",o.a.createElement("div",{className:"load-more-circular-progress"},o.a.createElement(je.CircularProgress,{size:"small"}))),!n&&o.a.createElement("span",null,r," ",o.a.createElement("span",{className:"load-more-icon fa fa-caret-down"})))}}])&&Rt(n.prototype,r),a&&Rt(n,a),t}();function Mt(e){return(Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function At(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ft(e){return(Ft=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ut(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zt(e,t){return(zt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Wt=function(e){function t(e,n){var r,o,a,i,c,l;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=Ft(t).call(this,e,n),r=!a||"object"!==Mt(a)&&"function"!=typeof a?Ut(o):a,i=Ut(r),l=function(){var e=(r.props.history||[]).length;Object(Z.trackEvent)("flux.service.history.showmore",{allWorkloads:r.props.workloadId===T.FLUX_ALL_WORKLOADS,count:e}),r.setState({loadingMore:!0,n:Math.min(1e3,2*r.state.n)});var t=z()(r.props.history);r.loadHistory(r.props,r.state.n,t&&t.Stamp)},(c="handleClickMore")in i?Object.defineProperty(i,c,{value:l,enumerable:!0,configurable:!0,writable:!0}):i[c]=l,r.state={isMoreToLoad:!0,loadingMore:!1,n:100},r}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zt(e,t)}(t,o.a.Component),n=t,(r=[{key:"loadHistory",value:function(e){var t=this,n=e.instanceId,r=e.workloadId,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.props.getFluxHistory(n,r,o,a).then(function(e){var n=e.isMore;t.setState({isMoreToLoad:t.state.isMoreToLoad&&n,loadingMore:!1})})}},{key:"componentDidMount",value:function(){var e=this;this.stopPolling=Object(Pt.b)(function(){return e.loadHistory(e.props)},1e4)}},{key:"componentWillUnmount",value:function(){this.stopPolling()}},{key:"render",value:function(){var e=this.props,t=e.instanceId,n=e.workloadId,r=e.loading,a=e.history,i=void 0===a?[]:a,c=e.config,l=this.state,s=l.n,u=l.loadingMore,p=l.isMoreToLoad;return o.a.createElement("div",{style:this.props.style},o.a.createElement("h3",{style:{marginTop:18}},"History"),0===i.length&&o.a.createElement(je.ListItem,{style:{color:B.a.colors.purple200},text:r?"Loading...":"No historical records"}),i.map(function(e){return o.a.createElement(de.a,{key:C()(e,["Event","id"]),config:c,event:e,instanceId:t,workloadId:n})}),!r&&p&&o.a.createElement(qt,{n:s,loading:u,handleClick:this.handleClickMore}))}}])&&At(n.prototype,r),a&&At(n,a),t}();var Bt=Object(p.connect)(function(e,t){var n=t.instanceId,r=t.workloadId,o=Object(D.a)(e,n,r);return{config:Object(q.g)(e)[n],history:o,loading:!C()(Object(q.h)(e),[n,r])}},{getFluxHistory:R.A})(Wt),Kt=n(227);function Qt(e){try{return JSON.parse(e)}catch(t){return e}}var Ht=f.default.div.withConfig({displayName:"flux-read-only-message__MessageContainer",componentId:"sc-1ygqnr4-0"})(["margin:12px 0 24px 0;display:flex;align-items:center;"]),Gt=f.default.div.withConfig({displayName:"flux-read-only-message__Icon",componentId:"sc-1ygqnr4-1"})(["color:",";opacity:0.7;margin-right:12px;"],function(e){return e.theme.colors.yellow500}),Vt=f.default.div.withConfig({displayName:"flux-read-only-message__Body",componentId:"sc-1ygqnr4-2"})(["flex:1;h3{margin:0;color:",";}img{max-width:100%;max-height:300px;}blockquote{margin:8px 0 0 0;}footer{margin-top:12px;}"],function(e){return e.theme.colors.yellow500}),Yt=function(e){var t=e.antecedent,n=e.instanceId;return r.createElement(G.a,{key:t,to:Object($.p)(n,t)},t)},Zt=function(e){var t=e.readOnly,n=e.message,o=e.user,a=e.ts,i=e.antecedent,c=e.instanceId,l=t?"far fa-eye":"fa fa-lock";return r.createElement(Ht,null,r.createElement(Gt,null,r.createElement("i",{className:"fa-3x fa-fw ".concat(l)}))," ",r.createElement(Vt,null,r.createElement("h3",null,t?"Read-only":"Resource locked"),r.createElement("blockquote",null,function(e,t,n){return t?r.createElement("span",null,"This workload is controlled by a chart:"," ",r.createElement(Yt,{antecedent:t,instanceId:n})):e?r.createElement(Kt.a,{text:Qt(e)}):"No lock reason given."}(n,i,c),(o||a)&&r.createElement("footer",null,o&&r.createElement("cite",null,Object(Be.h)(o))," ",a&&r.createElement(je.TimestampTag,{relative:!0,timestamp:a})))))};Zt.defaultProps={ts:void 0};var Xt=Zt;function $t(e){return($t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function en(e){return(en=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nn(e,t){return(nn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var on=f.default.div.withConfig({displayName:"flux-lock-message-editor__EditorContainer",componentId:"sc-1p81hmd-0"})(["padding:0 6px 6px 6px;"]),an=f.default.div.withConfig({displayName:"flux-lock-message-editor__MessageForm",componentId:"sc-1p81hmd-1"})(["padding:8px;background-color:",";border:1px solid ",";border-top-right-radius:",";border-bottom-right-radius:",";border-bottom-left-radius:",";"],function(e){var t=e.preview,n=e.theme;return t?n.colors.gray50:"white"},function(e){return e.theme.colors.gray200},function(e){return e.theme.borderRadius.soft},function(e){return e.theme.borderRadius.soft},function(e){return e.theme.borderRadius.soft}),cn=f.default.textarea.withConfig({displayName:"flux-lock-message-editor__MessageTextarea",componentId:"sc-1p81hmd-2"})(["outline:none;border:none;width:100%;font-size:",";height:100px;box-sizing:border-box;margin-bottom:4px;resize:none;"],function(e){return e.theme.fontSizes.small}),ln=Object(f.default)(Kt.a).withConfig({displayName:"flux-lock-message-editor__MarkdownPreview",componentId:"sc-1p81hmd-3"})(["min-height:100px;margin-bottom:4px;padding:2px;font-size:",";"],function(e){return e.theme.fontSizes.small}),sn=Object(f.default)(J.a).withConfig({displayName:"flux-lock-message-editor__TabButton",componentId:"sc-1p81hmd-4"})(["border:1px solid ",";border-bottom:1px solid ",";margin-bottom:-1px;box-shadow:none;border-top-left-radius:",";border-top-right-radius:",";"],function(e){return e.theme.colors.gray200},function(e){var t=e.active,n=e.theme;return t?"transparent":n.colors.gray200},function(e){return e.theme.borderRadius.soft},function(e){return e.theme.borderRadius.soft}),un=Object(f.default)(sn).withConfig({displayName:"flux-lock-message-editor__PreviewButton",componentId:"sc-1p81hmd-5"})(["background-color:",";"],function(e){return e.theme.colors.gray50}),pn=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=en(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==$t(o)&&"function"!=typeof o?tn(r):o,rn(tn(n),"state",{showPreview:!1}),rn(tn(n),"togglePreview",function(){n.setState({showPreview:!n.state.showPreview})}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nn(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.onClickLock,n=e.onClickCancel,r=e.disabled,a=e.message,i=e.user,c=e.onChange,l=e.locked,s=this.state.showPreview;return o.a.createElement(on,null,o.a.createElement(sn,{active:!s,label:"Write",onClick:this.togglePreview})," ",o.a.createElement(un,{active:s,value:!0,onClick:this.togglePreview,label:"Preview"}),o.a.createElement(an,{preview:s},!s&&o.a.createElement(cn,{autoFocus:!0,value:a,onChange:c,disabled:r,placeholder:"I am ".concat(l?"unlocking":"locking"," this resource because...")}),s&&(l?o.a.createElement(ln,{text:a}):o.a.createElement(Xt,{message:a,user:i})),o.a.createElement(J.a,{style:{border:"1px solid #ccc"},disabled:r,value:{lock:!l},label:l?"Unlock":"Lock",fa:l?"fa fa-unlock":"fa fa-lock",onClick:t}),!s&&o.a.createElement(J.a,{disabled:r,flat:!0,label:"Cancel",onClick:n})))}}])&&Jt(n.prototype,r),a&&Jt(n,a),t}(),fn=n(1380),dn=n.n(fn),mn=function(e){Object(Z.trackEvent)("flux.readonly.configure.click"),Q.a.push(Object($.k)(e))},hn=function(e){return e.theme.colors.white},yn=function(e){return Object(Xe.transparentize)(.7,e.theme.colors.gray200)},bn=f.default.div.withConfig({displayName:"flux-config-instructions__ScreenshotContainer",componentId:"sc-1lih4zn-0"})(["padding:8px;box-shadow:",";border-radius:",";background-color:",";"],function(e){return e.theme.boxShadow.light},function(e){return e.theme.borderRadius.soft},function(e){return e.theme.colors.purple25}),gn=f.default.div.withConfig({displayName:"flux-config-instructions__Instructions",componentId:"sc-1lih4zn-1"})(["background-color:",";border:1px solid ",";border-radius:",";font-size:",";button{height:34px;}padding:24px;margin:24px;h3{margin-top:0;}ul{list-style:inherit;}"],hn,yn,function(e){return e.theme.borderRadius.soft},function(e){return e.theme.fontSizes.small}),vn=f.default.div.withConfig({displayName:"flux-config-instructions__Banner",componentId:"sc-1lih4zn-2"})(["background-color:",";border:1px solid ",";border-radius:",";font-size:",";button{height:34px;}padding:6px 8px 6px 12px;margin-bottom:12px;i{color:",";}"],hn,yn,function(e){return e.theme.borderRadius.soft},function(e){return e.theme.fontSizes.small},function(e){return e.theme.colors.yellow500}),wn=Object(f.default)(J.a).withConfig({displayName:"flux-config-instructions__BannerButton",componentId:"sc-1lih4zn-3"})(["margin-left:8px;"]),kn=function(e){var t=e.instanceId;return o.a.createElement(vn,null,o.a.createElement("i",{className:"fa fa-exclamation-triangle fa-fw"})," One-click deploy actions are disabled. Workloads are read-only."," ",o.a.createElement(wn,{primary:!0,value:t,onClick:mn,label:"Configure"}))},_n=function(e){var t=e.instanceId;return o.a.createElement(gn,null,o.a.createElement("h3",null,"Automate deployment with GitOps"),o.a.createElement(bn,null,o.a.createElement("img",{src:dn.a,style:{width:631},alt:"See a record of all the changes to your cluster"})),o.a.createElement("p",null,"Configuring the Git repository enables:"),o.a.createElement("ul",null,o.a.createElement("li",null,"One-click deploy actions"),o.a.createElement("li",null,"Pull request based deploys are secure and safe"),o.a.createElement("li",null,"See dry run before releasing"),o.a.createElement("li",null,"Easy selection of workloads to batch deploy"),o.a.createElement("li",null,"A full deployment event history"),o.a.createElement("li",null,"Auto-update, rollbacks, lock/unlock of deployments"),o.a.createElement("li",null,"To learn more, read about:"," ",o.a.createElement("a",{href:"https://www.weave.works/blog/gitops-operations-by-pull-request",target:"_blank"},"GitOpsOperations by pull request"))),o.a.createElement(J.a,{primary:!0,value:t,onClick:mn,label:"Configure Git repository"}))},On=n(1381),En=n.n(On),Sn=n(1382),xn=n.n(Sn),jn=n(282),Cn=n(46),In=n.n(Cn),Pn=n(112),Tn=n.n(Pn),Rn=n(2373),Nn=n(302);function Ln(e){return(Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qn(e){return(qn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function An(e,t){return(An=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Un=function(e){return Object(Xe.mix)(.9,e.theme.colors.purple700,e.theme.colors.purple25)},zn=f.default.div.withConfig({displayName:"nudge__NudgePopover",componentId:"tpofcq-0"})(["color:",";background-color:",";font-size:",";max-width:200px;border-radius:",";border:1px solid ",";margin:14px;padding:14px;box-shadow:",";h3,p{color:",";margin:0 0 12px 0;}"],function(e){return e.theme.colors.white},Un,function(e){return e.theme.fontSizes.small},function(e){return e.theme.borderRadius.soft},Un,function(e){return e.theme.boxShadow.light},function(e){return e.theme.colors.white}),Wn=f.default.div.withConfig({displayName:"nudge__ButtonContainer",componentId:"tpofcq-1"})(["text-align:right;"]),Bn=f.default.div.withConfig({displayName:"nudge__Arrow",componentId:"tpofcq-2"})(["position:absolute;width:3em;height:3em;&[data-placement*='bottom']{top:0;left:0;margin-top:-0.9em;width:3em;height:1em;&::before{border-width:0 1.5em 1em 1.5em;border-color:transparent transparent "," transparent;}}&[data-placement*='top']{bottom:0;left:0;margin-bottom:-0.9em;width:3em;height:1em;&::before{border-width:1em 1.5em 0 1.5em;border-color:"," transparent transparent transparent;}}&[data-placement*='right']{left:0;margin-left:-0.9em;height:3em;width:1em;&::before{border-width:1.5em 1em 1.5em 0;border-color:transparent "," transparent transparent;}}&[data-placement*='left']{right:0;margin-right:-0.9em;height:3em;width:1em;&::before{border-width:1.5em 0 1.5em 1em;border-color:transparent transparent transparent ",";}}&::before{content:'';margin:auto;display:block;width:0;height:0;border-style:solid;}"],Un,Un,Un,Un),Kn=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=qn(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Ln(o)&&"function"!=typeof o?Mn(r):o,Fn(Mn(n),"handleClickClose",function(){var e=n.props.name;n.props.dismissNudge(e)}),Fn(Mn(n),"handleCallDismiss",function(){var e=n.props.name;n.props.dismissNudge(e,!1)}),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&An(e,t)}(t,r["Component"]),n=t,(o=[{key:"componentDidMount",value:function(){this.props.loadUserEvents()}},{key:"render",value:function(){var e=this,t=this.props,n=t.instance,o=t.children,a=t.show,i=t.content,c=t.events,l=n&&Object(Nn.c)(n,["nudges"]),s=l&&a(c)&&r.createElement(r.Fragment,null,r.createElement("h3",null,"Tip!"),i,r.createElement(Wn,null,r.createElement(je.Button,{onClick:this.handleClickClose,text:"Close"}))),u=document.querySelector("#app-popovers");if(!u)throw new Error("There should really be an #app-popovers container");return r.createElement(Rn.a,null,r.createElement(Rn.c,null,function(t){var n=t.ref;return r.createElement("div",{ref:n},o(l?e.handleCallDismiss:In.a))}),Boolean(s)&&Tn.a.createPortal(r.createElement(Rn.b,{placement:"bottom"},function(e){var t=e.ref,n=e.style,o=e.placement,a=e.arrowProps;return r.createElement(zn,{ref:t,style:n},s,r.createElement(Bn,{"data-placement":o,ref:a.ref,style:a.style}))}),u))}}])&&Dn(n.prototype,o),a&&Dn(n,a),t}();var Qn=Object(p.connect)(function(e){return{events:e.root.userEvents,instance:Object(Pe.b)(e)}},{dismissNudge:R.o,loadUserEvents:R.Y})(Kn),Hn=Object(p.connect)(function(e){return{isFluxConfigured:q.j(e)}})(function(e){var t=e.children,n=e.isFluxConfigured,o=e.disabled;return r.createElement(Qn,{name:"batchaction",content:r.createElement("p",null,"If you select multiple workloads, you can lock and automate them in a batch with this menu."),show:function(e){return!o&&n&&function(e){var t=Object(jn.b)(e,"flux.service.lock"),n=Object(jn.b)(e,"flux.service.automate"),r=Object(jn.b)(e,"nudges.dismissed",{name:"batchaction"});return Boolean(t||n)&&!r}(e)}},t)}),Gn=Object(p.connect)(function(e){return{isFluxConfigured:q.j(e)}})(function(e){var t=e.children,n=e.isFluxConfigured,o=e.disabled;return r.createElement(Qn,{name:"deploytagfilter",content:r.createElement("p",null,"Filter which tags are released when updating."),show:function(e){return!o&&n&&function(e){var t=Object(jn.b)(e,"flux.service.image.release"),n=Object(jn.b)(e,"nudges.dismissed",{name:"deploytagfilter"});return Boolean(t)&&!n}(e)}},t)}),Vn=n(1722),Yn=n.n(Vn),Zn=n(73);function Xn(e){return(Xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jn(e){return(Jn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function er(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tr(e,t){return(tr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rr=f.default.h3.withConfig({displayName:"filter-tags__Text",componentId:"d369uw-0"})(["margin-top:10px;"]),or=Object(f.default)(je.Button).withConfig({displayName:"filter-tags__StyledButton",componentId:"d369uw-1"})(["margin-bottom:10px;background-color:transparent;color:",";box-shadow:none;&:hover{background-color:",";}",";"],function(e){return e.theme.colors.purple500},function(e){return e.theme.colors.purple100},function(e){return e.active&&"\n    background-color: ".concat(e.theme.colors.purple100,";\n    ")}),ar=f.default.div.withConfig({displayName:"filter-tags__Options",componentId:"d369uw-2"})(["display:flex;justify-content:space-between;margin:0 auto 10px;max-width:500px;"]),ir=f.default.div.withConfig({displayName:"filter-tags__Option",componentId:"d369uw-3"})(["text-align:center;"]),cr=f.default.div.withConfig({displayName:"filter-tags__OptionText",componentId:"d369uw-4"})([""]),lr=f.default.div.withConfig({displayName:"filter-tags__Matches",componentId:"d369uw-5"})(["display:flex;flex-wrap:wrap;margin-bottom:30px;padding-right:8px;padding-left:8px;"]),sr=Object(f.default)(ot).withConfig({displayName:"filter-tags__StyledImageTag",componentId:"d369uw-6"})(["margin-bottom:10px;",";"],function(e){return e.disabled&&"\n    opacity: 0.5;\n  "}),ur=function(e,t,n){return 0===e.length?[]:e.filter(function(e){return Object(Be.n)(e.ID,t,n)})},pr=function(e,t){return Yn()(e,t,function(e,t){return e.ID===t.ID})},fr=function(e){return function(t){return e===t}},dr=fr(Zn.a),mr=fr(Zn.e),hr=fr(Zn.d),yr=function(e){function t(e){var n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=Jn(t).call(this,e),n=!a||"object"!==Xn(a)&&"function"!=typeof a?er(r):a,nr(er(n),"reset",function(){n.setState({filterMode:n.props.filterMode,value:n.props.filterValue})}),nr(er(n),"updateMatches",function(){var e=ur(n.props.tags||[],n.state.value,n.state.filterMode);n.setState({matches:e,restTags:pr(n.props.tags||[],e)})}),nr(er(n),"debouncedUpdateMatches",x()(n.updateMatches,200)),nr(er(n),"handleInputChange",function(e){var t=e.currentTarget.value;n.setState({value:t}),n.debouncedUpdateMatches(),n.props.onChange(t,n.state.filterMode)}),nr(er(n),"handleModeChange",function(e){return function(){n.setState({filterMode:e},function(){n.updateMatches()}),n.props.onChange(n.state.value,e)}}),nr(er(n),"renderTag",function(e){return function(t){var r=t.ID===n.props.current,a=t.ID===n.props.latestId;return o.a.createElement(sr,{key:t.ID,current:r,latest:a,disabled:e},Object(Be.m)(t.ID))}});var i=ur(n.props.tags||[],e.filterValue,e.filterMode);return n.state={filterMode:e.filterMode||Zn.a,matches:i,restTags:pr(n.props.tags||[],i),value:e.filterValue},n}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tr(e,t)}(t,r["Component"]),n=t,(a=[{key:"render",value:function(){var e=this.state,t=e.filterMode,n=e.matches,r=e.restTags,a=e.value;return o.a.createElement("div",null,o.a.createElement(rr,null,"Only tags that match the rule are released when doing an update."),o.a.createElement(ar,null,o.a.createElement(ir,null,o.a.createElement(or,{active:dr(t),onClick:this.handleModeChange(Zn.a)},"Glob"),o.a.createElement(cr,null,"e.g. master-*")),o.a.createElement(ir,null,o.a.createElement(or,{active:mr(t),onClick:this.handleModeChange(Zn.e)},"Semantic Versioning"),o.a.createElement(cr,null,"e.g. >1.3.x")),o.a.createElement(ir,null,o.a.createElement(or,{active:hr(t),onClick:this.handleModeChange(Zn.d)},"Regular Expression"),o.a.createElement(cr,null,"e.g. ^[a-Z][0-9]+$"))),o.a.createElement(je.Input,{placeholder:"Enter expression",onChange:this.handleInputChange,value:a}),o.a.createElement(rr,null,"Matching tags:"),o.a.createElement(lr,null,En()(n,10).map(this.renderTag(!1)),n.length<10&&En()(r,10-n.length).map(this.renderTag(!0)),0===n.length&&o.a.createElement("span",null,"No matching tags.")))}}])&&$n(n.prototype,a),i&&$n(n,i),t}();nr(yr,"displayName","FilterTagsDialog");var br=yr,gr=n(1396);function vr(e){return(vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kr(e,t){return!t||"object"!==vr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _r(e){return(_r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Or(e,t){return(Or=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Er,Sr={ARROW_LEFT:o.a.createElement(function(){return o.a.createElement("svg",{className:"behind",viewBox:"-12 -10 50 70"},o.a.createElement("path",{d:"M14.6103373,24.7006484 L29.7198245,39.8101356 C31.2819217,41.3722328 31.2819217,43.9048927 29.7198245,45.4669899 L27.2428554,47.943959 C25.6807582,49.5060562 23.1480983,49.5060562 21.5860011,47.943959 L1.60429261,27.9622505 C0.710692259,27.0686502 0.328277514,25.8574398 0.457048382,24.6919981 C0.334630674,23.5325266 0.717743899,22.3297858 1.60638806,21.4411416 L21.5880966,1.45943314 C23.1501937,-0.102664028 25.6828536,-0.102664028 27.2449508,1.45943314 L29.7198245,3.93430687 C31.2819217,5.49640404 31.2819217,8.02906396 29.7198245,9.59116112 L14.6103373,24.7006484 Z",id:"Combined-Shape",transform:"translate(15.662059, 24.701696) scale(-1, 1) translate(-15.662059, -24.701696) "}))},null),ARROW_RIGHT:o.a.createElement(function(){return o.a.createElement("svg",{className:"ahead",viewBox:"-8 -10 50 70"},o.a.createElement("g",{id:"Angle",transform:"translate(15.500000, 25.000000) scale(-1, 1) translate(-15.500000, -25.000000) "},o.a.createElement("path",{d:"M14.6103373,24.7006484 L29.7198245,39.8101356 C31.2819217,41.3722328 31.2819217,43.9048927 29.7198245,45.4669899 L27.2428554,47.943959 C25.6807582,49.5060562 23.1480983,49.5060562 21.5860011,47.943959 L1.60429261,27.9622505 C0.710692259,27.0686502 0.328277514,25.8574398 0.457048382,24.6919981 C0.334630674,23.5325266 0.717743899,22.3297858 1.60638806,21.4411416 L21.5880966,1.45943314 C23.1501937,-0.102664028 25.6828536,-0.102664028 27.2449508,1.45943314 L29.7198245,3.93430687 C31.2819217,5.49640404 31.2819217,8.02906396 29.7198245,9.59116112 L14.6103373,24.7006484 Z",id:"Combined-Shape",transform:"translate(15.662059, 24.701696) scale(-1, 1) translate(-15.662059, -24.701696) "})))},null),DASH:o.a.createElement(function(){return o.a.createElement("svg",{className:"none",viewBox:"0 -13 50 70"},o.a.createElement("rect",{id:"Combined-Shape",x:"0",y:"16",width:"50",height:"13",rx:"4"}))},null),EQUALS:o.a.createElement(function(){return o.a.createElement("svg",{className:"equal",viewBox:"0 -13 50 70"},o.a.createElement("path",{d:"M4,6 L46,6 C48.209139,6 50,7.790861 50,10 L50,15 C50,17.209139 48.209139,19 46,19 L4,19 C1.790861,19 2.705415e-16,17.209139 0,15 L0,10 C-2.705415e-16,7.790861 1.790861,6 4,6 Z M4,26 L46,26 C48.209139,26 50,27.790861 50,30 L50,35 C50,37.209139 48.209139,39 46,39 L4,39 C1.790861,39 2.705415e-16,37.209139 0,35 L0,30 C-2.705415e-16,27.790861 1.790861,26 4,26 Z",id:"Combined-Shape"}))},null)},xr=f.default.div.withConfig({displayName:"comparison-icon__Container",componentId:"gwsg1v-0"})(["position:relative;color:",";width:1em;height:1em;border-radius:",";svg{position:absolute;border-radius:",";top:0;width:20px;height:20px;fill:",";&.ahead,&.behind{background-color:",";}&.equal{background-color:",";}&.none{background-color:",";}&.ahead{background-color:",";}}&.container-fa-exchange{background-color:",";}&.container-fa-minus{background-color:",";}&.container-fa-angle-right{background-color:",";}"],function(e){return e.theme.colors.white},function(e){return e.theme.borderRadius.soft},function(e){return e.theme.borderRadius.soft},function(e){return e.theme.colors.white},function(e){return e.theme.colors.blue600},function(e){return e.theme.colors.green500},function(e){return e.theme.colors.gray600},function(e){return e.theme.colors.yellow500},function(e){return e.theme.colors.green500},function(e){return e.theme.colors.gray600},function(e){return e.theme.colors.blue600}),jr=(Er=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),kr(this,_r(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Or(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.className,n=e.target,r=e.container,a=Sr[function(e,t){return e?E()(t)?"DASH":e.currentTag===t.currentTag?"EQUALS":new Date(e.currentCreatedAt)>new Date(t.CreatedAt||C()(t,"Current.CreatedAt"))?"ARROW_RIGHT":"ARROW_LEFT":null}(r,n)];return o.a.createElement("div",{className:t},o.a.createElement(xr,{className:"container"},a))}}])&&wr(n.prototype,r),a&&wr(n,a),t}(),Object(f.default)(Er).withConfig({displayName:"comparison-icon",componentId:"gwsg1v-1"})(["width:100%;display:flex;flex-direction:column;align-items:center;"]));function Cr(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Ir=f.default.td.withConfig({displayName:"components__Cell",componentId:"sc-1t7sg45-0"})(["font-size:",";padding:10px 8px;.weave-matched-text{border:none;}",";",""],function(e){return e.theme.fontSizes.normal},function(e){var t=e.border;return t&&"border-".concat(t,": 1px dashed ").concat(xe.a.cellBorder," !important;")},function(e){var t=e.align;return t&&"text-align: ".concat(t,";")}),Pr=f.default.div.withConfig({displayName:"components__CheckboxWrapper",componentId:"sc-1t7sg45-1"})(["display:inline-block;border-radius:2px;line-height:1px;input{cursor:pointer;margin:0;}"]),Tr=Object(f.default)(Ir).withConfig({displayName:"components__CheckboxCell",componentId:"sc-1t7sg45-2"})(["&:hover ","{box-shadow:0px 0px 0px 2px ",";background-color:",";}"],Pr,Object(Xe.transparentize)(.5,xe.a.highlight),Object(Xe.transparentize)(.5,xe.a.highlight)),Rr=function(e){var t=e.children,n=Cr(e,["children"]);return r.createElement(Tr,n,r.createElement(Pr,null,t))},Nr=Object(f.default)(Ir).withConfig({displayName:"components__UpdateButtonCell",componentId:"sc-1t7sg45-3"})(["padding:5px 0 0 12px !important;text-align:center;"]),Lr=Object(f.default)(J.a).withConfig({displayName:"components__UpdateButton",componentId:"sc-1t7sg45-4"})(["padding:0;font-size:",";height:28px;"],function(e){return e.theme.fontSizes.small}),Dr=Object(f.default)(J.b).withConfig({displayName:"components__UpdateLabel",componentId:"sc-1t7sg45-5"})(["padding:0;line-height:16px;"]),qr=f.default.span.withConfig({displayName:"components__SubText",componentId:"sc-1t7sg45-6"})(["white-space:nowrap;display:",";color:",";"," font-size:",";line-height:18px;font-weight:normal;font-style:normal;font-stretch:normal;letter-spacing:normal;"],function(e){return e.inline?"inline":"block"},function(e){return e.color||xe.a.grayText},function(e){return e.inline&&"margin-left: 2px;"},function(e){return e.theme.fontSizes.small}),Mr=f.default.span.withConfig({displayName:"components__TimestampWrapper",componentId:"sc-1t7sg45-7"})(["height:16px;line-height:16px;padding:2px 0;margin:-2px 0;"]),Ar=Object(f.default)(Ir).withConfig({displayName:"components__ImageCell",componentId:"sc-1t7sg45-8"})([""]),Fr=f.default.div.withConfig({displayName:"components__ImageCellFlexer",componentId:"sc-1t7sg45-9"})(["display:flex;align-items:center;"]),Ur=function(e){var t=e.id,n=e.tag,o=e.createdAt,a=e.searchTerms,i=e.latest,c=e.subtextClassname,l=e.border,s=e.className,u=e.compact,p=e.loading,f=e.shimmer,d=e.strikethrough,m=e.align,h=e.current;return r.createElement(Ar,{align:m,border:l,className:s},r.createElement(Fr,null,function(e,t,n){return e?null:t?n?null:r.createElement(qr,null,r.createElement("em",null,"No tag specified")):r.createElement(qr,null,r.createElement("em",null,"No workload found"))}(p,t,n)||r.createElement(r.Fragment,null,r.createElement(ot,{shimmer:Boolean(f||p),strikethrough:d,title:t,initialLoading:!t&&p,latest:Boolean(i),current:Boolean(h)},r.createElement(je.MatchedText,{text:n||"",matches:a})),t&&o&&r.createElement(Mr,{className:c},r.createElement(je.TimestampTag,{relative:!0,compact:u,timestamp:o})))))};function zr(e){return(zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Br(e,t){return!t||"object"!==zr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Kr(e){return(Kr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qr(e,t){return(Qr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Ur.defaultProps={align:"",border:"",className:"",compact:!0,current:!0,latest:!1,loading:!1,searchTerms:[],shimmer:!1,strikethrough:!1,subtextClassname:""};var Hr=f.default.div.withConfig({displayName:"flux-tag-list__Container",componentId:"sc-1cv5e0l-0"})([""]),Gr=f.default.table.withConfig({displayName:"flux-tag-list__TagsList",componentId:"sc-1cv5e0l-1"})(["border-collapse:collapse;width:100%;table-layout:fixed;"]),Vr=f.default.tr.withConfig({displayName:"flux-tag-list__Row",componentId:"sc-1cv5e0l-2"})(["",";"],function(e){return e.current&&Object(f.css)(["background-color:",";"],Object(Xe.transparentize)(.5,e.theme.colors.purple100))}),Yr=Object(f.default)(Ur).withConfig({displayName:"flux-tag-list__AvailableImageCell",componentId:"sc-1cv5e0l-3"})(["",";"],function(e){return!e.matchesTag&&Object(f.css)(["opacity:0.5;"])}),Zr=function(e){var t=e.busy,n=e.isCurrent,r=e.newer,a=e.tagFilter,i=e.tagFilterPrefix,c=e.tag,l=e.workload,s=e.onClickRelease,u=e.disabled,p=!l.Automated&&!l.ReadOnly&&o.a.createElement(Qe.a,{permissions:["flux.image.deploy"]},o.a.createElement(Lr,{label:"Release",title:Object(Be.i)(l,t),value:{tag:c,workload:l},disabled:u||l.Locked,onClick:s}));return o.a.createElement(Vr,{current:n},o.a.createElement(Yr,{matchesTag:Object(Be.n)(c.ID,a,i),id:c.ID,tag:Object(Be.m)(c.ID),createdAt:c.CreatedAt,isCurrent:n,compact:!1,current:n,latest:!r}),o.a.createElement(Nr,{style:{width:"90px"}},n?o.a.createElement(J.b,null,"Current"):p))},Xr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Br(this,Kr(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qr(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.busy,n=e.container,r=e.workload,a=e.onClickRelease,i=e.disabled,c=e.tagFilter,l=e.tagFilterPrefix,s=e.expanded,u=this.props.tags,p=void 0===u?[]:u,f=0;s||(f=p.length-4,p=En()(p,4));var d=null===c?n.tagFilter:c;return o.a.createElement(Hr,null,o.a.createElement(Gr,null,o.a.createElement("tbody",null,p.map(function(e){return o.a.createElement(Zr,{busy:t,tagFilter:d,tagFilterPrefix:l||n.tagFilterPrefix,disabled:i,key:e.ID,isCurrent:n.Current.ID===e.ID,newer:n.newer,tag:e,workload:r,onClickRelease:a})}))),o.a.createElement(gr.a,{handleClick:this.props.onClickMore,collection:this.props.tags,expanded:s,notShown:f}))}}])&&Wr(n.prototype,r),a&&Wr(n,a),t}();function $r(e){return($r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eo(e){return(eo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function to(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function no(e,t){return(no=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ro(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var oo=f.default.span.withConfig({displayName:"flux-container-details__StatusLine",componentId:"sc-83pcu3-0"})(["font-weight:bold;"]),ao=function(e){var t=e.container;return o.a.createElement(oo,null,t.diverged&&t.divergedMessage,!t.diverged&&t.behind&&o.a.createElement(xn.a,{plural:"versions behind latest",singular:"version behind latest",count:t.behind}),t.updating&&"Updating...",t.upToDate&&"Up to date")},io=f.default.div.withConfig({displayName:"flux-container-details__RequestStatus",componentId:"sc-83pcu3-1"})(["padding:16px;"]),co=f.default.div.withConfig({displayName:"flux-container-details__TagListToolbar",componentId:"sc-83pcu3-2"})(["display:flex;padding:6px 0px;justify-content:flex-end;align-items:center;border-bottom:1px dotted ",";"],B.a.colors.purple100),lo=f.default.span.withConfig({displayName:"flux-container-details__CurrentFilter",componentId:"sc-83pcu3-3"})(["font-size:",";margin-right:8px;"],function(e){return e.theme.fontSizes.small}),so=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=eo(t).call(this,e),n=!o||"object"!==$r(o)&&"function"!=typeof o?to(r):o,ro(to(n),"filterTagsRef",void 0),ro(to(n),"itemRef",void 0),ro(to(n),"closeAlert",function(){n.setState({alertVisible:!1})}),ro(to(n),"toggleFilterModal",function(){var e=n.state.showFilterModal;e&&Object(Z.trackEvent)("flux.service.tagfilterdialog.show"),n.setState({showFilterModal:!e})}),ro(to(n),"doSubmit",function(e,t,r){n.props.doSubmit(e,t,r||Zn.a,e.tagFilter||"").catch(function(e){var t=e.errors;n.setState({tagFilterNotices:t})}),n.setState({tagFilterPrefix:r,tagFilterValue:t})}),ro(to(n),"handleClickMore",function(){var e=(n.props.availableTags||[]).length;Object(Z.trackEvent)("flux.service.images.showmore",{count:e});var t=!n.state.tagListExpanded;n.setState({tagListExpanded:t})}),ro(to(n),"handleTagFilterChange",function(e,t){n.setState({unsavedTagFilterPrefix:t,unsavedTagFilterValue:e})}),ro(to(n),"handleTagFilterCancel",function(){n.setState({tagFilterPrefix:C()(n.props,"container.tagFilterPrefix",Zn.a),tagFilterValue:C()(n.props,"container.tagFilter","")}),n.toggleFilterModal(),n.filterTagsRef.reset()}),ro(to(n),"handleTagFilterSave",function(){var e=n.props.container,t=n.state,r=t.unsavedTagFilterValue,o=t.unsavedTagFilterPrefix;Object(Z.trackEvent)("flux.service.tagfilterdialog.save.click",{type:o}),n.closeAlert(),n.toggleFilterModal(),n.doSubmit(e,r,o)}),ro(to(n),"handleTagFilterDelete",function(){var e=n.props.container;Object(Z.trackEvent)("flux.service.tagfilterdialog.delete.click"),n.setState({tagFilterPrefix:Zn.a,tagFilterValue:""},function(){n.toggleFilterModal(),n.doSubmit(e,"",Zn.a)})}),n.state={alertVisible:!1,showFilterModal:!1,tagFilterNotices:null,tagFilterPrefix:null,tagFilterValue:null,tagListExpanded:!1,unsavedTagFilterPrefix:null,unsavedTagFilterValue:""},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&no(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this,t=this.props,n=t.busy,r=t.isFirstItem,a=t.disabled,i=t.container,c=t.containerDetailsLoaded,l=t.availableTags,s=t.workload,u=t.onClickRelease,p=t.loading,f=t.error,d=t.onClickRetry,m=null===this.state.tagFilterValue?i.tagFilter:this.state.tagFilterValue,h=this.state.tagFilterPrefix||i.tagFilterPrefix,y=l&&En()(l,100);return o.a.createElement("div",{ref:function(t){t&&(e.itemRef=t)}},o.a.createElement(Ue.a,null,o.a.createElement(je.Alert,{type:"error",visible:this.state.alertVisible,onClose:this.closeAlert},(this.state.tagFilterNotices||[]).map(function(e){return e.message}).join(". "))),o.a.createElement(je.ListItem,{style:{padding:0},text:i.Name,subText:o.a.createElement("span",null,i.imageRepo,i.currentTag?":".concat(i.currentTag):o.a.createElement("em",null," (No tag specified)"),o.a.createElement("br",null),i.Current.CreatedAt&&o.a.createElement(je.TimestampTag,{relative:!0,timestamp:i.Current.CreatedAt}),c&&o.a.createElement(ao,{container:i}))}),o.a.createElement(co,{expanded:this.state.tagListExpanded},m&&o.a.createElement(lo,null,"Tags filtered via ",h,": ",m),o.a.createElement(Qe.a,{permissions:["flux.policy.update"]},o.a.createElement(Gn,{disabled:!r||a},function(t){return o.a.createElement(J.a,{label:"Filter tags",title:"Filter tags",onClick:function(){return t(),e.toggleFilterModal()},onClose:e.toggleFilterModal,fa:"fa fa-filter"})}))),o.a.createElement(je.Dialog,{title:"Deploy rules",active:this.state.showFilterModal,actions:[o.a.createElement(je.Button,{onClick:this.handleTagFilterSave,primary:!0,disabled:!this.state.unsavedTagFilterValue},"Save"),o.a.createElement(je.Button,{onClick:this.handleTagFilterCancel},"Cancel"),o.a.createElement(je.Button,{onClick:this.handleTagFilterDelete,danger:!0},"Delete")],onClose:this.handleTagFilterCancel},o.a.createElement(br,{ref:function(t){t&&(e.filterTagsRef=t)},current:C()(i,"Current.ID",""),latestId:C()(i,"newer.ID",""),filterValue:m||"",filterMode:h||Zn.a,tags:y,onChange:this.handleTagFilterChange})),!y&&p&&o.a.createElement(io,null,o.a.createElement(je.CircularProgress,{inline:!0,size:20})),!y&&!p&&o.a.createElement(io,null,f||"Empty"," ",o.a.createElement(J.a,{label:"Retry",onClick:d})),y&&o.a.createElement(Xr,{tags:y,busy:n,disabled:a,container:i,tagFilter:m,tagFilterPrefix:h,workload:s,onClickRelease:u,onClickMore:this.handleClickMore,expanded:this.state.tagListExpanded}))}}])&&Jr(n.prototype,r),a&&Jr(n,a),t}();function uo(e){return(uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function po(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function fo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?po(n,!0).forEach(function(t){go(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):po(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function mo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ho(e){return(ho=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bo(e,t){return(bo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function go(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vo=f.default.div.withConfig({displayName:"flux-workload-details__PageContainer",componentId:"sc-1v6qx6e-0"})(["display:flex;flex-direction:column;h2{margin:0;}"]),wo=f.default.div.withConfig({displayName:"flux-workload-details__ColumnContainer",componentId:"sc-1v6qx6e-1"})(["display:flex;flex:1;align-items:stretch;min-height:0;"]),ko=f.default.h3.withConfig({displayName:"flux-workload-details__SectionHeader",componentId:"sc-1v6qx6e-2"})(["margin-top:18px;"]),_o=f.default.div.withConfig({displayName:"flux-workload-details__MainColumn",componentId:"sc-1v6qx6e-3"})(["flex:1;"]),Oo=f.default.div.withConfig({displayName:"flux-workload-details__SubColumn",componentId:"sc-1v6qx6e-4"})(["flex:1 1 30%;margin-left:32px;"]),Eo=f.default.div.withConfig({displayName:"flux-workload-details__Title",componentId:"sc-1v6qx6e-5"})(["display:flex;align-items:flex-end;justify-content:space-between;margin-bottom:12px;"]),So=f.default.div.withConfig({displayName:"flux-workload-details__LockMessageWrapper",componentId:"sc-1v6qx6e-6"})(["background-color:",";border-bottom-left-radius:",";border-bottom-right-radius:",";"],function(e){return e.theme.colors.gray50},function(e){return e.theme.borderRadius.soft},function(e){return e.theme.borderRadius.soft}),xo=f.default.div.withConfig({displayName:"flux-workload-details__GotoAntecedent",componentId:"sc-1v6qx6e-7"})(["font-size:",";margin-bottom:12px;"],function(e){return e.theme.fontSizes.small}),jo=f.default.div.withConfig({displayName:"flux-workload-details__DeployStatusContainer",componentId:"sc-1v6qx6e-8"})(["margin-bottom:36px;margin-left:8px;","{margin-left:16px;}"],We.a),Co=f.default.div.withConfig({displayName:"flux-workload-details__SyncError",componentId:"sc-1v6qx6e-9"})(["color:",";margin-top:16px;"],function(e){return e.theme.colors.orange800}),Io=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=ho(t).call(this,e),n=!o||"object"!==uo(o)&&"function"!=typeof o?yo(r):o,go(yo(n),"stopPollingFluxWorkloads",void 0),go(yo(n),"stopPollingFluxAvailableImages",void 0),go(yo(n),"handleClickToggleLockMessage",function(){n.setState({lockMessage:"",showLockingMessageEditor:!n.state.showLockingMessageEditor})}),go(yo(n),"handleClickLock",function(e){var t=e.lock;Object(Z.trackEvent)("flux.service.lock",{value:t}),n.props.dispatch(Object(R.hb)(n.props.instanceId,n.props.workload,t,n.state.lockMessage)).then(function(){n.setState({error:"",lockMessage:"",showLockingMessageEditor:!1})}).catch(n.handleLockAutomateReleaseError)}),go(yo(n),"handleLockAutomateReleaseError",function(e){var t=e.errors;n.setState({error:t[0].message})}),go(yo(n),"handleClearError",function(){n.setState({error:""})}),go(yo(n),"handleClickAutomate",function(e){var t=e.workload;Object(Z.trackEvent)("flux.service.automate",{value:!t.Automated}),n.setState({showLockingMessageEditor:!1}),n.props.dispatch(Object(R.b)(n.props.instanceId,t,!t.Automated)).catch(n.handleLockAutomateReleaseError)}),go(yo(n),"doRelease",function(e,t,r){n.props.dispatch(Object(R.xb)(n.props.instanceId,[e.ID],t.ID,void 0,r,!0)).catch(n.handleLockAutomateReleaseError)}),go(yo(n),"handleClickRelease",function(e){var t=e.workload,r=e.tag,o=e.urlParams,a=void 0===o?{}:o;r?Object(Z.trackEvent)("flux.service.image.release"):Object(Z.trackEvent)("flux.service.release"),n.setState({showLockingMessageEditor:!1}),n.doRelease(t,r,a)}),go(yo(n),"handleClickSubmitTag",function(e,t,r,o){var a=o;return t&&(a=t),n.props.dispatch(Object(R.p)(n.props.instanceId,n.props.workload,e.Name,a,r,Boolean(t)))}),go(yo(n),"handleClickOpenInMonitor",function(e,t){t.preventDefault(),t.stopPropagation(),Object(Z.trackEvent)("flux.service.viewWorkload"),Q.a.push(Object($.Z)(n.props.sharedQueryParams,n.props.instanceId,n.props.workloadId))}),go(yo(n),"handleRetryLoadImages",function(){n.props.dispatch(Object(R.z)(n.props.instanceId,n.props.workload.ID))}),go(yo(n),"handleLockMessageChange",function(e){n.setState({lockMessage:e.target.value})}),go(yo(n),"handleClickCancel",function(){n.setState({showLockingMessageEditor:!1})}),go(yo(n),"toggleCanaryModal",function(){n.setState({showCanaryModal:!n.state.showCanaryModal})}),go(yo(n),"handleSelectCanaryTag",function(e,t){n.setState({canaryTags:fo({},n.state.canaryTags,go({},e,t))})}),go(yo(n),"handleCanaryRelease",function(){var e=n.props,t=e.workload,r=e.containers,o=n.state.canaryTags;r.forEach(function(e){var r=o[e.Current.ID];n.doRelease(t,r,{canary:!0})})}),n.state={canaryTags:{},error:"",lockMessage:"",showCanaryModal:!1,showLockingMessageEditor:!1},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bo(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.startPolling(this.props)}},{key:"componentWillUnmount",value:function(){this.stopPolling()}},{key:"startPolling",value:function(e){this.stopPollingFluxAvailableImages=e.dispatch(Object(R.kb)(e.instanceId,e.workloadId))}},{key:"stopPolling",value:function(){this.stopPollingFluxAvailableImages()}},{key:"render",value:function(){var e=this,t=this.props,n=t.busy,r=t.disabled,a=t.workload,i=t.containers,c=t.availableTags,l=t.containerDetailsLoaded,s=t.instanceId,u=t.error,p=t.loaded,f=t.imagesLoading,d=t.daemonConfig,m=t.user,h=t.workloadId,y=t.showNotConfiguredInstructions,b=this.state.canaryTags,g=C()(d,["git","repoUrl"]),v=Object($.Z)(this.props.sharedQueryParams,this.props.instanceId,this.props.workloadId);return p?a?o.a.createElement(vo,null,o.a.createElement(Ue.a,null,o.a.createElement(je.Alert,{visible:Boolean(this.state.error),type:"error",onClose:this.handleClearError},this.state.error)),o.a.createElement(Eo,null,o.a.createElement("h2",null,a.ID," ",n&&o.a.createElement(je.CircularProgress,{inline:!0,size:24})),o.a.createElement(G.a,{to:v},o.a.createElement(J.a,{label:"View workload",onClick:this.handleClickOpenInMonitor}))),(a.Locked||a.ReadOnly)&&o.a.createElement(Xt,{readOnly:Boolean(a.ReadOnly),message:a.readOnlyReason||a.lockReason,user:a.lockUser||"",antecedent:a.Antecedent,instanceId:s}),!a.ReadOnly&&o.a.createElement(Ve,{busy:n,disabled:r,showLockingMessageEditor:this.state.showLockingMessageEditor,workload:a,onClickAutomate:this.handleClickAutomate,onClickLock:this.handleClickToggleLockMessage,onClickRelease:this.handleClickRelease,onClickCanary:this.toggleCanaryModal}),o.a.createElement(je.Dialog,{title:"Canary Release",active:this.state.showCanaryModal,actions:[o.a.createElement(je.Button,{disabled:E()(b),onClick:this.handleCanaryRelease,primary:!0},"Canary Release")],width:"310px",onClose:this.toggleCanaryModal},o.a.createElement(It,{canaryTags:b,containers:i,allContainersAvailableTags:c,onSelectCanaryTag:this.handleSelectCanaryTag})),o.a.createElement(So,null,this.state.showLockingMessageEditor&&o.a.createElement(pn,{user:m,disabled:r,message:this.state.lockMessage,onChange:this.handleLockMessageChange,onClickLock:this.handleClickLock,onClickCancel:this.handleClickCancel,locked:a.Locked})),o.a.createElement(wo,null,o.a.createElement(_o,null,o.a.createElement("div",{className:"tour-step-anchor deploy-containers-panel"},o.a.createElement(ko,null,"Images"),a.Antecedent&&o.a.createElement(xo,null,"Change versions using the chart controlling this deployment:"," ",o.a.createElement(Yt,{instanceId:s,antecedent:a.Antecedent})),E()(i)&&"This workload has no containers",i&&i.map(function(t,i){return o.a.createElement(so,{isFirstItem:0===i,containerDetailsLoaded:l,busy:n,disabled:r,key:t.Name,container:t,availableTags:c[t.Name],workload:a,onClickRelease:e.handleClickRelease,loading:f,error:u,onClickRetry:e.handleRetryLoadImages,doSubmit:e.handleClickSubmitTag})}))),o.a.createElement(Oo,null,y?o.a.createElement(_n,{instanceId:s}):o.a.createElement(o.a.Fragment,null,o.a.createElement(ko,null,"Status"),o.a.createElement(jo,null,o.a.createElement(We.b,{workload:a}),a.SyncError&&o.a.createElement(Co,null,a.SyncError)),o.a.createElement(Bt,{key:a.ID,instanceId:s,workloadId:a.ID}))))):o.a.createElement(vo,null,o.a.createElement("h2",null,"Uh oh! Could not find resource ",h),g&&o.a.createElement("p",null,"Maybe check out the"," ",o.a.createElement("a",{href:g,target:"github"},"config repo on github"),".")):o.a.createElement(Ee.a,{text:"Loading resource..."})}}])&&mo(n.prototype,r),a&&mo(n,a),t}();var Po=Object(p.connect)(function(e,t){var n=t.instanceId,r=t.workloadId,o=e.root,a=C()(q.m(e),[r]),i=C()(o,["fluxImageRequests",n,r],{}),c=i.status,l=i.error,s=q.g(e)[n]||{},u=Boolean(q.d(e)),p=C()(q.c(e),[r]);return{availableTags:C()(q.a(e),r)||{},busy:p,containerDetailsLoaded:u,containers:C()(q.b(e),[r]),daemonConfig:s,disabled:Boolean(p||C()(a,["ReadOnly"])),error:l,imagesLoading:"loading"===c,loaded:Boolean(q.e(e)),sharedQueryParams:Object(ze.b)(e),user:o.email,workload:a}})(Io),To=n(226),Ro=n.n(To),No=n(102),Lo=n.n(No),Do=n(127),qo=n.n(Do),Mo=n(99),Ao=n.n(Mo),Fo=n(309),Uo=n.n(Fo),zo=n(68),Wo=n.n(zo),Bo=n(47),Ko=n.n(Bo),Qo=n(14),Ho=n.n(Qo),Go=n(90),Vo=n.n(Go),Yo=n(89),Zo=n.n(Yo),Xo=n(625),$o=n.n(Xo),Jo=n(113),ea=n.n(Jo),ta=n(62),na=n.n(ta),ra=n(233),oa=n.n(ra),aa=n(188),ia=n.n(aa),ca=n(411),la=n(1376),sa=n(1397),ua=n(190),pa=n(56),fa=n.n(pa),da=n(1290),ma=n(1238);function ha(e){return(ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ya(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ba(e,t){return!t||"object"!==ha(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ga(e){return(ga=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function va(e,t){return(va=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wa,ka,_a,Oa=Object(f.default)(Ir).withConfig({displayName:"flux-deploy-status-image__ImageRepoCell",componentId:"sc-13ch8oo-0"})(["color:",";"],xe.a.grayText),Ea=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ba(this,ga(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&va(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.container,n=e.searchTerms,r=e.matches,a=e.matchesHasTags,i=e.sortHighlightClassnames,c=e.targetContainer,l=e.loading,s=e.updating,u=o.a.createElement(Oa,{title:"".concat(t.imageRepo,"  Container: ").concat(t.Name)},r.shortImageRepo&&o.a.createElement(je.MatchedText,{text:t.shortImageRepo,matches:n}),!r.shortImageRepo&&r.imageRepo&&o.a.createElement(je.MatchedText,{text:t.imageRepo,matches:n}),!r.shortImageRepo&&!r.imageRepo&&o.a.createElement(ma.a,{value:t.shortImageRepo}),C()(r,["Current","ID"])&&!r.shortImageRepo&&!r.currentTag&&!r.imageRepo&&o.a.createElement(qr,null,"Image:"," ",o.a.createElement(je.MatchedText,{text:t.Current.ID,matches:n})),(a&&t.tagFilter||C()(r,["tagFilter"]))&&o.a.createElement(qr,null,"Tag filter:"," ",o.a.createElement(je.MatchedText,{text:t.tagFilter,matches:n})),r.Name&&o.a.createElement(qr,null,"Container:"," ",o.a.createElement(je.MatchedText,{text:t.Name,matches:n}))),p=o.a.createElement(Ur,{id:c.ID||C()(c,["Current","ID"]),loading:l,tag:c.currentTag,subtextClassname:i.targetImage,createdAt:c.CreatedAt||c.currentCreatedAt||t.currentCreatedAt,searchTerms:n,latest:Object(Be.d)(t,c)}),f=o.a.createElement(Ir,null,o.a.createElement(qr,{color:"inherit",title:t.diverged?t.divergedMessage:void 0,className:i.behind},!l&&o.a.createElement("span",null,t.diverged?"Diverged":o.a.createElement(jr,{container:t,target:c})))),d=o.a.createElement(Ur,{id:t.Current.ID,tag:t.currentTag,subtextClassname:i.currentTag,createdAt:t.currentCreatedAt,searchTerms:n,shimmer:s,latest:Object(Be.d)(c,t)});return o.a.createElement(o.a.Fragment,null,u,p,f,d)}}])&&ya(n.prototype,r),a&&ya(n,a),t}();function Sa(e){return(Sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xa(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ja(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ca(e){return(Ca=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ia(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pa(e,t){return(Pa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ta(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}_a={matches:{}},(ka="defaultProps")in(wa=Ea)?Object.defineProperty(wa,ka,{value:_a,enumerable:!0,configurable:!0,writable:!0}):wa[ka]=_a;var Ra=f.default.tbody.withConfig({displayName:"flux-deploy-status-item__WorkloadRows",componentId:"skdumn-0"})(["cursor:pointer;border-bottom:1px solid ",";border-left:3px solid transparent;"," ",";&:hover{background-color:",";}"],xe.a.cellBorder,function(e){return e.checked&&"background-color: ".concat(xe.a.rowSelected,";")},function(e){return e.focused&&"border-left: 3px solid ".concat(B.a.colors.blue400," !important;")},function(e){return e.theme.colors.white}),Na=f.default.tr.withConfig({displayName:"flux-deploy-status-item__ImageRow",componentId:"skdumn-1"})([""]),La=f.default.span.withConfig({displayName:"flux-deploy-status-item__Path",componentId:"skdumn-2"})(["color:",";min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"],xe.a.grayText),Da=Object(f.default)(Ir).withConfig({displayName:"flux-deploy-status-item__IconCell",componentId:"skdumn-3"})(["vertical-align:top;"]),qa=Object(f.default)(Ir).withConfig({displayName:"flux-deploy-status-item__LabelCell",componentId:"skdumn-4"})(["vertical-align:top;",":hover &,",":hover & a{color:",";","{color:",";}}",":hover + &{color:inherit;","{color:",";}}"],Ra,Ra,xe.a.highlight,La,xe.a.highlight,Tr,La,xe.a.grayText),Ma=Object(f.default)(G.a).withConfig({displayName:"flux-deploy-status-item__LabelLink",componentId:"skdumn-5"})(["color:inherit;display:block;"]),Aa=function(){return r.createElement(Ir,{colSpan:4},r.createElement(qr,null,r.createElement("em",null,"This workload has no containers")))},Fa=function(e){var t=e.workload,n=e.busy,o=e.loading;return o?r.createElement(Dr,null,"Loading..."):t.updating?r.createElement(Dr,null,"Deploying..."):t.ReadOnly?r.createElement(Dr,{title:Object(Be.i)(t,n,o)},"Read-only"):!t.upToDate||t.Automated||t.Locked?t.Automated&&t.Locked?r.createElement("div",{title:"Automated & Locked ($".concat(t.lockReason,"))")},Object(J.c)("fa fa-rocket",{color:"inherit"}),Object(J.c)("fa fa-lock",{color:"inherit",marginLeft:"20px"})):t.Automated?Object(J.c)("fa fa-rocket",{color:"inherit"},{title:"Automated"}):t.Locked?Object(J.c)("fa fa-lock",{color:"inherit"},{title:"Locked (".concat(t.lockReason,")")}):r.createElement(Dr,null,"Updatable"):""},Ua=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=Ca(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Sa(o)&&"function"!=typeof o?Ia(r):o,Ta(Ia(n),"handleClick",function(){n.props.onClick(n.props.workload.ID)}),Ta(Ia(n),"handleCheck",function(e){e.stopPropagation(),n.props.onCheck(n.props.workload.ID,!n.props.checked)}),Ta(Ia(n),"handleClickLabel",function(e){(e.ctrlKey||e.metaKey||1===e.button)&&e.stopPropagation()}),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pa(e,t)}(t,r["PureComponent"]),n=t,(o=[{key:"render",value:function(){var e=this.props,t=e.checked,n=e.readOnly,o=e.workload,a=e.containers,i=e.targetContainers,c=e.focused,l=e.searchTerms,s=e.matches,u=void 0===s?{}:s,p=e.busy,f=e.instanceId,d=e.loading,m=xa(a),h=m[0],y=m.slice(1),b=a.length,g=function(e){var t=["currentTag","targetImage","behind"].map(function(t){var n=Be.a[t],r=n(null,e);return{index:e.map(function(e){return n(null,[e])}).indexOf(r),key:t}});return e.map(function(e,n){return fa()(t.map(function(e){var t=e.key,r=e.index;return[t,n===r?void 0:Object(Be.b)(t)]}))})}(a);return r.createElement(Ra,{className:"tour-step-anchor deploy-resource-details",focused:c,checked:t,onClick:this.handleClick},r.createElement(Na,null,!n&&r.createElement(Rr,{onClick:this.handleCheck},r.createElement("input",{type:"checkbox",readOnly:!0,checked:t})),r.createElement(qa,{title:o.ID,border:"right",rowSpan:b},r.createElement(Ma,{to:Object($.p)(f,o.ID),onClick:this.handleClickLabel},u.ID?r.createElement(je.MatchedText,{text:o.ID,matches:l}):r.createElement(ma.a,{highlighted:!0,value:o.ID}))),h?r.createElement(Ea,{loading:d,container:h,targetContainer:C()(i,[h.Name],{}),sortHighlightClassnames:g[0],matchesHasTags:C()(u,["has:tagfilter"]),matches:C()(u,"Containers[0]"),searchTerms:l,updating:o.updating}):r.createElement(Aa,null),r.createElement(Da,{rowSpan:b},p&&r.createElement(je.CircularProgress,{size:"small",center:!0}),o.updating&&!p&&r.createElement(da.a,null)),r.createElement(Da,{rowSpan:b},r.createElement(Fa,{workload:o,busy:p,loading:d}))),y.filter(Boolean).map(function(e,t){return r.createElement(Na,{key:e.Name},!n&&r.createElement(Ir,null),r.createElement(Ea,{targetContainer:C()(i,[e.Name],{}),sortHighlightClassnames:g[t+1],container:e,matchesHasTags:C()(u,["has:tagfilter"]),matches:C()(u,["Containers",String(t+1)]),loading:d,updating:o.updating,searchTerms:l}))}))}}])&&ja(n.prototype,o),a&&ja(n,a),t}();function za(e){return(za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wa(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ba(){return(Ba=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ka(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Qa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ha(e){return(Ha=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ga(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Va(e,t){return(Va=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ya(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Za=function(e){return Ao()(e,function(e){return e&&!e.ReadOnly})},Xa=-1,$a=27,Ja=function(e){return e.containerImageSource!==Zn.b};function ei(e){if(e!==Xa){var t=document.getElementsByClassName("deploy-resource-details")[e];if(t){var n=window.innerHeight,r=t.getBoundingClientRect(),o=r.top;r.bottom>n&&t.scrollIntoView(!1),o<0&&t.scrollIntoView(!1)}}}var ti=function(e){var t=e.workloads,n=e.checkedItems,r=0===n.length?t:ea()(t,function(e){return n.includes(e.ID)});return Ao()(r,function(e){return!e.ReadOnly&&(t=e.Containers,n=e.targetContainers,Ao()(t,function(e){var t=n[e.Name];return void 0!==t&&e.currentTag!==t.currentTag}));var t,n})},ni=function(e,t){return void 0===e?"desc"===t?"":void 0:e},ri={behind:function(e,t){return ni(Be.a.behind(e,e.Containers),t)},compare:function(e,t){return ni(Be.a.compare(e,e.Containers),t)},currentTag:function(e,t){return ni(Be.a.currentTag(e,e.Containers),t)},status:function(e){return[!(e.Locked||e.ReadOnly||e.Automated||e.upToDate),e.Locked&&e.Automated,e.Automated,e.Locked,e.ReadOnly,e.upToDate]},targetImage:function(e,t){return ni(Be.a.targetImage(e,e.targetContainers),t)}},oi=[{label:"Lock...",value:"lock-selected"},{label:"Unlock...",value:"unlock-selected"},{label:"Automate",value:"automate-selected"},{label:"De-automate",value:"de-automate-selected"}],ai=[{label:"Image repository",value:Zn.b}],ii=Object(f.default)(je.Dropdown).withConfig({displayName:"flux-deploy-status-container__ToolbarDropdown",componentId:"sc-17ksfep-0"})(["margin-left:16px;padding:0;width:132px;div{width:unset;}.dropdown-item{width:130px;}"]),ci=Object(f.default)(je.Button).withConfig({displayName:"flux-deploy-status-container__ActionsDropdown",componentId:"sc-17ksfep-1"})(["text-align:left;width:100%;display:flex;white-space:nowrap;span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;min-width:0;flex:1;margin-right:6px;}i{min-width:0;}"]),li=f.default.div.withConfig({displayName:"flux-deploy-status-container__ActionsContainer",componentId:"sc-17ksfep-2"})(["display:flex;"]),si=f.default.div.withConfig({displayName:"flux-deploy-status-container__StatusText",componentId:"sc-17ksfep-3"})(["margin-left:16px;line-height:36px;",""],function(e){return e.pulse&&Object(f.css)(["animation:",";"],xe.a.loadingAnimation)}),ui=f.default.div.withConfig({displayName:"flux-deploy-status-container__ImageSourceSelectorLabel",componentId:"sc-17ksfep-4"})(["position:absolute;top:-24px;font-size:",";color:",";width:250px;"],function(e){return e.theme.fontSizes.small},function(e){return e.theme.colors.gray600}),pi=Object(f.default)(je.DataTable).withConfig({displayName:"flux-deploy-status-container__DeployDataTable",componentId:"sc-17ksfep-5"})(["thead,tbody{border-bottom:1px solid ",";}& .","{opacity:0.6;}td{border:0;}thead td{border:0 !important;font-size:",";font-weight:normal;vertical-align:bottom;}thead td:nth-child(10){text-align:center;}input{font-size:",";}"],function(e){return e.theme.colors.purple100},function(e){var t=e.sortBy;return Object(Be.b)(t)},function(e){return e.theme.fontSizes.small},function(e){return e.theme.fontSizes.normal}),fi=Object(f.default)(je.Button).withConfig({displayName:"flux-deploy-status-container__UpdateButton",componentId:"sc-17ksfep-6"})(["min-width:calc(120px + 12px + 12px);"]),di=function(e,t){var n=e.checkedItems,r=e.pinnedSearches,o=e.searchTerms,a=e.workloads;return n.length>0?n:o.length>0||r.length>0?Ho()(a,"ID"):Vo()(t)?t():t},mi=function(e){function t(e){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=Ha(t).call(this,e),n=!a||"object"!==za(a)&&"function"!=typeof a?Ga(r):a,Ya(Ga(n),"handleCheckItem",function(e,t){var r=t?oa()(n.props.checkedItems,e):Ro()(n.props.checkedItems,e);n.props.setDeployStatusItemChecked(r)}),Ya(Ga(n),"allChecked",function(){return n.props.workloads.length&&na()(n.props.workloads,function(e){return Zo()(n.props.checkedItems,e.ID)})}),Ya(Ga(n),"handleClickReleaseSelected",function(){var e=n.props,t=e.instanceId,r=e.currentUser,o=e.checkedItems,a=e.containerImageSource,i=e.workloads;if(Object(Z.trackEvent)("flux.services.update.click",{workloads_selected:o.length}),Ja(n.props)){var c=di(n.props,function(){return Ho()(i,"ID")});n.doPromotion(c)}else n.props.releaseBatch(t,di(n.props,[T.FLUX_ALL_WORKLOADS]),r).then(function(e){Q.a.push(Object($.n)(t,e,{containerImageSource:a}))}).catch(n.handleReceiveError)}),Ya(Ga(n),"doPromotion",function(e){var t=n.props,r=t.instanceId,o=t.workloads,a=t.currentUser,i=ea()(o,function(t){return Zo()(e,t.ID)}),c=Wo()(i,function(e,t){var n=Ho()(t.targetContainers,function(e,n){var r=Ze()(t.Containers,{Name:n});return r?{Container:n,Current:Object(Be.q)(r.imageRepo,r.currentTag),Target:Object(Be.q)(e.imageRepo,e.currentTag)}:null});return Uo()(e,t.ID,ia()(n))},{});n.props.releaseContainerVersions(r,c,a).catch(n.handleReceiveError)}),Ya(Ga(n),"handleReceiveError",function(e){var t=e.errors;n.setState({error:t[0].message}),n.delayCloseInfo(1e4)}),Ya(Ga(n),"doBatchPolicyChange",function(e,t,r){var o=n.props,a=o.instanceId,i=o.checkedItems;return n.closeLockDialog(),n.props.batchPolicyChange(a,i,e,t,r).catch(n.handleReceiveError)}),Ya(Ga(n),"delayCloseInfo",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3;setTimeout(n.closeInfo,e)}),Ya(Ga(n),"handleClickLockSelected",function(){Object(Z.trackEvent)("flux.services.lock.click",{workloads_selected:n.props.checkedItems.length}),n.setState({lockMsgDialogActive:!0,lockMsgType:"add"})}),Ya(Ga(n),"handleClickUnlockSelected",function(){Object(Z.trackEvent)("flux.services.unlock.click",{workloads_selected:n.props.checkedItems.length}),n.setState({lockMsgDialogActive:!0,lockMsgType:"remove"})}),Ya(Ga(n),"handleLockOrUnlockSubmit",function(){n.doBatchPolicyChange("locked",n.state.lockMsgType,n.state.lockMsgText)}),Ya(Ga(n),"handleLockMsgTextChange",function(e){n.setState({lockMsgText:e.target.value})}),Ya(Ga(n),"closeLockDialog",function(){n.setState({lockMsgDialogActive:!1,lockMsgText:"",lockMsgType:null})}),Ya(Ga(n),"closeInfo",function(){n.setState({error:null})}),Ya(Ga(n),"handleClickAutomateSelected",function(){Object(Z.trackEvent)("flux.services.automate.click",{workloads_selected:n.props.checkedItems.length}),n.doBatchPolicyChange("automated","add","test")}),Ya(Ga(n),"handleClickDeAutomateSelected",function(){Object(Z.trackEvent)("flux.services.deautomate.click",{workloads_selected:n.props.checkedItems.length}),n.doBatchPolicyChange("automated","remove","test")}),Ya(Ga(n),"handleCheckAll",function(){var e=n.allChecked()||n.props.checkedItems.length>0?[]:Ho()(n.props.workloads,"ID");n.props.setDeployStatusItemChecked(e)}),Ya(Ga(n),"handleClickItem",function(e){Object(Z.trackEvent)("flux.services.listitem.click"),n.props.updateFluxFocusIndex($o()(n.props.workloads,function(t){return t.ID===e}));var t=Object($.p)(n.props.instanceId,e);Q.a.push(t)}),Ya(Ga(n),"onKeyDown",function(e){n.state.lockMsgDialogActive||(("Enter"===e.code||"KeyJ"===e.code&&e.ctrlKey)&&n.props.focusIndex!==Xa&&"INPUT"!==document.activeElement.tagName?n.handleClickItem(n.props.workloads[n.props.focusIndex].ID):"ArrowUp"===e.code?(e.preventDefault(),n.handleArrowKeys(-1)):"ArrowDown"===e.code?(e.preventDefault(),n.handleArrowKeys(1)):"KeyN"===e.code&&e.ctrlKey?(e.preventDefault(),n.handleArrowKeys(1)):"KeyP"===e.code&&e.ctrlKey&&(e.preventDefault(),n.handleArrowKeys(-1)))}),Ya(Ga(n),"handleSaveItemRef",function(e,t){n.itemRefs[t]=e}),Ya(Ga(n),"onKeyPress",function(e){"/"!==String.fromCharCode(e.charCode)||n.props.focused||(e.preventDefault(),n.props.focusFluxSearch())}),Ya(Ga(n),"onKeyUp",function(e){e.keyCode===$a&&n.props.focused&&(Object(Z.trackEvent)("flux.services.filter.escape.press"),n.props.query?n.props.updateSearch("",[]):n.props.blurFluxSearch())}),Ya(Ga(n),"handleActionSelect",function(e,t){switch(t){case"lock-selected":n.handleClickLockSelected(t);break;case"unlock-selected":n.handleClickUnlockSelected(t);break;case"automate-selected":n.handleClickAutomateSelected(t);break;case"de-automate-selected":n.handleClickDeAutomateSelected(t)}}),Ya(Ga(n),"setImageSource",function(e){e!==Zn.b&&(n.setState({fetchingImageSource:!0}),n.props.getFluxImages(e,T.FLUX_ALL_WORKLOADS,["Name","Current","LatestFiltered","NewFilteredImagesCount"]).then(function(){return n.setState({fetchingImageSource:!1})}).catch(n.handleReceiveError))}),Ya(Ga(n),"handleImageSourceChange",function(e,t){Q.a.push(Object($.o)(n.props.instanceId,t)),Object(Z.trackEvent)("flux.services.imagesource.select"),n.setImageSource(t)}),Ya(Ga(n),"handleFilterSelect",function(e){Object(Z.trackEvent)("flux.services.filters.select",{name:e})}),Ya(Ga(n),"handleSort",function(e,t){n.setState({sortBy:e,sortOrder:t})}),n.state={error:null,fetchingImageSource:!1,lockMsgDialogActive:!1,lockMsgText:"",lockMsgType:null,sortBy:"ID",sortOrder:"asc"},n.itemRefs={},n.searchRef=o.a.createRef(),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Va(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"handleArrowKeys",value:function(e){var t=this.props.focusIndex+e;t<Xa?t=this.props.workloads.length-1:t>=this.props.workloads.length&&(t=Xa),this.props.updateFluxFocusIndex(t)}},{key:"componentDidMount",value:function(){ei(this.props.focusIndex),this.setImageSource(this.props.containerImageSource),window.addEventListener("keypress",this.onKeyPress),window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keypress",this.onKeyPress),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)}},{key:"componentDidUpdate",value:function(e){var t=C()(this.searchRef,["current","input"]);t&&!e.focused&&this.props.focused?t.focus():t&&e.focused&&!this.props.focused&&t.blur()}},{key:"componentWillReceiveProps",value:function(e){var t=e.query,n=e.focusIndex,r=e.containerImageSource;t!==this.props.query&&ei(0),n!==this.props.focusIndex&&ei(n),r!==this.props.containerImageSource&&this.setImageSource(r)}},{key:"render",value:function(){var e=this,t=this.props,n=t.instanceId,r=t.query,a=t.updateAllowed,i=t.searchTerms,c=t.matches,l=t.containerDetailsLoaded,s=t.loaded,u=t.className,p=t.workloads,f=t.instance,d=t.instances,m=t.checkedItems,h=t.containerImageSource,y=this.state,b=y.lockMsgDialogActive,g=y.lockMsgType,v=y.error,w=y.fetchingImageSource,k=this.allChecked(),_=0===m.length,O=_||!a,E=r.length>0,S=m.length>0,x=Ja(this.props)?ti(this.props):a;if(!s)return o.a.createElement(Ee.a,{text:"Loading resources..."});var j={element:o.a.createElement(o.a.Fragment,null,"Target:",o.a.createElement("br",null),f.name),value:"currentTag"},I=[{element:o.a.createElement(o.a.Fragment,null,"Source:",o.a.createElement("br",null),o.a.createElement(je.Text,{small:!0},Ja(this.props)?C()(d,[h,"name"]):"Latest image")),value:"targetImage"},{sortable:!1,value:"compare",width:"50px"},j];return o.a.createElement("div",{className:u},o.a.createElement(Ue.a,null,o.a.createElement(je.Alert,{type:"error",visible:Boolean(v),onClose:this.closeInfo},v)),o.a.createElement(je.Grid,null,o.a.createElement(je.GridRow,{alignContent:"left"},o.a.createElement(je.GridColumn,{span:2},o.a.createElement("div",{style:{position:"relative"}},o.a.createElement(ui,null,"Select source repo/cluster:"),o.a.createElement(je.Dropdown,{className:"image-repo-source",withComponent:function(e){return o.a.createElement(ci,e,o.a.createElement("span",null,C()(d,[h,"name"])||ai[0].label),o.a.createElement("i",{className:"fa fa-caret-down",style:{float:"right"}}))},items:[ai,Ho()(qo()(Ko()(d,n),[function(e){return e.name.toLowerCase()}]),function(e){return{label:e.name,value:e.id}})],value:h,onChange:this.handleImageSourceChange}))),o.a.createElement(je.GridColumn,{span:6},o.a.createElement(la.a,{onFocus:this.props.focusFluxSearch,onFilterSelect:this.handleFilterSelect,onBlur:this.props.blurFluxSearch,filters:ca.a})),o.a.createElement(je.GridColumn,{span:6},o.a.createElement(li,null,o.a.createElement(Qe.a,{permissions:["flux.image.deploy"]},o.a.createElement(fi,{disabled:!x,primary:!0,title:k?"Preview which containers can be updated to the latest images":"Preview updates to the selected containers",onClick:this.handleClickReleaseSelected},function(e,t,n){var r=e.searchTerms.length>0||e.pinnedSearches.length>0,o=Ja(e)?"Promote":"Update",a=t||n?r?"filtered":"all":"selected";return"".concat(o," ").concat(a,"...")}(this.props,k,_))),o.a.createElement(Qe.a,{permissions:["flux.policy.update"]},o.a.createElement(Hn,null,function(t){return o.a.createElement(ii,{withComponent:function(e){var n=e.onClick,r=Ka(e,["onClick"]);return o.a.createElement(ci,Ba({},r,{title:O?"No workloads currently selected!":"",onClick:function(){return Object(Z.trackEvent)("flux.services.moreactions.click"),t(),n()}}),o.a.createElement("span",null,"More actions..."),o.a.createElement("i",{className:"fa fa-caret-down",style:{float:"right"}}))},disabled:O,onChange:e.handleActionSelect,items:oi})})),(E||S)&&o.a.createElement(si,null,E&&o.a.createElement(o.a.Fragment,null,o.a.createElement("i",{className:"fa fa-filter"})," Filtered view"),S?"".concat(E?", ":"").concat(m.length," workload").concat(1!==m.length?"s":""," selected"):""))))),o.a.createElement(Qe.a,{permissions:["flux.image.deploy","flux.policy.update"]},function(t,a){return o.a.createElement(pi,{className:"tour-step-anchor deploy-resources-overview",onSort:e.handleSort,nested:!0,columns:[].concat(Wa(t||a?[{element:o.a.createElement(sa.a,{type:"checkbox",onClick:e.handleCheckAll,checked:k,indeterminate:e.props.checkedItems.length>0&&!k}),sortable:!1,value:"selected",width:"18px"}]:[]),[{label:"Workload",value:"ID",width:"25%"},{label:"Image",sortable:!1,value:"image",width:"25%"}],I,[{sortable:!1,value:"busy",width:"24px"},{initialSortOrder:"desc",label:"Status",value:"status",width:"80px"}]),data:p,sortBy:e.state.sortBy,sortOrder:e.state.sortOrder,sortOverrides:ri},function(s){return s.length>0?Ho()(s,function(r,s){return o.a.createElement(Ua,{readOnly:!t&&!a,workload:r,key:r.ID,busy:r.busy,focused:e.props.focusIndex===s,onClick:e.handleClickItem,onCheck:e.handleCheckItem,instanceId:n,matches:c[r.ID],searchTerms:i,containers:r.Containers,loading:w||!l,unknownTarget:r.targetContainers.error,targetContainers:r.targetContainers,checked:Zo()(e.props.checkedItems,r.ID)})}):o.a.createElement("tbody",null,o.a.createElement("tr",{style:{padding:12}},o.a.createElement("td",{colSpan:"5"},o.a.createElement(je.Text,{small:!0},r?'No resources matching "'.concat(r,'"'):"No resources found"))))})}),o.a.createElement(je.Dialog,{active:b,onClose:this.closeLockDialog},o.a.createElement("h3",null,"Commit message"),o.a.createElement(pn,{onClickLock:this.handleLockOrUnlockSubmit,onClickCancel:this.closeLockDialog,message:this.state.lockMsgText,disabled:!1,locked:"remove"===g,onChange:this.handleLockMsgTextChange})))}}])&&Qa(n.prototype,r),a&&Qa(n,a),t}();Ya(mi,"defaultProps",{containerImageSource:Zn.b});var hi=Object(p.connect)(function(e,t){var n=t.instanceId,r=e.root,o=r.fluxFocusIndex,a=r.fluxDeployStatusTable.checkedItems,i=Boolean(q.d(e)),c=Ao()(Lo()(q.c(e))),l=q.f(e),s=Lo()(l),u=a.map(function(e){return l[e]}),p=Za(s),f=Za(u),d=ua.c(e).pinnedSearches;return{checkedItems:a,containerDetailsLoaded:i,currentUser:r.currentUser,focused:o===Xa,focusIndex:o,instance:r.instances[n],instances:r.instances,loaded:Boolean(q.e(e)),matches:q.l(e),pinnedSearches:d,query:ua.b(e),searchTerms:ua.d(e),updateAllowed:!c&&(f||p),workloads:s}},{batchPolicyChange:R.c,blurFluxSearch:R.d,focusFluxSearch:R.q,getFluxImages:R.B,releaseBatch:R.vb,releaseContainerVersions:R.wb,setDeployStatusItemChecked:R.Hb,updateFluxFocusIndex:R.Tb,updateSearch:R.Wb})(function(e){return Object(f.default)(e).withConfig({displayName:"flux-deploy-status-container",componentId:"sc-17ksfep-7"})(["margin-top:26px;","{.dropdown-popover{width:auto;}}.image-repo-source{width:unset;}"],je.Dropdown)}(mi));function yi(e){return(yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gi(e){return(gi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wi(e,t){return(wi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ki(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _i=f.default.div.withConfig({displayName:"workloads-page__MiniError",componentId:"sc-7xnwpv-0"})(["margin-left:auto;color:",";padding-top:8px;"],function(e){return e.theme.colors.purple300}),Oi=f.default.div.withConfig({displayName:"workloads-page__ErrorContainer",componentId:"sc-7xnwpv-1"})(["color:",";border-radius:",";padding:24px;margin:100px auto;max-width:500px;text-align:center;"],function(e){return e.theme.colors.purple800},function(e){return e.theme.borderRadius.soft}),Ei=f.default.i.withConfig({displayName:"workloads-page__ErrorIcon",componentId:"sc-7xnwpv-2"})(["opacity:0.5;font-size:",";margin-bottom:24px;"],function(e){return e.theme.overlayIconSize}),Si=f.default.p.withConfig({displayName:"workloads-page__ErrorText",componentId:"sc-7xnwpv-3"})(["margin-top:0;opacity:0.7;"]),xi=f.default.div.withConfig({displayName:"workloads-page__Instructions",componentId:"sc-7xnwpv-4"})(["text-align:left;margin-top:24px;font-size:",";"],function(e){return e.theme.fontSizes.small}),ji=f.default.span.withConfig({displayName:"workloads-page__LoadingPulse",componentId:"sc-7xnwpv-5"})(["animation:",";"],xe.a.loadingAnimation),Ci=function(e){var t=e.error,n=e.icon,r=void 0===n?"fa fa-exclamation":n,a=e.children;return o.a.createElement(Oi,null,o.a.createElement(Ei,{className:r}),t&&o.a.createElement(Si,null,t),a)},Ii=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=gi(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==yi(o)&&"function"!=typeof o?vi(r):o,ki(vi(n),"handleClickSettings",function(){Object(Z.trackEvent)("flux.nav.click",{link:"configure"}),Q.a.push(Object($.z)(n.props.instanceId))}),ki(vi(n),"handleClickReconnect",function(){Object(Z.trackEvent)("flux.nav.click",{link:"setup"}),Q.a.push(Object($.E)(n.props.instanceId))}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wi(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentWillReceiveProps",value:function(e){e.selectedWorkloadId&&!this.props.selectedWorkloadId&&window.scrollTo(0,0)}},{key:"renderLoaders",value:function(){return this.props.loadedFluxdState?null:o.a.createElement(Ee.a,{text:"Connecting to your cluster..."})}},{key:"renderBigError",value:function(){var e=this.props,t=e.notConnected,n=e.connectionError,r=e.workloadErrors,a=e.config,i=e.instanceId,c=a.lastSeen,l=c&&P()(c).fromNow();return"0001-01-01T00:00:00Z"===c?o.a.createElement(Ci,{icon:"fa fa-plug",error:"Your cluster hasn't connected to Weave Cloud yet"},o.a.createElement("div",null,o.a.createElement(J.a,{label:"Connect cluster...",onClick:this.handleClickReconnect}))):t?o.a.createElement(Ci,{icon:"fa fa-plug",error:o.a.createElement(ji,null,"Waiting for agent to reconnect...")},o.a.createElement(xi,null,o.a.createElement("p",null,"Your cluster is not connected to Weave Cloud. It last connected"," ",l,"."),o.a.createElement("p",null,"This might be temporary and we","'","ll continue checking, but if this persists try reconnecting the Agent by following the instruction on the"," ",o.a.createElement(G.a,{to:Object($.E)(i)},"Install page"),"."," "))):n?o.a.createElement(Ci,{error:n},o.a.createElement("div",null,o.a.createElement(ji,null,"Retrying..."))):r?o.a.createElement(Ci,{error:r},o.a.createElement("div",null,o.a.createElement(J.a,{label:"Check configuration",onClick:this.handleClickSettings}))):null}},{key:"renderMiniError",value:function(){var e=this.props,t=e.notConnected,n=e.connectionError,r=e.workloadErrors;return t?o.a.createElement(_i,null,"Agent not connected."," ",o.a.createElement(ji,null,"Waiting for agent to reconnect...")):n?o.a.createElement(_i,null,n,". ",o.a.createElement(ji,null,"Retrying...")):r?o.a.createElement(_i,null,r," ",o.a.createElement(J.a,{label:"Check configuration",onClick:this.handleClickSettings})):null}},{key:"renderContent",value:function(){var e=this.props,t=e.instanceId,n=e.selectedWorkloadId,r=e.fluxdState,a=e.config,i="connected"===r&&o.a.createElement(kn,{instanceId:t}),c=n?o.a.createElement(Po,{key:n,showNotConfiguredInstructions:"connected"===r,instanceId:t,workloadId:n}):o.a.createElement(hi,{instanceId:t,containerImageSource:this.props.containerImageSource});return o.a.createElement(o.a.Fragment,null,i,o.a.createElement(Fe,{config:a,fluxdState:r,instanceId:t}),c)}},{key:"render",value:function(){var e=this,t=this.props,n=t.instanceId,r=t.isConnected,a=t.loadedWorkloads,i=!a&&this.renderBigError(),c=a&&this.renderMiniError();return o.a.createElement(o.a.Fragment,null,o.a.createElement(o.a.Fragment,{key:n},o.a.createElement(Se.a,{fns:[function(){return e.props.pollFluxStatus(n)}]}),r&&o.a.createElement(Se.a,{fns:[function(){return e.props.pollFluxWorkloads(n)},function(){return e.props.pollFluxImages(n)}]})),o.a.createElement(fe,{instanceId:n,toolbarItems:c},this.renderLoaders()||i||this.renderContent()))}}])&&bi(n.prototype,r),a&&bi(n,a),t}(),Pi=function(e){if(!e)return{};var t=e[0];return{connectionError:t.connectionError&&t.message,workloadErrors:!t.connectionError&&t.message}};var Ti=Object(p.connect)(function(e){var t=e.root,n=t.urlParams,r=n.instanceId,o=n.workloadId,a=n.containerImageSource,i=q.i(e),c=q.g(e)[r]||{},l="not-connected"===i,s=Pi(t.fluxWorkloadErrors[r]),u=s.workloadErrors;return{config:c,connectionError:s.connectionError,containerImageSource:a,fluxdState:i,instanceId:r,isConnected:Boolean(c.connected),loadedFluxdState:null!==i,loadedWorkloads:Boolean(q.e(e)),notConnected:l,selectedWorkloadId:o,workloadErrors:u}},{blurFluxSearch:R.d,focusFluxSearch:R.q,getFluxWorkloads:R.F,pollFluxImages:R.lb,pollFluxStatus:R.mb,pollFluxWorkloads:R.nb})(Ii),Ri=n(17),Ni=n(85),Li=n.n(Ni),Di=n(49),qi=n.n(Di),Mi=n(53),Ai=f.default.div.withConfig({displayName:"stage__StageWrapper",componentId:"at7do2-0"})(["display:flex;margin-top:10px;& + &{margin-top:40px;}"]),Fi=f.default.div.withConfig({displayName:"stage__StageIcon",componentId:"at7do2-1"})(["min-width:24px;margin-right:15px;"]),Ui=f.default.h4.withConfig({displayName:"stage__StageTitle",componentId:"at7do2-2"})(["font-weight:bold;margin-top:2px;margin-bottom:10px;"]),zi=f.default.div.withConfig({displayName:"stage__StageContent",componentId:"at7do2-3"})([""]),Wi=f.default.i.withConfig({displayName:"stage__ISuccess",componentId:"at7do2-4"})(["color:",";"],Object(Mi.color)("green500")),Bi=f.default.i.withConfig({displayName:"stage__IWarning",componentId:"at7do2-5"})(["color:",";"],Object(Mi.color)("yellow500")),Ki=Object(f.default)(je.CircularProgress).withConfig({displayName:"stage__StyledCircularProgress",componentId:"at7do2-6"})(["margin-top:-1px;"]),Qi=function(e){var t=e.children,n=e.status,r=e.title;return o.a.createElement(Ai,null,o.a.createElement(Fi,null,function(e){switch(e){case"done":return o.a.createElement(Wi,{className:"fa fa-lg fa-check"});case"error":return o.a.createElement(Bi,{className:"fa fa-lg fa-exclamation-circle"});case"in_progress":return o.a.createElement(Ki,{size:"small"});case"diverged":return o.a.createElement(Bi,{className:"fa fa-lg fa-exclamation-triangle"});default:return null}}(n)),o.a.createElement("div",null,o.a.createElement(Ui,null,r),o.a.createElement(zi,null,t)))},Hi=function(e,t){var n=fa()((C()(t,["results",e,"PerContainer"])||[]).map(function(e){return[e.Container,e.Current]})),r=fa()((C()(t,["results",e,"PerContainer"])||[]).map(function(e){return[e.Container,e.Target]})),o=fa()((C()(t,["workloads",e,"Containers"])||[]).map(function(e){return[e.Name,e.Current.ID]})),a=fa()(qi()(r).filter(function(e){return o[e]&&o[e]!==r[e]&&o[e]!==n[e]}).map(function(e){return[e,o[e]]}));return{currents:o,diverged:a,sources:n,targets:r}},Gi=function(e,t){var n=Hi(e,t),r=n.targets,o=n.currents;return!E()(r)&&!E()(o)&&na()(qi()(r),function(e){return r[e]===o[e]})},Vi=function(e,t){var n=Hi(e,t).diverged;return!E()(n)},Yi=function(e,t){var n=e.Status,r=e.ID;return n===Zn.f.READY&&Gi(r,t)},Zi=function(e,t){return na()(e,function(e){return Yi(e,t)||e.Status===Zn.f.ERROR})},Xi=function(e,t){return Ao()(e,function(e){return function(e,t){var n=e.Status,r=e.ID;return n===Zn.f.READY&&Vi(r,t)}(e,t)})},$i=function(e){return function(t,n,r){return!t||n===e&&r}},Ji=$i(1),ec=$i(2),tc=function(e,t,n,r){var o=Lo()(e.workloads);return Ji(t,n,r)&&function(e,t){return na()(e,function(e){return Yi(e,t)})}(o,e)?"done":t&&ec(t,n,r)?"error":!t&&Zi(o,e)?"error":Xi(o,e)?"diverged":"in_progress"},nc=n(304),rc=n.n(nc),oc=n(162),ac=n.n(oc),ic=f.default.div.withConfig({displayName:"progress-indicator__ProgressWrap",componentId:"sc-2d6ogz-0"})(["display:flex;flex:1 1 auto;"]),cc=f.default.div.withConfig({displayName:"progress-indicator__Progress",componentId:"sc-2d6ogz-1"})(["display:flex;flex-grow:1;max-width:190px;"]),lc=f.default.div.withConfig({displayName:"progress-indicator__Indicator",componentId:"sc-2d6ogz-2"})(["flex-grow:1;height:18px;"]),sc=Object(f.default)(lc).withConfig({displayName:"progress-indicator__Bar",componentId:"sc-2d6ogz-3"})(["max-width:190px;background-color:",";background-image:linear-gradient( to right,"," ","%,transparent 0% );"],function(e){return e.theme.colors.gray200},function(e){var t=e.hasError,n=e.theme;return t?n.colors.orange600:n.colors.green500},function(e){return e.percent}),uc=Object(f.default)(lc).withConfig({displayName:"progress-indicator__BaseStep",componentId:"sc-2d6ogz-4"})(["max-width:18px;& + &{margin-left:1px;}"]),pc=Object(f.default)(uc).withConfig({displayName:"progress-indicator__Step",componentId:"sc-2d6ogz-5"})(["background-color:",";"],function(e){return e.hasError?e.theme.colors.orange600:e.done?e.theme.colors.green500:e.started?Object(Xe.transparentize)(.6,e.theme.colors.green500):e.theme.colors.gray200}),fc=f.default.span.withConfig({displayName:"progress-indicator__Count",componentId:"sc-2d6ogz-6"})(["margin-left:10px;"]),dc=function(e){var t=e.total,n=e.started,r=void 0===n?0:n,a=e.done,i=void 0===a?0:a,c=e.count,l=void 0===c?0:c,s=e.hasError,u=void 0!==s&&s;return t?(l=l||i,o.a.createElement(ic,null,o.a.createElement(cc,null,function(e,t,n,r){return e>10?o.a.createElement(sc,{hasError:r,percent:(n||t)/e*100}):ac()(e).map(function(e,a){var i=a+1;return o.a.createElement(pc,{key:a,done:i<=n,started:i<=t&&!r,hasError:i<=t&&r})})}(t,r,i,u)),o.a.createElement(fc,null,l,"/",t))):null};function mc(e){return(mc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yc(e){return(yc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gc(e,t){return(gc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var wc=f.default.tr.withConfig({displayName:"progress-row__Row",componentId:"sc-1jqo1o5-0"})(["> td{border-left:0;}"]),kc=f.default.span.withConfig({displayName:"progress-row__ErrorMsg",componentId:"sc-1jqo1o5-1"})(["color:",";"],function(e){return e.theme.colors.orange600}),_c=f.default.i.withConfig({displayName:"progress-row__Icon",componentId:"sc-1jqo1o5-2"})(["margin-right:10px;"]),Oc=f.default.span.withConfig({displayName:"progress-row__ErrorStatus",componentId:"sc-1jqo1o5-3"})(["color:",";"],function(e){return e.theme.colors.orange600}),Ec=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=yc(t).call(this,e),n=!o||"object"!==mc(o)&&"function"!=typeof o?bc(r):o,vc(bc(n),"interval",void 0),n.state={initialTimestamp:P()(),timeElapsed:""},n.interval=setInterval(function(){C()(n.props,["release","workloads",n.props.workload.workloadId,"Status"])===Zn.f.UPDATING&&n.setState(function(e){var t=P()().diff(e.initialTimestamp);return{timeElapsed:P.a.utc(t).format("mm:ss")}})},1e3),n}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gc(e,t)}(t,r["PureComponent"]),n=t,(a=[{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var e=this,t=this.props,n=t.release,a=t.workload,i=C()(n,["workloads",a.workloadId],{}),c=i.Rollout,l=i.Status,s=c||{},u=s.Updated,p=s.Desired,f=s.Outdated,d=s.Messages,m=l===Zn.f.ERROR,h=!Gi(a.workloadId,n);return o.a.createElement(r.Fragment,null,o.a.createElement(wc,null,o.a.createElement("td",null,o.a.createElement(ma.a,{highlighted:!0,value:a.workloadId})),o.a.createElement("td",null,function(e,t,n){return e===Zn.f.ERROR?o.a.createElement(Oc,null,"Error"):e===Zn.f.READY&&Gi(t,n)?"Released":Vi(t,n)?"Diverged from release plan":"Deploying..."}(l,a.workloadId,n)),o.a.createElement("td",null,!h&&o.a.createElement(dc,{started:f,count:f,total:p})),o.a.createElement("td",null,!h&&o.a.createElement(dc,{hasError:m,total:p,done:u,started:u})),o.a.createElement("td",null,this.state.timeElapsed)),m&&o.a.createElement(o.a.Fragment,null,o.a.createElement(wc,null,o.a.createElement("td",{colSpan:5},d.map(function(e){return o.a.createElement(kc,{key:e},e)}))),o.a.createElement(wc,null,o.a.createElement("td",{colSpan:5},o.a.createElement(je.Button,{onClick:function(){return e.props.onOpenWorkload(a.workloadId)}},o.a.createElement(_c,{className:"fa fa-cube"}),"Open in workloads")))))}}])&&hc(n.prototype,a),i&&hc(n,i),t}();vc(Ec,"displayName","ProgressRow");var Sc=Ec;function xc(e){return(xc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cc(e){return(Cc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ic(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pc(e,t){return(Pc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Rc=f.default.tr.withConfig({displayName:"canary-progress-row__Row",componentId:"jpnhg5-0"})(["> td{border-left:0;}"]),Nc=f.default.span.withConfig({displayName:"canary-progress-row__ErrorMsg",componentId:"jpnhg5-1"})(["color:",";"],function(e){return e.theme.colors.orange600}),Lc=f.default.i.withConfig({displayName:"canary-progress-row__Icon",componentId:"jpnhg5-2"})(["margin-right:10px;"]),Dc=f.default.span.withConfig({displayName:"canary-progress-row__ErrorStatus",componentId:"jpnhg5-3"})(["color:",";"],function(e){return e.theme.colors.orange600}),qc=f.default.div.withConfig({displayName:"canary-progress-row__ProgressWrap",componentId:"jpnhg5-4"})(["display:flex;"]),Mc=f.default.span.withConfig({displayName:"canary-progress-row__Weight",componentId:"jpnhg5-5"})(["margin-left:10px;"]),Ac=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,n=!(o=Cc(t).call(this,e))||"object"!==xc(o)&&"function"!=typeof o?Ic(r):o,Tc(Ic(n),"interval",void 0),Tc(Ic(n),"initialTimestamp",void 0),n.state={timeElapsed:""},n}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pc(e,t)}(t,r["PureComponent"]),n=t,(a=[{key:"componentDidMount",value:function(){var e=this;this.initialTimestamp=P()(),this.interval=setInterval(function(){if(0===e.props.canaryStatus){var t=P()().diff(e.initialTimestamp);e.setState({timeElapsed:P.a.utc(t).format("mm:ss")})}},1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var e=this,t=this.props,n=t.release,a=t.workload,i=t.primaryWeight,c=t.canaryWeight,l=t.canaryStatus,s=t.primaryStatus,u=t.primaryRollout,p=t.canaryRollout,f=u.Updated,d=u.Desired,m=u.Outdated,h=u.Messages,y=p.Updated,b=p.Desired,g=p.Outdated,v=s===Zn.f.ERROR,w=!Gi(a.workloadId,n);return o.a.createElement(r.Fragment,null,o.a.createElement(Rc,null,o.a.createElement("td",null,o.a.createElement(ma.a,{highlighted:!0,value:a.workloadId})),o.a.createElement("td",null,function(e){return 2===e?o.a.createElement(Dc,null,"Error"):1===e?"Released":"Deploying..."}(l)),o.a.createElement("td",null,!w&&o.a.createElement(qc,null,o.a.createElement(dc,{started:m,count:m,done:f,total:d}),o.a.createElement(Mc,null,i,"%"))),o.a.createElement("td",null,!w&&o.a.createElement(qc,null,o.a.createElement(dc,{started:g,count:g,done:y,total:b}),o.a.createElement(Mc,null,c,"%"))),o.a.createElement("td",null,this.state.timeElapsed)),v&&o.a.createElement(o.a.Fragment,null,o.a.createElement(Rc,null,o.a.createElement("td",{colSpan:5},h.map(function(e){return o.a.createElement(Nc,{key:e},e)}))),o.a.createElement(Rc,null,o.a.createElement("td",{colSpan:5},o.a.createElement(je.Button,{onClick:function(){return e.props.onOpenWorkload(a.workloadId)}},o.a.createElement(Lc,{className:"fa fa-cube"}),"Open in workloads")))))}}])&&jc(n.prototype,a),i&&jc(n,i),t}();Tc(Ac,"displayName","CanaryProgressRow");var Fc=Object(p.connect)(function(e,t){var n=t.workload,r=C()(e,["root","urlParams","instanceId"]),o=C()(e,["root","workloadsCanary",r,n.workloadId],{}),a=C()(o,"weight",{}),i=C()(o,"status"),c=C()(a,"primary"),l=C()(a,"canary"),s=C()(e,["root","fluxWorkloads",r,"".concat(n.workloadId,"-primary")],{}),u=C()(e,["root","fluxWorkloads",r,n.workloadId],{});return{canaryRollout:C()(u,"Rollout",{}),canaryStatus:i,canaryWeight:l,primaryRollout:C()(s,"Rollout",{}),primaryStatus:C()(s,"Status"),primaryWeight:c}})(Ac);function Uc(e){return(Uc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wc(e,t){return!t||"object"!==Uc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bc(e){return(Bc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Kc(e,t){return(Kc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qc=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Wc(this,Bc(t).apply(this,arguments))}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kc(e,t)}(t,r["PureComponent"]),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.canary,n=e.availableTags,r=e.divergedContainers,a=e.primaryWorkload,i=e.workload,c=i.PerContainer||[];return Ho()(c,function(e,l){var s=e.Container,u=e.Target,p=function(e,t){return function(n){return Ze()(C()(e,[t]),function(e){return Object(Be.m)(e.ID)===Object(Be.m)(n)})||{}}}(n,s),f=p(t?C()(a,["Containers",0,"Current","ID"],""):u),d=r[s],m=p(d);return o.a.createElement("tr",{key:s},0===l&&o.a.createElement("td",{rowSpan:c.length},o.a.createElement(ma.a,{highlighted:!0,value:i.workloadId})),o.a.createElement("td",null,s),o.a.createElement(Ur,{id:f.ID,tag:Object(Be.m)(f.ID),createdAt:f?f.CreatedAt:"",latest:!0,strikethrough:Boolean(d)}),d?o.a.createElement(Ur,{id:d,createdAt:m?m.CreatedAt:"",tag:Object(Be.m)(d),latest:!0}):o.a.createElement("td",null),o.a.createElement("td",null,d&&"Diverged from release plan"))})}}])&&zc(n.prototype,a),i&&zc(n,i),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Qc,"displayName","SummaryRow");var Hc=Qc;function Gc(e){return(Gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vc(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function Yc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zc(e){return(Zc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $c(e,t){return($c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var el=f.default.div.withConfig({displayName:"stepper__StepperWrapper",componentId:"sc-1egxm71-0"})(["display:flex;"]),tl=f.default.div.withConfig({displayName:"stepper__Nav",componentId:"sc-1egxm71-1"})(["min-width:200px;"]),nl=f.default.div.withConfig({displayName:"stepper__NavItem",componentId:"sc-1egxm71-2"})(["display:flex;align-items:center;height:40px;margin-bottom:10px;padding-left:18px;border-radius:",";cursor:pointer;",";",";"],function(e){return e.theme.borderRadius.soft},function(e){return!e.disabled&&"\n      &:hover {\n        background-color: ".concat(e.theme.colors.purple400,";\n        color: ").concat(e.theme.colors.white,";\n      }\n\n      ").concat(e.active&&"\n        background-color: ".concat(e.theme.colors.purple400,";\n        color: ").concat(e.theme.colors.white,";\n      "),"\n  ")},function(e){return e.disabled&&"\n    color:  ".concat(e.theme.colors.gray200,";\n    cursor: auto;\n  ")}),rl=f.default.div.withConfig({displayName:"stepper__ContentWrapper",componentId:"sc-1egxm71-3"})(["margin-left:20px;overflow:auto;"]),ol=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Zc(t).call(this,e),n=!o||"object"!==Gc(o)&&"function"!=typeof o?Xc(r):o,Jc(Xc(n),"contentWrapperRef",void 0),Jc(Xc(n),"contentWrapperHeight",void 0),Jc(Xc(n),"contentPaddingHeight",void 0),Jc(Xc(n),"stepRefs",void 0),Jc(Xc(n),"stepPositions",void 0),Jc(Xc(n),"getStepPositions",function(){return Wo()(n.stepRefs,function(e,t,n){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vc(n,!0).forEach(function(t){Jc(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vc(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,Jc({},n,t.offsetTop))},{})}),Jc(Xc(n),"scrollToActive",function(e,t){var r=e.steps,o=(t||{}).steps,a=function(e){return z()(e.filter(function(e){return"Monitor"!==e.name&&!e.disabled}))},i=a(r),c=o&&a(o);c&&i.name===c.name||(n.stepPositions=n.getStepPositions(),n.scrollTo(i.name))}),Jc(Xc(n),"scrollTo",function(e){var t=$o()(n.props.steps,function(t){return t.name===e}),r=n.stepRefs[e].offsetTop-n.contentWrapperRef.offsetTop;n.setState({currentStep:t}),n.contentWrapperRef.scrollTop=r}),Jc(Xc(n),"handleNavClick",function(e,t){return function(){t||n.scrollTo(e)}}),Jc(Xc(n),"handleScroll",function(){n.stepPositions=n.getStepPositions();for(var e=n.contentWrapperRef.scrollTop+n.contentWrapperRef.offsetTop+20,t=n.props.steps.map(function(e){return e.name}),r=function(r){var o=t[r];if(n.stepPositions[o]<e)return n.setState({currentStep:$o()(n.props.steps,function(e){return e.name===o})}),"break"},o=t.length-1;t.length>0&&o>-1;o-=1){if("break"===r(o))break}}),n.state={currentStep:e.initialStep||0},n.stepRefs={},n.stepPositions={},n}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$c(e,t)}(t,r["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){var e=this.contentWrapperRef.offsetTop,t=document.documentElement&&document.documentElement.clientHeight||0;this.contentWrapperHeight=t-104-e,this.contentPaddingHeight=this.contentWrapperHeight-130,this.scrollToActive(this.props)}},{key:"componentDidUpdate",value:function(e){this.scrollToActive(this.props,e)}},{key:"render",value:function(){var e=this,t=this.props.steps,n=this.state.currentStep;return o.a.createElement(el,null,o.a.createElement(tl,null,t.map(function(t,r){var a=t.name,i=t.disabled,c=void 0!==i&&i;return o.a.createElement(nl,{key:a,active:n===r,disabled:c,onClick:e.handleNavClick(a,c)},a)})),o.a.createElement(rl,{style:{height:"".concat(this.contentWrapperHeight,"px")},ref:function(t){t&&(e.contentWrapperRef=t)},onScroll:this.handleScroll},t.map(function(t){var n=t.component,r=t.disabled,a=t.name;return!r&&o.a.createElement("div",{key:a,ref:function(t){t&&(e.stepRefs[a]=t)}},o.a.createElement(cl,null,a),n)}),o.a.createElement("div",{style:{height:"".concat(this.contentPaddingHeight,"px")}})))}}])&&Yc(n.prototype,a),i&&Yc(n,i),t}();Jc(ol,"displayName","Stepper");var al=ol,il=f.default.div.withConfig({displayName:"components__Section",componentId:"sc-1ucit1h-0"})(["margin-bottom:50px;"]),cl=f.default.h3.withConfig({displayName:"components__Header",componentId:"sc-1ucit1h-1"})(["font-weight:bold;"]),ll=f.default.h4.withConfig({displayName:"components__SubHeader",componentId:"sc-1ucit1h-2"})(["font-weight:bold;"]);function sl(e){return(sl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ul(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pl(e,t){return!t||"object"!==sl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fl(e){return(fl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dl(e,t){return(dl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ml=f.default.tbody.withConfig({displayName:"success-row__TBody",componentId:"sc-15hg7q2-0"})(["td:not(:nth-of-type(2)){border:none;}"]),hl=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),pl(this,fl(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dl(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.availableTags,n=e.workload,r=e.canary,a=e.primaryWorkload,i=n.PerContainer;return o.a.createElement(ml,null,i&&Ho()(i,function(e,c){var l=e.Container,s=e.Current,u=e.Target,p=e.canaryWeights,f=function(e){return Ze()(C()(t,[l]),function(t){return Object(Be.m)(t.ID)===Object(Be.m)(e)})},d=f(u),m=f(r?C()(a,["Containers",0,"Current","ID"],""):s);return o.a.createElement("tr",{key:l},0===c&&o.a.createElement("td",{rowSpan:i.length},o.a.createElement(ma.a,{highlighted:!0,value:n.workloadId})),o.a.createElement("td",null,l),r&&o.a.createElement("td",null,p.minWeight),r&&o.a.createElement("td",null,p.stepWeight),r&&o.a.createElement("td",null,p.maxWeight),o.a.createElement(Ur,{id:u,tag:Object(Be.m)(u),createdAt:d&&d.CreatedAt,latest:Object(Be.d)(m,d)}),o.a.createElement(Ur,{id:s,tag:Object(Be.m)(s),createdAt:m&&m.CreatedAt,latest:Object(Be.d)(d,m)}))}))}}])&&ul(n.prototype,r),a&&ul(n,a),t}(),yl=function(e){var t=e.className,n=e.workload;return o.a.createElement("tr",{className:t},o.a.createElement("td",null,o.a.createElement(ma.a,{highlighted:!0,value:n.workloadId})),o.a.createElement("td",null,n.Error))},bl=function(e){return e?"Canary image":"Image"},gl=function(e,t,n){return[{label:"Workload",value:"workloadId"},{label:"Containers",value:"PerContainer"},e?{label:"Min W.",sortable:!1,value:"minW",width:"60px"}:null,e?{label:"Step W.",sortable:!1,value:"stepW",width:"60px"}:null,e?{label:"Max W.",sortable:!1,value:"MaxW",width:"60px"}:null,{label:t?"Source: ".concat(C()(t,"name","")):bl(e),sortable:!1,value:"source"},{label:e?"Primary image":"Target: ".concat(C()(n,"name","")),sortable:!1,value:"target"}].filter(Boolean)},vl=function(e){var t=e.groups,n=e.instance,r=e.sourceInstance,a=e.canary,i=e.primaryWorkload,c=e.availableTags;return Ho()(t,function(e,t){var l=0===e.length,s="success"===t?"Updating resources":"".concat(rc()(t)," resources");return l&&"success"!==t?null:o.a.createElement(il,{key:t},o.a.createElement(ll,null,s),"success"===t?o.a.createElement(je.DataTable,{nested:!0,data:e,sortBy:"workloadId",sortOrder:"asc",columns:gl(a,r,n)},function(e){return Ho()(e,function(e){return o.a.createElement(hl,{canary:a,workload:e,key:e.workloadId,availableTags:c[e.workloadId],primaryWorkload:i})})}):o.a.createElement(je.DataTable,{data:e,columns:[{label:"Workload",value:"workloadId"},{label:"Reason",value:"reason"}]},function(e){return Ho()(e,function(e){return o.a.createElement(yl,{workload:e,key:e.workloadId})})}))})},wl=n(1313);function kl(e){return(kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ol(e,t){return!t||"object"!==kl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function El(e){return(El=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Sl(e,t){return(Sl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xl=f.default.span.withConfig({displayName:"release-progress__SyncMsg",componentId:"vxh1ib-0"})(["font-size:",";color:",";"],function(e){return e.theme.fontSizes.small},function(e){return e.theme.colors.gray600}),jl=f.default.span.withConfig({displayName:"release-progress__ErrorMsg",componentId:"vxh1ib-1"})(["color:",";"],function(e){return e.theme.colors.orange600}),Cl=[{label:"Workload",value:"workloadId"},{label:"Status",sortable:!1,value:"status"},{label:"Old Pods",sortable:!1,value:"old"},{label:"New Pods",sortable:!1,value:"new"},{label:"Elapsed time",sortable:!1,value:"time"}],Il=[Cl[0],Cl[1],{label:"Primary",sortable:!1,value:"primary"},{label:"Canary",sortable:!1,value:"canary"},Cl[4]],Pl=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ol(this,El(t).apply(this,arguments))}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sl(e,t)}(t,r["PureComponent"]),n=t,(a=[{key:"render",value:function(){var e=this,t=this.props,n=t.release,r=t.config,a=t.workloads,i=t.canary,c=t.canaryStatus,l=t.rolloutComplete,s=function(e){return e.synced?"done":e.error?"error":"in_progress"}(n),u=tc(n,i,c,l);return o.a.createElement(il,null,o.a.createElement(Qi,{status:s,title:"Sync"},o.a.createElement(xl,null,function(e,t){if(!e.commited)return"Waiting to sync";if(e.error)return o.a.createElement(jl,null,"Error: ".concat(e.error));var n=e.synced?"Synced":"Syncing",r=e.commitId?e.commitId:"";return o.a.createElement("span",null,n," ",o.a.createElement(wl.a,{id:r,config:t}))}(n,r))),"done"===s&&o.a.createElement(Qi,{status:u,title:"Apply"},o.a.createElement(je.DataTable,{nested:!0,flush:!0,data:a,sortBy:"workloadId",sortOrder:"asc",columns:i?Il:Cl},function(t){return Ho()(t,function(t){return o.a.createElement("tbody",{key:t.workloadId},i?o.a.createElement(Fc,{workload:t,release:n,rolloutComplete:l,onOpenWorkload:e.props.onOpenWorkload}):o.a.createElement(Sc,{workload:t,release:n,onOpenWorkload:e.props.onOpenWorkload}))})})))}}])&&_l(n.prototype,a),i&&_l(n,i),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Pl,"displayName","ReleaseProgress");var Tl=Pl,Rl=n(1398),Nl=n(1377),Ll=n(1291),Dl=n(1470),ql=n(1311),Ml=n(1279);function Al(e){return(Al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ul(e){return(Ul=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wl(e,t){return(Wl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Kl=f.default.div.withConfig({displayName:"flux-release-notebook-entry__EntryContainer",componentId:"sc-9f91r4-0"})(["margin:8px 0;font-size:",";background-color:",";border-bottom:1px solid ",";box-sizing:border-box;padding:12px;"],function(e){return e.theme.fontSizes.small},function(e){return e.theme.colors.white},function(e){return e.theme.colors.gray200}),Ql=f.default.div.withConfig({displayName:"flux-release-notebook-entry__Query",componentId:"sc-9f91r4-1"})(["margin-bottom:8px;"]),Hl=f.default.div.withConfig({displayName:"flux-release-notebook-entry__Error",componentId:"sc-9f91r4-2"})(["color:",";padding:12px 12px;border-radius:",";border:1px solid ",";"],function(e){return e.theme.colors.orange500},function(e){return e.theme.borderRadius.soft},function(e){return Object(Xe.transparentize)(.8,e.theme.colors.orange500)}),Gl=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=Ul(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Al(o)&&"function"!=typeof o?zl(r):o,Bl(zl(n),"state",{error:null}),Bl(zl(n),"handleReceiveQuery",function(){n.setState({error:null})}),Bl(zl(n),"handleReceiveError",function(e){n.setState({error:e})}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wl(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.entry,n=e.instanceId,r=e.queryEnd,a=this.state.error,i="text"===t.type?"markdown":"promql";return o.a.createElement(Kl,null,o.a.createElement(Ql,null,o.a.createElement(ql.a,{readOnly:!0,value:t.query,language:i,wrapLines:!0,isNotebook:!0,showLineNumbers:!1})),a&&o.a.createElement(Hl,null,o.a.createElement("i",{className:"fas fa-exclamation-triangle"})," ",a),"promql"===i&&o.a.createElement("div",{style:a&&{display:"none"}},o.a.createElement(Ml.a,{graphHeight:200,onReceiveError:this.handleReceiveError,onReceiveQuery:this.handleReceiveQuery,end:r,query:t.query,instanceId:n})))}}])&&Fl(n.prototype,r),a&&Fl(n,a),t}();function Vl(e){return(Vl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zl(e,t){return!t||"object"!==Vl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xl(e){return(Xl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $l(e,t){return($l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Jl=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Zl(this,Xl(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$l(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this,t=this.props,n=t.instanceId,r=t.notebook,a=(void 0===r?{}:r).entries||[];return o.a.createElement(o.a.Fragment,null,a.map(function(t){return o.a.createElement(Gl,{key:t.id,entry:t,queryEnd:e.props.queryEnd,instanceId:n})}))}}])&&Yl(n.prototype,r),a&&Yl(n,a),t}();var es=Object(p.connect)(function(e,t){var n=t.id,r=t.instanceId,o=((e.root.prometheus[r]||{}).notebooks||{}).data;return{notebook:(void 0===o?[]:o).find(function(e){return e.id===n}),queryEnd:Object(M.e)(e)}})(Jl),ts=n(416),ns=n.n(ts),rs=n(60),os=n.n(rs),as=n(276),is=n.n(as),cs=n(1905),ls=n.n(cs);function ss(e){return(ss="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function us(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function ps(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?us(n,!0).forEach(function(t){ys(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):us(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function fs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ds(e){return(ds=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ms(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hs(e,t){return(hs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ys(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var bs=f.default.div.withConfig({displayName:"flux-release-notebook-selector__Container",componentId:"sc-1svc5wr-0"})(["margin-bottom:12px;display:flex;width:100%;"]),gs=f.default.div.withConfig({displayName:"flux-release-notebook-selector__InputContainer",componentId:"sc-1svc5wr-1"})(["display:inline-block;position:relative;flex:1;margin-right:12px;ul{margin:0;padding:0;}"]),vs=f.default.div.withConfig({displayName:"flux-release-notebook-selector__ShadowWrapper",componentId:"sc-1svc5wr-2"})(["position:absolute;padding:10px;margin:-10px;width:calc(100% - 2px);z-index:",";"],function(e){return e.theme.layers.dropdown}),ws=f.default.div.withConfig({displayName:"flux-release-notebook-selector__SuggestionContainer",componentId:"sc-1svc5wr-3"})(["box-shadow:0 1px 3px ",",0 1px 2px ",";max-height:400px;overflow-y:auto;margin-left:1px;background:",";"],function(e){return Object(Xe.transparentize)(.88,e.theme.colors.black)},function(e){return Object(Xe.transparentize)(.76,e.theme.colors.black)},function(e){return e.theme.colors.white}),ks=f.default.div.withConfig({displayName:"flux-release-notebook-selector__Item",componentId:"sc-1svc5wr-4"})(["color:",";padding:12px 0 12px 24px;background:",";position:relative;border-bottom:1px solid ",";font-size:",";cursor:pointer;",""],function(e){return e.theme.colors.purple300},function(e){return e.theme.colors.white},function(e){return e.theme.colors.gray200},function(e){return e.theme.fontSizes.small},function(e){return e.isHighlighted&&"background-color: aliceblue;"}),_s=Object(f.default)(ks).withConfig({displayName:"flux-release-notebook-selector__Title",componentId:"sc-1svc5wr-5"})(["color:",";border-bottom:none;padding:12px 0 12px 12px;"],function(e){return e.theme.colors.black}),Os=f.default.input.withConfig({displayName:"flux-release-notebook-selector__Input",componentId:"sc-1svc5wr-6"})(["font-size:",";line-height:2em;padding:2px 8px;border:1px solid ",";border-radius:",";color:",";width:100%;box-sizing:border-box;outline:none;.react-autosuggest__container--open &{border-top-left-radius:",";border-top-right-radius:",";}"],function(e){return e.theme.fontSizes.normal},function(e){return e.theme.colors.gray200},function(e){return e.theme.borderRadius.soft},function(e){return e.theme.colors.purple800},function(e){return e.theme.borderRadius.soft},function(e){return e.theme.borderRadius.soft}),Es=function(e,t){var n=e.title,r=t.isHighlighted;return o.a.createElement(ks,{isHighlighted:r},n)};function Ss(e){var t=e.title;return o.a.createElement(_s,null,t)}var xs=function(e){return o.a.createElement(Os,e)};function js(e){var t=e.containerProps,n=e.children;return o.a.createElement(vs,null,o.a.createElement(ws,t,n))}var Cs=function(e){return e.title},Is=function(e){return e.items},Ps=function(e,t){return is()(t,function(e){return e.items}).find(function(t){return t.id===e})};var Ts=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=ds(t).call(this,e),n=!o||"object"!==ss(o)&&"function"!=typeof o?ms(r):o,ys(ms(n),"handleSuggestionSelected",function(e,t){var r=t.suggestion,o=r.id,a=r.type;Object(Z.trackEvent)("flux.release.monitoring.select",ps({type:a},"dashboard"===a&&{dashboardId:o})),n.props.onSuggestionSelected(e,{suggestion:r})}),ys(ms(n),"getSuggestions",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=n.props.sections,r=void 0===t?[]:t,o=e.trim().toLowerCase(),a=o.length;return 0===a?r:r.map(function(t){return{items:t.items.filter(function(t){var n=t.title;return Object(ca.d)(n,e)}),title:t.title}}).filter(function(e){return e.items.length>0})}),ys(ms(n),"onSuggestionsFetchRequested",function(e){var t=e.value;n.setState({suggestions:n.getSuggestions(t)})}),ys(ms(n),"onSuggestionsClearRequested",function(){n.setState({suggestions:[]})}),ys(ms(n),"handleChange",function(e,t){var r=t.newValue;n.setState({editingValue:r})}),ys(ms(n),"handleBlur",function(){n.setState({editingValue:""})}),ys(ms(n),"handleClickOpenInMonitor",function(){var e=n.props,t=e.instanceId,r=e.sections,o=e.selectedId,a=e.sharedQueryParams,i=Ps(o,r),c=i.id,l=i.type,s=i.namespace,u={dashboard:function(){return"workload-resources"===c?Object($.i)(ps({},a,{namespace:s}),t):Object($.g)(a,t)},notebook:function(){return Object($.Q)(a,t,o)},workload:function(){return Object($.Z)(a,t,c)}}[l]();Q.a.push(u)}),n.state={editingValue:"",suggestions:e.sections||[]},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hs(e,t)}(t,o.a.Component),n=t,(r=[{key:"maybeLoadDefaultDashboard",value:function(){var e,t=(e=this.props.workloadIds)?1===e.length?e[0]:"workload-resources":null,n=Ps(t,this.props.sections);n&&this.props.onSuggestionSelected(null,{method:"replace",suggestion:n})}},{key:"componentDidMount",value:function(){this.props.selectedId||this.maybeLoadDefaultDashboard()}},{key:"componentWillReceiveProps",value:function(e){var t=e.sections,n=e.selectedId;os()(t,this.props.sections)&&os()(n,this.props.selectedId)||this.setState({editingValue:"",suggestions:t})}},{key:"render",value:function(){var e=this.state,t=e.editingValue,n=e.suggestions,r=Ps(this.props.selectedId,this.props.sections),a={dashboard:"View dashboard",notebook:"Edit notebook",workload:"View workload"}[r&&r.type];return o.a.createElement(bs,null,o.a.createElement(gs,null,o.a.createElement(ls.a,{multiSection:!0,inputProps:{onBlur:this.handleBlur,onChange:this.handleChange,placeholder:r&&r.title||"Select notebook",value:t},shouldRenderSuggestions:function(){return!0},focusInputOnSuggestionClick:!1,suggestions:n,onSuggestionSelected:this.handleSuggestionSelected,onSuggestionsFetchRequested:this.onSuggestionsFetchRequested,onSuggestionsClearRequested:this.onSuggestionsClearRequested,getSuggestionValue:Cs,getSectionSuggestions:Is,renderSectionTitle:Ss,renderSuggestion:Es,renderSuggestionsContainer:js,renderInputComponent:xs})),a&&o.a.createElement(J.a,{label:a,onClick:this.handleClickOpenInMonitor}))}}])&&fs(n.prototype,r),a&&fs(n,a),t}();Ts.defaultProps={value:""};var Rs=Object(p.connect)(function(e,t){var n=t.instanceId,r=t.workloadIds,o=((e.root.prometheus[n]||{}).notebooks||{}).data,a=void 0===o?[]:o,i=function(e){return ns()((e||[]).map(function(e){return Object(D.b)(e).namespace}))}(r||[]);return{sections:[{items:[{id:"workload-resources",namespace:1===i.length?i[0]:void 0,title:"Workload resources",type:"dashboard"},{id:"node-resources",title:"Node resources",type:"dashboard"}],title:"Dashboards"},{items:(r||[]).filter(function(e){return e!==T.FLUX_ALL_WORKLOADS}).map(function(e){return{id:e,title:e,type:"workload"}}),title:"Workload dashboards"},{items:a.map(function(e){return ps({},e,{type:"notebook"})}),title:"Notebooks"}],sharedQueryParams:Object(ze.b)(e)}})(Ts),Ns=n(125);function Ls(e){return(Ls="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ds(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qs(e,t){return!t||"object"!==Ls(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ms(e){return(Ms=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function As(e,t){return(As=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fs=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),qs(this,Ms(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&As(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.startAutoRefreshTimer(this.props)}},{key:"componentWillUnmount",value:function(){this.stopAutoRefreshTimer()}},{key:"startAutoRefreshTimer",value:function(){var e=this;this.props.updateTimeTravelTimestamp(Object(Ns.c)()),this.autoRefreshTimer=setInterval(function(){e.props.updateTimeTravelTimestamp(Object(Ns.c)())},1e4)}},{key:"stopAutoRefreshTimer",value:function(){clearInterval(this.autoRefreshTimer)}},{key:"render",value:function(){return null}}])&&Ds(n.prototype,r),a&&Ds(n,a),t}(),Us=Object(p.connect)(null,{updateTimeTravelTimestamp:R.ac})(Fs),zs=n(363),Ws=n.n(zs),Bs=n(55),Ks=n(1299),Qs=n(1273),Hs=n(1340);function Gs(e){return(Gs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vs(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ys(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function Zs(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Xs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $s(e){return($s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Js(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eu(e,t){return(eu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nu="prom.selectedNS",ru=f.default.div.withConfig({displayName:"workload-resources__NamespaceSelector",componentId:"sf5tb8-0"})(["font-size:",";align-items:baseline;margin-left:30px;margin-bottom:20px;display:flex;"],function(e){return e.theme.fontSizes.normal}),ou=f.default.span.withConfig({displayName:"workload-resources__SelectorLabel",componentId:"sf5tb8-1"})(["margin-right:1em;"]),au={label:"--- All namespaces ---",value:""},iu=function(e){return e?[e]:[]},cu=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=$s(t).call(this,e),n=!o||"object"!==Gs(o)&&"function"!=typeof o?Js(r):o,tu(Js(n),"getActiveChartId",function(){return n.props.location.hash.slice(1)}),tu(Js(n),"smoothScrollToActiveChart",function(){if(!n.state.scrolled){var e=n.getActiveChartId(),t=document.querySelector('div[data-id="'.concat(e,'"]'));e&&t&&(n.setState({scrolled:!0}),t.scrollIntoView({behavior:"smooth",block:"start",inline:"start"}))}}),tu(Js(n),"handleNamespaceSelect",function(e,t){var r=n.props.location.query,o=(r.workload,Zs(r,["workload"])),a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ys(n,!0).forEach(function(t){tu(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ys(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},n.props.location,{query:o});Q.a.push({pathname:n.props.location.pathname,search:Object(Ns.h)({namespace:t},a)}),Object(Z.trackEvent)("prom.dashboard.service.resources.namespace.change",{namespace:t}),n.updateSelectedNamespace(t)}),tu(Js(n),"updateSelectedNamespace",function(e){n.setState({selectedLegendKeys:[],selectedNamespace:e}),Object(Bs.storageSet)(nu,e)}),n.state={scrolled:!1,selectedLegendKeys:iu(e.location.query.workload),selectedNamespace:e.namespace||au.value},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eu(e,t)}(t,o.a.Component),n=t,(r=[{key:"fetchNamespaceLabels",value:function(e){Ws()(e.platform)||this.props.loadNamespacesList(e.instanceId,e.platform)}},{key:"getRows",value:function(e,t){this.rows=Hs.a.getRows({instance:e.instance,namespace:t.selectedNamespace,platform:e.platform})}},{key:"componentWillMount",value:function(){this.fetchNamespaceLabels(this.props),this.getRows(this.props,this.state)}},{key:"componentWillUpdate",value:function(e,t){this.props.instanceId===e.instanceId&&this.props.platform===e.platform||this.fetchNamespaceLabels(e),this.props.platform===e.platform&&this.state.selectedNamespace===t.selectedNamespace||this.getRows(e,t)}},{key:"componentWillReceiveProps",value:function(e){var t=this.state.selectedNamespace,n=t!==au.value,r=Zo()(e.namespaces,t);e.isLoading||!n||r||this.updateSelectedNamespace(au.value)}},{key:"componentDidMount",value:function(){this.smoothScrollToActiveChart()}},{key:"componentDidUpdate",value:function(){this.smoothScrollToActiveChart()}},{key:"componentWillUnmount",value:function(){this.namespaceLabelsRequest&&this.namespaceLabelsRequest.cancel()}},{key:"render",value:function(){var e,t=this.state,n=t.selectedNamespace,r=t.selectedLegendKeys,a=this.props,i=a.platform,c=a.metricNamesLoaded,l=a.metricsExist,s=a.namespaces,u=a.instanceId,p=a.location;if(c&&!l){var f,d=o.a.createElement("span",null,"Please"," ",o.a.createElement(G.a,{to:Object($.U)(u)},"re-install the Weave Cloud agents")," ","to collect Workload Resources metrics.");if(""===i)f=d;else f="kubernetes"===i||"docker"===i?d:o.a.createElement("span",null,"We cannot currently provide the Workload Resources Dashboard for your cluster platform.");e=o.a.createElement(Ks.a,null,"Sorry, we could not find any workload metrics.",f)}var m=[au].concat(Vs(Ho()(s,function(e){return{label:e,value:e}}))),h=this.getActiveChartId();return o.a.createElement("div",{className:Hs.a.id},e,!this.props.hideTimeTravel&&o.a.createElement(N.a,{instanceId:u,location:p,hasRangeSelector:!0}),this.props.isLoading?o.a.createElement(Ee.a,null):o.a.createElement("div",null,o.a.createElement(ru,null,o.a.createElement(ou,null,"Namespace"),o.a.createElement(je.Dropdown,{onChange:this.handleNamespaceSelect,value:n,items:m},o.a.createElement("strong",null,n))),o.a.createElement(Qs.a,{rows:this.rows,instanceId:u,focusedChartId:h,selectedLegendKeys:r,namespaceId:n,location:p})))}}])&&Xs(n.prototype,r),a&&Xs(n,a),t}();var lu=Object(p.connect)(function(e,t){var n=t.params.instanceId,r=e.root.instances[n],o=Object(Pe.f)(n)(e).platform,a=e.root.prometheus[n]||{},i=t.location.query.namespace||Object(Bs.storageGet)(nu,au.value),c=a.metricNames,l=a.metricNames,s=void 0===l?[]:l;return{instance:r,instanceId:n,isLoading:C()(e,["root","namespaces",n,"loading"],!0),metricNamesLoaded:c,metricsExist:Hs.a.getRows({instance:r,namespace:i,platform:o}).every(function(e){return e.charts.every(function(e){return Object(Ns.b)(s,e.queryMetrics)})||e.optional}),namespace:i,namespaces:C()(e,["root","namespaces",n,"data"],[]),platform:o}},{loadNamespacesList:R.V})(cu);function su(e){return(su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uu(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function pu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?uu(n,!0).forEach(function(t){yu(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uu(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function fu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function du(e){return(du=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hu(e,t){return(hu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var bu=["cadvisor-resources","go-runtime"],gu=f.default.div.withConfig({displayName:"monitoring__Container",componentId:"sc-1osh957-0"})([""]),vu=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=du(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==su(o)&&"function"!=typeof o?mu(r):o,yu(mu(n),"handleSelectedTabChange",function(e){var t=n.props,r=t.canary,o=t.containerImageSource,a=t.instanceId,i=t.release.id,c=t.workloadSummaryId;Q.a.push(Object($.n)(a,i,{canary:r,containerImageSource:o,workloadId:c,workloadTabId:e}))}),yu(mu(n),"showItem",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"push",r=n.props,o=r.instanceId,a=r.release,i=r.containerImageSource,c=r.canary,l=e.id,s=e.type,u=e.namespace,p={dashboard:{dashboardId:l,dashboardNamespace:u},notebook:{notebookId:l},workload:{workloadId:l}}[s],f=Object($.n)(o,a.id,pu({},p,{canary:c,containerImageSource:i}));"push"===t?Q.a.push(f):Q.a.replace(f)}),yu(mu(n),"handleSuggestionSelected",function(e,t){var r=t.suggestion,o=t.method;n.showItem(r,o)}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hu(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.canary,n=e.dashboardId,r=e.dashboards,a=e.instance,i=e.instanceId,c=e.location,l=e.notebookId,s=e.selectedTabId,u=e.workloadIds,p=e.workloadSummaryId;return o.a.createElement(gu,null,o.a.createElement(Us,null),o.a.createElement(Rs,{instanceId:i,onSuggestionSelected:this.handleSuggestionSelected,selectedId:l||p||n,workloadIds:u}),"workload-resources"===n&&o.a.createElement(lu,{hideTimeTravel:!0,params:{instanceId:i},location:c}),"node-resources"===n&&o.a.createElement(Rl.a,{hideTimeTravel:!0,params:{instanceId:i},location:c}),p&&o.a.createElement(Nl.a,{location:this.props.location,onSelectedTabChange:this.handleSelectedTabChange,instanceId:i,workloadId:p,dashboardId:s},r&&Ho()(r,function(e){return o.a.createElement(Ll.a,{key:e.id,id:e.id,name:e.name},o.a.createElement(Dl.a,{canary:t,canaryAppMesh:Object(Nn.c)(a,["canary-appmesh"]),instanceId:i,workloadId:p,dashboard:e}))})),l&&o.a.createElement(es,{key:l,instanceId:i,id:l}))}}])&&fu(n.prototype,r),a&&fu(n,a),t}();var wu=Object(p.connect)(function(e,t){var n=t.instanceId,r=t.workloadSummaryId,o=C()(e,"root.urlQuery.canary",!1),a=C()(e,["root","instances",n])||{},i=C()(e,["root","prometheus",n,"workloadDashboards",r]),c=C()(e,["root","prometheus",n,"workloadDashboards","".concat(r,"-primary")]);return o&&(i=c),{canary:o,containerImageSource:e.root.urlQuery.containerImageSource,dashboards:ea()(i,function(e){return bu.includes(e.id)}),instance:a,selectedTabId:e.root.urlParams.selectedTabId||bu[0]}})(vu);function ku(e){return(ku="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ou(e){return(Ou=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Eu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Su(e,t){return(Su=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xu(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function ju(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Cu=f.default.div.withConfig({displayName:"release__SummaryBar",componentId:"sc-1htiz71-0"})(["position:fixed;bottom:0;left:0;display:flex;width:100%;padding:30px 4%;background-color:",";box-shadow:-1px 0 3px ",";button{margin-right:16px;width:200px;height:44px;font-size:",";}> div{display:flex;align-items:center;}"],function(e){return e.theme.colors.white},function(e){return e.theme.colors.gray200},function(e){return e.theme.fontSizes.normal}),Iu=f.default.div.withConfig({displayName:"release__Summary",componentId:"sc-1htiz71-1"})(["margin-left:40px;"]),Pu=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return o.a.createElement(je.Alert,{visible:!0,type:"warning",icon:"exclamation-triangle",title:t},o.a.createElement("div",null,e))},Tu=Pu("\n  The tags of some workloads have changed and no longer reflect either the\n  initial or desired value specified in this release! Another release may\n  have taken precedence or a manual change may have been made to the\n  cluster.\n","Image tags have diverged"),Ru=Pu("\nCanary was not promoted as the error threshold was\nexceeded.\n"),Nu=function(e){return Wo()(e.results,function(e,t,n){return e[t.Status]&&e[t.Status].push(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xu(n,!0).forEach(function(t){ju(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xu(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({workloadId:n},t)),e},{failure:[],skipped:[],success:[]})},Lu=[{label:"Workload",value:"workloadId"},{label:"Containers",value:"containers"},{label:"Image",value:"latestImage"},{label:"",value:"divergedImage"},{label:"Notes",value:"divergedImageMessage"}],Du=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=Ou(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==ku(o)&&"function"!=typeof o?Eu(r):o,ju(Eu(n),"state",{releaseTimestamp:0}),ju(Eu(n),"handleClickRelease",function(){n.props.canary&&n.setState({releaseTimestamp:Date.now()}),n.props.onClickRelease()}),ju(Eu(n),"handleClickDone",function(){var e=n.props,t=e.sharedQueryParams,r=e.instanceId;Q.a.push(Object($.m)(t,r))}),ju(Eu(n),"fetchContainerDetails",function(){var e=n.props,t=e.release,r=e.instanceId,o=Nu(t).success;Li()(o,function(e){var t=e.workloadId;n.props.dispatch(Object(R.z)(r,t))})}),ju(Eu(n),"handleOpenWorkload",function(e){var t=n.props,r=t.sharedQueryParams,o=t.instanceId;window.open(Object($.Z)(r,o,e))}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Su(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.props.release&&this.props.instanceId&&this.fetchContainerDetails()}},{key:"componentDidUpdate",value:function(e){var t=this.props.release;!C()(e,["release","success"])&&!!C()(t,"success")&&this.fetchContainerDetails()}},{key:"render",value:function(){var e=this.props,t=e.onClickRetry,n=e.error,r=e.release,a=e.plan,i=e.config,c=e.className,l=e.instanceId,s=e.notebookId,u=e.workloadSummaryId,p=e.dashboardId,f=e.instance,d=e.sourceInstance,m=e.canary,h=e.canaryStatus,y=e.primaryWorkload,b=e.availableTags,g=this.state.releaseTimestamp,v=m?function(e,t,n,r,o){return 0!==e&&"done"===tc(r)&&Date.now()-t>2e4&&(n.imageId===C()(o,"Containers[0].Current.ID")||E()(n)||2===e)}(h,g,a,r,y):"done"===tc(r),w="diverged"===tc(r),k=!(n||r&&r.id),_=r&&(!r.status||"running"===r.status||"queued"===r.status),O=r&&!r.isPlan&&"succeeded"===r.status;if(k||!f)return o.a.createElement("div",{className:"flux-release"},o.a.createElement("h2",null,"Loading release"),o.a.createElement(je.CircularProgress,null));if(n)return o.a.createElement("div",{className:"flux-release"},o.a.createElement("h2",null,"Error loading release"),o.a.createElement("p",null,n),o.a.createElement(J.a,{label:"retry",onClick:t}));var S=Nu(r.results?r:a);return o.a.createElement("div",{className:"".concat(c," flux-release")},o.a.createElement("div",null,o.a.createElement(al,{steps:[{component:o.a.createElement("div",null,_&&r.isPlan&&o.a.createElement(je.CircularProgress,null),o.a.createElement(vl,{canary:m,groups:S,sourceInstance:d,primaryWorkload:y,availableTags:b,instance:f})),name:"Resources"},{component:o.a.createElement(Tl,{config:i,release:r,workloads:S.success,canary:m,canaryStatus:h,rolloutComplete:v,onOpenWorkload:this.handleOpenWorkload}),disabled:r.isPlan,name:"Deploy progress"},{component:o.a.createElement(il,null,Xi(Lo()(r.workloads),r)&&Tu,2===h&&Ru,o.a.createElement(je.DataTable,{nested:!0,flush:!0,data:S.success,sortBy:"workloadId",sortOrder:"asc",columns:Lu},function(e){return Ho()(e,function(e){return o.a.createElement("tbody",{key:e.workloadId},o.a.createElement(Hc,{divergedContainers:Hi(e.workloadId,r).diverged,availableTags:b[e.workloadId],workload:e,canary:m,canaryStatus:h,primaryWorkload:y}))})})),disabled:!(v||w),name:"Summary"},{component:o.a.createElement(il,null,o.a.createElement(wu,{location:this.props.location,workloadIds:r.workloadIds,instanceId:l,workloadSummaryId:u,dashboardId:p,notebookId:s,release:r})),name:"Monitor"}]}),!_&&o.a.createElement(Cu,null,r.isPlan&&o.a.createElement(je.Button,{primary:!0,disabled:0===S.success.length||r.commited,onClick:this.handleClickRelease},"Release"),(O||r.error)&&o.a.createElement(je.Button,{primary:v,title:"You can safely leave this page while the release is ongoing",onClick:this.handleClickDone},"Back to resources"),o.a.createElement(Iu,null,v||r.error?"Updated":"Updating","",o.a.createElement(xn.a,{singular:"image",count:S.success.length}),S.skipped.length>0&&o.a.createElement("span",null,", ",O?"skipped":"skipping","",o.a.createElement(xn.a,{singular:"image",count:S.skipped.length}))))))}}])&&_u(n.prototype,r),a&&_u(n,a),t}();var qu=Object(p.connect)(function(e,t){var n=t.instanceId,r=C()(e,"root.urlParams.workloadSummaryId"),o=C()(e,"root.urlQuery.canary")&&C()(e,["root","workloadsCanary",n,r,"status"]),a=(q.e(e)||{})["".concat(r,"-primary")];return{availableTags:q.a(e),canaryStatus:o,instanceId:n,primaryWorkload:a,sharedQueryParams:Object(ze.b)(e)}})(function(e){return Object(f.default)(e).withConfig({displayName:"release",componentId:"sc-1htiz71-2"})([""])}(Du));function Mu(e){return(Mu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Au(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Fu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Uu(e){return(Uu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wu(e,t){return(Wu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ku=4e3,Qu=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=Uu(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Mu(o)&&"function"!=typeof o?zu(r):o,Bu(zu(n),"pollTimeout",void 0),Bu(zu(n),"cancelLoadReleaseInfo",void 0),Bu(zu(n),"state",{alertActive:!1,error:null}),Bu(zu(n),"loadReleaseInfo",function(){var e=n.props,t=e.canary,r=e.dispatch,o=e.instanceId,a=e.release,i=void 0===a?{}:a,c=e.releaseId,l=e.workloadSummaryId,s=[];return i.commited||i.planned?i.commited&&i.synced?s=[r(Object(R.F)(o)).then(function(){return Object(Ri.f)(Ku)})]:i.commitId&&(s=[r(Object(R.E)(o,i.commitId))]):s=[r(Object(R.C)(o,c))],t&&o&&l&&(s=[].concat(Au(s),[r(Object(R.w)(o,l)),r(Object(R.v)(o,l)),r(Object(R.F)(o))])),Promise.all(s).catch(function(e){n.setState({alertActive:!0,error:e.errors[0].message})})}),Bu(zu(n),"handleAlertClose",function(){n.setState({alertActive:!1})}),Bu(zu(n),"handleClickRelease",function(){var e=n.props,t=e.canary,r=e.currentUser,o=e.dashboardId,a=e.dashboardNamespace,i=e.dispatch,c=e.instanceId,l=e.notebookId,s=e.release,u=s.workloadIds,p=s.imageId,f=s.type,d=s.containerSpecs,m=e.releaseId,h=e.selectedTabId,y=e.workloadSummaryId;i("image"!==f?Object(R.wb)(c,d,r,"execute",{canary:t}):Object(R.xb)(c,u,p,m,{canary:t,dashboardId:o,dashboardNamespace:a,notebookId:l,workloadId:y,workloadTabId:h},!1))}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wu(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){var e=this.props,t=e.dispatch,n=e.release;n&&n.completed||(this.cancelLoadReleaseInfo=Object(Pt.b)(this.loadReleaseInfo,1e3)),t(Object(R.W)(this.props.instanceId)),t(Object(R.K)())}},{key:"componentDidUpdate",value:function(e){e.releaseId!==this.props.releaseId&&(this.cancelLoadReleaseInfo&&this.cancelLoadReleaseInfo(),this.cancelLoadReleaseInfo=Object(Pt.b)(this.loadReleaseInfo,1e3))}},{key:"componentWillUnmount",value:function(){this.cancelLoadReleaseInfo&&this.cancelLoadReleaseInfo()}},{key:"render",value:function(){var e=this.props,t=e.canary,n=e.className,r=e.config,a=e.dashboardId,i=e.instance,c=e.instanceId,l=e.location,s=e.notebookId,u=e.plan,p=e.release,f=e.sourceInstance,d=e.workloadSummaryId,m=this.state,h=m.error,y=m.alertActive;return o.a.createElement(fe,{hideFooter:!0,instanceId:c,className:n},o.a.createElement(Ue.a,null,o.a.createElement(je.Alert,{type:"error",visible:y,onClose:this.handleAlertClose},h)),o.a.createElement(qu,{canary:t,config:r,dashboardId:a,instance:i,instanceId:c,location:l,notebookId:s,plan:u,release:p,sourceInstance:f,workloadSummaryId:d,onClickRelease:this.handleClickRelease}))}}])&&Fu(n.prototype,r),a&&Fu(n,a),t}(),Hu=Object(p.connect)(function(e,t){var n=t.params,r=n.dashboardId,o=n.instanceId,a=n.notebookId,i=n.releaseId,c=n.selectedTabId,l=n.workloadSummaryId,s=e.root,u=Object(q.k)(e),p=C()(u,[o,i]),f=p&&!p.isPlan&&p,d=p&&p.isPlan?p:C()(u,[o,s.fluxLastPlan],{}),m=f||d,h=s.urlQuery,y=h.containerImageSource,b=h.namespace,g=s.instances[y];return{canary:C()(s,["urlQuery","canary"],!1),config:Object(q.g)(e)[o],currentUser:s.currentUser,dashboardId:r,dashboardNamespace:b,instance:s.instances[o],instanceId:o,notebookId:a,plan:d,release:m,releaseId:i,selectedTabId:c,sourceInstance:g,workloadSummaryId:l}})(function(e){return Object(f.default)(e).withConfig({displayName:"page",componentId:"sc-19qns6d-0"})([""])}(Qu));t.default=[o.a.createElement(u.a,{name:"flux"},o.a.createElement(i.a,{to:"services"}),o.a.createElement(l.a,{from:"intro",to:"services"}),o.a.createElement(u.a,{name:"releases",path:"releases/:releaseId",gaName:"ReleasesPage",mpEvent:"flux.releasepage.view",component:Hu}),o.a.createElement(u.a,{name:"releases",path:"releases/:releaseId/dashboards/:dashboardId",noMpEvent:!0,gaName:"ReleasesPage",component:Hu}),o.a.createElement(u.a,{name:"releases",path:"releases/:releaseId/notebooks/:notebookId",noMpEvent:!0,gaName:"ReleasesPage",component:Hu}),o.a.createElement(u.a,{name:"releases",path:"releases/:releaseId/workloads/:workloadSummaryId",noMpEvent:!0,gaName:"ReleasesPage",component:Hu}),o.a.createElement(u.a,{name:"releases",path:"releases/:releaseId/workloads/:workloadSummaryId/:selectedTabId",noMpEvent:!0,gaName:"ReleasesPage",component:Hu}),o.a.createElement(u.a,{name:"services",path:"services",gaName:"Flux",mpEvent:"flux.page.view",component:Ti}),o.a.createElement(u.a,{name:"services",path:"services/compare/:containerImageSource",gaName:"Flux",mpEvent:"flux.page.view",component:Ti}),o.a.createElement(u.a,{name:"service-details",path:"services/:workloadId",gaName:"Flux",mpEvent:"flux.page.view",component:Ti}),o.a.createElement(u.a,{name:"history",path:"history",gaName:"Flux",mpEvent:"flux.page.view",component:Oe}),o.a.createElement(u.a,{name:"finish-setup",path:"finish-setup",gaName:"FluxFinishSetup",mpEvent:"flux.finishsetup.view",component:_}),o.a.createElement(u.a,{name:"finish-setup/push-github-deploy-keys",path:"finish-setup/push-github-deploy-keys",gaName:"FluxFinishSetup",noMpEvent:!0,component:_}))]}}]);