(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{1213:function(e,t,n){"use strict";n.d(t,"c",function(){return k}),n.d(t,"b",function(){return _}),n.d(t,"a",function(){return j});var r=n(47),o=n.n(r),a=n(149),i=n.n(a),l=n(0),c=n.n(l),s=n(18),u=n.n(s),p=n(9),f=n(1);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function v(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(n,!0).forEach(function(t){w(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=16,C={"wc-stop":{svg:c.a.createElement("polygon",{points:"397.414486 202.259745 428.693916 233.377342 428.813072 278.039879 397.702153 310.084647 353.585514 310.740255 322.306084 279.622658 322.186928 234.960121 353.297847 202.915353"}),viewBox:"321 201 109 111"},"wc-stop-o":{svg:c.a.createElement("g",null,c.a.createElement("path",{d:"M397.414486,202.259745 L428.693916,233.377342 L428.813072,278.039879 L397.702153,310.084647 L353.585514,310.740255 L322.306084,279.622658 L322.186928,234.960121 L353.297847,202.915353 L397.414486,202.259745 Z M393.924588,210.897545 L420.222746,237.059642 L420.322926,274.609638 L394.166444,301.551253 L357.075412,302.102455 L330.777254,275.940358 L330.677074,238.390362 L356.833556,211.448747 L393.924588,210.897545 Z",fillRule:"evenodd"}),c.a.createElement("polygon",{fillRule:"evenodd",points:"390.267655 219.948772 411.346124 240.918187 411.42642 271.015216 390.461507 292.609429 360.732345 293.051228 339.653876 272.081813 339.57358 241.984784 360.538493 220.390571"})),viewBox:"321 201 109 111"}};function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e){if(i()(e,"wc-"))return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=C[e];if(n){var r=E({fill:u.a.colors.purple300,height:O,width:O},t);return c.a.createElement("svg",{style:r,viewBox:n.viewBox},n.svg)}}(e,t);var r=E({color:u.a.colors.purple300,fontSize:O},t);return c.a.createElement("i",g({style:r,className:e},n))}}var _=Object(f.default)(p.Text).withConfig({displayName:"flux-button__Label",componentId:"wwwnph-0"})(["line-height:28px;font-size:",";padding:0 12px;min-width:90px;"],function(e){return e.theme.fontSizes.small}),j=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return r=this,o=(e=h(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==m(o)&&"function"!=typeof o?y(r):o,w(y(n),"handleClick",function(e){var t=n.props.onClick;t&&t(n.props.value,e)}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(t,c.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.fa,n=e.title,r=e.svg,a=e.label,i=e.flat,l=e.primary,s=e.selected,f=e.style,m=o()(this.props,["fa","title","svg","flat","onClick","style"]),d=E({display:"inline-block",fontSize:u.a.fontSizes.small},i&&{backgroundColor:"transparent"},{},i&&!s&&{boxShadow:"none"},{},f),h=E({verticalAlign:"text-top"},l&&{color:"white"});return c.a.createElement(p.Button,g({title:n,style:d,onClick:this.handleClick},m),k(t||r,h)," ",c.a.createElement("span",null,a))}}])&&d(n.prototype,r),a&&d(n,a),t}()},1243:function(e,t,n){"use strict";var r=n(1),o=n(45),a=n(18),i=n.n(a),l=Object(r.keyframes)(["50%{opacity:1;}75%{opacity:0.4;}100%{opacity:1;}"]),c={background:i.a.colors.purple25,caretColor:i.a.colors.blue700,cellBorder:Object(o.transparentize)(.6,i.a.colors.gray200),currentTag:Object(o.transparentize)(.7,i.a.colors.yellow500),grayText:i.a.colors.gray600,highlight:i.a.colors.blue700,latestTag:Object(o.transparentize)(.7,i.a.colors.green500),loadingAnimation:Object(r.css)(["","2.5s infinite"],l),rowSelected:Object(o.transparentize)(.5,i.a.colors.purple100),unknownTag:i.a.colors.purple100};t.a=c},1293:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r=n(90),o=n.n(r),a=n(0),i=n.n(a);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=n(1).default.div.withConfig({displayName:"tooltip-wrapper__Tooltip",componentId:"sc-1khisxm-0"})(["background:",";border-radius:",";color:",";opacity:",";z-index:",";border:0;padding:8px;position:absolute;top:-33px;margin-left:-3px;transition:opacity 0.5s;white-space:nowrap;width:max-content;pointer-events:none;&:before{border-left:8px solid transparent;border-right:8px solid transparent;border-top:8px solid ",";content:'';display:block;height:0;left:4px;position:absolute;top:32px;width:0;}"],function(e){return e.theme.colors.purple800},function(e){return e.theme.borderRadius.soft},function(e){return e.theme.colors.white},function(e){return e.active?.75:0},function(e){return e.theme.layers.tooltip},function(e){return e.theme.colors.purple800}),d=function(e){function t(e,n){var r,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=s(t).call(this,e,n),r=!a||"object"!==l(a)&&"function"!=typeof a?u(o):a,f(u(r),"handleMouseEnter",function(){r.props.showOnHover&&r.setState({hovered:!0})}),f(u(r),"handleMouseLeave",function(){r.setState({hovered:!1})}),r.state={hovered:!1},r}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this,t=this.props,n=t.text,r=t.children,a=t.className,l=t.active,c=t.withComponent||"div";return i.a.createElement(c,{style:{display:"inline-block"},onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,className:a},o()(r)?r(this.state.hovered,n):i.a.createElement(i.a.Fragment,null,i.a.createElement(m,{ref:function(t){e.tooltip=t},text:n,className:"tooltip",active:this.state.hovered||l}),r))}}])&&c(n.prototype,r),a&&c(n,a),t}()},1315:function(e,t,n){var r=n(626),o=1,a=4;e.exports=function(e){return r(e,o|a)}},1379:function(e,t,n){"use strict";var r=n(32),o=n.n(r),a=n(0),i=n(5),l=n.n(i),c=n(22),s=n(302);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),f(this,m(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,a["Component"]),n=t,(r=[{key:"render",value:function(){var e,t=this.props,n=t.instances,r=t.instanceId,i=t.flags,l=t.substitute,c=t.children,u=t.inverted,p=t.teamId;if(e=r?n[r]:n[this.context.router.params.instanceId],o()(n)||!e&&!p)return null;var f=p?Object(s.e)(p,i,n):Object(s.c)(e,i);return(u?!f:f)?a.Children.only(c):l||null}}])&&p(n.prototype,r),i&&p(n,i),t}();h.contextTypes={router:l.a.object.isRequired},t.a=Object(c.connect)(function(e){return{instances:e.root.instances}})(h)},1397:function(e,t,n){"use strict";var r=n(47),o=n.n(r),a=n(0),i=n.n(a);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,p(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,i.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.el.indeterminate=this.props.indeterminate}},{key:"componentDidUpdate",value:function(e){e.indeterminate!==this.props.indeterminate&&(this.el.indeterminate=this.props.indeterminate)}},{key:"render",value:function(){var e=this;return i.a.createElement("input",c({},o()(this.props,"indeterminate"),{type:"checkbox",readOnly:!0,ref:function(t){e.el=t}}))}}])&&s(n.prototype,r),a&&s(n,a),t}();m.defaultProps={indeterminate:!1},t.a=m},1468:function(e,t,n){"use strict";var r=n(126),o=n.n(r),a=n(150),i=n.n(a),l=n(6),c=n.n(l),s=n(0),u=n.n(s),p=n(22),f=n(13),m=n.n(f),d=n(1),h=n(9),y=n(11),b=n(2),g=n(55),v=n(17),E=n(223),w=n(111),O=n(158),C=n(128),k=n(45),_=n(19),j=n.n(_),S=n(303),P=n(18),x=n.n(P);function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var A={container:{borderTop:"1px dotted ".concat(x.a.colors.purple100),color:x.a.colors.purple300,cursor:"pointer",fontSize:"90%",margin:"4px 4px 0 4px",padding:"6px 6px 0 0",textTransform:"uppercase"},icon:{color:x.a.colors.purple300,fontSize:"120%",position:"relative",top:1}},F=function(e){function t(){var e,n,r,o,a,i,l;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return r=this,o=(e=D(t)).call.apply(e,[this].concat(s)),n=!o||"object"!==I(o)&&"function"!=typeof o?T(r):o,a=T(n),l=function(e){e.preventDefault(),n.props.handleClick&&n.props.handleClick(),n.props.onClick&&n.props.onClick()},(i="handleClick")in a?Object.defineProperty(a,i,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[i]=l,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(t,u.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.collection,n=e.notShown,r=e.expanded,o=e.hideNumber,a=e.message,i=t&&(r||n>0),l=(void 0===a?"":a)||"+".concat(n),c=!o&&!r&&n>0?l:"",s=!r&&n>0?"fa fa-caret-down":"fa fa-caret-up";return i?u.a.createElement("div",{style:A.container,onClick:this.handleClick},c," ",u.a.createElement("span",{style:A.icon,className:s})):u.a.createElement("span",null)}}])&&N(n.prototype,r),o&&N(n,o),t}(),M=Object(p.connect)()(F),K=n(1243),B=n(418),W=n.n(B),U=n(1213),z=n(1315),H=n.n(z),G=n(309),L=n.n(G),q=n(47),V=n.n(q);function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Q(){return(Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $(e){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function X(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z(e,t){return(Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var te=d.default.label.withConfig({displayName:"flux-forms__Label",componentId:"sc-20qwr2-0"})(["display:block;"]),ne=(d.default.label.withConfig({displayName:"flux-forms__LabelInline",componentId:"sc-20qwr2-1"})(["display:inline-block;"]),d.default.div.withConfig({displayName:"flux-forms__Field",componentId:"sc-20qwr2-2"})(["display:inline-block;"])),re=(d.default.div.withConfig({displayName:"flux-forms__FormLine",componentId:"sc-20qwr2-3"})(["margin:8px 0;"]),d.default.span.withConfig({displayName:"flux-forms__Note",componentId:"sc-20qwr2-4"})(["opacity:0.5;font-style:italic;"])),oe=d.default.input.withConfig({displayName:"flux-forms__FormInput",componentId:"sc-20qwr2-5"})(["margin:2px 0 2px 0;padding:6px;font-size:",";border:1px solid ",";"],function(e){return e.theme.fontSizes.small},function(e){return e.theme.colors.gray50}),ae=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return r=this,o=(e=$(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Y(o)&&"function"!=typeof o?X(r):o,ee(X(n),"handleInputChange",function(e){var t=e.target.value,r=n.props,o=r.path;(0,r.onChange)(function(e){return L()(H()(e),o,t)})}),ee(X(n),"handleBlur",function(e){n.props.onBlur&&n.props.onBlur(e,n.props.path)}),ee(X(n),"handleFocus",function(e){n.props.onFocus&&n.props.onFocus(e,n.props.path)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Z(e,t)}(t,u.a.Component),n=t,(r=[{key:"render",value:function(){var e=V()(this.props,["value","onChange","className","state","path","onFocus","onBlur"]),t=this.props,n=t.path,r=t.state,o=t.className,a=c()(r,n)||"",i="".concat(o);return u.a.createElement(oe,Q({className:i,onChange:this.handleInputChange,onFocus:this.handleFocus,onBlur:this.handleBlur,value:a},e))}}])&&J(n.prototype,r),o&&J(n,o),t}();function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function le(){return(le=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function se(e){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pe(e,t){return(pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fe(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(n,!0).forEach(function(t){de(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function de(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var he=d.default.form.withConfig({displayName:"flux-setup-git-form__GitConfigWrapper",componentId:"sc-12ye55g-0"})(["display:flex;flex-direction:column;align-items:center;"]),ye=Object(d.default)(oe).withConfig({displayName:"flux-setup-git-form__GitConfigInput",componentId:"sc-12ye55g-1"})(["width:100%;height:30px;margin-bottom:24px;"]),be=d.default.div.withConfig({displayName:"flux-setup-git-form__InlineContainer",componentId:"sc-12ye55g-2"})(["display:inline-block;"]),ge=Object(d.default)(ae).withConfig({displayName:"flux-setup-git-form__GitFluxFormField",componentId:"sc-12ye55g-3"})(["width:300px;"]),ve=function(e){if(!e)return{branch:"",path:"",url:""};var t=W()(e);e&&0===t.protocols.length&&(t=W()("https://".concat(e)));var n=t.user.includes(":")&&t.protocol.startsWith("http")?t.protocol:"ssh";return{branch:t.ref,path:t.filepath,url:W.a.stringify(me({},t,{git_suffix:!1}),n)}},Ee=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=se(t).call(this,e),n=!o||"object"!==ie(o)&&"function"!=typeof o?ue(r):o,de(ue(n),"onGitURLChange",function(e){n.setState({gitURL:e.currentTarget.value})}),de(ue(n),"handleContinue",function(e){e.preventDefault();var t=n.state.gitURL,r=ve(t),o=r.url,a=r.path,i=r.branch;n.props.onChange(function(e){return me({},e,{git:me({},e.git,{branch:i,path:a,url:o})})})}),n.state={gitURL:""},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pe(e,t)}(t,u.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props;return e.state.git.url||e.state.git.path?u.a.createElement(be,null,u.a.createElement(ne,null,u.a.createElement(te,{htmlFor:"git.URL"},"SSH URL"),u.a.createElement(ge,le({id:"git.URL",path:["git","url"]},e))),u.a.createElement("span",null," / "),u.a.createElement(ne,null,u.a.createElement(te,{htmlFor:"git.path"},"Path to YAML files ",u.a.createElement(re,null,"optional")),u.a.createElement(ae,le({id:"git.path",path:["git","path"]},e))),u.a.createElement("span",null," : "),u.a.createElement(ne,null,u.a.createElement(te,{htmlFor:"git.branch"},"Branch ",u.a.createElement(re,null,"optional")),u.a.createElement(ae,le({id:"git.branch",path:["git","branch"],placeholder:"master"},e)))):u.a.createElement(he,{onSubmit:this.handleContinue},u.a.createElement(ye,{id:"git.URL",autoFocus:e.focus,onChange:this.onGitURLChange,placeholder:"Paste any GitHub, GitLab, BitBucket or Git SSH URL here",value:this.state.gitURL}),u.a.createElement(U.a,{primary:!0,label:"Continue"}))}}])&&ce(n.prototype,r),o&&ce(n,o),t}(),we=d.default.div.withConfig({displayName:"flux-setup-key__Container",componentId:"vkfzmk-0"})(["display:flex;flex-direction:row;margin-left:12px;"]),Oe=d.default.div.withConfig({displayName:"flux-setup-key__Views",componentId:"vkfzmk-1"})(["flex:1;min-width:0;"]),Ce=d.default.div.withConfig({displayName:"flux-setup-key__KeyView",componentId:"vkfzmk-2"})(["margin-bottom:12px;display:flex;"]),ke=d.default.div.withConfig({displayName:"flux-setup-key__Label",componentId:"vkfzmk-3"})(["color:",";width:140px;margin-right:12px;text-transform:uppercase;font-family:",";font-size:",";line-height:19px;vertical-align:top;opacity:1;"],function(e){return e.theme.colors.purple600},function(e){return e.theme.fontFamilies.regular},function(e){return e.theme.fontSizes.small}),_e=Object(d.default)(ke).withConfig({displayName:"flux-setup-key__MainLabel",componentId:"vkfzmk-4"})(["opacity:0.7;width:100px;text-align:left;"]),je=d.default.div.withConfig({displayName:"flux-setup-key__Value",componentId:"vkfzmk-5"})(["font-family:",";font-size:",";line-height:19px;white-space:normal;word-wrap:break-word;flex:1;min-width:0;"],function(e){return e.theme.fontFamilies.monospace},function(e){return e.theme.fontSizes.small});function Se(e){var t=e.config,n=c()(t,["key"],""),r=c()(t,["fingerprints","md5","hash"],""),o=c()(t,["fingerprints","sha256","hash"],"");return u.a.createElement("div",null,u.a.createElement(we,null,u.a.createElement(_e,null,"Public deploy key"),u.a.createElement(Oe,null,u.a.createElement(Ce,null,u.a.createElement(ke,null,"MD5 fingerprint"),u.a.createElement(je,null,r||"No key present")),u.a.createElement(Ce,null,u.a.createElement(ke,null,"SHA-256 fingerprint"),u.a.createElement(je,null,o||"No key present")),u.a.createElement(Ce,null,u.a.createElement(ke,null,"Full key"),u.a.createElement(je,null,n||"No key present")))))}var Pe=n(5),xe=n.n(Pe),Ie=n(8),Ne=n(3),De=n(7);function Te(e){return(Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ae(e){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Me(e,t){return(Me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ke(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function Be(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function We(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Ue="/push-github-deploy-keys";function ze(){return window.location.pathname.endsWith(Ue)}function He(e){var t=We(e.find(function(e){return"github"===e.id}).link.href.split("?"),2),n=t[0],r=t[1],o=Object(Ne.e)(r),a=Object(Ne.m)({next:"".concat(window.location.pathname).concat(Ue)}),i=Object(Ne.m)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(n,!0).forEach(function(t){Be(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},o,{redirect_uri:"".concat(o.redirect_uri,"?").concat(a)}),["scope"]);return"".concat(n,"?").concat(i)}var Ge=Object(d.default)(U.a).withConfig({displayName:"flux-setup-push-github-key__InlineFluxButton",componentId:"sc-12apm3k-0"})(["min-width:0;height:26px;padding:0 8px;margin:4px 0;"]),Le=Object(d.default)(h.Alert).withConfig({displayName:"flux-setup-push-github-key__ErrorMessage",componentId:"sc-12apm3k-1"})(["h3{color:",";}p{margin-left:12px;}"],function(e){return e.theme.colors.white}),qe=Object(d.default)(U.a).withConfig({displayName:"flux-setup-push-github-key__ManualInstructionsButton",componentId:"sc-12apm3k-2"})(["color:",";"],function(e){return e.theme.colors.purple400}),Ve=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Ae(t).call(this,e),n=!o||"object"!==Te(o)&&"function"!=typeof o?Fe(r):o,Be(Fe(n),"handleClickPushKeys",function(){n.pushGithubKeys(n.props)}),Be(Fe(n),"handleClickOpenGithubDeployKeys",function(){Object(De.trackEvent)("flux.config.deploykeys.view");var e=n.props,t=e.owner,r=e.repo;Object(v.s)("https://github.com/".concat(t,"/").concat(r,"/settings/keys"))}),Be(Fe(n),"handlePushKeysSuccess",function(){n.handleFinishPushingKeys(),n.props.onSuccess&&n.props.onSuccess(n.props.instanceId)}),Be(Fe(n),"handlePushKeysError",function(e){var t=e.status,r=e.errors;401===t?(Object(De.trackEvent)("flux.config.deploykeys.auth"),Ie.M().then(function(e){var t=He(e.logins);n.props.onBeforeOauthRedirect&&n.props.onBeforeOauthRedirect(),window.location=t})):(n.handleFinishPushingKeys(r),n.props.onError&&n.props.onError(r))}),n.state={showingPushingKeysOverlay:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Me(e,t)}(t,u.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){ze()&&this.props.config&&this.pushGithubKeys(this.props,!0)}},{key:"componentWillReceiveProps",value:function(e){!this.props.config&&e.config&&ze()&&this.pushGithubKeys(e,!0)}},{key:"pushGithubKeys",value:function(e){var t=e.owner,n=e.repo,r=e.instanceId,o=e.instanceName,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(De.trackEvent)("flux.config.deploykeys.push",{redirectedToGitHub:a}),this.setState({showingPushingKeysOverlay:!0}),Ie.eb(r,t,n,o).then(this.handlePushKeysSuccess,this.handlePushKeysError)}},{key:"handleFinishPushingKeys",value:function(e){if(Object(De.trackEvent)("flux.config.deploykeys.finishpush",{success:!e}),this.setState({showingPushingKeysOverlay:!1}),ze()){var t=window.location.pathname.replace(Ue,"");m.a.replace(t)}}},{key:"renderDialog",value:function(){var e=this.props,t=e.owner,n=e.repo;return u.a.createElement(h.Dialog,{active:this.state.showingPushingKeysOverlay},u.a.createElement("div",null,u.a.createElement("h2",{style:{marginTop:0}},u.a.createElement(h.CircularProgress,{inline:!0})," ",u.a.createElement("span",{style:{verticalAlign:"middle"}},"Pushing GitHub deploy keys...")),u.a.createElement("p",null,"To repository: ",t,"/",n)))}},{key:"render",value:function(){var e=this.props,t=e.owner,n=e.repo,r=e.pushedKeysError,o=e.pushedKeysSuccess,a=e.onClickShowManualInstructions,i=e.showManualInstructions;return u.a.createElement("div",null,u.a.createElement("div",{className:"form-line"},u.a.createElement("div",{className:"form-el"},u.a.createElement(U.a,{primary:!0,label:"Push key to GitHub",onClick:this.handleClickPushKeys})," ",u.a.createElement(U.a,{label:"View ".concat(t,"/").concat(n," GitHub keys"),onClick:this.handleClickOpenGithubDeployKeys}),u.a.createElement(qe,{flat:!0,label:"".concat(i?"Hide":"Show"," manual instructions"),onClick:a}),o&&u.a.createElement(h.Alert,{type:"success"},"Successfully pushed keys"),r&&u.a.createElement(u.a.Fragment,null,u.a.createElement(Le,{type:"warning"},u.a.createElement("h3",null,"Error pushing keys"),r.map(function(e){return u.a.createElement("p",{key:e.message},e.message)})),u.a.createElement("p",null,"If you continue to receive this error try manually adding the key."," ")),i&&u.a.createElement("p",null,u.a.createElement(Ge,{label:"Open ".concat(t,"/").concat(n," GitHub keys"),onClick:this.handleClickOpenGithubDeployKeys})," ","and click ",u.a.createElement("b",null,"Add deploy key"),". Provide the FULL KEY below and make sure to ",u.a.createElement("b",null,"Allow write access"),"."))),this.renderDialog())}}])&&Re(n.prototype,r),o&&Re(n,o),t}();Ve.contextTypes={router:xe.a.object.isRequired};var Ye=Ve;function Qe(e){return(Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $e(e,t){return!t||"object"!==Qe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xe(e){return(Xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ze(e,t){return(Ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var et=d.default.div.withConfig({displayName:"flux-setup-git-permissions__DeployKey",componentId:"sc-1790qg9-0"})(["margin:8px;"]),tt=d.default.span.withConfig({displayName:"flux-setup-git-permissions__RepoUrl",componentId:"sc-1790qg9-1"})(["opacity:0.7;"]),nt=function(e){var t=e.url,n=e.deployKey;return u.a.createElement("div",null,u.a.createElement("p",null,"Please enable read / write access on the git repository at"," ",u.a.createElement(tt,null,t)," for the following key:"),u.a.createElement(et,null,u.a.createElement(je,null,n||"No key present")),u.a.createElement("p",null,"This step requires copying the above key and saving it somewhere in the configuration of your git repository. You many need to check the documentation for your git repository provider or contact your git repository administrator. When enabled please click the button below to proceed."))},rt=function(e){var t=e.owner,n=e.repo,r=e.deployKey;return u.a.createElement("div",null,u.a.createElement("p",null,"Add the following key to a"," ",u.a.createElement("a",{href:"https://bitbucket.org/".concat(t,"/").concat(n,"/admin/access"),target:"bitbucket.org"},"Bitbucket user that has access to ",t,"/",n,"."," "),"On Bitbucket navigate to:"," ",u.a.createElement("em",null,"User ",">"," Settings ",">"," SSH Keys ",">"," Add key.")),u.a.createElement(et,null,u.a.createElement(Ce,null,u.a.createElement(ke,null,"Label"),u.a.createElement(je,null,"Flux deploy key")),u.a.createElement(Ce,null,u.a.createElement(ke,null,"Key"),u.a.createElement(je,null,r||"No key present"))))},ot=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),$e(this,Xe(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ze(e,t)}(t,u.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.instanceId,n=e.instanceName,r=e.config,o=e.onBeforeOauthRedirect,a=e.onSuccess,i=e.onError,l=e.closeOnSuccess,s=e.onClickUserSaysTheyPushedKeys,p=e.pushedKeysError,f=e.pushedKeysSuccess,m=e.onClickShowManualInstructions,d=e.showManualInstructions,h=c()(r,["url"],""),y=c()(r,["key"],""),b=Object(C.o)(h),g=b.owner,v=b.repo;return h?Object(C.l)(r)?u.a.createElement(Ye,{closeOnSuccess:l,owner:g,repo:v,instanceId:t,instanceName:n,config:r,pushedKeysSuccess:f,pushedKeysError:p,onClickShowManualInstructions:m,onBeforeOauthRedirect:o,onSuccess:a,onError:i,showManualInstructions:d,onClickUserSaysTheyPushedKeys:s}):Object(C.k)(r)?u.a.createElement(rt,{owner:g,repo:v,deployKey:y}):u.a.createElement(nt,{deployKey:y,url:h}):u.a.createElement("p",null,"First configure the config repository above.")}}])&&Je(n.prototype,r),o&&Je(n,o),t}(),at=n(1316);var it=d.default.div.withConfig({displayName:"flux-setup-steps__AgentStatus",componentId:"sc-1dim8a0-0"})(["display:",";border-radius:",";padding:13px;margin:",";background-color:",";color:",";a{color:",";}"],function(e){return e.inline?"inline-block":"block"},function(e){return e.theme.borderRadius.soft},function(e){return e.inline?"0 0 18px 0":"8px 0"},function(e){var t=e.state,n=e.theme;return{disconnected:n.colors.blue600,error:n.colors.yellow500,starting:n.colors.blue600,success:n.colors.green500}[t]},function(e){return e.theme.colors.white},function(e){return Object(k.transparentize)(.2,e.theme.colors.white)}),lt=d.default.span.withConfig({displayName:"flux-setup-steps__AgentStatusHeader",componentId:"sc-1dim8a0-1"})(["font-weight:bold;display:block;font-size:",";margin-bottom:8px;",""],function(e){return e.theme.fontSizes.normal},function(e){return e.pulse&&Object(d.css)(["animation:",";"],K.a.loadingAnimation)}),ct=d.default.div.withConfig({displayName:"flux-setup-steps__SettingsPage",componentId:"sc-1dim8a0-2"})(["font-size:",";"],function(e){return e.theme.fontSizes.small});function st(e){var t=e.done,n=e.current,r=e.warning,o=e.theme;return t?o.colors.green500:n?o.colors.blue400:r?o.colors.yellow500:o.colors.purple400}var ut=Object(d.keyframes)(["0%{box-shadow:0 0 0 0 ",";}70%{box-shadow:0 0 0 20px ",";}100%{box-shadow:0 0 0 20px transparent;}"],function(e){return e.theme.colors.blue400},function(e){return e.theme.colors.blue400}),pt=d.default.div.withConfig({displayName:"flux-setup-steps__Section",componentId:"sc-1dim8a0-3"})(["margin:48px 0;transition:opacity 0.5s;opacity:",";"],function(e){var t=e.done,n=e.current,r=e.warning;return t||n||r?1:.5}),ft=d.default.div.withConfig({displayName:"flux-setup-steps__Icon",componentId:"sc-1dim8a0-4"})(["border-radius:",";display:inline-block;width:1.8em;font-size:",";line-height:1.8em;box-shadow:0 0 0 ",";transition:color 0.5s;background-color:",";color:",";text-align:center;margin-right:4px;",";"],function(e){return e.theme.borderRadius.circle},function(e){return e.theme.fontSizes.normal},st,st,function(e){return e.theme.colors.white},function(e){var t=e.current,n=e.warning;return(t||n)&&Object(d.css)(["animation:"," 2s infinite;"],ut)}),mt=d.default.h3.withConfig({displayName:"flux-setup-steps__SectionHeader",componentId:"sc-1dim8a0-5"})(["margin-left:-38px;margin-bottom:-4px;color:",";"],function(e){return e.theme.colors.purple900}),dt=d.default.div.withConfig({displayName:"flux-setup-steps__SectionDescription",componentId:"sc-1dim8a0-6"})(["margin:0 0 24px 0;"]),ht=d.default.p.withConfig({displayName:"flux-setup-steps__CodeInstructions",componentId:"sc-1dim8a0-7"})(["margin:24px 0 4px 0;"]),yt=d.default.div.withConfig({displayName:"flux-setup-steps__SubSection",componentId:"sc-1dim8a0-8"})(["margin-bottom:14px;"]),bt=function(e){var t=e.errors;return u.a.createElement(it,{state:"error"},u.a.createElement(lt,null,u.a.createElement("i",{className:"fa fa-exclamation-triangle fa-fw"})," Configuration status"),t)},gt=function(e){var t=e.instanceId;return u.a.createElement(it,{state:"error"},u.a.createElement(lt,{pulse:!0},u.a.createElement("i",{className:"fa fa-exclamation-triangle fa-fw"})," Waiting for agent to connect..."),"Weave Deploy Agent is not connected. This might be temporary and we","'","ll continue checking, but if this persists try reconnecting the Agent by following the instruction on the"," ",u.a.createElement(j.a,{to:Object(y.E)(t)},"Install page"),"."," ")},vt=function(){return u.a.createElement(it,{state:"disconnected"},u.a.createElement(lt,{pulse:!0},u.a.createElement("i",{className:"fa fa-exclamation-triangle fa-fw"})," Waiting for agent to reconnect..."),"It does a little restart during re-configuration. This can take up to 30 seconds.")},Et=function(){return u.a.createElement(it,{state:"starting"},u.a.createElement(lt,{pulse:!0},u.a.createElement("i",{className:"fa fa-check-circle fa-fw"})," Agent reconnected"),"Starting up, just a second...")},wt=function(e){var t=e.onClickViewResources;return u.a.createElement(it,{state:"success"},u.a.createElement(lt,null,u.a.createElement("i",{className:"fa fa-check-circle fa-fw"})," Agent configured"),u.a.createElement("div",null,"You are ready to deploy."),u.a.createElement(U.a,{onClick:t,style:{marginTop:8},label:"View resources"}))};function Ot(e){var t=e.config,n=e.fluxdState,r=e.focusedField,o=e.hasGithubRepo,a=e.hasRepo,i=e.instanceId,l=e.instanceName,s=e.localConfig,p=e.localErrors,f=e.probeToken,m=e.progress,d=e.seenAConnectedFlux,h=e.showFullKey,y=e.showManualInstructions,b=e.startingUp,g=e.pushedKeys,v=e.pushedKeysError,E=e.pushedKeysSuccess,w=e.handleClickToggleKey,O=e.handleClickViewResources,C=e.handleClickShowManualInstructions,k=e.handlePushedKeys,_=e.handlePushedKeysError,j=e.handleBeforeOauthRedirect,P=e.handleRepoChange,x=e.handleRepoFieldBlur,I=e.handleRepoFieldFocus,N=e.handleUserSaysTheyPushedKeys,D=c()(t,["errors",0,"message"]),T=Boolean(g===s.git.url||o&&!y);return u.a.createElement(ct,null,!d&&u.a.createElement(gt,{instanceId:i}),d&&"not-connected"===n&&u.a.createElement(vt,null),b&&u.a.createElement(Et,null),a&&D&&!p&&!b&&u.a.createElement(bt,{errors:D}),p&&!b&&u.a.createElement(bt,{errors:p}),"configured"===n&&u.a.createElement(wt,{onClickViewResources:O}),m.repo&&u.a.createElement(pt,m.repo,u.a.createElement(mt,null,u.a.createElement(ft,m.repo,"1")," Config repository"," ",u.a.createElement(re,null,"where your Kubernetes YAMLs are")),u.a.createElement(dt,null,"When a new image is deployed, ",u.a.createElement("em",null,"Weave Cloud Deploy")," will update the YAML files in your repository"),u.a.createElement(Ee,{focus:!a,instanceId:i,state:s,onChange:P,onBlur:x,onFocus:I})),(m.writePermission||m.apply)&&u.a.createElement(pt,m.writePermission,u.a.createElement(mt,null,u.a.createElement(ft,m.writePermission,"2")," Config repository read/write permission"),u.a.createElement(dt,null,u.a.createElement("em",null,"Weave Cloud Deploy")," requires write access to the config repository. Deploy keys are used to grant this permission."),u.a.createElement(yt,null,u.a.createElement(ot,{instanceId:i,config:s.git,pushedKeysError:v,pushedKeysSuccess:E,showManualInstructions:y,onSuccess:k,onClickShowManualInstructions:C,onError:_,onBeforeOauthRedirect:j,instanceName:l})),u.a.createElement(yt,null,h&&u.a.createElement(Se,{instanceId:i,config:s.git}),!y&&u.a.createElement(M,{collection:[1],notShown:1,message:"Show deploy key details",expanded:h,onClick:w})),!T&&u.a.createElement(U.a,{primary:!0,label:"Read/write access for this deploy key has been enabled",onClick:N})),m.apply&&u.a.createElement(pt,m.apply,u.a.createElement(mt,null,u.a.createElement(ft,m.apply,"3")," Update cluster"),u.a.createElement(dt,null,u.a.createElement(ht,null,"To ",u.a.createElement("b",null,"save")," the above changes to the config repository, apply it to your cluster:")),u.a.createElement(S.a,null,u.a.createElement(at.a,{instanceId:i,key:"flux-apply-kubectl-command",token:f,focused:r,config:s.git,prevConfig:t.git}))))}function Ct(e){return(Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kt(){return(kt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function _t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jt(e){return(jt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function St(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pt(e,t){return(Pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var It=3e4,Nt=["new","cloned"],Dt=function(e){return["connected","configured"].includes(e)},Tt=d.default.div.withConfig({displayName:"flux-setup-steps-container__ExampleRepo",componentId:"sc-1dte1aw-0"})(["font-family:",";"],function(e){return e.theme.fontFamilies.monospace}),Rt=function(e){var t=e.repoUrl,n=Object(C.o)(t),r=n.host,o=n.owner,a=n.repo,i="github.com"===r&&o&&a?"git@github.com:".concat(o,"/").concat(a):"git@github.com:user/repo-name";return u.a.createElement("div",null,"Weave Cloud Deploy does not support authentication on GitHub over"," ",u.a.createElement("em",null,"http(s)"),". Please change the URL to one that supports SSH. E.g."," ",u.a.createElement(Tt,null,i))},At=d.default.div.withConfig({displayName:"flux-setup-steps-container__LoadingContainer",componentId:"sc-1dte1aw-1"})(["margin:100px auto;width:500px;text-align:center;"]);function Ft(e,t){return!Object(v.q)(e,t,"git.url","git.path","git.branch")}function Mt(e){return"".concat(e,".fluxsetup.git")}function Kt(e,t){Object(g.storageSetObject)(Mt(e),o()(t,"url","path","branch"),window.sessionStorage)}var Bt=function(e){function t(e){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=jt(t).call(this,e),n=!o||"object"!==Ct(o)&&"function"!=typeof o?St(r):o,xt(St(n),"setStartingUp",function(){n.setState({startingUp:!0}),n.startingUpTimeout=setTimeout(function(){n.setState({startingUp:!1})},It)}),xt(St(n),"clearStartingUp",function(){n.setState({startingUp:!1}),clearTimeout(n.startingUpTimeout)}),xt(St(n),"handleClickToggleKey",function(){n.setState({showFullKey:!n.state.showFullKey})}),xt(St(n),"handleRepoChange",function(e){n.setState(function(t){return{localConfig:e(t.localConfig)}})}),xt(St(n),"handleRepoFieldBlur",function(){n.setState({focusedField:null})}),xt(St(n),"handleRepoFieldFocus",function(e,t){n.setState({focusedField:c()(t,[1])})}),xt(St(n),"handleBeforeOauthRedirect",function(){Kt(n.props.instanceId,n.state.localConfig.git)}),xt(St(n),"handlePushedKeys",function(){n.setState({pushedKeys:c()(n.state.localConfig,["git","url"],""),pushedKeysSuccess:!0,showFullKey:!1,showManualInstructions:!1})}),xt(St(n),"handlePushedKeysError",function(e){n.setState({pushedKeysError:e,showFullKey:!0,showManualInstructions:!0})}),xt(St(n),"handleUserSaysTheyPushedKeys",function(){n.setState({pushedKeys:c()(n.state.localConfig,["git","url"],""),pushedKeysError:null,pushedKeysSuccess:null,showFullKey:!1,showManualInstructions:!1})}),xt(St(n),"handleClickShowManualInstructions",function(){var e=!n.state.showManualInstructions;n.setState({showFullKey:e,showManualInstructions:e})}),xt(St(n),"handleClickViewResources",function(){var e=n.props,t=e.sharedQueryParams,r=e.instanceId;m.a.push(Object(y.m)(t,r))});var a,l,s=(a=e.instanceId,l=Object(g.storageGetObject)(Mt(a),"",window.sessionStorage),Kt(a,{}),l?{git:l}:{});return n.state={focusedField:null,localConfig:i()({},e.config,s),pushedKeys:e.pushedKeys,pushedKeysError:null,pushedKeysSuccess:null,seenAConnectedFlux:Dt(e.fluxdState),sessionConfig:s,showFullKey:!1,showManualInstructions:!1,startingUp:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pt(e,t)}(t,u.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=this.props.instanceId;this.stopPollingFluxStatus=this.props.pollFluxStatus(e,2500),this.props.getInstanceData(e)}},{key:"componentWillUnmount",value:function(){this.stopPollingFluxStatus(),clearTimeout(this.startingUpTimeout)}},{key:"componentWillReceiveProps",value:function(e){var t=e.fluxdState,n=e.config,r=e.pushedKeys;Dt(t)&&this.setState({seenAConnectedFlux:!0});var o="not-connected"===t,a="configured"===t;"not-connected"===this.props.fluxdState&&"connected"===t&&Nt.includes(n.status)?this.setStartingUp():(o||a)&&this.clearStartingUp(),Ft(this.props.config,n)||this.setState({localConfig:i()({},n,this.state.sessionConfig),pushedKeys:r})}},{key:"render",value:function(){var e=this.props,t=e.probeToken,n=e.instanceId,r=e.instanceName,o=e.config,a=e.fluxdState,i=this.state,l=i.localConfig,s=i.focusedField,p=i.pushedKeys,f=i.seenAConnectedFlux,m=i.showFullKey,d=i.showManualInstructions,y=i.startingUp,b=i.pushedKeysError,g=i.pushedKeysSuccess,v=c()(o,["git","url"]),E=o.status&&Boolean("cloned"===o.status),w=c()(l,["git","url"]),O=Boolean((w||"").match(/^https?:\/\/github\.com/i)),k=O&&u.a.createElement(Rt,{repoUrl:w}),_=function(e,t,n,r,o,a,i,l){if("not-connected"===r||!0===o||!l)return{};if(i)return{repo:{warning:!0}};if("connected"===r&&Ft(e,t)){if(a)return{repo:{done:!0},writePermission:{warning:!0}};if(t.git.url)return{repo:{warning:!0},writePermission:{warning:!0}}}if("configured"===r){if(Ft(e,t))return{apply:{done:!0},repo:{done:!0},writePermission:{done:!0}};if(e.git.url===t.git.url&&(e.git.path!==t.git.path||e.git.branch!==t.git.branch))return{apply:{current:!0},repo:{done:!0}}}var s=c()(e,["git","url"]);return s?n!==s?{repo:{done:!0},writePermission:{current:!0}}:{apply:{current:!0},repo:{done:!0},writePermission:{done:!0}}:{repo:{current:!0}}}(l,o,p,a,y,E,O,f);if(!o.loaded)return u.a.createElement(At,null,u.a.createElement(h.CircularProgress,{inline:!0}),u.a.createElement("p",null,"Loading status..."));var j={config:o,fluxdState:a,focusedField:s,hasRepo:v,instanceId:n,instanceName:r,localConfig:l,localErrors:k,probeToken:t,progress:_,pushedKeys:p,pushedKeysError:b,pushedKeysSuccess:g,seenAConnectedFlux:f,showFullKey:m,showManualInstructions:d,startingUp:y};return u.a.createElement(Ot,kt({},j,{hasGithubRepo:Object(C.l)(l.git),handleClickToggleKey:this.handleClickToggleKey,handleClickViewResources:this.handleClickViewResources,handleClickShowManualInstructions:this.handleClickShowManualInstructions,handlePushedKeys:this.handlePushedKeys,handlePushedKeysError:this.handlePushedKeysError,handleBeforeOauthRedirect:this.handleBeforeOauthRedirect,handleRepoChange:this.handleRepoChange,handleRepoFieldBlur:this.handleRepoFieldBlur,handleRepoFieldFocus:this.handleRepoFieldFocus,handleUserSaysTheyPushedKeys:this.handleUserSaysTheyPushedKeys}))}}])&&_t(n.prototype,r),o&&_t(n,o),t}();t.a=Object(p.connect)(function(e,t){var n=t.params,r=e.root,o=n.instanceId,a=r.instances[o]||{},i=a.probeToken,l=a.name,s=Object(E.g)(e)[o]||{},u=Object(E.i)(e);return{config:s,fluxdState:u,instanceId:o,instanceName:l,probeToken:i,pushedKeys:"configured"===u&&c()(s,["git","url"]),sharedQueryParams:Object(w.b)(e)}},{getInstanceData:b.H,pollFluxStatus:b.mb})(Object(O.a)(Bt))},2375:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(192),i=n.n(a),l=n(20),c=n.n(l),s=n(31),u=n.n(s),p=n(297),f=n(22),m=n(2),d=n(300),h=n(9),y=n(75),b=n(1310),g=n(1),v=n(53),E=g.default.div.withConfig({displayName:"elements__Page",componentId:"kljwvs-0"})(["max-width:1280px;min-width:inherit;#zuora_payment iframe{width:100%;height:1000px;}.weave-dialog{&-window{max-height:80vh;overflow:auto;padding:16px;}&-content{overflow-y:auto;overflow-x:hidden;}}.weave-grid-row{.weave-grid-column:first-child{margin-left:0;}.weave-grid-column:last-child{margin-right:0;}.weave-paper{height:100%;& > div:first-child{padding:16px;}}}"]),w=g.default.h2.withConfig({displayName:"elements__H2",componentId:"kljwvs-1"})(["margin:0;"]),O=g.default.h2.withConfig({displayName:"elements__H3",componentId:"kljwvs-2"})(["font-size:",";margin-bottom:8px;"],Object(v.fontSize)("large")),C=g.default.a.withConfig({displayName:"elements__Link",componentId:"kljwvs-3"})(["text-decoration:underline;"]);function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var x=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),j(this,S(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props.instance.refuseDataAccess;return o.a.createElement(E,{className:"billing-page"},o.a.createElement(w,null,"Billing"),o.a.createElement("p",null,"You are billed through the Google Cloud Platform."),e&&o.a.createElement(b.a,{icon:"fa fa-exclamation-circle"},o.a.createElement("strong",null,"Your Google Cloud Platform subscription to Weave Cloud is disabled."),o.a.createElement("br",null),"To continue using Weave Cloud, please reactivate your subscription via Google Cloud Platform."),o.a.createElement("p",null,o.a.createElement(C,{target:"_blank",href:y.b,rel:"noopener"},o.a.createElement(h.Button,{primary:!0,text:e?"Reactivate subscription":"Go to Google Cloud Platform"}))))}}])&&_(n.prototype,r),a&&_(n,a),t}(),I=Object(f.connect)(function(e,t){var n=e.root,r=t.params;return{instance:n.instances[r.instanceId]}})(x),N=n(14),D=n.n(N),T=n(398),R=n.n(T),A=n(6),F=n.n(A),M=n(18),K=n.n(M),B=function(e,t){return"".concat(t).concat(e.toFixed(2))},W={EUR:{format:function(e,t){return"".concat(e.toFixed(2)).concat(t)},symbol:""},GBP:{format:B,symbol:""},USD:{format:B,symbol:"$"}};function U(e,t){return void 0===e?null:(e=parseFloat(e),Number.isNaN(e)?null:F()(W,"".concat(t,".format"),B)(e,function(e){return F()(W,"".concat(e,".symbol"),e)}(t)))}var z=n(7),H=n(1249),G=n(191),L=n(283),q=n(15),V=n.n(q),Y=n(16),Q=n(186),J=n.n(Q),$=n(185),X=n.n($),Z=n(44),ee=n(286),te=g.default.label.withConfig({displayName:"user-details-form__Label",componentId:"xi4nub-0"})(["width:30%;max-width:280px;"]),ne=g.default.div.withConfig({displayName:"user-details-form__FormItem",componentId:"xi4nub-1"})(["color:",";margin-bottom:10px;width:100%;display:flex;input,select{border-radius:",";border:1px solid ",";box-shadow:0px 1px 3px transparentize(",",0.9);font-family:",";font-size:",";height:28px;padding:2px;width:215px;}select{background-color:",";padding:0 2px;}"],Object(v.color)("purple400"),Object(v.borderRadius)("soft"),Object(v.color)("gray200"),Object(v.color)("black"),function(e){return e.theme.fontFamilies.regular},Object(v.fontSize)("normal"),Object(v.color)("white")),re=g.default.div.withConfig({displayName:"user-details-form__ValidationMessage",componentId:"xi4nub-2"})(["color:",";opacity:",";line-height:28px;margin-left:8px;"],Object(v.color)("orange500"),function(e){return e.active?"1":"0"}),oe=function(e){var t=e.onChange,n=e.messages,r=e.states,a=e.currencies,i=e.currencyOfSubscription;return o.a.createElement(Z.Form,{model:"forms.accountDetails",onChange:X()(t,500)},o.a.createElement("div",{className:"user-details-form"},o.a.createElement(ne,null,o.a.createElement(te,{htmlFor:"firstName"},"First name"),o.a.createElement(Z.Control.text,{model:"forms.accountDetails.firstName"}),o.a.createElement(re,{active:!!n.firstName},J()(n.firstName))),o.a.createElement(ne,null,o.a.createElement(te,{htmlFor:"lastName"},"Last name"),o.a.createElement(Z.Control.text,{model:"forms.accountDetails.lastName"}),o.a.createElement(re,{active:!!n.lastName},J()(n.lastName))),o.a.createElement(ne,null,o.a.createElement(te,{htmlFor:"workEmail"},"Email"),o.a.createElement(Z.Control.text,{model:"forms.accountDetails.workEmail"}),o.a.createElement(re,{active:!!n.workEmail},J()(n.workEmail))),o.a.createElement(ne,null,o.a.createElement(te,{htmlFor:"country"},"Country"),o.a.createElement(Z.Control.select,{model:"forms.accountDetails.country"},D()(ee.a,function(e,t){return o.a.createElement("option",{key:e,value:e},t)})),o.a.createElement(re,{active:!!n.country},J()(n.country))),r&&o.a.createElement(ne,null,o.a.createElement(te,{htmlFor:"state"},"State / Province"),o.a.createElement(Z.Control.select,{model:"forms.accountDetails.state"},r.map(function(e){return o.a.createElement("option",{key:e},e)})),o.a.createElement(re,{active:!!n.state},J()(n.state))),o.a.createElement(ne,null,o.a.createElement(te,{htmlFor:"address1"},"Address 1"),o.a.createElement(Z.Control.text,{model:"forms.accountDetails.address1"}),o.a.createElement(re,{active:!!n.address1},J()(n.address1))),o.a.createElement(ne,null,o.a.createElement(te,{htmlFor:"address2"},"Address 2"),o.a.createElement(Z.Control.text,{model:"forms.accountDetails.address2"}),o.a.createElement(re,{active:!!n.address2},J()(n.address2))),o.a.createElement(ne,null,o.a.createElement(te,{htmlFor:"city"},"City"),o.a.createElement(Z.Control.text,{model:"forms.accountDetails.city"}),o.a.createElement(re,{active:!!n.city},J()(n.city))),o.a.createElement(ne,null,o.a.createElement(te,{htmlFor:"zipCode"},"Postal code"),o.a.createElement(Z.Control.text,{model:"forms.accountDetails.zipCode"}),o.a.createElement(re,{active:!!n.zipCode},J()(n.zipCode))),o.a.createElement(ne,null,o.a.createElement(te,{htmlFor:"workPhone"},"Contact phone number"),o.a.createElement(Z.Control.text,{model:"forms.accountDetails.workPhone"}),o.a.createElement(re,{active:!!n.workPhone},J()(n.workPhone))),o.a.createElement(ne,null,o.a.createElement(te,{htmlFor:"currency"},"Currency:"),(i||1===a.length)&&o.a.createElement(Z.Control.text,{model:"forms.accountDetails.currency",disabled:!0}),!i&&1!==a.length&&o.a.createElement(Z.Control.select,{model:"forms.accountDetails.currency"},a.map(function(e){return o.a.createElement("option",{key:e},e)})),o.a.createElement(re,{active:!!n.currency},J()(n.currency)))))};function ae(e){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function le(e){return(le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function se(e,t){return(se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pe=function(e){return e&&V()(e).format("D MMM YYYY")},fe=g.default.div.withConfig({displayName:"payment-method__Container",componentId:"sc-126797v-0"})(["display:flex;padding:16px;.weave-dialog{padding-top:10vh;}"]),me=g.default.div.withConfig({displayName:"payment-method__BlockerWrapper",componentId:"sc-126797v-1"})(["position:relative;"]),de=g.default.div.withConfig({displayName:"payment-method__Blocker",componentId:"sc-126797v-2"})(["background-color:transparentize(",",0.2);position:absolute;display:none;left:0;top:0;right:0;bottom:0;",";"],Object(v.color)("white"),function(e){return e.active&&"\n    display: block;\n  "}),he=g.default.div.withConfig({displayName:"payment-method__PaymentMethodEmpty",componentId:"sc-126797v-3"})(["padding:16px;width:100%;line-height:36px;"]),ye=g.default.div.withConfig({displayName:"payment-method__PaymentMethodItem",componentId:"sc-126797v-4"})(["border:1px solid ",";padding:16px;width:100%;line-height:36px;"],Object(v.color)("gray600")),be=g.default.div.withConfig({displayName:"payment-method__Name",componentId:"sc-126797v-5"})(["display:inline-block;"]),ge=g.default.div.withConfig({displayName:"payment-method__Controls",componentId:"sc-126797v-6"})(["float:right;"]),ve=g.default.div.withConfig({displayName:"payment-method__UserDetailsContainer",componentId:"sc-126797v-7"})(["width:100%;margin:30px 0 30px 0;"]),Ee=g.default.div.withConfig({displayName:"payment-method__ScrollableContent",componentId:"sc-126797v-8"})(["max-height:600px;overflow-y:scroll;"]),we=g.default.div.withConfig({displayName:"payment-method__CreditCardWrapper",componentId:"sc-126797v-9"})(["display:",";"],function(e){return e.visible?"block":"none"}),Oe=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return r=this,o=(e=le(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==ae(o)&&"function"!=typeof o?ce(r):o,ue(ce(n),"handlePaymentEdit",function(){n.props.setCreditCardFormActive(!0)}),ue(ce(n),"handleDialogClose",function(){n.props.setCreditCardFormActive(!1)}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&se(e,t)}(t,o.a.Component),n=t,(r=[{key:"renderEmpty",value:function(){return o.a.createElement(he,null,o.a.createElement(be,null,"No payment method found"),o.a.createElement(ge,null,o.a.createElement(h.Button,{primary:!0,onClick:this.handlePaymentEdit,text:"Add"})))}},{key:"renderPaymentMethod",value:function(){var e=this.props.paymentMethod,t=e.cardType,n=e.cardNumber;return o.a.createElement(ye,null,o.a.createElement(be,null,t," ",n),o.a.createElement(ge,null,o.a.createElement(h.Button,{style:{marginLeft:16},onClick:this.handlePaymentEdit,text:"Edit"})))}},{key:"render",value:function(){var e=this.props,t=e.currencies,n=e.currency,r=e.currencyOfSubscription,a=e.paymentMethod,i=e.fetchingAccount,l=e.userDetailsFormIsValid,c=e.messages,s=e.states,u=e.interimUsage,p=e.interimStart,f=e.interimEnd,m="",d=F()(u,n,"0");if(u){var y="".concat(pe(p)," to ").concat(pe(f));m=o.a.createElement("div",null,o.a.createElement(O,null,"Total: $",d),o.a.createElement("div",{className:"blocker"},o.a.createElement("div",{className:"block-message"},"One off payment for post trial period ",y)))}return o.a.createElement(fe,null,i&&o.a.createElement(h.CircularProgress,{center:!0}),!i&&(a?this.renderPaymentMethod():this.renderEmpty()),o.a.createElement(we,{visible:this.props.creditCardFormActive},o.a.createElement(h.Dialog,{active:!0,onClose:this.handleDialogClose},o.a.createElement(Ee,null,o.a.createElement(O,null,"Billing contact details"),o.a.createElement(ve,{className:"details-form-container"},o.a.createElement(oe,{onChange:this.props.validateUserDetailsForm,messages:c,states:s,currencies:t,currencyOfSubscription:r})),m,o.a.createElement(O,null,"Credit card info"),o.a.createElement(me,null,o.a.createElement(de,{active:!l},o.a.createElement("div",{className:"block-message"},"Please complete Billing Contact Details section above before entering credit card details")),o.a.createElement("div",{id:"zuora_payment"}))))))}}])&&ie(n.prototype,r),a&&ie(n,a),t}(),Ce=function(e){return"USA"===e?Y.US_STATES:"CAN"===e?Y.CAN_PROVINCES:null};var ke=Object(f.connect)(function(e){var t=e.billing,n=e.root,r=e.forms,o=t.paymentMethod,a=t.creditCardFormActive,i=t.fetching,l=t.userDetailsFormMessages,c=t.userDetailsFormIsValid;return{creditCardFormActive:a,currencies:t.currencies,currency:t.currency,currencyOfSubscription:t.currencyOfSubscription,email:n.email,fetchingAccount:i.accountDetails,interimEnd:t.interimEnd,interimStart:t.interimStart,interimUsage:t.interimUsage,messages:l,paymentMethod:o,states:Ce(r.accountDetails.country),userDetailsFormIsValid:c}},{setCreditCardFormActive:m.Gb,validateUserDetailsForm:m.cc})(Oe),_e=g.default.table.withConfig({displayName:"invoice-table__Table",componentId:"wf2vty-0"})(["width:100%;text-align:left;td{font-size:",";}"],Object(v.fontSize)("small")),je=g.default.thead.withConfig({displayName:"invoice-table__TableHead",componentId:"wf2vty-1"})(["margin-bottom:8px;"]),Se=g.default.div.withConfig({displayName:"invoice-table__TableEmpty",componentId:"wf2vty-2"})(["padding:32px;"]);function Pe(e){var t=e.children;return 0===t.length?o.a.createElement(Se,null,"No invoices found"):o.a.createElement(_e,null,o.a.createElement(je,null,o.a.createElement("tr",null,o.a.createElement("th",null,"Invoice number"),o.a.createElement("th",null,"Invoice date"),o.a.createElement("th",null,"Amount"),o.a.createElement("th",null))),o.a.createElement("tbody",null,t))}function xe(e){return(xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ne(e){return(Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function De(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Te(e,t){return(Te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Re=function(e){function t(){var e,n,r,o,a,i,l;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return r=this,o=(e=Ne(t)).call.apply(e,[this].concat(s)),n=!o||"object"!==xe(o)&&"function"!=typeof o?De(r):o,a=De(n),l=function(){n.props.onClick(n.props.invoice.invoiceNumber)},(i="handleClick")in a?Object.defineProperty(a,i,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[i]=l,n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Te(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props.currency,t=this.props.invoice,n=t.invoiceNumber,r=t.amount,a=t.body,i=t.invoiceDate;return o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement(C,{title:"View ".concat(n),onClick:this.handleClick},n)),o.a.createElement("td",null,i),o.a.createElement("td",null,U(r,e)),o.a.createElement("td",null,a&&o.a.createElement(C,{href:a,target:"_blank"},"Download")))}}])&&Ie(n.prototype,r),a&&Ie(n,a),t}();function Ae(e){return(Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Me(e,t){return!t||"object"!==Ae(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Be(e,t){return(Be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var We=g.default.div.withConfig({displayName:"invoice__InvoiceContent",componentId:"sc-16zdpr8-0"})(["padding:8px;& > div,h2,h3{margin-bottom:8px;}"]),Ue=Object(g.default)(w).withConfig({displayName:"invoice__Title",componentId:"sc-16zdpr8-1"})(["display:inline-block;margin-right:32px;"]),ze=g.default.table.withConfig({displayName:"invoice__Table",componentId:"sc-16zdpr8-2"})(["text-align:left;font-size:",";border-spacing:0;width:100%;"],Object(v.fontSize)("small")),He=g.default.thead.withConfig({displayName:"invoice__TableHead",componentId:"sc-16zdpr8-3"})(["box-shadow:0 4px 2px -2px transparentize(",",0.84);border-bottom:1px solid ",";font-size:",";"],Object(v.color)("black"),Object(v.color)("gray600"),Object(v.fontSize)("tiny")),Ge=g.default.tr.withConfig({displayName:"invoice__TR",componentId:"sc-16zdpr8-4"})(["line-height:20px;&:nth-child(even){background-color:",";}"],Object(v.color)("purple100")),Le=g.default.th.withConfig({displayName:"invoice__TH",componentId:"sc-16zdpr8-5"})(["padding:3px 4px;text-transform:uppercase;color:",";"],Object(v.color)("purple400")),qe=g.default.td.withConfig({displayName:"invoice__TD",componentId:"sc-16zdpr8-6"})(["padding:3px 4px;text-overflow:ellipsis;"]),Ve=g.default.div.withConfig({displayName:"invoice__InvoiceInfo",componentId:"sc-16zdpr8-7"})(["max-width:55%;line-height:32px;"]),Ye=g.default.ul.withConfig({displayName:"invoice__InvoiceInfoList",componentId:"sc-16zdpr8-8"})(["padding-left:0;"]),Qe=g.default.span.withConfig({displayName:"invoice__InvoiceInfoValue",componentId:"sc-16zdpr8-9"})(["float:right;"]),Je={accountName:{label:"Account name"},accountNumber:{label:"Account number"},amount:{currencyFormat:U,label:"Amount"},balance:{currencyFormat:U,label:"Balance"},dueDate:{label:"Due date"},invoiceDate:{label:"Invoice date"},invoiceNumber:{label:"Invoice number"},invoiceTargetDate:{label:"Target date"}};function $e(){Object(z.trackEvent)("billing.invoice.download")}var Xe=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Me(this,Ke(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Be(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){Object(z.trackEvent)("billing.invoice.view")}},{key:"render",value:function(){var e=this.props,t=e.invoice,n=e.currency;return t?o.a.createElement(We,null,o.a.createElement(Ue,null,"Invoice #",t.invoiceNumber),t.body&&o.a.createElement(C,{onClick:$e,href:t.body,target:"_blank"},"Download"),o.a.createElement(Ve,null,o.a.createElement(Ye,null,D()(Je,function(e,r){var a=e.label,i=e.currencyFormat;return o.a.createElement("li",{key:r},a,":",o.a.createElement(Qe,null,i?i(t[r],n):t[r]))}))),o.a.createElement("div",{className:"invoice-items"},o.a.createElement(O,null,"Charge summary"),o.a.createElement(ze,null,o.a.createElement(He,null,o.a.createElement(Ge,null,o.a.createElement(Le,null,"Subscription"),o.a.createElement(Le,null,"Product"),o.a.createElement(Le,null,"Charge name"),o.a.createElement(Le,null,"Start date"),o.a.createElement(Le,null,"End date"),o.a.createElement(Le,null,"Amount"))),o.a.createElement("tbody",null,t.invoiceItems.map(function(e){return o.a.createElement(Ge,{key:e.subscriptionName},o.a.createElement(qe,null,e.subscriptionName),o.a.createElement(qe,null,e.productName),o.a.createElement(qe,null,e.chargeName),o.a.createElement(qe,null,e.workloadStartDate),o.a.createElement(qe,null,e.workloadEndDate),o.a.createElement(qe,null,U(e.chargeAmount,n)))}))))):null}}])&&Fe(n.prototype,r),a&&Fe(n,a),t}(),Ze=n(1293);function et(e){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nt(e,t){return!t||"object"!==et(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rt(e){return(rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ot(e,t){return(ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function at(e){var t="no usage";return e.usage>0&&(t=parseFloat(e.usage/3600).toFixed(2).replace(/\.?0+$/,""),t+=" host hours"),"".concat(t," (").concat(Object(H.b)(e.day),")")}var it=g.default.rect.withConfig({displayName:"usage-chart__Bar",componentId:"sc-1xogo69-0"})(["fill:",";&:hover{opacity:0.75;}"],function(e){return e.theme.colors.purple400}),lt=g.default.div.withConfig({displayName:"usage-chart__Chart",componentId:"sc-1xogo69-1"})(["position:relative;padding:0 1em;margin:2em 0 2em 0;svg{width:100%;overflow:visible;border:1px solid ",";}"],function(e){return e.theme.colors.gray600}),ct=g.default.span.withConfig({displayName:"usage-chart__AxisLabelY",componentId:"sc-1xogo69-2"})(["position:absolute;left:0;transform:rotate(-90deg);width:1em;display:inline-block;font-size:",";top:55px;"],function(e){return e.theme.fontSizes.small}),st=g.default.span.withConfig({displayName:"usage-chart__AxisLabelX",componentId:"sc-1xogo69-3"})(["display:block;text-align:center;font-size:",";"],function(e){return e.theme.fontSizes.small}),ut=g.default.line.withConfig({displayName:"usage-chart__Line",componentId:"sc-1xogo69-4"})(["stroke:",";"],function(e){return e.theme.colors.blue700}),pt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),nt(this,rt(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ot(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){for(var e=V()(this.props.start),t=V()(this.props.end),n=0,r=[],a=V()(e);a.isBefore(t);a.add(1,"days")){var i=a.format("YYYY-MM-DD"),l=this.props.usages[i]||0;0!==l&&r.push({day:i,usage:l}),n=Math.max(n,l)}var c="".concat(23*r.length);return o.a.createElement(lt,null,o.a.createElement("svg",{height:"100"},D()(r,function(e,t){return o.a.createElement(Ze.a,{withComponent:"g",key:e.day,text:at(e),showOnHover:!0},function(r,a){return o.a.createElement(o.a.Fragment,null,o.a.createElement("text",{y:"-10px",width:"20",style:{opacity:r?1:0},transform:"translate(".concat(24*t,", 0)")},a),o.a.createElement(it,{height:"".concat(e.usage/n*100,"%"),transform:"translate(".concat(24*t,", 0)"),y:"".concat(100-e.usage/n*100),width:"20",key:e.day}))})}),o.a.createElement(ut,{x1:c,x2:c,y1:"100",y2:"0"})),o.a.createElement(ct,null,"Usage"),o.a.createElement(st,null,"Day"))}}])&&tt(n.prototype,r),a&&tt(n,a),t}();function ft(e){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dt(e){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ht(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yt(e,t){return(yt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gt=g.default.div.withConfig({displayName:"page-zuora__InvoicesSection",componentId:"sc-10w77qy-0"})([".weave-dialog{padding-top:10vh;overflow:auto;&-content{overflow:auto;}}"]),vt=g.default.div.withConfig({displayName:"page-zuora__StatusWrapper",componentId:"sc-10w77qy-1"})(["display:flex;width:100%;"]),Et=g.default.div.withConfig({displayName:"page-zuora__DateRange",componentId:"sc-10w77qy-2"})(["margin-bottom:16px;"]),wt=g.default.div.withConfig({displayName:"page-zuora__InfoContent",componentId:"sc-10w77qy-3"})(["flex:1;text-align:center;"]),Ot=g.default.div.withConfig({displayName:"page-zuora__InfoContentValue",componentId:"sc-10w77qy-4"})(["font-size:",";color:",";"],Object(v.fontSize)("extraLarge"),function(e){return e.color}),Ct=g.default.div.withConfig({displayName:"page-zuora__InfoContentSubtext",componentId:"sc-10w77qy-5"})(["font-size:",";"],Object(v.fontSize)("large")),kt=g.default.i.withConfig({displayName:"page-zuora__Icon",componentId:"sc-10w77qy-6"})(["margin-right:8px;"]);function _t(){window.Intercom("showNewMessage","I have a query regarding my account.")}function jt(){window.Intercom("update",{"long-time-on-billing-page":1})}var St=function(e){function t(){var e,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=dt(t).call(this),e=!r||"object"!==ft(r)&&"function"!=typeof r?ht(n):r,bt(ht(e),"handlePaymentSubmit",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.props.submitCreditCard(n)}),bt(ht(e),"handleMessageClose",function(){e.props.setMessageDialogActive(!1),e.props.hpmError||e.props.setCreditCardFormActive(!1)}),bt(ht(e),"handleInvoiceToggle",function(t){e.setState(function(){return{activeInvoice:t||e.state.activeInvoice,invoicesDialogOpen:!e.state.invoicesDialogOpen}})}),bt(ht(e),"handleCurrencySelect",function(t,n){e.props.setPreferredCurrency(n)}),e.state={activeInvoice:null,invoicesDialogOpen:!1},e}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yt(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=this.props.params;Object(z.trackEvent)("billing.page.view",{accountExpired:0===this.props.trialRemaining&&!this.props.paymentMethod,paymentMethodExists:!R()(this.props.paymentMethod),trialRemaining:this.props.trialRemaining}),window.Intercom&&window.Intercom("update",{"long-time-on-billing-page":0}),this.intercomMsgTimeout=setTimeout(jt,6e4),this.props.getAccountDetails(e.instanceId),this.props.getInvoices(e.instanceId),this.props.getAccountStatus(e.instanceId)}},{key:"componentWillUnmount",value:function(){window.Intercom&&window.Intercom("update",{"long-time-on-billing-page":0}),clearTimeout(this.intercomMsgTimeout)}},{key:"renderAccountStatus",value:function(){var e,t,n,r,a=this.props,i=a.paymentStatus,l=a.trialLength,c=a.trialRemaining,s=a.trialStart,u=a.trialEnd,p=a.fetching.accountStatus,f=F()(i,"status",null);switch(f){case"trial":t="far fa-clock",n="Trial active",e="".concat(c," days remaining");break;case"trial_expired":t="far fa-credit-card",n="Trial expired",e="Please submit a payment method",r=K.a.colors.orange500;break;case"subscription_inactive":t="far fa-times-circle",n="Subscription inactive",e="Please contact support",r=K.a.colors.orange500;break;case"payment_error":t="far fa-times-circle",n="Payment error",e="".concat(i.description,"\n").concat(i.action),r=K.a.colors.orange500;break;case"active":t="far fa-check-circle",n="Active",e="Great job!",r=K.a.colors.green500;break;default:t="far fa-times-circle",n="Unknown status",e="Please contact support"}var m=o.a.createElement("span",null,""),d=o.a.createElement(h.CircularProgress,{center:!0});return!p&&f&&("trial"===f.substr(0,5)&&(m="Trial period: ",m+=0===l?"ended ".concat(Object(H.b)(u)):"".concat(Object(H.b)(s)," to ").concat(Object(H.b)(u))),d=o.a.createElement("div",null,o.a.createElement(Ot,{color:r},o.a.createElement(kt,{className:t}),n,o.a.createElement(Ct,null,e)))),o.a.createElement("div",null,o.a.createElement(O,null,"Account status"),o.a.createElement(Et,null,m),o.a.createElement(L.a,{style:{padding:"0"}},o.a.createElement(wt,null,d)))}},{key:"renderEstimatedMonthlyUsage",value:function(){var e=this.props,t=e.trialRemaining,n=e.estimatedMonthlyUsage,r=e.currency;return"0"===F()(n,r,"0")?null:o.a.createElement("span",{style:{float:"right"},title:"Estimation based on your usage during the past 7 days"},"Estimated monthly bill",0!==t&&" (after trial expiration)",": ~",U(n[r],r))}},{key:"renderInterimStatus",value:function(){var e=this.props,t=e.currency,n=e.interimUsage,r=e.interimStart,a=e.interimEnd,i=e.trialRemaining,l=e.paymentMethod,c=F()(n,t,"0");if(0!==i||l||"0"===c)return null;var s="Post trial period: ".concat(Object(H.b)(r)," to ").concat(Object(H.b)(a));return o.a.createElement(h.GridRow,null,o.a.createElement(h.GridColumn,{span:12},o.a.createElement(G.a,null,o.a.createElement("div",null,o.a.createElement(O,null,"Billable Usage: $",c),o.a.createElement(Et,null,s)))))}},{key:"render",value:function(){var e=this,t=this.props,n=t.invoices,r=t.fetching,a=t.trialRemaining,i=t.paymentMethod,l=t.usageToDate,c=t.currencies,s=t.currency,u=t.currencyOfSubscription,p=t.billingPeriodStart,f=t.billingPeriodEnd,m=t.usagePerDay,d=t.activeHosts,y=n.find(function(t){return t.invoiceNumber===e.state.activeInvoice});return o.a.createElement(E,{className:"billing-page"},o.a.createElement(w,null,"Billing"),o.a.createElement(h.Grid,null,!r.accountDetails&&0===a&&!i&&o.a.createElement(h.GridRow,null,o.a.createElement(h.Alert,{type:"warning"},"Your trial has ended. Please enter your payment details below.")),!u&&l&&o.a.createElement(h.GridRow,null,o.a.createElement(h.GridColumn,{span:12},o.a.createElement(G.a,null,o.a.createElement("div",null,o.a.createElement(O,null,"Currency:"),o.a.createElement(h.Dropdown,{className:"currency-dropdown",onChange:this.handleCurrencySelect,items:D()(c,function(e){return{label:e,value:e}}),value:s}))))),o.a.createElement(h.GridRow,null,o.a.createElement(h.GridColumn,{span:6},o.a.createElement(G.a,{height:"100%"},o.a.createElement("div",{style:{minHeight:"140px"}},o.a.createElement(O,null,"Current usage"),o.a.createElement(Et,null,r.accountStatus?o.a.createElement("span",null,""):"".concat(Object(H.b)(p)," to ").concat(Object(H.b)(f))),o.a.createElement(L.a,{style:{padding:"0"}},r.accountStatus&&o.a.createElement(h.CircularProgress,{center:!0}),!r.accountStatus&&o.a.createElement(vt,null,o.a.createElement(wt,null,o.a.createElement(Ot,null,d&&"~".concat(d.toFixed(1))||"0"),o.a.createElement(Ct,{title:"Calculated by looking at yesterday's total usage"},"Active nodes")),o.a.createElement(wt,null,o.a.createElement(Ot,null,l&&"".concat(U(l[s],s))),o.a.createElement(Ct,null,"Usage to date"))))))),o.a.createElement(h.GridColumn,{span:6},o.a.createElement(G.a,{height:"100%"},this.renderAccountStatus()))),o.a.createElement(h.GridRow,null,o.a.createElement(h.GridColumn,{span:12},o.a.createElement(G.a,null,o.a.createElement("div",{style:{paddingBottom:16}},o.a.createElement("div",null,o.a.createElement(O,{style:{display:"inline"}},"Usage history"),!r.accountStatus&&this.renderEstimatedMonthlyUsage()),r.accountStatus?o.a.createElement(h.CircularProgress,{center:!0}):o.a.createElement(pt,{usages:m,start:p,end:f}))))),this.renderInterimStatus(),o.a.createElement(h.GridRow,null,o.a.createElement(h.GridColumn,{span:12},o.a.createElement(G.a,null,o.a.createElement("div",null,o.a.createElement(O,null,"Payment method"),o.a.createElement(ke,null))))),o.a.createElement(h.GridRow,null,o.a.createElement(h.GridColumn,{span:12},o.a.createElement(G.a,null,o.a.createElement(gt,null,o.a.createElement(O,null,"Invoices"),r.invoices&&o.a.createElement(h.CircularProgress,{center:!0}),!r.invoices&&o.a.createElement(Pe,null,this.props.invoices.map(function(t){return o.a.createElement(Re,{onClick:e.handleInvoiceToggle,invoice:t,key:t.invoiceNumber,currency:s})})),o.a.createElement(h.Dialog,{active:this.state.invoicesDialogOpen,onClose:this.handleInvoiceToggle},o.a.createElement(Xe,{invoice:y,currency:s})))))),o.a.createElement(h.GridRow,null,o.a.createElement(h.GridColumn,{span:12},"If you have any billing enquiries, please contact us via our"," ",o.a.createElement(C,{onClick:_t},"Live Chat"),"."))),o.a.createElement(h.Dialog,{active:this.props.messageDialogActive,onClose:this.handleMessageClose,actions:r.updateAccount?null:[o.a.createElement(h.Button,{primary:!0,text:"OK",onClick:this.handleMessageClose})]},o.a.createElement("p",{className:this.props.hpmError?"fail":"success"},this.props.hpmMessage)))}}])&&mt(n.prototype,r),a&&mt(n,a),t}();function Pt(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function xt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function It(e){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dt(e,t){return!t||"object"!==It(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Tt(e){return(Tt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rt(e,t){return(Rt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var At=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Dt(this,Tt(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rt(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e;switch(this.props.instance.billingProvider){case"gcp":e=I;break;case"zuora":default:e=St}return o.a.createElement(d.a,{permissions:["instance.billing.update"]},o.a.createElement(e,this.props))}}])&&Nt(n.prototype,r),a&&Nt(n,a),t}(),Ft=Object(f.connect)(function(e,t){var n=e.billing,r=e.root,o=t.params,a=r.instances[o.instanceId];return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pt(n,!0).forEach(function(t){xt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({email:r.email,instance:a},n)},{getAccountDetails:m.s,getAccountStatus:m.t,getInvoices:m.L,setCreditCardFormActive:m.Gb,setMessageDialogActive:m.Jb,setPreferredCurrency:m.Lb,submitCreditCard:m.Ob,validateUserDetailsForm:m.cc})(At),Mt=n(127),Kt=n.n(Mt),Bt=n(155),Wt=n(163),Ut=n(302),zt=n(158),Ht=n(1664),Gt=n(64);function Lt(e){var t=e.connected,n=e.loading,r=e.intermediate,a=e.loadingText,i=e.successText,l=e.intermediateText,c=void 0===l?"":l,s=e.failText,u=o.a.createElement("div",{className:"status-text"},o.a.createElement("i",{className:"far fa-check-circle"}),o.a.createElement("h3",null,i)),p=o.a.createElement("div",{className:"status-text"},o.a.createElement("i",{className:"fa fa-times-circle"}),o.a.createElement("h3",null,s)),f=o.a.createElement("div",{className:"status-text"},o.a.createElement(h.CircularProgress,{inline:!0}),o.a.createElement("h3",null,a)),m=o.a.createElement("div",{className:"status-text"},o.a.createElement("i",{className:"fa fa-puzzle-piece"}),o.a.createElement("h3",null,c));return o.a.createElement("div",{className:"connection-status"},n&&f,!n&&t&&u,!n&&!t&&!r&&p,!n&&!t&&r&&m)}var qt=n(39),Vt=n.n(qt),Yt=n(19),Qt=n.n(Yt),Jt=n(222),$t=n.n(Jt),Xt=n(11),Zt=n(585);function en(e){return(en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nn(e,t){return!t||"object"!==en(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rn(e){return(rn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function on(e,t){return(on=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function an(e,t){e&&t&&e(t)}var ln=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),nn(this,rn(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&on(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.compact,n=void 0!==t&&t,r=e.instance,a=e.instanceStatus,i=e.instanceId,l=e.onClickWorkload,c=$t()("workload-intro",{"workload-intro-compact":n}),s=Object(Wt.c)(r),u=function(e){return!!Vt()(s,function(t){return t.name===e})};return o.a.createElement("div",{className:"product-grid"},o.a.createElement(h.Grid,null,o.a.createElement(h.GridRow,{alignContent:"center"},u("Network")&&o.a.createElement(h.GridColumn,{span:3},o.a.createElement("div",{className:c},o.a.createElement(Qt.a,{to:a.discovery?"/network/".concat(i):"/network/".concat(i,"/intro"),onClick:function(){return an(l,"discovery")}},o.a.createElement(G.a,{height:"180px"},o.a.createElement("div",{className:"workload-intro-doodle workload-intro-doodle-prom"}),o.a.createElement("div",{className:"workload-intro-title"},"Network",o.a.createElement("span",{className:"workload-intro-status"},o.a.createElement(Zt.a,{iconOnly:!0,withTooltip:!0,checked:a.discovery}))),o.a.createElement("div",{className:"workload-intro-text"},"Connect your hosts together using Weave Net"),!a.discovery&&o.a.createElement("div",{className:"workload-intro-hint"},"Click for more..."))))),u("Deploy")&&o.a.createElement(h.GridColumn,{span:3},o.a.createElement("div",{className:c},o.a.createElement(Qt.a,{to:a.flux?"/fluxv2/".concat(i):"/fluxv2/".concat(i,"/intro"),onClick:function(){return an(l,"flux")}},o.a.createElement(G.a,{height:"180px"},o.a.createElement("div",{className:"workload-intro-doodle workload-intro-doodle-flux"}),o.a.createElement("div",{className:"workload-intro-title"},"Deploy",o.a.createElement("span",{className:"workload-intro-status"},o.a.createElement(Zt.a,{iconOnly:!0,withTooltip:!0,checked:a.flux}))),o.a.createElement("div",{className:"workload-intro-text"},"Release applications to your cluster"),!a.flux&&o.a.createElement("div",{className:"workload-intro-hint"},"Click for more..."))))),u("Explore")&&o.a.createElement(h.GridColumn,{span:3},o.a.createElement("div",{className:c},o.a.createElement(Qt.a,{onClick:function(){return an(l,"scope")},to:a.scope?"/app/".concat(i):"/app/".concat(i,"/intro")},o.a.createElement(G.a,{height:"180px"},o.a.createElement("div",{className:"workload-intro-doodle workload-intro-doodle-scope"}),o.a.createElement("div",{className:"workload-intro-title"},"Explore",o.a.createElement("span",{className:"workload-intro-status"},o.a.createElement(Zt.a,{iconOnly:!0,withTooltip:!0,checked:a.scope}))),o.a.createElement("div",{className:"workload-intro-text"},"View, control and troubleshoot your cluster and applications"),!a.scope&&o.a.createElement("div",{className:"workload-intro-hint"},"Click for more..."))))),u("Monitor")&&o.a.createElement(h.GridColumn,{span:3},o.a.createElement("div",{className:c},o.a.createElement(Qt.a,{to:a.prom?Object(Xt.N)({},i):"/prom/".concat(i,"/intro"),onClick:function(){return an(l,"prom")}},o.a.createElement(G.a,{height:"180px"},o.a.createElement("div",{className:"workload-intro-doodle workload-intro-doodle-prom"}),o.a.createElement("div",{className:"workload-intro-title"},"Monitor",o.a.createElement("span",{className:"workload-intro-status"},o.a.createElement(Zt.a,{iconOnly:!0,withTooltip:!0,checked:a.prom}))),o.a.createElement("div",{className:"workload-intro-text"},"View dashboards, query metrics and customize alerts"),!a.prom&&o.a.createElement("div",{className:"workload-intro-hint"},"Click for more..."))))))))}}])&&tn(n.prototype,r),a&&tn(n,a),t}();function cn(e){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sn(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function un(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sn(n,!0).forEach(function(t){hn(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sn(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function pn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fn(e){return(fn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dn(e,t){return(dn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yn=function(e){function t(){var e,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=fn(t).call(this),e=!r||"object"!==cn(r)&&"function"!=typeof r?mn(n):r,hn(mn(e),"clearErrors",function(){e.setErrors(null)}),hn(mn(e),"setErrors",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e.setState(un({},e.state,{errors:t}))}),hn(mn(e),"expandHelp",function(t){t.preventDefault(),e.state.showHelp||e.setState({showHelp:!0})}),hn(mn(e),"handleNameChange",function(t){e.props.updateInstance({id:e.props.params.instanceId,name:t})}),e.state={errors:null,fetchingProbes:!1,id:"",probes:[],probeToken:"",showHelp:!1,user:""},e}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dn(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.props.params.instanceId&&this.props.getInstanceData(this.props.params.instanceId)}},{key:"render",value:function(){var e=this.props,t=e.instance,n=e.instanceStatus,r=e.connected,a=t&&t.id?Object(Wt.b)(t):[],i=a.filter(function(e){return n[e.id]}).length,l="".concat(i.toString(),"/").concat(a.length.toString()," of your Weave Cloud agents are connected"),c={activity:{margin:"200px auto",textAlign:"center",width:"150px"},code:{backgroundColor:K.a.colors.purple900,borderRadius:4,color:K.a.colors.purple200,fontFamily:"monospace",fontSize:"0.9rem",marginLeft:-16,padding:16},completed:{borderTop:"2px dotted ".concat(K.a.colors.gray50),display:r?"block":"none",marginBottom:24,marginTop:24},help:{borderTop:"2px dotted ".concat(K.a.colors.gray50),display:r?"none":"block",fontSize:"85%",lineHeight:1.5,marginBottom:24,marginTop:24},helpBlock:{display:this.state.showHelp?"block":"none",marginLeft:"-1em"},helpHint:{fontSize:"95%",textAlign:"center"},step:{marginBottom:"1em",marginTop:"3em",position:"relative"}};return this.props.instance?o.a.createElement("div",{className:"page onboarding-page"},o.a.createElement("h2",null,"Weave Cloud Agent Status"),o.a.createElement(h.Grid,null,o.a.createElement(h.GridRow,{alignContent:"center"},o.a.createElement(h.GridColumn,{span:7},this.props.doingFirstProbeCheck&&o.a.createElement(Bt.a,{text:"Checking connection..."}),!this.props.doingFirstProbeCheck&&o.a.createElement(Lt,{successText:"All Weave Cloud agents are connected!",loadingText:"Checking your Weave Cloud agents...",intermediateText:l,loading:this.props.fetchingInstanceStatus,connected:a.length===i,intermediate:r,failText:"No Weave Cloud agents connected"}),!this.props.doingFirstProbeCheck&&o.a.createElement(ln,{compact:!0,instanceId:this.props.params.instanceId,instance:this.props.instance,instanceStatus:this.props.instanceStatus})),o.a.createElement(h.GridColumn,{span:5},o.a.createElement(G.a,null,o.a.createElement(Ht.a,{id:this.props.params.instanceId,name:this.props.instance.name,onChange:this.handleNameChange,probeToken:this.props.probeToken})))))):o.a.createElement("div",{style:c.activity},o.a.createElement(h.LogoProgress,null))}}])&&pn(n.prototype,r),a&&pn(n,a),t}();var bn=Object(f.connect)(function(e,t){var n=e.root,r=n.instances,o=n.probes,a=t.params.instanceId,i=Object(Gt.d)(a)(e),l=r[a],c=l.featureFlags;return{connected:Object(Ut.d)(i),doingFirstProbeCheck:i.initial,featureFlags:c,fetchingInstanceStatus:i.fetching,instance:l,instanceStatus:i,probes:Kt()(o,["hostname","id"]),probeToken:l.probeToken}},{getInstanceData:m.H,getSetupStatus:m.Q,updateInstance:m.Ub})(Object(zt.a)(yn)),gn=n(13),vn=n.n(gn),En=n(3),wn=n(310);function On(e){return(On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cn(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["/api/users/org/",""]);return Cn=function(){return e},e}function kn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _n(e){return(_n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sn(e,t){return(Sn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xn=function(e){function t(){var e,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=_n(t).call(this),e=!r||"object"!==On(r)&&"function"!=typeof r?jn(n):r,Pn(jn(e),"handleClickDelete",function(){e.doDelete()}),Pn(jn(e),"handleDeleteError",function(t){var n=t.errors[0];Object(z.trackNetworkError)(n.message),e.setState({deleteErrorText:n.message,deleting:!1})}),Pn(jn(e),"handleChangeDeleteInput",function(t){var n=e.props.instanceName&&(e.props.instanceName.toLowerCase()===t.target.value.toLowerCase()||e.props.instanceId.toLowerCase()===t.target.value.toLowerCase());e.setState({instanceNameValid:n})}),Pn(jn(e),"handleKeyDownDelete",function(t){13===t.keyCode&&e.state.instanceNameValid&&e.doDelete()}),e.state={deleteErrorText:"",deleting:!1,instanceNameValid:!1},e}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sn(e,t)}(t,o.a.Component),n=t,(r=[{key:"doDelete",value:function(){var e=this;this.setState({deleting:!0}),Object(En.b)(Object(En.d)(Cn(),this.props.instanceId)).then(function(){e.props.deleteInstance(e.props.instanceId),vn.a.push(Object(Xt.C)())}).catch(this.handleDeleteError)}},{key:"render",value:function(){var e={deleteButton:{marginLeft:"2em"},deleteError:{display:this.state.deleteErrorText?"block":"none"},errorLabel:{color:K.a.colors.orange500,fontSize:"0.8rem"},label:{overflow:"hidden",textOverflow:"ellipsis"}},t=this.props.instanceName;return o.a.createElement("div",null,o.a.createElement("div",{style:e.label},o.a.createElement("p",null,"You can delete this Weave Cloud instance for your cluster"," ",o.a.createElement("strong",null,t),"."),o.a.createElement("p",null,"Please type its name to confirm:")),o.a.createElement("div",{style:e.deleteError},o.a.createElement("p",{style:e.errorLabel},this.state.deleteErrorText)),o.a.createElement(wn.a,{hintText:"Type the instance name",onChange:this.handleChangeDeleteInput,onKeyDown:this.handleKeyDownDelete}),o.a.createElement(h.Button,{danger:!0,style:e.deleteButton,disabled:!this.state.instanceNameValid||this.state.deleting,onClick:this.handleClickDelete,text:"Delete this instance"}))}}])&&kn(n.prototype,r),a&&kn(n,a),t}(),In=Object(f.connect)(null,{deleteInstance:m.k})(xn),Nn=n(17);function Dn(e){return(Dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rn(e,t){return!t||"object"!==Dn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function An(e){return(An=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fn(e,t){return(Fn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Mn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Rn(this,An(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fn(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.props.params.instanceId&&this.props.getInstanceData(this.props.params.instanceId)}},{key:"render",value:function(){var e=this.props,t=e.instance,n=e.params;return t?"gcp"===t.billingProvider?o.a.createElement("div",{className:"page page-delete"},o.a.createElement("h2",null,"Delete instance"),o.a.createElement("p",null,"To remove your instance, cancel your subscription on Google Cloud Platform."),o.a.createElement("p",null,o.a.createElement("a",{target:"_blank",href:y.b,rel:"noopener"},o.a.createElement(h.Button,{primary:!0,text:"Go to Google Cloud Platform"})))):o.a.createElement("div",{className:"page page-delete"},o.a.createElement(d.a,{permissions:["instance.delete"]},o.a.createElement("h2",null,"Delete Instance"),o.a.createElement(In,{instanceName:t.name,instanceId:n.instanceId}),"kubernetes"===t.platform&&o.a.createElement(Nn.b,null))):o.a.createElement("div",{style:{margin:"200px auto",textAlign:"center",width:"150px"}},o.a.createElement(h.LogoProgress,null))}}])&&Tn(n.prototype,r),a&&Tn(n,a),t}();var Kn=Object(f.connect)(function(e,t){return{instance:e.root.instances[t.params.instanceId]}},{getInstanceData:m.H})(Object(zt.a)(Mn)),Bn=n(1468),Wn=g.default.p.withConfig({displayName:"page__Instructions",componentId:"sc-12leh7k-0"})(["font-size:",";"],function(e){return e.theme.fontSizes.small}),Un=function(e){return o.a.createElement("div",{className:"page page-team"},o.a.createElement(d.a,{permissions:["instance.token.view"]},o.a.createElement("h2",null,"Configure Deploy"),o.a.createElement("div",null,o.a.createElement(Wn,null,o.a.createElement("em",null,"Weave Cloud Deploy")," watches your container image repositories for changes and deploys new images it finds to your Kubernetes Cluster either automatically or on your command."),o.a.createElement(Wn,null,"It connects together your existing infrastructure not hosted on Weave Cloud: Your ",o.a.createElement("b",null,"Kubernetes cluster"),", the ",o.a.createElement("b",null,"Git repository")," ","containing the configuration files of the cluster, and a"," ",o.a.createElement("b",null,"Container image registry")," hosting images produced by your continuous delivery (CD) system.")),o.a.createElement(Bn.a,e)))},zn=n(421),Hn=n(223),Gn=n(128),Ln=n(8),qn=n(1661),Vn=n.n(qn),Yn=n(1660),Qn=n.n(Yn),Jn=n(1662),$n=n.n(Jn);function Xn(e){return(Xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function er(e){return(er=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nr(e,t){return(nr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var or,ar=g.default.div.withConfig({displayName:"create-webhook-dialog__WebhookType",componentId:"xm4n9e-0"})(["display:flex;align-items:center;cursor:pointer;"]),ir=g.default.input.withConfig({displayName:"create-webhook-dialog__WebhookSelect",componentId:"xm4n9e-1"})(["cursor:pointer;margin:10px;"]),lr=g.default.img.withConfig({displayName:"create-webhook-dialog__WebhookImage",componentId:"xm4n9e-2"})(["margin:10px;width:64px;"]),cr=g.default.div.withConfig({displayName:"create-webhook-dialog__CreateButtonContainer",componentId:"xm4n9e-3"})(["display:flex;justify-content:center;margin-top:20px;"]),sr=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=er(t).call(this,e),n=!o||"object"!==Xn(o)&&"function"!=typeof o?tr(r):o,rr(tr(n),"handleCreateWebhook",function(){Object(Ln.g)(n.props.instanceId,n.state.integrationType).then(function(e){n.props.handleViewWebhook(e.secretID),n.props.close()},function(){})}),rr(tr(n),"handleIntegrationTypeChange",function(e){n.setState({integrationType:e})}),n.state={integrationType:Y.WEBHOOK_TYPE_GITHUB_PUSH},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nr(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement("h3",null,"Select the type of webhook:"),o.a.createElement("div",null,o.a.createElement("form",null,o.a.createElement(ar,{onClick:function(){return e.handleIntegrationTypeChange(Y.WEBHOOK_TYPE_GITHUB_PUSH)}},o.a.createElement(ir,{type:"radio",checked:this.state.integrationType===Y.WEBHOOK_TYPE_GITHUB_PUSH}),o.a.createElement(lr,{alt:"GitHub push",src:Vn.a}),o.a.createElement("div",null,o.a.createElement("b",null,"GitHub push"),o.a.createElement("div",null,"Let Weave Cloud observe changes in your Git config repo and deploy immediately"))),o.a.createElement(ar,{onClick:function(){return e.handleIntegrationTypeChange(Y.WEBHOOK_TYPE_DOCKERHUB_IMAGE_PUSH)}},o.a.createElement(ir,{type:"radio",checked:this.state.integrationType===Y.WEBHOOK_TYPE_DOCKERHUB_IMAGE_PUSH}),o.a.createElement(lr,{alt:"Docker Hub",src:Qn.a}),o.a.createElement("div",null,o.a.createElement("b",null,"Docker Hub"),o.a.createElement("div",null,"Let Weave Cloud deploy new images immediately"))),o.a.createElement(ar,{onClick:function(){return e.handleIntegrationTypeChange(Y.WEBHOOK_TYPE_QUAY_IMAGE_PUSH)}},o.a.createElement(ir,{type:"radio",checked:this.state.integrationType===Y.WEBHOOK_TYPE_QUAY_IMAGE_PUSH}),o.a.createElement(lr,{alt:"Quay",src:$n.a}),o.a.createElement("div",null,o.a.createElement("b",null,"Quay"),o.a.createElement("div",null,"Let Weave Cloud deploy new images immediately"))))),o.a.createElement(cr,null,o.a.createElement(h.Button,{primary:!0,onClick:this.handleCreateWebhook},"Create")))}}])&&Zn(n.prototype,r),a&&Zn(n,a),t}(),ur=Object(f.connect)(null,{createInstanceWebhook:Ln.g})(sr);function pr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fr=(pr(or={},Y.WEBHOOK_TYPE_DOCKERHUB_IMAGE_PUSH,"DockerHub Image Push"),pr(or,Y.WEBHOOK_TYPE_GITHUB_PUSH,"GitHub Push"),pr(or,Y.WEBHOOK_TYPE_QUAY_IMAGE_PUSH,"Quay Image Push"),or),mr=g.default.th.withConfig({displayName:"webhooks-table__CenteredHeaderCell",componentId:"g0tlkx-0"})(["text-align:center;"]),dr=g.default.td.withConfig({displayName:"webhooks-table__CenteredCell",componentId:"g0tlkx-1"})(["text-align:center;"]),hr=function(e){var t=e.handleDeleteWebhook,n=e.handleViewWebhook,r=e.webhooks;return void 0===r?o.a.createElement(Bt.a,null):0===r.length?null:o.a.createElement("div",{className:"weave-data-table"},o.a.createElement("table",null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement(mr,null,"Status"),o.a.createElement(mr,null,"Type"),o.a.createElement(mr,null,"ID"),o.a.createElement("th",null),o.a.createElement("th",null))),o.a.createElement("tbody",null,r.map(function(e){return o.a.createElement("tr",{key:e.secretID},o.a.createElement(dr,null,o.a.createElement("i",{className:$t()({"fa fa-check":e.firstSeenAt,"fa fa-times":!e.firstSeenAt}),title:e.firstSeenAt?"Ready":"We have not yet seen a ping!"})),o.a.createElement(dr,null,fr[e.integrationType]),o.a.createElement(dr,null,"".concat(e.secretID.substring(0,8),"**********")),o.a.createElement(dr,null,o.a.createElement(h.Button,{onClick:function(){return n(e.secretID)}},"View")),o.a.createElement(dr,null,o.a.createElement(d.a,{permissions:["instance.webhook.delete"]},o.a.createElement(h.Button,{onClick:function(){return t(e.secretID)}},"Delete"))))}))))};function yr(e){return(yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function br(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gr(e,t){return!t||"object"!==yr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vr(e){return(vr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Er(e,t){return(Er=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wr=g.default.div.withConfig({displayName:"webhook-details-dialog__Step",componentId:"sc-1j1js8s-0"})(["position:relative;margin:35px 50px;"]),Or=g.default.div.withConfig({displayName:"webhook-details-dialog__StepIcon",componentId:"sc-1j1js8s-1"})(["border-radius:",";box-shadow:0 0 0 ",";background-color:",";font-size:",";color:",";position:absolute;text-align:center;line-height:28px;width:28px;left:-40px;top:-5px;"],function(e){return e.theme.borderRadius.circle},function(e){return e.theme.colors.gray200},function(e){return e.theme.colors.gray200},function(e){return e.theme.fontSizes.normal},function(e){return e.theme.colors.white}),Cr=g.default.div.withConfig({displayName:"webhook-details-dialog__CodeContainer",componentId:"sc-1j1js8s-2"})(["text-align:center;margin-top:15px;"]),kr=g.default.div.withConfig({displayName:"webhook-details-dialog__CenteredContainer",componentId:"sc-1j1js8s-3"})(["display:flex;align-items:center;justify-content:center;"]),_r=g.default.span.withConfig({displayName:"webhook-details-dialog__LoadingText",componentId:"sc-1j1js8s-4"})(["margin-left:5px;"]),jr=g.default.span.withConfig({displayName:"webhook-details-dialog__SuccessText",componentId:"sc-1j1js8s-5"})(["margin-bottom:20px;"]),Sr=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=gr(this,vr(t).call(this,e))).stopPolling=function(){return null},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Er(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.stopPolling=this.props.pollInstanceWebhooks(this.props.instanceId)}},{key:"componentWillUnmount",value:function(){this.stopPolling()}},{key:"render",value:function(){var e=this.props.webhook;if(!e)return o.a.createElement(kr,null,o.a.createElement(h.CircularProgress,null));switch(e.integrationType){case Y.WEBHOOK_TYPE_GITHUB_PUSH:return this.renderGitHub();case Y.WEBHOOK_TYPE_DOCKERHUB_IMAGE_PUSH:return this.renderDockerHub();case Y.WEBHOOK_TYPE_QUAY_IMAGE_PUSH:return this.renderQuay();default:return console.error("Invalid webhook integration type: ",e.integrationType),this.props.close(),null}}},{key:"renderGitHub",value:function(){var e=this.props,t=e.webhook,n=e.owner,r=e.repo;return o.a.createElement("div",null,o.a.createElement("h3",null,"GitHub webhook:"),o.a.createElement(wr,null,o.a.createElement(Or,null,"1"),"Open the"," ",n&&r?o.a.createElement("a",{onClick:function(){return function(e,t){Object(Nn.s)(function(e,t){return"https://github.com/".concat(e,"/").concat(t,"/settings/hooks")}(e,t))}(n,r)}},"GitHub webhooks settings"):o.a.createElement("span",null,"GitHub webhooks settings")," ","page and create a new webhook"),o.a.createElement(wr,null,o.a.createElement(Or,null,"2"),"Enter the Payload URL:",o.a.createElement(Cr,null,o.a.createElement(h.Code,null,"".concat(window.location.origin,"/webhooks/").concat(t&&t.secretID,"/")))),o.a.createElement(wr,null,o.a.createElement(Or,null,"3"),"Enter the secret:",o.a.createElement(Cr,null,o.a.createElement(h.Code,null,t&&t.secretSigningKey))),o.a.createElement(wr,null,o.a.createElement(Or,null,"4"),"Save the webhook"),t&&t.firstSeenAt?o.a.createElement("div",null,o.a.createElement(kr,null,o.a.createElement(jr,null,"We received a ping from GitHub!")),o.a.createElement(kr,null,o.a.createElement(h.Button,{onClick:this.props.close},"Close"))):o.a.createElement(kr,null,o.a.createElement(h.CircularProgress,null),o.a.createElement(_r,null,"Waiting for ping from GitHub")))}},{key:"renderDockerHub",value:function(){var e=this.props.webhook;return o.a.createElement("div",null,o.a.createElement("h3",null,"DockerHub webhook:"),o.a.createElement(wr,null,o.a.createElement(Or,null,"1"),"Open the webhooks page under the DockerHub repository"),o.a.createElement(wr,null,o.a.createElement(Or,null,"2"),"Enter the Webhook URL:",o.a.createElement(Cr,null,o.a.createElement(h.Code,null,"".concat(window.location.origin,"/webhooks/").concat(e&&e.secretID,"/")))),o.a.createElement(wr,null,o.a.createElement(Or,null,"3"),"Save the webhook"),e&&e.firstSeenAt?o.a.createElement("div",null,o.a.createElement(kr,null,o.a.createElement(jr,null,"We received a request from DockerHub!")),o.a.createElement(kr,null,o.a.createElement(h.Button,{onClick:this.props.close},"Close"))):o.a.createElement(kr,null,o.a.createElement(h.CircularProgress,null),o.a.createElement(_r,null,"Waiting for the first request from DockerHub")))}},{key:"renderQuay",value:function(){var e=this.props.webhook;return o.a.createElement("div",null,o.a.createElement("h3",null,"Quay webhook:"),o.a.createElement(wr,null,o.a.createElement(Or,null,"1"),"Open the quay repository setting page and click 'Create Notification'"),o.a.createElement(wr,null,o.a.createElement(Or,null,"2"),"Select the 'Push to Repository' event type"),o.a.createElement(wr,null,o.a.createElement(Or,null,"3"),"Select the 'Webhook POST' notification type"),o.a.createElement(wr,null,o.a.createElement(Or,null,"4"),"Enter the Webhook URL:",o.a.createElement(Cr,null,o.a.createElement(h.Code,null,"".concat(window.location.origin,"/webhooks/").concat(e&&e.secretID,"/")))),o.a.createElement(wr,null,o.a.createElement(Or,null,"5"),"Save the webhook"),e&&e.firstSeenAt?o.a.createElement("div",null,o.a.createElement(kr,null,o.a.createElement(jr,null,"We received a request from Quay!")),o.a.createElement(kr,null,o.a.createElement(h.Button,{onClick:this.props.close},"Close"))):o.a.createElement(kr,null,o.a.createElement(h.CircularProgress,null),o.a.createElement(_r,null,"Waiting for the first request from Quay")))}}])&&br(n.prototype,r),a&&br(n,a),t}(),Pr=Object(f.connect)(null,{pollInstanceWebhooks:m.pb})(Sr);function xr(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function Ir(e){return(Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dr(e){return(Dr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rr(e,t){return(Rr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ar(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Fr=function(e){function t(e,n){var r,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=Dr(t).call(this,e,n),r=!a||"object"!==Ir(a)&&"function"!=typeof a?Tr(o):a,Ar(Tr(r),"handleCreateWebhookDialogToggle",function(){r.setState({isCreateWebhookDialogOpen:!r.state.isCreateWebhookDialogOpen})}),Ar(Tr(r),"handleViewWebhook",function(e){r.setState({selectedWebhookSecretId:e})}),Ar(Tr(r),"handleCloseViewWebhook",function(){r.setState({selectedWebhookSecretId:null})}),Ar(Tr(r),"handleDeleteWebhook",function(e){if(window.confirm("Are you sure you want to delete this webhook?")){var t=r.props.instanceId;r.props.deleteInstanceWebhook(t,e)}}),r.state={isCreateWebhookDialogOpen:!1,selectedWebhookSecretId:null},r}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rr(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=this.props.instanceId;this.props.getInstanceWebhooks(e),this.props.getFluxStatus(e)}},{key:"render",value:function(){var e=this.props,t=e.instance,n=e.instanceId,r=e.owner,a=e.repo,i=this.state,l=i.isCreateWebhookDialogOpen,c=i.selectedWebhookSecretId,s=null!==c,u=t.webhooks&&t.webhooks.find(function(e){return e.secretID===c});return o.a.createElement("div",{className:"page"},o.a.createElement("h2",null,"Incoming Webhooks"),o.a.createElement("p",null,"Webhooks allow Deploy to immediately respond to changes in your git config or image repository. Deploy will otherwise fall back to a slightly slower polling strategy."),o.a.createElement(d.a,{permissions:["instance.webhook.create"]},o.a.createElement(h.Button,{onClick:this.handleCreateWebhookDialogToggle,primary:!0},"Create new webhook")),o.a.createElement(hr,{handleDeleteWebhook:this.handleDeleteWebhook,handleViewWebhook:this.handleViewWebhook,webhooks:t.webhooks}),o.a.createElement(h.Dialog,{active:l,onClose:this.handleCreateWebhookDialogToggle},l&&o.a.createElement(ur,{close:this.handleCreateWebhookDialogToggle,instanceId:n,handleViewWebhook:this.handleViewWebhook})),o.a.createElement(h.Dialog,{active:s,onClose:this.handleCloseViewWebhook},s&&o.a.createElement(Pr,{close:this.handleCloseViewWebhook,instanceId:n,webhook:u,owner:r,repo:a})))}}])&&Nr(n.prototype,r),a&&Nr(n,a),t}();var Mr=Object(f.connect)(function(e){var t=Object(Gt.b)(e),n=t?t.id:void 0;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xr(n,!0).forEach(function(t){Ar(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xr(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({instance:t,instanceId:n},function(e){var t=F()(e,["git","url"],""),n=Object(Gn.o)(t),r=n.host,o=void 0===r?"":r,a=n.owner,i=n.repo;return o.includes("github.com")&&a&&i?{owner:a,repo:i}:{}}(Object(Hn.g)(e)[n]))},{deleteInstanceWebhook:zn.a,getFluxStatus:m.D,getInstanceWebhooks:zn.b})(Fr),Kr=n(5),Br=n.n(Kr),Wr=n(180),Ur=n(159),zr=n(1379);function Hr(e){return(Hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gr(){return(Gr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Lr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qr(e,t){return!t||"object"!==Hr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vr(e){return(Vr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yr(e,t){return(Yr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),qr(this,Vr(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yr(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.props.params.instanceId?this.props.getInstanceData(this.props.params.instanceId):this.checkOnboardingStatus()}},{key:"componentDidUpdate",value:function(e){!e.instance&&this.props.instance&&this.checkOnboardingStatus()}},{key:"checkOnboardingStatus",value:function(){var e=this.props.instance;Object(Wr.c)(e)&&vn.a.push(Object(Xt.U)(e.id))}},{key:"hasFeatureFlag",value:function(e){var t=this.props.instance;return t&&t.featureFlags&&t.featureFlags.indexOf(e)>-1}},{key:"isActiveMenuItem",value:function(e){var t=this.context.router.isActive,n=Object(Xt.B)(this.props.params.instanceId);return!!t("".concat(n,"/").concat(e),!1)||!(!t("".concat(n,"/"),!0)||"status"!==e)}},{key:"render",value:function(){var e=this.props.instance,t=this.props.params.instanceId,n=(this.props.instance||{}).refuseDataAccess;return o.a.createElement(Ur.a,Gr({page:"instance"},this.props.params),!e&&o.a.createElement("div",{style:{margin:"200px auto",textAlign:"center",width:"150px"}},o.a.createElement(h.LogoProgress,null)),e&&o.a.createElement(h.Grid,null,o.a.createElement(h.GridRow,{alignContent:"center"},o.a.createElement(h.GridColumn,{span:2},o.a.createElement("div",{className:"menu"},o.a.createElement(h.Menu,null,!n&&o.a.createElement("div",null,o.a.createElement(Qt.a,{to:Object(Xt.B)(t)},o.a.createElement(h.MenuItem,{active:this.isActiveMenuItem("status"),text:"Agent Status"})),o.a.createElement(d.a,{permissions:["instance.token.view"]},o.a.createElement(Qt.a,{to:Object(Xt.E)(t)},o.a.createElement(h.MenuItem,{active:this.isActiveMenuItem("setup"),text:"Install"}))),o.a.createElement(Qt.a,{to:Object(Xt.z)(t)},o.a.createElement(h.MenuItem,{text:"Configure"})),o.a.createElement(d.a,{permissions:["instance.token.view"]},o.a.createElement(Qt.a,{to:Object(Xt.z)(t)},o.a.createElement(h.MenuItem,{active:this.isActiveMenuItem("deploy"),text:"Deploy",isSubItem:!0}))),o.a.createElement(Qt.a,{to:Object(Xt.Y)(t)},o.a.createElement(h.MenuItem,{active:this.isActiveMenuItem("webhooks"),text:"Incoming Webhooks",isSubItem:!0})),o.a.createElement(Qt.a,{to:Object(Xt.e)(t)},o.a.createElement(h.MenuItem,{active:this.isActiveMenuItem("cloudwatch"),text:"AWS CloudWatch",isSubItem:!0})),o.a.createElement(Qt.a,{to:Object(Xt.R)(t)},o.a.createElement(h.MenuItem,{active:this.isActiveMenuItem("notifications"),text:"Notifications",isSubItem:!0})),o.a.createElement(Qt.a,{to:Object(Xt.b)(t)},o.a.createElement(h.MenuItem,{active:this.isActiveMenuItem("alerts"),text:"Alerts",isSubItem:!0}))),o.a.createElement(Qt.a,{to:Object(Xt.X)(t)},o.a.createElement(h.MenuItem,{active:this.isActiveMenuItem("team"),text:"Team",subtext:this.props.instance.teamId})),o.a.createElement(d.a,{permissions:["instance.billing.update"]},o.a.createElement(zr.a,{flags:["billing"]},o.a.createElement(Qt.a,{to:Object(Xt.d)(t)},o.a.createElement(h.MenuItem,{active:this.isActiveMenuItem("billing"),text:"Billing"})))),o.a.createElement(d.a,{permissions:["instance.delete"]},o.a.createElement(Qt.a,{to:Object(Xt.j)(t)},o.a.createElement(h.MenuItem,{active:this.isActiveMenuItem("delete"),text:"Delete"})))))),o.a.createElement(h.GridColumn,{span:9},this.props.children))))}}])&&Lr(n.prototype,r),a&&Lr(n,a),t}();Qr.contextTypes={router:Br.a.object.isRequired};var Jr=Object(f.connect)(function(e,t){var n=t.params.instanceId;return{instance:e.root.instances[n]}},{getInstanceData:m.H})(Object(zt.a)(Qr)),$r=n(113),Xr=n.n($r),Zr=n(151),eo=n.n(Zr),to=n(559),no=n(409),ro=n(584),oo=n(582);function ao(e){return(ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function io(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lo(e){return(lo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function co(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function so(e,t){return(so=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function uo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var po=g.default.div.withConfig({displayName:"users__UserItem",componentId:"sc-2h21ya-0"})(["display:flex;align-items:center;height:36px;padding:3px 0 3px 16px;& > *{margin-right:6px;}.dropdown-popover{width:auto;}background-color:",";"],function(e){return e.self?e.theme.colors.gray50:"transparent"}),fo=g.default.div.withConfig({displayName:"users__UserName",componentId:"sc-2h21ya-1"})(["flex:1;"]),mo=function(e){function t(){var e,n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,l=new Array(i),c=0;c<i;c++)l[c]=arguments[c];return r=this,a=(e=lo(t)).call.apply(e,[this].concat(l)),n=!a||"object"!==ao(a)&&"function"!=typeof a?co(r):a,uo(co(n),"state",{errors:null,notices:null,submitting:!1}),uo(co(n),"doRequestAndShowMessage",function(e){return n.setState({submitting:!0}),e().then(function(e){return n.props.dispatch(Object(m.I)(n.props.instance.id)).then(function(){n.setState({notices:[{message:e}],submitting:!1})})}).catch(function(e){n.setState({errors:e.errors,submitting:!1})})}),uo(co(n),"handleChangeRole",function(e,t){var r=n.props.instance.teamId;n.doRequestAndShowMessage(function(){return Object(Ln.ub)(e.email,t,r).then(function(){return"".concat(e.email," is now a team ").concat(t)})})}),uo(co(n),"handleClickRemove",function(e){var t=e.self?"Do you really want to remove yourself from the team?":"Do you really want to remove ".concat(e.email,"'s from the team?");if(window.confirm(t)){var r=n.props.instance.teamId;n.doRequestAndShowMessage(function(){return Object(Ln.ib)(e.email,r).then(function(){return"".concat(e.email," removed from this team")})})}}),uo(co(n),"handleSubmitInviteForm",function(e){n.doRequestAndShowMessage(function(){return e})}),uo(co(n),"renderUser",function(e){var t=n.state.submitting,r=n.props,a=r.instance,i=r.userRoles,l=e.self?"".concat(e.email," (me)"):e.email;return o.a.createElement(po,{key:e.email,self:e.self},o.a.createElement(fo,null,l),o.a.createElement(d.a,{teamId:a.teamId,permissions:["team.member.update"]},o.a.createElement(ro.a,{onChange:function(t,r){return n.handleChangeRole(e,r)},roleId:e.roleId,userRoles:i,width:"auto",disabled:t})),o.a.createElement(d.a,{teamId:a.teamId,permissions:["team.member.remove"]},function(r){return r||e.self?o.a.createElement(h.Button,{disabled:t,text:"Remove",onClick:function(){return n.handleClickRemove(e)}}):null}))}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&so(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.props.dispatch(Object(m.I)(this.props.instance.id))}},{key:"render",value:function(){var e=this,t=this.state,n=t.errors,r=t.notices,a=t.submitting,i=this.props,l=i.instance,c=i.userRoles,s=n||r,u=n?"error":"info";return o.a.createElement(o.a.Fragment,null,o.a.createElement(d.a,{teamId:l.teamId,permissions:["team.member.invite"]},o.a.createElement("p",null,"Invite users to access the Instances of this team"),o.a.createElement(oo.a,{teamId:l.teamId,userRoles:c,disabled:a,onSubmit:this.handleSubmitInviteForm})),o.a.createElement("h4",null,"Current members"),!l.users&&o.a.createElement("span",null,o.a.createElement(h.CircularProgress,null)),l.users&&o.a.createElement(to.a,null,l.users.map(this.renderUser)),o.a.createElement(no.a,null,o.a.createElement(h.Alert,{type:u,visible:Boolean(s),onClose:function(){e.setState({errors:null,notices:null})}},(s||[]).map(function(e){return e.message}).join(". "))))}}])&&io(n.prototype,r),a&&io(n,a),t}(),ho=Object(f.connect)()(mo),yo=n(561);function bo(e){return(bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function go(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vo(e){return(vo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Eo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wo(e,t){return(wo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Co=g.default.div.withConfig({displayName:"move-dialog__Error",componentId:"sc-1u08olu-0"})(["color:",";"],function(e){return e.theme.colors.orange500}),ko=g.default.div.withConfig({displayName:"move-dialog__Container",componentId:"sc-1u08olu-1"})(["","{padding-left:0;}","{padding-left:0;}.weave-dialog-window{width:400px;}.weave-dialog-actions{margin-top:20px;}"],h.Dropdown,h.Input),_o=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=vo(t).call(this,e),n=!o||"object"!==bo(o)&&"function"!=typeof o?Eo(r):o,Oo(Eo(n),"handleSubmit",function(){var e=n.props.instance,t=n.state,r=t.teamName,o=t.teamId;n.setState({error:null,submitting:!0}),Object(Ln.fb)(e.id,{teamId:o,teamName:r}).then(function(){n.setState({submitting:!1}),n.handleClose()}).catch(function(e){var t=e.errors;n.setState({error:t[0]&&t[0].message,submitting:!1})})}),Oo(Eo(n),"handleClose",function(){n.setState({teamId:n.props.instance.teamId,teamName:null}),n.props.onClose()}),Oo(Eo(n),"handleChangeTeam",function(e,t){n.setState({teamId:e,teamName:t})}),n.state={error:null,submitting:!1,teamId:e.instance.teamId,teamName:null},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wo(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.teams,n=e.teamName,r=e.instance,a=e.userRoles,i=this.state.teamId!==r.teamId,l=[];return i&&l.push(o.a.createElement(h.Button,{primary:!0,onClick:this.handleSubmit,text:"Transfer"})),l.push("Cancel"),o.a.createElement(ko,null,o.a.createElement(h.Dialog,{active:!0,actions:l,onClose:this.handleClose,onActionClick:this.handleClose,overlay:!0},o.a.createElement("h2",null,"Transfer ownership"," ",this.state.submitting&&o.a.createElement(h.CircularProgress,{inline:!0})),this.state.error&&o.a.createElement(Co,null,this.state.error),"Team",o.a.createElement(yo.a,{create:!0,teamId:r.teamId,teams:t,onChange:this.handleChangeTeam,userRoles:a}),i&&o.a.createElement(b.a,null,"Moving this instance to another team removes access for all members of the current team ",o.a.createElement("strong",null,n))))}}])&&go(n.prototype,r),a&&go(n,a),t}();function jo(e){return(jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function So(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Po(e){return(Po=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Io(e,t){return(Io=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function No(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Do=function(e,t){return t?eo()(e,"id")[t.teamId]:null},To=g.default.span.withConfig({displayName:"page__TeamName",componentId:"g4pg8d-0"})(["font-weight:bold;"]),Ro=g.default.ul.withConfig({displayName:"page__InstanceList",componentId:"g4pg8d-1"})(["list-style-type:circle;padding:0 1em;margin:0.5em 0;"]),Ao=g.default.li.withConfig({displayName:"page__InstanceItem",componentId:"g4pg8d-2"})([""]),Fo=g.default.div.withConfig({displayName:"page__MoveContainer",componentId:"g4pg8d-3"})(["width:32em;display:flex;justify-content:space-between;align-items:center;"]),Mo=g.default.div.withConfig({displayName:"page__UsersContainer",componentId:"g4pg8d-4"})(["width:32em;"]),Ko=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Po(t).call(this,e),n=!o||"object"!==jo(o)&&"function"!=typeof o?xo(r):o,No(xo(n),"fetchData",function(){var e=n.props,t=e.dispatch,r=e.instance;t(Object(m.R)()),r&&r.id&&t(Object(m.H)(r.id))}),No(xo(n),"showMoveDialog",function(){n.setState({moveDialogVisible:!0})}),No(xo(n),"closeMoveDialog",function(){n.setState({moveDialogVisible:!1}),n.fetchData()}),n.state={moveDialogVisible:!1},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Io(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this.props,t=e.instance,n=e.instances,r=e.teams,a=e.teamName,i=e.userRoles;if(!t)return o.a.createElement(Bt.a,null);var l=Xr()(n,function(e){return e.teamId===t.teamId});return o.a.createElement("div",{className:"page page-team"},o.a.createElement("h2",null,"Collaborate on Weave Cloud"),o.a.createElement(d.a,{teamId:t.teamId,permissions:["instance.transfer"]},o.a.createElement("h3",null,"Ownership"),o.a.createElement(Fo,null,"Transfer this instance to another team",o.a.createElement(h.Button,{onClick:this.showMoveDialog},"Transfer")),this.state.moveDialogVisible&&o.a.createElement(_o,{teams:r,instance:t,teamName:a,onClose:this.closeMoveDialog,userRoles:i})),o.a.createElement(d.a,{teamId:t.teamId,permissions:["team.members.view"]},o.a.createElement("h3",null,"Members"," ",a&&o.a.createElement("span",null,"of ",o.a.createElement(To,null,a))),a&&l.length>1&&o.a.createElement(b.a,null,"Membership grants access to all instances in that team:",o.a.createElement(Ro,null,D()(l,function(e){return o.a.createElement(Ao,{key:e.id},o.a.createElement(To,null,e.name))}))),o.a.createElement(Mo,null,o.a.createElement(ho,{userRoles:i,instance:t}))))}}])&&So(n.prototype,r),a&&So(n,a),t}();var Bo=Object(f.connect)(function(e){var t=e.root,n=t.teams||[],r=Gt.c(e),o=t.instances[r],a=Do(n,o);return{instance:o,instances:t.instances,teamName:a&&a.name,teams:n,userRoles:t.userRoles}})(Ko),Wo=n(99),Uo=n.n(Wo),zo=n(226),Ho=n.n(zo),Go=n(68),Lo=n.n(Go),qo=n(89),Vo=n.n(qo),Yo=n(52),Qo=n.n(Yo),Jo=n(62),$o=n.n(Jo),Xo=n(424),Zo=n(1397),ea=n(29),ta=n(553);function na(e){var t=e.expanded,n=e.onExpand,r=e.placeholder,a=e.children,i=e.subText;return o.a.createElement("div",{className:"expandable"},t?a:o.a.cloneElement(r,{onClick:n}),!t&&i)}function ra(e){return(ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oa(){return(oa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function aa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ia(e){return(ia=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function la(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ca(e,t){return(ca=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ua(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[24,20],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;return e&&e.length>n?"".concat(e.substr(0,t[0]),"...").concat(e.substr(e.length-t[1],e.length)):e}var pa,fa=Object(g.default)(h.Button).withConfig({displayName:"integration-form__RemoveButton",componentId:"sc-3eq7vq-0"})(["float:right;"]),ma=g.default.div.withConfig({displayName:"integration-form__FormGroup",componentId:"sc-3eq7vq-1"})(["margin-bottom:0;padding:8px 0 8px 0;width:100%;","{width:100%;padding-left:0;& > div{height:unset;}}input,textarea{box-sizing:border-box;}input{width:90%;}textarea{width:100%;overflow-x:auto;white-space:nowrap;resize:none;border-radius:",";border:1px solid ",";font-family:",";}"],h.Input,function(e){return e.theme.borderRadius.soft},function(e){return e.theme.colors.gray50},function(e){return e.theme.fontFamilies.monospace}),da=(pa=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return r=this,o=(e=ia(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==ra(o)&&"function"!=typeof o?la(r):o,sa(la(n),"handleCancel",function(e){n.props.onCancel(e,n.props.name)}),sa(la(n),"handleRemove",function(e){n.props.onRemove(e,n.props.name,n.props.title)}),sa(la(n),"handleSave",function(e){n.props.onSave("stackdriver"===n.props.name?{addressData:JSON.parse(e.addressData)}:e,n.props.name,n.props.title)}),sa(la(n),"handleExpand",function(e){n.props.onExpand(e,n.props.name)}),sa(la(n),"handleChange",function(e){n.props.onChange(e,n.props.name)}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ca(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.className,n=e.disabled,r=e.model,a=e.settings,i=e.receiverProps,l=e.title;return o.a.createElement(na,{expanded:a.expanded,placeholder:o.a.createElement(h.Button,{disabled:n,text:"Configure ".concat(l)}),subText:o.a.createElement(ta.a,{success:a.configured,opts:[o.a.createElement("span",null,l," configured:"," ",o.a.createElement("b",null,ua(a.addressData))),"".concat(l," not configured")]}),onExpand:this.handleExpand},o.a.createElement("div",{className:t},o.a.createElement(Z.Form,{id:r,model:r,onSubmit:this.handleSave},o.a.createElement("div",null,i.instructions,o.a.createElement(ma,null,o.a.createElement(Z.Control.text,oa({type:i.inputType,model:"".concat(r,".addressData"),component:h.Input,label:i.label,onChange:X()(this.handleChange,500),valid:a.valid,message:!a.valid&&a.reason},i.inputProps)))),o.a.createElement("div",{className:"buttons"},o.a.createElement(h.Button,{primary:!a.loading&&!!a.submittable,disabled:a.loading||!a.submittable,type:"submit",text:"Save"}),o.a.createElement(h.Button,{text:"Cancel",onClick:this.handleCancel,type:"button",disabled:a.loading}),a.loading&&o.a.createElement(h.CircularProgress,{inline:!0}),a.configured&&o.a.createElement(fa,{onClick:this.handleRemove,type:"button",danger:!0,text:"Remove"})))))}}])&&aa(n.prototype,r),a&&aa(n,a),t}(),Object(g.default)(pa).withConfig({displayName:"integration-form",componentId:"sc-3eq7vq-2"})(["background-color:",";padding:16px;.weave-grid-column{margin:16px 0;padding:0;}"],function(e){return e.theme.colors.gray50})),ha=n(1315),ya=n.n(ha),ba=n(309),ga=n.n(ba),va=n(46),Ea=n.n(va);function wa(e){return(wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ca(e){return(Ca=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ka(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _a(e,t){return(_a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ja(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Sa=r.createContext({}),Pa=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return r=this,o=(e=Ca(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==wa(o)&&"function"!=typeof o?ka(r):o,ja(ka(n),"handleOnChange",function(e,t){var r=ga()(ya()(n.props.values),e,t);n.props.onChange(r)}),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_a(e,t)}(t,r["Component"]),n=t,(o=[{key:"render",value:function(){var e=this.props,t=e.children,n=e.values;return r.createElement(Sa.Provider,{value:{fields:n,onChange:this.handleOnChange}},t)}}])&&Oa(n.prototype,o),a&&Oa(n,a),t}();function xa(e){return(xa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ia(){return(Ia=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Na(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function Da(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ta(e){return(Ta=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ra(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Aa(e,t){return(Aa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ja(Pa,"defaultProps",{onChange:Ea.a});var Ma=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return r=this,o=(e=Ta(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==xa(o)&&"function"!=typeof o?Ra(r):o,Fa(Ra(n),"handleChange",function(e){var t=n.props,r=t.type;(0,t.onChange)(t.model,"input"===r?e.target.value:e.target.checked)}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Aa(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e="checkbox"===this.props.type?"checked":"value",t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Na(n,!0).forEach(function(t){Fa(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Na(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},this.props,Fa({},e,this.props.value));return o.a.createElement("input",Ia({},t,{onChange:this.handleChange}))}}])&&Da(n.prototype,r),a&&Da(n,a),t}();Fa(Ma,"defaultProps",{onChange:Ea.a});var Ka=function(e){return Object(g.default)(e).withConfig({displayName:"input",componentId:"sc-131efny-0"})([""])}(function(e){return o.a.createElement(Sa.Consumer,null,function(t){var n=t.onChange,r=t.fields;return o.a.createElement(Ma,Ia({},e,{value:F()(r,e.model),onChange:n}))})}),Ba=Pa;function Wa(e){return(Wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ua(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function za(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function Ha(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?za(n,!0).forEach(function(t){Ya(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):za(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ga(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function La(e){return(La=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Va(e,t){return(Va=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ya(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Qa=g.default.a.withConfig({displayName:"page__HelpLink",componentId:"rt9dhv-0"})(["color:",";text-decoration:underline;"],function(e){return e.theme.colors.black}),Ja=function(e){return{instructions:o.a.createElement("div",null,o.a.createElement(Qa,{target:"_blank",href:e},"Create an Opsgenie API Token")," ","and paste the token in the field below")}},$a={email:{inputProps:{style:{maxWidth:"40%"},type:"text"},instructions:"Enter comma-separated email addresses to which notifications should be sent"},opsgenie:Ja("https://app.opsgenie.com/integration#/add/API"),"opsgenie-eu":Ja("https://app.eu.opsgenie.com/integration#/add/API"),pagerduty:{instructions:o.a.createElement("div",null,o.a.createElement(Qa,{target:"_blank",href:"https://support.pagerduty.com/docs/services-and-integrations"},"Create a PagerDuty API Token")," ","and paste the token in the field below")},slack:{inputProps:{},instructions:o.a.createElement("div",null,"Install the"," ",o.a.createElement(Qa,{target:"_blank",href:"https://slack.com/apps/A0F7XDUAZ-incoming-webhooks?page=1"},"Slack Incoming Webhooks App")," ","and copy the Webhook URL into the field below")},stackdriver:{inputProps:{rows:"14",textarea:!0},instructions:o.a.createElement("div",null,o.a.createElement(Qa,{target:"_blank",href:"https://console.cloud.google.com/apis/credentials/serviceaccountkey"},"Create a service account")," ","and paste the JSON key in the field below")}},Xa=g.default.div.withConfig({displayName:"page__Content",componentId:"rt9dhv-1"})(["position:relative;input:disabled{cursor:not-allowed;}input[type='checkbox']{cursor:pointer;}"]),Za=g.default.section.withConfig({displayName:"page__Section",componentId:"rt9dhv-2"})(["margin-bottom:3em;"]),ei=g.default.div.withConfig({displayName:"page__Description",componentId:"rt9dhv-3"})(["text-overflow:ellipsis;overflow:hidden;font-size:",";"],function(e){return e.theme.fontSizes.small}),ti=Object(g.default)(Zo.a).withConfig({displayName:"page__HeaderCheckbox",componentId:"rt9dhv-4"})(["display:block;margin:2px auto 0 auto;font-size:",";"],function(e){return e.theme.fontSizes.normal}),ni=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return r=this,o=(e=La(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Wa(o)&&"function"!=typeof o?qa(r):o,Ya(qa(n),"handleAlertClose",function(){Object(z.trackEvent)("notification.settings.alert.dismiss",{type:n.props.settingsMessage.success?"success":"error"},"Dismissed an <Alert /> on the notification settings form"),n.props.dismissNotificationSettingsMessage()}),Ya(qa(n),"handleSettingCancel",function(){Object(z.trackEvent)("notification.settings.cancel",{},"Canceled editing notification settings"),n.props.resetNotificationSettingsForm(n.props.params.instanceId)}),Ya(qa(n),"handleSettingChange",function(e){n.props.formActionsChange("forms.notificationSettings",e),n.props.submitNotificationSettings(n.props.params.instanceId,e)}),Ya(qa(n),"handleCheckAll",function(e,t){var r=Qo()(n.props.formData,function(n){return Ha({},n,Ya({},t,e.target.checked))});n.handleSettingChange(r)}),Ya(qa(n),"handleSettingsLoaded",function(e){var t=Ua(e,2),r=t[0],o=t[1];n.props.receiveNotificationSettings(n.props.params.instanceId,r,o,!0)}),Ya(qa(n),"handleTestNotificationClick",function(){Object(Ln.kb)(n.props.params.instanceId)}),Ya(qa(n),"handleIntegrationFormSave",function(e,t,r){Object(z.trackEvent)("notification.settings.integration.saved",{type:t}),n.props.submitIntegrationSettings(n.props.params.instanceId,Ha({type:t},e),r)}),Ya(qa(n),"handleIntegrationFormCancel",function(e,t){n.props.resetIntegrationsForm(n.props.params.instanceId,t),n.props.setIntegrationExpanded(t,!1)}),Ya(qa(n),"handleIntegrationFormRemove",function(e,t,r){Object(z.trackEvent)("notification.settings.integration.removed",{type:t}),n.props.setIntegrationExpanded(t,!1),n.props.removeIntegration(n.props.params.instanceId,t,r)}),Ya(qa(n),"handleIntegrationFormChange",function(e,t){n.props.validateIntegration(t,e.target.value)}),Ya(qa(n),"handleIntegrationFormExpand",function(e,t){n.props.setIntegrationExpanded(t,!0)}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Va(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this,t=this.props,n=t.eventTypes,r=t.submittingSettings,a=t.settingsMessage,i=t.params.instanceId,l=t.integrationSettings,c=t.formData,s=t.featureFlags,u=function(e){return $o()(c,function(t){return t[e]})},p=function(e){return Uo()(c,function(t){return t[e]})&&!u(e)},f=Xr()(ea.allReceivers,function(e){var t=$a[e];return!F()(t,"featureFlag")||Vo()(s,t.featureFlag)});return o.a.createElement("div",{className:"page notifications-page"},o.a.createElement(d.a,{permissions:["notification.settings.update"]},function(t){return o.a.createElement(Xa,null,o.a.createElement(no.a,null,o.a.createElement(h.Alert,{type:a.success?"success":"error",visible:a.visible,onClose:e.handleAlertClose},a.message)),o.a.createElement("h2",null,"Configure Notifications"," ",r&&o.a.createElement(h.CircularProgress,{inline:!0})),o.a.createElement(Xo.a,{resource:Ln.P,args:[i],onLoad:e.handleSettingsLoaded,loadingIcon:o.a.createElement(Bt.a,{text:"Fetching settings..."})},o.a.createElement(Ba,{onChange:e.handleSettingChange,values:c},o.a.createElement("div",{className:"weave-data-table"},o.a.createElement("table",null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Event Name"),D()(f,function(n){return o.a.createElement("th",{className:"right",key:n},ea.receiverLabels[n],l[n].configured?o.a.createElement(ti,{indeterminate:p(n),checked:u(n),disabled:!t,onChange:function(t){return e.handleCheckAll(t,n)}}):o.a.createElement("span",{className:"configured-subtext"},"not configured"))}))),o.a.createElement("tbody",null,D()(n,function(e){return o.a.createElement("tr",{key:e.name},o.a.createElement("td",{className:"cell"},o.a.createElement("div",null,o.a.createElement(h.Text,{bold:!0},e.displayName)),o.a.createElement(ei,{title:e.description},e.description)),D()(f,function(n){if(Vo()(e.hiddenReceiverTypes,n))return o.a.createElement("td",{className:"cell right",key:n});var r=l[n].configured,a=!r&&Vo()(e.defaultReceiverTypes,n);return o.a.createElement("td",{className:"cell right",key:n},a?o.a.createElement("input",{type:"checkbox",checked:!0,disabled:!0}):o.a.createElement(Ka,{model:"".concat(e.name,".").concat(n),disabled:!r||!t,type:"checkbox"}))}))}))))),o.a.createElement(Za,null,o.a.createElement("h3",null,"Monitor alerts"),o.a.createElement("p",null,"Configure which alerts are raised in the"," ",o.a.createElement(Qt.a,{to:Object(Xt.b)(i)},"Alerts")," ","section.")),o.a.createElement(Za,null,o.a.createElement("h3",null,"Integrations"),D()(Ho()(f,"browser"),function(n){return o.a.createElement(da,{key:n,disabled:!t,model:"forms.".concat(n,"Settings"),name:n,title:ea.receiverLabels[n],settings:l[n],onSave:e.handleIntegrationFormSave,onCancel:e.handleIntegrationFormCancel,onRemove:e.handleIntegrationFormRemove,onChange:e.handleIntegrationFormChange,onExpand:e.handleIntegrationFormExpand,receiverProps:$a[n]})}),o.a.createElement("p",null,"Desktop notifications can be enabled from the"," ",o.a.createElement(Qt.a,{to:Object(Xt.a)()},"user settings page"))),o.a.createElement(Za,null,o.a.createElement("h3",null,"Test Notifications"),o.a.createElement("p",null,o.a.createElement(h.Button,{disabled:!t,onClick:e.handleTestNotificationClick,text:"Send Test Notification"})))))}))}}])&&Ga(n.prototype,r),a&&Ga(n,a),t}();var ri=Object(f.connect)(function(e,t){var n=e.root,r=e.forms,o=t.params,a=Lo()(ea.allReceivers,function(e,t){return e[t]=Ha({},n.integrationSettings[t],{addressData:r["".concat(t,"Settings")].addressData}),e},{});return{eventTypes:n.eventConfig[o.instanceId],featureFlags:F()(n.instances,[o.instanceId,"featureFlags"],[]),fetchingSettings:n.notificationSettingsStatus.fetching,formData:r.notificationSettings,integrationSettings:a,settingsFormStatus:r.forms.notificationSettings.$form,settingsMessage:n.notificationSettingsStatus,submittingSettings:n.notificationSettingsStatus.submitting}},{dismissNotificationSettingsMessage:m.n,formActionsChange:Z.actions.change,receiveNotificationSettings:m.sb,removeIntegration:m.yb,resetIntegrationsForm:m.Bb,resetNotificationSettingsForm:m.Cb,setIntegrationExpanded:m.Ib,submitIntegrationSettings:m.Pb,submitNotificationSettings:m.Qb,validateIntegration:m.bc})(ni),oi=n(1667),ai=n(1467),ii=n(1658);var li=Object(f.connect)(function(e,t){var n=t.params.instanceId;return{instance:Object(Gt.f)(n)(e),instanceId:n}},{loadResource:m.X})(function(e){var t=e.instance,n=e.instance,r=n.environment,a=n.platform,i=e.instanceId,l=function(e){return oi.a[e]||oi.a.empty}(a);return t&&t.id&&(""===t.platform||""===t.environment)&&vn.a.replace(Object(Xt.U)(t.id)),o.a.createElement(d.a,{permissions:["instance.token.view"]},o.a.createElement("div",{className:"page page-setup"},o.a.createElement("h2",null,"Install the Weave Cloud Agents"),o.a.createElement("p",null,o.a.createElement("em",null,"Instructions for"," ","".concat(ii.b[a]," (").concat(ii.a[r],")"),".")),o.a.createElement(l,{instance:t,environment:r}),"gke"!==r&&o.a.createElement(ai.a,{platform:a,environment:r,instanceId:i})))}),ci=n(1311);function si(e){return(si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ui(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pi(e){return(pi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mi(e,t){return(mi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function di(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var hi=g.default.div.withConfig({displayName:"prom-config-file__PromConfigFileContainer",componentId:"sc-1bilulq-0"})(["margin-top:32px;background-color:",";border-radius:",";"],function(e){return e.theme.colors.purple50},function(e){return e.theme.borderRadius.soft}),yi=g.default.span.withConfig({displayName:"prom-config-file__Name",componentId:"sc-1bilulq-1"})(["color:",";line-height:2.2;"],function(e){return e.theme.colors.purple800}),bi=g.default.span.withConfig({displayName:"prom-config-file__ToolsButton",componentId:"sc-1bilulq-2"})(["padding-left:16px;"]),gi=g.default.span.withConfig({displayName:"prom-config-file__ToolsLabel",componentId:"sc-1bilulq-3"})(["padding-left:16px;",";"],function(e){return e.error&&"\n    color: ".concat(e.theme.colors.orange500,";\n  ")}),vi=g.default.div.withConfig({displayName:"prom-config-file__Header",componentId:"sc-1bilulq-4"})(["height:40px;display:flex;flex-direction:row;justify-content:space-between;padding-left:15px;align-items:center;cursor:pointer;"]),Ei=g.default.div.withConfig({displayName:"prom-config-file__HeaderControls",componentId:"sc-1bilulq-5"})(["display:flex;flex-direction:row;align-items:center;"]),wi=g.default.div.withConfig({displayName:"prom-config-file__HeaderButtons",componentId:"sc-1bilulq-6"})(["padding-top:4px;padding-left:10px;"]),Oi=g.default.i.withConfig({displayName:"prom-config-file__Chevron",componentId:"sc-1bilulq-7"})(["padding:8px;margin:0 10px;"]),Ci=function(e){function t(e,n){var r,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=pi(t).call(this,e,n),r=!a||"object"!==si(a)&&"function"!=typeof a?fi(o):a,di(fi(r),"handleClickHeader",function(){r.setState({loading:!0,visible:!r.state.visible})}),di(fi(r),"handleClickDefault",function(e){e.stopPropagation(),r.setState({emptyRule:r.state.value,value:r.props.defaultRules});var t=r.props.trackingPrefix,n=void 0===t?"config":t;Object(z.trackEvent)("prom.".concat(n,".file.defaults.click"))}),di(fi(r),"handleClickRestore",function(e){e.stopPropagation(),r.setState({changed:!1,value:r.props.value});var t=r.props.trackingPrefix,n=void 0===t?"config":t;Object(z.trackEvent)("prom.".concat(n,".file.restore.click"))}),di(fi(r),"handleClickSave",function(e){e.stopPropagation(),r.props.onSave&&r.props.onSave(r.props.name,r.state.value);var t=r.props.trackingPrefix,n=void 0===t?"config":t;Object(z.trackEvent)("prom.".concat(n,".file.save.click"))}),di(fi(r),"handleClickDelete",function(e){if(e.stopPropagation(),window.confirm("Do you really want to delete the file ".concat(r.props.name,"?"))){r.props.onDelete&&r.props.onDelete(r.props.name);var t=r.props.trackingPrefix,n=void 0===t?"config":t;Object(z.trackEvent)("prom.".concat(n,".file.delete.click"))}}),di(fi(r),"handleValueChange",function(e){var t=!1,n=r.props.value;t=n?e!==n:e!==r.state.emptyRule,r.setState({changed:t,value:e})}),r.state={changed:!1,emptyRule:e.emptyRule,loading:!e.defaultVisible,value:e.value||e.emptyRule,visible:e.defaultVisible||!1},r}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mi(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentWillReceiveProps",value:function(e){this.props.saving&&!e.saving&&this.setState({changed:!1,value:e.value})}},{key:"componentDidUpdate",value:function(){var e=this,t=this.state,n=t.collapsed,r=t.loading;!n&&r&&setTimeout(function(){return e.setState({loading:!1})},500)}},{key:"render",value:function(){var e=this.props,t=e.errors,n=e.metricNames,r=e.name,a=e.readOnly,i=e.saving,l=e.showAddDefault,c=e.showDelete,s=e.trackingPrefix,u=this.state,p=u.changed,f=u.emptyRule,m=u.loading,d=u.visible,y=this.props.value||f,b=this.state.value,g=b!==y,v=""===b||b===f;return o.a.createElement(hi,null,o.a.createElement(vi,{onClick:this.handleClickHeader},o.a.createElement(yi,null,r),o.a.createElement(Ei,null,d&&!m&&!a&&o.a.createElement(wi,null,o.a.createElement(bi,null,o.a.createElement(h.Button,{onClick:this.handleClickSave,disabled:!g,text:"Save"})),p&&o.a.createElement(bi,null,o.a.createElement(h.Button,{onClick:this.handleClickRestore,text:"Discard changes"})),i&&o.a.createElement(gi,null,"Saving..."),!i&&t&&o.a.createElement(gi,{error:!0},t[0]&&t[0].message||t),v&&l&&o.a.createElement(bi,null,o.a.createElement(h.Button,{onClick:this.handleClickDefault,text:"Add default rules"})),c&&o.a.createElement(bi,null,o.a.createElement(h.Button,{onClick:this.handleClickDelete,text:"Delete"}))),o.a.createElement(Oi,{className:$t()({"fa fa-chevron-down":!d,"fa fa-chevron-up":d})}))),d&&o.a.createElement("div",{className:"prom-config-file-content"},m&&o.a.createElement(Bt.a,{style:{margin:"0 auto",padding:"20px"}}),!m&&o.a.createElement(ci.a,{onChange:this.handleValueChange,value:b,metricNames:n,language:"alertmanager"===s?"yaml":"promqlAlertConfig",readOnly:i||a})))}}])&&ui(n.prototype,r),a&&ui(n,a),t}();function ki(e){return(ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _i(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function ji(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Si(e){return(Si=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xi(e,t){return(xi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ii(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ni=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return r=this,o=(e=Si(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==ki(o)&&"function"!=typeof o?Pi(r):o,Ii(Pi(n),"handleSave",function(e,t){var r=n.props.params.instanceId;if(!Object(Nn.e)(t))return n.props.updatePrometheusConfigError(r,Y.ILLEGAL_URL_MESSAGE);var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_i(n,!0).forEach(function(t){Ii(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_i(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},n.props.data.config,{alertmanager_config:t});return n.props.savePrometheusConfig(r,o)}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xi(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.data,n=e.loading,r=e.readOnly;if(n)return o.a.createElement(Bt.a,{text:"Loading Alertmanager configuration..."});return o.a.createElement(Ci,{name:"Configuration (YAML)",trackingPrefix:"alertmanager",emptyRule:"# Alertmanager configuration\n\n\n",onSave:this.handleSave,readOnly:r,value:t.config.alertmanager_config})}}])&&ji(n.prototype,r),a&&ji(n,a),t}();var Di=Object(f.connect)(function(e,t){var n=e.root.prometheus[t.params.instanceId]||{},r=n.metricNames,o=void 0===r?[]:r,a=n.config,i=!a;return{data:(a||{}).data,loading:i,metricNames:o}},{clearPrometheusConfigError:m.g,getPrometheusConfig:m.N,savePrometheusConfig:m.Eb,updatePrometheusConfigError:m.Vb})(Ni),Ti=n(549);function Ri(e){return(Ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ai(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function Fi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ai(n,!0).forEach(function(t){Ui(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ai(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Mi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ki(e){return(Ki=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wi(e,t){return(Wi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ui(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zi=null,Hi=null,Gi=3e4;function Li(){return"prometheus-".concat(Date.now(),".rules")}var qi=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Ki(t).call(this,e),n=!o||"object"!==Ri(o)&&"function"!=typeof o?Bi(r):o,Ui(Bi(n),"handleSave",function(e,t){var r=n.props.files||{};r[e]||(n.nextKey=Li());var o=Fi({},r,Ui({},e,t)),a=Fi({},n.props.data.config,{rules_files:o});n.props.savePrometheusConfig(n.props.params.instanceId,a)}),Ui(Bi(n),"handleDelete",function(e){var t=Fi({},n.props.files||{});delete t[e];var r=Fi({},n.props.data.config,{rules_files:t});n.props.savePrometheusConfig(n.props.params.instanceId,r)}),n.nextKey=Li(),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wi(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.props.checkPrometheus(this.props.params.instanceId)}},{key:"componentWillReceiveProps",value:function(e){e.params.instanceId!==this.props.params.instanceId&&(this.nextKey=Li(),this.props.checkPrometheus(e.params.instanceId))}},{key:"componentWillUnmount",value:function(){clearTimeout(Hi)}},{key:"render",value:function(){var e=this,t=this.props,n=t.readOnly,r=t.files;if(t.loading)return o.a.createElement(Bt.a,{text:"Loading rules..."});var a=Object.keys(r).length,i=Fi({},r,Ui({},this.nextKey,"")),l=Object.values(r).find(function(e){return Vo()(e,Ti.a)});return o.a.createElement("div",null,0===a&&o.a.createElement("div",null,o.a.createElement("p",null,"No alerting or recording rules found. You can create rules by adding them to the field below, or add some default rules for Kubernetes.")),Object.keys(i).map(function(t,r){return o.a.createElement(Ci,{trackingPrefix:"rules",showAddDefault:!l&&!i[t],showDelete:r<a,emptyRule:"# Recording rules\n\n# Alert rules\n",defaultRules:Ti.a,key:t,name:t,onDelete:e.handleDelete,onSave:e.handleSave,value:i[t],metricNames:e.props.metricNames,readOnly:n})}))}}])&&Mi(n.prototype,r),a&&Mi(n,a),t}();var Vi=Object(f.connect)(function(e,t){var n=e.root.prometheus[t.params.instanceId]||{},r=n.metricNames,o=void 0===r?[]:r,a=n.config,i=!a;return{data:(a||{}).data,files:F()(a,["data","config","rules_files"],{})||{},loading:i,metricNames:o}},{checkPrometheus:function e(t){return function(n){clearTimeout(Hi),zi=t,Object(Ln.U)(t).then(function(e){t===zi&&n(Object(m.ub)(t,e.data))}).catch(function(){t===zi&&n(Object(m.tb)(t,"Prometheus connection error"))}).then(function(){Hi=setTimeout(function(){n(e(t))},Gi)})}},clearPrometheusConfigError:m.g,getPrometheusConfig:m.N,savePrometheusConfig:m.Eb})(qi);function Yi(e){return(Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qi(){return(Qi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ji(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $i(e){return($i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zi(e,t){return(Zi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var el=g.default.div.withConfig({displayName:"page__AlertsPageContainer",componentId:"saj1ss-0"})(["padding:48px;"]),tl=g.default.div.withConfig({displayName:"page__Section",componentId:"saj1ss-1"})(["margin-top:32px;"]),nl=g.default.h3.withConfig({displayName:"page__SectionTitle",componentId:"saj1ss-2"})(["font-size:",";font-weight:bold;"],function(e){return e.theme.fontSizes.normal}),rl=function(e){function t(){var e,n,r,o,a,i,l;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return r=this,o=(e=$i(t)).call.apply(e,[this].concat(s)),n=!o||"object"!==Yi(o)&&"function"!=typeof o?Xi(r):o,a=Xi(n),l=function(){n.props.clearPrometheusConfigError(n.props.params.instanceId)},(i="handleDismissErrors")in a?Object.defineProperty(a,i,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[i]=l,n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zi(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.props.getPrometheusConfig(this.props.params.instanceId)}},{key:"render",value:function(){var e=this,t=F()(this.props.error,["errors",0,"message"]);return o.a.createElement(d.a,{permissions:["alert.settings.update"]},function(n){return o.a.createElement(el,null,o.a.createElement("h2",null,"Configure Alerts"),o.a.createElement(tl,null,o.a.createElement(nl,null,"Alerting rules"),o.a.createElement("p",null,"Define alert conditions, expressed as"," ",o.a.createElement("a",{target:"promRules",href:"https://prometheus.io/docs/prometheus/1.8/configuration/alerting_rules/"},"Prometheus alerting rules"),"."),o.a.createElement(Vi,Qi({readOnly:!n},e.props))),o.a.createElement(tl,null,o.a.createElement(nl,null,"Alertmanager"),o.a.createElement("p",null,"Define how alerts should be processed and routed, by supplying a"," ",o.a.createElement("a",{target:"promConfiguration",href:"https://prometheus.io/docs/alerting/configuration/"},"Prometheus Alertmanager configuration"),".",o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("i",null,"Note:")," This is normally unnecessary since Weave Cloud contains a built-in configuration which routes alerts via"," ",o.a.createElement(Qt.a,{to:Object(Xt.R)(e.props.params.instanceId)},"Weave Cloud Notifications"),"; supplying your own Alertmanager configuration could break that integration."),o.a.createElement(Di,Qi({readOnly:!n},e.props))),o.a.createElement(no.a,null,o.a.createElement(h.Alert,{type:"error",visible:Boolean(t),onClose:e.handleDismissErrors},t)))})}}])&&Ji(n.prototype,r),a&&Ji(n,a),t}();var ol=Object(f.connect)(function(e,t){var n=e.root;return{error:F()(n.prometheus,[t.params.instanceId,"config","error"])}},{clearPrometheusConfigError:m.g,getPrometheusConfig:m.N})(rl),al=n(1549);function il(e){return(il="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ll(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cl(e,t){return!t||"object"!==il(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sl(e){return(sl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ul(e,t){return(ul=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pl=g.default.div.withConfig({displayName:"page__CloudWatchContainer",componentId:"sc-1u4zbeg-0"})(["padding:48px;"]),fl=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),cl(this,sl(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ul(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement(pl,null,o.a.createElement(al.a,null))}}])&&ll(n.prototype,r),a&&ll(n,a),t}();t.default=[o.a.createElement(c.a,{name:"instance",component:Jr},o.a.createElement(c.a,{path:"team",component:Bo,gaName:"TeamInstance",mpEvent:"instance.team.page.view"}),o.a.createElement(c.a,{path:"billing",component:Ft,gaName:"BillingInstance",mpEvent:"instance.billing.page.view"}),o.a.createElement(c.a,{path:"delete",component:Kn,gaName:"DeleteInstance",mpEvent:"instance.delete.page.view"}),o.a.createElement(c.a,{component:p.a},o.a.createElement(i.a,{component:bn,gaName:"ConfigureInstance",mpEvent:"instance.status.page.view"}),o.a.createElement(c.a,{path:"setup",component:li,gaName:"SetupPage",mpEvent:"instance.install.page.view"}),o.a.createElement(c.a,{path:"deploy",component:Un,gaName:"DeployInstance",mpEvent:"deploy.settings.page.view"}),o.a.createElement(c.a,{path:"deploy/push-github-deploy-keys",component:Un}),o.a.createElement(c.a,{path:"webhooks",component:Mr,gaName:"WebhooksPage",mpEvent:"deploy.webhooks.page.view"}),o.a.createElement(c.a,{path:"cloudwatch",component:fl,gaName:"CloudwatchPage",mpEvent:"prom.settings.cloudwatch.view"}),o.a.createElement(c.a,{path:"notifications",component:ri,gaName:"NotificationSettingsPage",mpEvent:"notification.settings.page.view"}),o.a.createElement(c.a,{path:"alerts",component:ol,gaName:"AlertsPage",mpEvent:"prom.alerts.view"}),o.a.createElement(u.a,{from:"alerting/rules",to:"alerts"}),o.a.createElement(u.a,{from:"alerting/receivers",to:"alerts"})))]}}]);